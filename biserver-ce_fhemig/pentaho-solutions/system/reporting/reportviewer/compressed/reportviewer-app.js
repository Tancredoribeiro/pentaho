/*!
* jQuery JavaScript Library v1.7.1
* http://jquery.com/
*
* Copyright 2011, John Resig
* Dual licensed under the MIT or GPL Version 2 licenses.
* http://jquery.org/license
*
* Includes Sizzle.js
* http://sizzlejs.com/
* Copyright 2011, The Dojo Foundation
* Released under the MIT, BSD, and GPL Licenses.
*
* Date: Mon Nov 21 21:11:03 2011 -0500
*/

/*!
 * Sizzle CSS Selector Engine
 *  Copyright 2011, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */

/*!
* jQuery Impromptu
* By: Trent Richardson [http://trentrichardson.com]
* Version 3.1
* Last Modified: 3/30/2010
*
* Copyright 2010 Trent Richardson
* Dual licensed under the MIT and GPL licenses.
* http://trentrichardson.com/Impromptu/GPL-LICENSE.txt
* http://trentrichardson.com/Impromptu/MIT-LICENSE.txt
*
*/

/*!
* jQuery UI 1.8.14
*
* Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
* Dual licensed under the MIT or GPL Version 2 licenses.
* http://jquery.org/license
*
* http://docs.jquery.com/UI
*/

/*!
 * jQuery UI Widget 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */

/*!
 * jQuery UI Mouse 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Mouse
 *
 * Depends:
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Position 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Position
 */

/*
 * jQuery UI Draggable 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Draggables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Droppable 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Droppables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.mouse.js
 *	jquery.ui.draggable.js
 */

/*
 * jQuery UI Resizable 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Resizables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Selectable 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Selectables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Sortable 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Sortables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Accordion 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Accordion
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Autocomplete 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Autocomplete
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.position.js
 */

/*
 * jQuery UI Menu (not officially released)
 * 
 * This widget isn't yet finished and the API is subject to change. We plan to finish
 * it for the next release. You're welcome to give it a try anyway and give us feedback,
 * as long as you're okay with migrating your code later on. We can help with that, too.
 *
 * Copyright 2010, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Menu
 *
 * Depends:
 *	jquery.ui.core.js
 *  jquery.ui.widget.js
 */

/*
 * jQuery UI Button 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Button
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Dialog 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Dialog
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *  jquery.ui.button.js
 *	jquery.ui.draggable.js
 *	jquery.ui.mouse.js
 *	jquery.ui.position.js
 *	jquery.ui.resizable.js
 */

/*
 * jQuery UI Slider 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Slider
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Tabs 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Tabs
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Datepicker 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Datepicker
 *
 * Depends:
 *	jquery.ui.core.js
 */

/*
 * jQuery UI Progressbar 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Progressbar
 *
 * Depends:
 *   jquery.ui.core.js
 *   jquery.ui.widget.js
 */

/*
 * jQuery UI Effects 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/
 */

/*
 * jQuery Easing v1.3 - http://gsgd.co.uk/sandbox/jquery/easing/
 *
 * Uses the built in easing capabilities added In jQuery 1.1
 * to offer multiple easing options
 *
 * TERMS OF USE - jQuery Easing
 *
 * Open source under the BSD License.
 *
 * Copyright 2008 George McGinley Smith
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice, this list of
 * conditions and the following disclaimer.
 * Redistributions in binary form must reproduce the above copyright notice, this list
 * of conditions and the following disclaimer in the documentation and/or other materials
 * provided with the distribution.
 *
 * Neither the name of the author nor the names of contributors may be used to endorse
 * or promote products derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
 * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
 * GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
 * AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 *
*/

/*
 *
 * TERMS OF USE - EASING EQUATIONS
 *
 * Open source under the BSD License.
 *
 * Copyright 2001 Robert Penner
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice, this list of
 * conditions and the following disclaimer.
 * Redistributions in binary form must reproduce the above copyright notice, this list
 * of conditions and the following disclaimer in the documentation and/or other materials
 * provided with the distribution.
 *
 * Neither the name of the author nor the names of contributors may be used to endorse
 * or promote products derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
 * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
 * GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
 * AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 */

/*
 * jQuery UI Effects Blind 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Blind
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Bounce 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Bounce
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Clip 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Clip
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Drop 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Drop
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Explode 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Explode
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Fade 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Fade
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Fold 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Fold
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Highlight 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Highlight
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Pulsate 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Pulsate
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Scale 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Scale
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Shake 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Shake
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Slide 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Slide
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Transfer 1.8.14
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Transfer
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*! Copyright (c) 2006 Brandon Aaron (http://brandonaaron.net)
* Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
* and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
*
*
* Version 2.1.1
*/

/*!
* jdMenu 1.4.1 (2008-03-31)
*
* Copyright (c) 2006,2007 Jonathan Sharp (http://jdsharp.us)
* Dual licensed under the MIT (MIT-LICENSE.txt)
* and GPL (GPL-LICENSE.txt) licenses.
*
* http://jdsharp.us/
*
* Built upon jQuery 1.2.1 (http://jquery.com)
* This also requires the jQuery dimensions >= 1.2 plugin
*/

/*!
* positionBy 1.0.7 (2008-01-29)
*
* Copyright (c) 2006,2007 Jonathan Sharp (http://jdsharp.us)
* Dual licensed under the MIT (MIT-LICENSE.txt)
* and GPL (GPL-LICENSE.txt) licenses.
*
* http://jdsharp.us/
*
* Built upon jQuery 1.2.2 (http://jquery.com)
* This also requires the jQuery dimensions plugin
*/

/*!
* jQuery Tooltip plugin 1.3
*
* http://bassistance.de/jquery-plugins/jquery-plugin-tooltip/
* http://docs.jquery.com/Plugins/Tooltip
*
* Copyright (c) 2006 - 2008 JÃ¶rn Zaefferer
*
*
* Dual licensed under the MIT and GPL licenses:
*   http://www.opensource.org/licenses/mit-license.php
*   http://www.gnu.org/licenses/gpl.html
*/

/*!
* jQuery blockUI plugin
* Version 2.33 (29-MAR-2010)
*
* Examples at: http://malsup.com/jquery/block/
* Copyright (c) 2007-2008 M. Alsup
* Dual licensed under the MIT and GPL licenses:
* http://www.opensource.org/licenses/mit-license.php
* http://www.gnu.org/licenses/gpl.html
*
* Thanks to Amir-Hossein Sobhi for some excellent contributions!
*/

/*! *
*
* Dual licensed under the MIT (MIT-LICENSE.txt)
* and GPL (GPL-LICENSE.txt) licenses.
*
*
* This is a jQuery plugin that allows events to be handled in reverse order of
* binding - add events to the head of the queue rather than the end.
*
* Particularly useful if you apply your "do"s in a modular order and wish to
* apply your "undo"s in reverse order.
*
* It adds the following two methods:
*
* reverse(event): reverses the order that functions attached to <event> are
*                 applied to this element.
*
* stack( event, data, fn ): just like bind(), except adds to the front of the
*                           event queue instead of the end.
*
* Also, every event method (.click(), .focus(), .resize(), .submit(), etc -
* 21 methods in all) can take an extra parameter "reverse" that controls if
* the event is added to the front or end of the event queue. For example:
*
*
* ... will show "3", "1" then "2" when the document is clicked.
*
*/

/*!
Base.js, version 1.1a
Copyright 2006-2010, Dean Edwards
License: http://www.opensource.org/licenses/mit-license.php
*/

//     Underscore.js 1.5.2
//     http://underscorejs.org
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

//     (c) 2010-2011 Jeremy Ashkenas, DocumentCloud Inc.
//     (c) 2011-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

/*!
* Copyright 2002 - 2013 Webdetails, a Pentaho company.  All rights reserved.
* 
* This software was developed by Webdetails and is provided under the terms
* of the Mozilla Public License, Version 2.0, or any later version. You may not use
* this file except in compliance with the license. If you need a copy of the license,
* please go to  http://mozilla.org/MPL/2.0/. The Initial Developer is Webdetails.
*
* Software distributed under the Mozilla Public License is distributed on an "AS IS"
* basis, WITHOUT WARRANTY OF ANY KIND, either express or  implied. Please refer to
* the license for the specific language governing your rights and limitations.
*/

/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */

/*!
/*!
* Copyright 2002 - 2014 Webdetails, a Pentaho company.  All rights reserved.
* 
* This software was developed by Webdetails and is provided under the terms
* of the Mozilla Public License, Version 2.0, or any later version. You may not use
* this file except in compliance with the license. If you need a copy of the license,
* please go to  http://mozilla.org/MPL/2.0/. The Initial Developer is Webdetails.
*
* Software distributed under the Mozilla Public License is distributed on an "AS IS"
* basis, WITHOUT WARRANTY OF ANY KIND, either express or  implied. Please refer to
* the license for the specific language governing your rights and limitations.
*/

/*!
* Copyright 2002 - 2013 Webdetails, a Pentaho company.  All rights reserved.
*
* This software was developed by Webdetails and is provided under the terms
* of the Mozilla Public License, Version 2.0, or any later version. You may not use
* this file except in compliance with the license. If you need a copy of the license,
* please go to  http://mozilla.org/MPL/2.0/. The Initial Developer is Webdetails.
*
* Software distributed under the Mozilla Public License is distributed on an "AS IS"
* basis, WITHOUT WARRANTY OF ANY KIND, either express or  implied. Please refer to
* the license for the specific language governing your rights and limitations.
*/

/*!
 * Copyright 2002 - 2013 Webdetails, a Pentaho company.  All rights reserved.
 *
 * This software was developed by Webdetails and is provided under the terms
 * of the Mozilla Public License, Version 2.0, or any later version. You may not use
 * this file except in compliance with the license. If you need a copy of the license,
 * please go to  http://mozilla.org/MPL/2.0/. The Initial Developer is Webdetails.
 *
 * Software distributed under the Mozilla Public License is distributed on an "AS IS"
 * basis, WITHOUT WARRANTY OF ANY KIND, either express or  implied. Please refer to
 * the license for the specific language governing your rights and limitations.
 */

/*!
 * Copyright 2002 - 2013 Webdetails, a Pentaho company.  All rights reserved.
 * 
 * This software was developed by Webdetails and is provided under the terms
 * of the Mozilla Public License, Version 2.0, or any later version. You may not use
 * this file except in compliance with the license. If you need a copy of the license,
 * please go to  http://mozilla.org/MPL/2.0/. The Initial Developer is Webdetails.
 *
 * Software distributed under the Mozilla Public License is distributed on an "AS IS"
 * basis, WITHOUT WARRANTY OF ANY KIND, either express or  implied. Please refer to
 * the license for the specific language governing your rights and limitations.
 */

/*! Copyright 2010 Stanford Visualization Group, Mike Bostock, BSD license. */

/*! 20ff53aee6ff40a717507776c4412811ca3c1d21 */

/*
 * TERMS OF USE - EASING EQUATIONS
 *
 * Open source under the BSD License.
 *
 * Copyright 2001 Robert Penner
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * - Redistributions of source code must retain the above copyright notice, this
 *   list of conditions and the following disclaimer.
 *
 * - Redistributions in binary form must reproduce the above copyright notice,
 *   this list of conditions and the following disclaimer in the documentation
 *   and/or other materials provided with the distribution.
 *
 * - Neither the name of the author nor the names of contributors may be used to
 *   endorse or promote products derived from this software without specific
 *   prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */

/*!!*/

/*!
* Copyright 2002 - 2014 Webdetails, a Pentaho company.  All rights reserved.
* 
* This software was developed by Webdetails and is provided under the terms
* of the Mozilla Public License, Version 2.0, or any later version. You may not use
* this file except in compliance with the license. If you need a copy of the license,
* please go to  http://mozilla.org/MPL/2.0/. The Initial Developer is Webdetails.
*
* Software distributed under the Mozilla Public License is distributed on an "AS IS"
* basis, WITHOUT WARRANTY OF ANY KIND, either express or  implied. Please refer to
* the license for the specific language governing your rights and limitations.
*/

/*!
 * Copyright 2002 - 2014 Webdetails, a Pentaho company.  All rights reserved.
 * 
 * This software was developed by Webdetails and is provided under the terms
 * of the Mozilla Public License, Version 2.0, or any later version. You may not use
 * this file except in compliance with the license. If you need a copy of the license,
 * please go to  http://mozilla.org/MPL/2.0/. The Initial Developer is Webdetails.
 *
 * Software distributed under the Mozilla Public License is distributed on an "AS IS"
 * basis, WITHOUT WARRANTY OF ANY KIND, either express or  implied. Please refer to
 * the license for the specific language governing your rights and limitations.
 */

/*!
* Copyright 2010 - 2013 Pentaho Corporation.  All rights reserved.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*
*/

/*!
* jQuery corner plugin: simple corner rounding
* Examples and documentation at: http://jquery.malsup.com/corner/
* version 1.98 (02-JUN-2009)
* Dual licensed under the MIT and GPL licenses:
* http://www.opensource.org/licenses/mit-license.php
* http://www.gnu.org/licenses/gpl.html
*/

/*! *****************************************************************************
* jquery.i18n.properties
*
* Dual licensed under the GPL (http://dev.jquery.com/browser/trunk/jquery/GPL-LICENSE.txt) and
* MIT (http://dev.jquery.com/browser/trunk/jquery/MIT-LICENSE.txt) licenses.
*
*              by Keith Wood (kbwood{at}iinet.com.au) June 2007
*
*****************************************************************************/

/*!
* Copyright 2002 - 2013 Webdetails, a Pentaho company.  All rights reserved.
* 
* This software was developed by Webdetails and is provided under the terms
* of the Mozilla Public License, Version 2.0, or any later version. You may not use
* this file except in compliance with the license. If you need a copy of the license,
* please go to  http://mozilla.org/MPL/2.0/. The Initial Developer is Webdetails.
*
* Software distributed under the Mozilla Public License is distributed on an "AS IS"
* basis, WITHOUT WARRANTY OF ANY KIND, either express or  implied. Please refer to
* the license for the specific language governing your rights and limitations.

This file is empty due to r.js build steps requiring an existing file for declared shims

*/

/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*!
 * Copyright 2010 - 2013 Pentaho Corporation.  All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */

/*!
* This program is free software; you can redistribute it and/or modify it under the
* terms of the GNU Lesser General Public License, version 2.1 as published by the Free Software
* Foundation.
*
* You should have received a copy of the GNU Lesser General Public License along with this
* program; if not, you can obtain a copy at http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html
* or from the Free Software Foundation, Inc.,
* 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
*
* This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
* without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
* See the GNU Lesser General Public License for more details.
*
* Copyright (c) 2002-2013 Pentaho Corporation..  All rights reserved.
*/

/*!
 * This program is free software; you can redistribute it and/or modify it under the
 * terms of the GNU Lesser General Public License, version 2.1 as published by the Free Software
 * Foundation.
 *
 * You should have received a copy of the GNU Lesser General Public License along with this
 * program; if not, you can obtain a copy at http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html
 * or from the Free Software Foundation, Inc.,
 * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 * See the GNU Lesser General Public License for more details.
 *
 * Copyright (c) 2002-2013 Pentaho Corporation..  All rights reserved.
 */

/*
 * This program is free software; you can redistribute it and/or modify it under the
 * terms of the GNU Lesser General Public License, version 2.1 as published by the Free Software
 * Foundation.
 *
 * You should have received a copy of the GNU Lesser General Public License along with this
 * program; if not, you can obtain a copy at http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html
 * or from the Free Software Foundation, Inc.,
 * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 * See the GNU Lesser General Public License for more details.
 *
 * Copyright 2014 Pentaho Corporation. All rights reserved.
 */

function encode_prepare_arr(e){if(typeof e=="number")return e;if($.isArray(e)){var t=new Array(e.length);return $.each(e,function(e,n){t[e]=encode_prepare(n)}),t}return encode_prepare(e)}function encode_prepare(e){if(e!=null){e=e.replace(/\+/g," ");if($.browser=="msie"||$.browser=="opera")return Utf8.decode(e)}return e}function getURLParameters(e){if(e.indexOf("?")>0){var t=e.split("?"),n=t[1].split("&"),r=[];for(var i=0;i<n.length;i++){var s=n[i].split("=");if(s[0].indexOf("param",0)==0){var o=[s[0].substring(5,s[0].length),unescape(s[1])];r.push(o)}}}return r}function toFormatedString(e){e+="";var t=e.split("."),n=t[0],r=t.length>1?"."+t[1]:"",i=/(\d+)(\d{3})/;while(i.test(n))n=n.replace(i,"$1,$2");return n+r}function doCsvQuoting(e,t,n){var r='"';if(t==null)return e;if(e==null)return null;e.indexOf(r)>=0&&(e=e.replace(r,r.concat(r)));if(n||e.indexOf(t)>=0)e=r.concat(e,r);return e}function pentahoAction(e,t,n,r,i){var s=WEB_CONTEXT_BASE+"ViewAction",o="wrapper=false&solution="+e+"&path="+t+"&action="+n;if(r){var u;for(u=0;u<r.length;u++)o+="&"+encodeURIComponent(r[u][0])+"="+encodeURIComponent(r[u][1])}return pentahoPost(s,o,i)}function pentahoService(e,t,n,r){var i=WEB_CONTEXT_BASE+"ServiceAction",s="ajax=true&";e&&(s+="component="+e+"&");if(t){var o;for(o=0;o<t.length;o++)s+="&"+encodeURIComponent(t[o][0])+"="+encodeURIComponent(t[o][1])}return pentahoPost(i,s,n,r)}function pentahoGet(e,t,n,r,i){var s=undefined!=n&&null!=n,o=null,u="text/xml";r&&(u=r);if(window.XMLHttpRequest)o=new XMLHttpRequest,o.overrideMimeType&&o.overrideMimeType(u);else if(window.ActiveXObject)try{o=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{o=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){o=null}}if(!o)throw new Error("Cannot create an XMLHTTP instance");s&&(o.onreadystatechange=function(){pentahoResponse(o,n)});if(i!==!0){var f=(new Date).getTime();t=t+(t.length===0?"":"&")+f+"="+f}return o.open("GET",e+"?"+t,s),o.send(null),s?null:getResponse(o)}function getUnauthorizedMsg(){return"<web-service><unauthorized/></web-service>"}function getNotFoundMsg(){return"<web-service><not-found/></web-service>"}function pentahoPost(e,t,n,r){var i=undefined!=n&&null!=n,s=null,o="text/xml";r&&(o=r);if(window.XMLHttpRequest)s=new XMLHttpRequest,s.overrideMimeType&&s.overrideMimeType(o);else if(window.ActiveXObject)try{s=new ActiveXObject("Msxml2.XMLHTTP")}catch(u){try{s=new ActiveXObject("Microsoft.XMLHTTP")}catch(u){s=null}}if(!s)throw new Error("Cannot create XMLHTTP instance");return i&&(s.onreadystatechange=function(){pentahoResponse(s,n)}),s.open("POST",e,i),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.setRequestHeader("Content-length",t.length),s.setRequestHeader("Connection","close"),s.send(t),i?null:getResponse(s)}function pentahoResponse(http_request,func){if(http_request.readyState==COMPLETE)try{var content=getResponse(http_request);if(typeof func=="function")func(content);else if(typeof func=="object"&&undefined!=func.obj)func.method.call(func.obj,content);else{if(typeof func!="string")throw new Error("Invalid state in pentahoResponse, unrecognized callback function.");eval(func+"( content );")}}catch(e){var msg=e.message;throw alert("pentaho-ajax.js.pentahoResponse(): "+e),e}}function getResponse(e){switch(e.status){case STATUS_OK:return e.responseText;case STATUS_UNAUTHORIZED:return getUnauthorizedMsg();case STATUS_NOT_FOUND:return getNotFoundMsg();default:return null}}function base64Decode(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");var n="",r,i,s,o,u,a,f,l=0;while(l<e.length)o=t.indexOf(e.charAt(l++)),u=t.indexOf(e.charAt(l++)),a=t.indexOf(e.charAt(l++)),f=t.indexOf(e.charAt(l++)),r=o<<2|u>>4,i=(u&15)<<4|a>>2,s=(a&3)<<6|f,n+=String.fromCharCode(r),a!==64&&(n+=String.fromCharCode(i)),f!==64&&(n+=String.fromCharCode(s));return utf8Decode(n)}function utf8Decode(e){var t="",n=0,r=c1=c2=0;while(n<e.length)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|c2&63),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63),n+=3);return t}(function(e,t){function u(e){var t=o[e]={},n,r;e=e.split(/\s+/);for(n=0,r=e.length;n<r;n++)t[e[n]]=!0;return t}function c(e,n,r){if(r===t&&e.nodeType===1){var i="data-"+n.replace(l,"-$1").toLowerCase();r=e.getAttribute(i);if(typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:s.isNumeric(r)?parseFloat(r):f.test(r)?s.parseJSON(r):r}catch(o){}s.data(e,n,r)}else r=t}return r}function h(e){for(var t in e){if(t==="data"&&s.isEmptyObject(e[t]))continue;if(t!=="toJSON")return!1}return!0}function p(e,t,n){var r=t+"defer",i=t+"queue",o=t+"mark",u=s._data(e,r);u&&(n==="queue"||!s._data(e,i))&&(n==="mark"||!s._data(e,o))&&setTimeout(function(){!s._data(e,i)&&!s._data(e,o)&&(s.removeData(e,r,!0),u.fire())},0)}function H(){return!1}function B(){return!0}function W(e){return!e||!e.parentNode||e.parentNode.nodeType===11}function X(e,t,n){t=t||0;if(s.isFunction(t))return s.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return s.grep(e,function(e,r){return e===t===n});if(typeof t=="string"){var r=s.grep(e,function(e){return e.nodeType===1});if(q.test(t))return s.filter(t,r,!n);t=s.filter(t,r)}return s.grep(e,function(e,r){return s.inArray(e,t)>=0===n})}function V(e){var t=$.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function at(e,t){return s.nodeName(e,"table")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ft(e,t){if(t.nodeType!==1||!s.hasData(e))return;var n,r,i,o=s._data(e),u=s._data(t,o),a=o.events;if(a){delete u.handle,u.events={};for(n in a)for(r=0,i=a[n].length;r<i;r++)s.event.add(t,n+(a[n][r].namespace?".":"")+a[n][r].namespace,a[n][r],a[n][r].data)}u.data&&(u.data=s.extend({},u.data))}function lt(e,t){var n;if(t.nodeType!==1)return;t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase();if(n==="object")t.outerHTML=e.outerHTML;else if(n!=="input"||e.type!=="checkbox"&&e.type!=="radio"){if(n==="option")t.selected=e.defaultSelected;else if(n==="input"||n==="textarea")t.defaultValue=e.defaultValue}else e.checked&&(t.defaultChecked=t.checked=e.checked),t.value!==e.value&&(t.value=e.value);t.removeAttribute(s.expando)}function ct(e){return typeof e.getElementsByTagName!="undefined"?e.getElementsByTagName("*"):typeof e.querySelectorAll!="undefined"?e.querySelectorAll("*"):[]}function ht(e){if(e.type==="checkbox"||e.type==="radio")e.defaultChecked=e.checked}function pt(e){var t=(e.nodeName||"").toLowerCase();t==="input"?ht(e):t!=="script"&&typeof e.getElementsByTagName!="undefined"&&s.grep(e.getElementsByTagName("input"),ht)}function dt(e){var t=n.createElement("div");return ut.appendChild(t),t.innerHTML=e.outerHTML,t.firstChild}function vt(e,t){t.src?s.ajax({url:t.src,async:!1,dataType:"script"}):s.globalEval((t.text||t.textContent||t.innerHTML||"").replace(st,"/*$0*/")),t.parentNode&&t.parentNode.removeChild(t)}function Lt(e,t,n){var r=t==="width"?e.offsetWidth:e.offsetHeight,i=t==="width"?xt:Tt,o=0,u=i.length;if(r>0){if(n!=="border")for(;o<u;o++)n||(r-=parseFloat(s.css(e,"padding"+i[o]))||0),n==="margin"?r+=parseFloat(s.css(e,n+i[o]))||0:r-=parseFloat(s.css(e,"border"+i[o]+"Width"))||0;return r+"px"}r=Nt(e,t,t);if(r<0||r==null)r=e.style[t]||0;r=parseFloat(r)||0;if(n)for(;o<u;o++)r+=parseFloat(s.css(e,"padding"+i[o]))||0,n!=="padding"&&(r+=parseFloat(s.css(e,"border"+i[o]+"Width"))||0),n==="margin"&&(r+=parseFloat(s.css(e,n+i[o]))||0);return r+"px"}function Gt(e){return function(t,n){typeof t!="string"&&(n=t,t="*");if(s.isFunction(n)){var r=t.toLowerCase().split(Rt),i=0,o=r.length,u,a,f;for(;i<o;i++)u=r[i],f=/^\+/.test(u),f&&(u=u.substr(1)||"*"),a=e[u]=e[u]||[],a[f?"unshift":"push"](n)}}}function Yt(e,n,r,i,s,o){s=s||n.dataTypes[0],o=o||{},o[s]=!0;var u=e[s],a=0,f=u?u.length:0,l=e===Xt,c;for(;a<f&&(l||!c);a++)c=u[a](n,r,i),typeof c=="string"&&(!l||o[c]?c=t:(n.dataTypes.unshift(c),c=Yt(e,n,r,i,c,o)));return(l||!c)&&!o["*"]&&(c=Yt(e,n,r,i,"*",o)),c}function Zt(e,n){var r,i,o=s.ajaxSettings.flatOptions||{};for(r in n)n[r]!==t&&((o[r]?e:i||(i={}))[r]=n[r]);i&&s.extend(!0,e,i)}function en(e,t,n,r){if(s.isArray(t))s.each(t,function(t,i){n||Ot.test(e)?r(e,i):en(e+"["+(typeof i=="object"||s.isArray(i)?t:"")+"]",i,n,r)});else if(!n&&t!=null&&typeof t=="object")for(var i in t)en(e+"["+i+"]",t[i],n,r);else r(e,t)}function tn(e,n,r){var i=e.contents,s=e.dataTypes,o=e.responseFields,u,a,f,l;for(a in o)a in r&&(n[o[a]]=r[a]);while(s[0]==="*")s.shift(),u===t&&(u=e.mimeType||n.getResponseHeader("content-type"));if(u)for(a in i)if(i[a]&&i[a].test(u)){s.unshift(a);break}if(s[0]in r)f=s[0];else{for(a in r){if(!s[0]||e.converters[a+" "+s[0]]){f=a;break}l||(l=a)}f=f||l}if(f)return f!==s[0]&&s.unshift(f),r[f]}function nn(e,n){e.dataFilter&&(n=e.dataFilter(n,e.dataType));var r=e.dataTypes,i={},o,u,a=r.length,f,l=r[0],c,h,p,d,v;for(o=1;o<a;o++){if(o===1)for(u in e.converters)typeof u=="string"&&(i[u.toLowerCase()]=e.converters[u]);c=l,l=r[o];if(l==="*")l=c;else if(c!=="*"&&c!==l){h=c+" "+l,p=i[h]||i["* "+l];if(!p){v=t;for(d in i){f=d.split(" ");if(f[0]===c||f[0]==="*"){v=i[f[1]+" "+l];if(v){d=i[d],d===!0?p=v:v===!0&&(p=d);break}}}}!p&&!v&&s.error("No conversion from "+h.replace(" "," to ")),p!==!0&&(n=p?p(n):v(d(n)))}}return n}function fn(){try{return new e.XMLHttpRequest}catch(t){}}function ln(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function bn(){return setTimeout(wn,0),yn=s.now()}function wn(){yn=t}function En(e,t){var n={};return s.each(gn.concat.apply([],gn.slice(0,t)),function(){n[this]=e}),n}function Sn(e){if(!cn[e]){var t=n.body,r=s("<"+e+">").appendTo(t),i=r.css("display");r.remove();if(i==="none"||i===""){hn||(hn=n.createElement("iframe"),hn.frameBorder=hn.width=hn.height=0),t.appendChild(hn);if(!pn||!hn.createElement)pn=(hn.contentWindow||hn.contentDocument).document,pn.write((n.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>"),pn.close();r=pn.createElement(e),pn.body.appendChild(r),i=s.css(r,"display"),t.removeChild(hn)}cn[e]=i}return cn[e]}function Nn(e){return s.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var n=e.document,r=e.navigator,i=e.location,s=function(){function H(){if(i.isReady)return;try{n.documentElement.doScroll("left")}catch(e){setTimeout(H,1);return}i.ready()}var i=function(e,t){return new i.fn.init(e,t,u)},s=e.jQuery,o=e.$,u,a=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,f=/\S/,l=/^\s+/,c=/\s+$/,h=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,p=/^[\],:{}\s]*$/,d=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,v=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,m=/(?:^|:|,)(?:\s*\[)+/g,g=/(webkit)[ \/]([\w.]+)/,y=/(opera)(?:.*version)?[ \/]([\w.]+)/,b=/(msie) ([\w.]+)/,w=/(mozilla)(?:.*? rv:([\w.]+))?/,E=/-([a-z]|[0-9])/ig,S=/^-ms-/,x=function(e,t){return(t+"").toUpperCase()},T=r.userAgent,N,C,k,L=Object.prototype.toString,A=Object.prototype.hasOwnProperty,O=Array.prototype.push,M=Array.prototype.slice,_=String.prototype.trim,D=Array.prototype.indexOf,P={};return i.fn=i.prototype={constructor:i,init:function(e,r,s){var o,u,f,l;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(e==="body"&&!r&&n.body)return this.context=n,this[0]=n.body,this.selector=e,this.length=1,this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?o=[null,e,null]:o=a.exec(e);if(o&&(o[1]||!r)){if(o[1])return r=r instanceof i?r[0]:r,l=r?r.ownerDocument||r:n,f=h.exec(e),f?i.isPlainObject(r)?(e=[n.createElement(f[1])],i.fn.attr.call(e,r,!0)):e=[l.createElement(f[1])]:(f=i.buildFragment([o[1]],[l]),e=(f.cacheable?i.clone(f.fragment):f.fragment).childNodes),i.merge(this,e);u=n.getElementById(o[2]);if(u&&u.parentNode){if(u.id!==o[2])return s.find(e);this.length=1,this[0]=u}return this.context=n,this.selector=e,this}return!r||r.jquery?(r||s).find(e):this.constructor(r).find(e)}return i.isFunction(e)?s.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),i.makeArray(e,this))},selector:"",jquery:"1.7.1",length:0,size:function(){return this.length},toArray:function(){return M.call(this,0)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=this.constructor();return i.isArray(e)?O.apply(r,e):i.merge(r,e),r.prevObject=this,r.context=this.context,t==="find"?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return i.each(this,e,t)},ready:function(e){return i.bindReady(),C.add(e),this},eq:function(e){return e=+e,e===-1?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(M.apply(this,arguments),"slice",M.call(arguments).join(","))},map:function(e){return this.pushStack(i.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:O,sort:[].sort,splice:[].splice},i.fn.init.prototype=i.fn,i.extend=i.fn.extend=function(){var e,n,r,s,o,u,a=arguments[0]||{},f=1,l=arguments.length,c=!1;typeof a=="boolean"&&(c=a,a=arguments[1]||{},f=2),typeof a!="object"&&!i.isFunction(a)&&(a={}),l===f&&(a=this,--f);for(;f<l;f++)if((e=arguments[f])!=null)for(n in e){r=a[n],s=e[n];if(a===s)continue;c&&s&&(i.isPlainObject(s)||(o=i.isArray(s)))?(o?(o=!1,u=r&&i.isArray(r)?r:[]):u=r&&i.isPlainObject(r)?r:{},a[n]=i.extend(c,u,s)):s!==t&&(a[n]=s)}return a},i.extend({noConflict:function(t){return e.$===i&&(e.$=o),t&&e.jQuery===i&&(e.jQuery=s),i},isReady:!1,readyWait:1,holdReady:function(e){e?i.readyWait++:i.ready(!0)},ready:function(e){if(e===!0&&!--i.readyWait||e!==!0&&!i.isReady){if(!n.body)return setTimeout(i.ready,1);i.isReady=!0;if(e!==!0&&--i.readyWait>0)return;C.fireWith(n,[i]),i.fn.trigger&&i(n).trigger("ready").off("ready")}},bindReady:function(){if(C)return;C=i.Callbacks("once memory");if(n.readyState==="complete")return setTimeout(i.ready,1);if(n.addEventListener)n.addEventListener("DOMContentLoaded",k,!1),e.addEventListener("load",i.ready,!1);else if(n.attachEvent){n.attachEvent("onreadystatechange",k),e.attachEvent("onload",i.ready);var t=!1;try{t=e.frameElement==null}catch(r){}n.documentElement.doScroll&&t&&H()}},isFunction:function(e){return i.type(e)==="function"},isArray:Array.isArray||function(e){return i.type(e)==="array"},isWindow:function(e){return e&&typeof e=="object"&&"setInterval"in e},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):P[L.call(e)]||"object"},isPlainObject:function(e){if(!e||i.type(e)!=="object"||e.nodeType||i.isWindow(e))return!1;try{if(e.constructor&&!A.call(e,"constructor")&&!A.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||A.call(e,r)},isEmptyObject:function(e){for(var t in e)return!1;return!0},error:function(e){throw new Error(e)},parseJSON:function(t){if(typeof t!="string"||!t)return null;t=i.trim(t);if(e.JSON&&e.JSON.parse)return e.JSON.parse(t);if(p.test(t.replace(d,"@").replace(v,"]").replace(m,"")))return(new Function("return "+t))();i.error("Invalid JSON: "+t)},parseXML:function(n){var r,s;try{e.DOMParser?(s=new DOMParser,r=s.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(o){r=t}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&i.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&f.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(S,"ms-").replace(E,x)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toUpperCase()===t.toUpperCase()},each:function(e,n,r){var s,o=0,u=e.length,a=u===t||i.isFunction(e);if(r){if(a){for(s in e)if(n.apply(e[s],r)===!1)break}else for(;o<u;)if(n.apply(e[o++],r)===!1)break}else if(a){for(s in e)if(n.call(e[s],s,e[s])===!1)break}else for(;o<u;)if(n.call(e[o],o,e[o++])===!1)break;return e},trim:_?function(e){return e==null?"":_.call(e)}:function(e){return e==null?"":e.toString().replace(l,"").replace(c,"")},makeArray:function(e,t){var n=t||[];if(e!=null){var r=i.type(e);e.length==null||r==="string"||r==="function"||r==="regexp"||i.isWindow(e)?O.call(n,e):i.merge(n,e)}return n},inArray:function(e,t,n){var r;if(t){if(D)return D.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=e.length,i=0;if(typeof n.length=="number")for(var s=n.length;i<s;i++)e[r++]=n[i];else while(n[i]!==t)e[r++]=n[i++];return e.length=r,e},grep:function(e,t,n){var r=[],i;n=!!n;for(var s=0,o=e.length;s<o;s++)i=!!t(e[s],s),n!==i&&r.push(e[s]);return r},map:function(e,n,r){var s,o,u=[],a=0,f=e.length,l=e instanceof i||f!==t&&typeof f=="number"&&(f>0&&e[0]&&e[f-1]||f===0||i.isArray(e));if(l)for(;a<f;a++)s=n(e[a],a,r),s!=null&&(u[u.length]=s);else for(o in e)s=n(e[o],o,r),s!=null&&(u[u.length]=s);return u.concat.apply([],u)},guid:1,proxy:function(e,n){if(typeof n=="string"){var r=e[n];n=e,e=r}if(!i.isFunction(e))return t;var s=M.call(arguments,2),o=function(){return e.apply(n,s.concat(M.call(arguments)))};return o.guid=e.guid=e.guid||o.guid||i.guid++,o},access:function(e,n,r,s,o,u){var a=e.length;if(typeof n=="object"){for(var f in n)i.access(e,f,n[f],s,o,r);return e}if(r!==t){s=!u&&s&&i.isFunction(r);for(var l=0;l<a;l++)o(e[l],n,s?r.call(e[l],l,o(e[l],n)):r,u);return e}return a?o(e[0],n):t},now:function(){return(new Date).getTime()},uaMatch:function(e){e=e.toLowerCase();var t=g.exec(e)||y.exec(e)||b.exec(e)||e.indexOf("compatible")<0&&w.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},sub:function(){function e(t,n){return new e.fn.init(t,n)}i.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(r,s){return s&&s instanceof i&&!(s instanceof e)&&(s=e(s)),i.fn.init.call(this,r,s,t)},e.fn.init.prototype=e.fn;var t=e(n);return e},browser:{}}),i.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){P["[object "+t+"]"]=t.toLowerCase()}),N=i.uaMatch(T),N.browser&&(i.browser[N.browser]=!0,i.browser.version=N.version),i.browser.webkit&&(i.browser.safari=!0),f.test(" ")&&(l=/^[\s\xA0]+/,c=/[\s\xA0]+$/),u=i(n),n.addEventListener?k=function(){n.removeEventListener("DOMContentLoaded",k,!1),i.ready()}:n.attachEvent&&(k=function(){n.readyState==="complete"&&(n.detachEvent("onreadystatechange",k),i.ready())}),i}(),o={};s.Callbacks=function(e){e=e?o[e]||u(e):{};var n=[],r=[],i,a,f,l,c,h=function(t){var r,i,o,u,a;for(r=0,i=t.length;r<i;r++)o=t[r],u=s.type(o),u==="array"?h(o):u==="function"&&(!e.unique||!d.has(o))&&n.push(o)},p=function(t,s){s=s||[],i=!e.memory||[t,s],a=!0,c=f||0,f=0,l=n.length;for(;n&&c<l;c++)if(n[c].apply(t,s)===!1&&e.stopOnFalse){i=!0;break}a=!1,n&&(e.once?i===!0?d.disable():n=[]:r&&r.length&&(i=r.shift(),d.fireWith(i[0],i[1])))},d={add:function(){if(n){var e=n.length;h(arguments),a?l=n.length:i&&i!==!0&&(f=e,p(i[0],i[1]))}return this},remove:function(){if(n){var t=arguments,r=0,i=t.length;for(;r<i;r++)for(var s=0;s<n.length;s++)if(t[r]===n[s]){a&&s<=l&&(l--,s<=c&&c--),n.splice(s--,1);if(e.unique)break}}return this},has:function(e){if(n){var t=0,r=n.length;for(;t<r;t++)if(e===n[t])return!0}return!1},empty:function(){return n=[],this},disable:function(){return n=r=i=t,this},disabled:function(){return!n},lock:function(){return r=t,(!i||i===!0)&&d.disable(),this},locked:function(){return!r},fireWith:function(t,n){return r&&(a?e.once||r.push([t,n]):(!e.once||!i)&&p(t,n)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!i}};return d};var a=[].slice;s.extend({Deferred:function(e){var t=s.Callbacks("once memory"),n=s.Callbacks("once memory"),r=s.Callbacks("memory"),i="pending",o={resolve:t,reject:n,notify:r},u={done:t.add,fail:n.add,progress:r.add,state:function(){return i},isResolved:t.fired,isRejected:n.fired,then:function(e,t,n){return a.done(e).fail(t).progress(n),this},always:function(){return a.done.apply(a,arguments).fail.apply(a,arguments),this},pipe:function(e,t,n){return s.Deferred(function(r){s.each({done:[e,"resolve"],fail:[t,"reject"],progress:[n,"notify"]},function(e,t){var n=t[0],i=t[1],o;s.isFunction(n)?a[e](function(){o=n.apply(this,arguments),o&&s.isFunction(o.promise)?o.promise().then(r.resolve,r.reject,r.notify):r[i+"With"](this===a?r:this,[o])}):a[e](r[i])})}).promise()},promise:function(e){if(e==null)e=u;else for(var t in u)e[t]=u[t];return e}},a=u.promise({}),f;for(f in o)a[f]=o[f].fire,a[f+"With"]=o[f].fireWith;return a.done(function(){i="resolved"},n.disable,r.lock).fail(function(){i="rejected"},t.disable,r.lock),e&&e.call(a,a),a},when:function(e){function c(e){return function(n){t[e]=arguments.length>1?a.call(arguments,0):n,--o||f.resolveWith(f,t)}}function h(e){return function(t){i[e]=arguments.length>1?a.call(arguments,0):t,f.notifyWith(l,i)}}var t=a.call(arguments,0),n=0,r=t.length,i=new Array(r),o=r,u=r,f=r<=1&&e&&s.isFunction(e.promise)?e:s.Deferred(),l=f.promise();if(r>1){for(;n<r;n++)t[n]&&t[n].promise&&s.isFunction(t[n].promise)?t[n].promise().then(c(n),f.reject,h(n)):--o;o||f.resolveWith(f,t)}else f!==e&&f.resolveWith(f,r?[e]:[]);return l}}),s.support=function(){var t,r,i,o,u,a,f,l,c,h,p,d,v,m=n.createElement("div"),g=n.documentElement;m.setAttribute("className","t"),m.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",r=m.getElementsByTagName("*"),i=m.getElementsByTagName("a")[0];if(!r||!r.length||!i)return{};o=n.createElement("select"),u=o.appendChild(n.createElement("option")),a=m.getElementsByTagName("input")[0],t={leadingWhitespace:m.firstChild.nodeType===3,tbody:!m.getElementsByTagName("tbody").length,htmlSerialize:!!m.getElementsByTagName("link").length,style:/top/.test(i.getAttribute("style")),hrefNormalized:i.getAttribute("href")==="/a",opacity:/^0.55/.test(i.style.opacity),cssFloat:!!i.style.cssFloat,checkOn:a.value==="on",optSelected:u.selected,getSetAttribute:m.className!=="t",enctype:!!n.createElement("form").enctype,html5Clone:n.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},a.checked=!0,t.noCloneChecked=a.cloneNode(!0).checked,o.disabled=!0,t.optDisabled=!u.disabled;try{delete m.test}catch(y){t.deleteExpando=!1}!m.addEventListener&&m.attachEvent&&m.fireEvent&&(m.attachEvent("onclick",function(){t.noCloneEvent=!1}),m.cloneNode(!0).fireEvent("onclick")),a=n.createElement("input"),a.value="t",a.setAttribute("type","radio"),t.radioValue=a.value==="t",a.setAttribute("checked","checked"),m.appendChild(a),l=n.createDocumentFragment(),l.appendChild(m.lastChild),t.checkClone=l.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=a.checked,l.removeChild(a),l.appendChild(m),m.innerHTML="",e.getComputedStyle&&(f=n.createElement("div"),f.style.width="0",f.style.marginRight="0",m.style.width="2px",m.appendChild(f),t.reliableMarginRight=(parseInt((e.getComputedStyle(f,null)||{marginRight:0}).marginRight,10)||0)===0);if(m.attachEvent)for(d in{submit:1,change:1,focusin:1})p="on"+d,v=p in m,v||(m.setAttribute(p,"return;"),v=typeof m[p]=="function"),t[d+"Bubbles"]=v;return l.removeChild(m),l=o=u=f=m=a=null,s(function(){var e,r,i,o,u,a,f,l,h,p,d,g=n.getElementsByTagName("body")[0];if(!g)return;f=1,l="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;",h="visibility:hidden;border:0;",p="style='"+l+"border:5px solid #000;padding:0;'",d="<div "+p+"><div></div></div>"+"<table "+p+" cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>",e=n.createElement("div"),e.style.cssText=h+"width:0;height:0;position:static;top:0;margin-top:"+f+"px",g.insertBefore(e,g.firstChild),m=n.createElement("div"),e.appendChild(m),m.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",c=m.getElementsByTagName("td"),v=c[0].offsetHeight===0,c[0].style.display="",c[1].style.display="none",t.reliableHiddenOffsets=v&&c[0].offsetHeight===0,m.innerHTML="",m.style.width=m.style.paddingLeft="1px",s.boxModel=t.boxModel=m.offsetWidth===2,typeof m.style.zoom!="undefined"&&(m.style.display="inline",m.style.zoom=1,t.inlineBlockNeedsLayout=m.offsetWidth===2,m.style.display="",m.innerHTML="<div style='width:4px;'></div>",t.shrinkWrapBlocks=m.offsetWidth!==2),m.style.cssText=l+h,m.innerHTML=d,r=m.firstChild,i=r.firstChild,u=r.nextSibling.firstChild.firstChild,a={doesNotAddBorder:i.offsetTop!==5,doesAddBorderForTableAndCells:u.offsetTop===5},i.style.position="fixed",i.style.top="20px",a.fixedPosition=i.offsetTop===20||i.offsetTop===15,i.style.position=i.style.top="",r.style.overflow="hidden",r.style.position="relative",a.subtractsBorderForOverflowNotVisible=i.offsetTop===-5,a.doesNotIncludeMarginInBodyOffset=g.offsetTop!==f,g.removeChild(e),m=e=null,s.extend(t,a)}),t}();var f=/^(?:\{.*\}|\[.*\])$/,l=/([A-Z])/g;s.extend({cache:{},uuid:0,expando:"jQuery"+(s.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?s.cache[e[s.expando]]:e[s.expando],!!e&&!h(e)},data:function(e,n,r,i){if(!s.acceptData(e))return;var o,u,a,f=s.expando,l=typeof n=="string",c=e.nodeType,h=c?s.cache:e,p=c?e[f]:e[f]&&f,d=n==="events";if((!p||!h[p]||!d&&!i&&!h[p].data)&&l&&r===t)return;p||(c?e[f]=p=++s.uuid:p=f),h[p]||(h[p]={},c||(h[p].toJSON=s.noop));if(typeof n=="object"||typeof n=="function")i?h[p]=s.extend(h[p],n):h[p].data=s.extend(h[p].data,n);return o=u=h[p],i||(u.data||(u.data={}),u=u.data),r!==t&&(u[s.camelCase(n)]=r),d&&!u[n]?o.events:(l?(a=u[n],a==null&&(a=u[s.camelCase(n)])):a=u,a)},removeData:function(e,t,n){if(!s.acceptData(e))return;var r,i,o,u=s.expando,a=e.nodeType,f=a?s.cache:e,l=a?e[u]:u;if(!f[l])return;if(t){r=n?f[l]:f[l].data;if(r){s.isArray(t)||(t in r?t=[t]:(t=s.camelCase(t),t in r?t=[t]:t=t.split(" ")));for(i=0,o=t.length;i<o;i++)delete r[t[i]];if(!(n?h:s.isEmptyObject)(r))return}}if(!n){delete f[l].data;if(!h(f[l]))return}s.support.deleteExpando||!f.setInterval?delete f[l]:f[l]=null,a&&(s.support.deleteExpando?delete e[u]:e.removeAttribute?e.removeAttribute(u):e[u]=null)},_data:function(e,t,n){return s.data(e,t,n,!0)},acceptData:function(e){if(e.nodeName){var t=s.noData[e.nodeName.toLowerCase()];if(t)return t!==!0&&e.getAttribute("classid")===t}return!0}}),s.fn.extend({data:function(e,n){var r,i,o,u=null;if(typeof e=="undefined"){if(this.length){u=s.data(this[0]);if(this[0].nodeType===1&&!s._data(this[0],"parsedAttrs")){i=this[0].attributes;for(var a=0,f=i.length;a<f;a++)o=i[a].name,o.indexOf("data-")===0&&(o=s.camelCase(o.substring(5)),c(this[0],o,u[o]));s._data(this[0],"parsedAttrs",!0)}}return u}return typeof e=="object"?this.each(function(){s.data(this,e)}):(r=e.split("."),r[1]=r[1]?"."+r[1]:"",n===t?(u=this.triggerHandler("getData"+r[1]+"!",[r[0]]),u===t&&this.length&&(u=s.data(this[0],e),u=c(this[0],e,u)),u===t&&r[1]?this.data(r[0]):u):this.each(function(){var t=s(this),i=[r[0],n];t.triggerHandler("setData"+r[1]+"!",i),s.data(this,e,n),t.triggerHandler("changeData"+r[1]+"!",i)}))},removeData:function(e){return this.each(function(){s.removeData(this,e)})}}),s.extend({_mark:function(e,t){e&&(t=(t||"fx")+"mark",s._data(e,t,(s._data(e,t)||0)+1))},_unmark:function(e,t,n){e!==!0&&(n=t,t=e,e=!1);if(t){n=n||"fx";var r=n+"mark",i=e?0:(s._data(t,r)||1)-1;i?s._data(t,r,i):(s.removeData(t,r,!0),p(t,n,"mark"))}},queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=s._data(e,t),n&&(!r||s.isArray(n)?r=s._data(e,t,s.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=s.queue(e,t),r=n.shift(),i={};r==="inprogress"&&(r=n.shift()),r&&(t==="fx"&&n.unshift("inprogress"),s._data(e,t+".run",i),r.call(e,function(){s.dequeue(e,t)},i)),n.length||(s.removeData(e,t+"queue "+t+".run",!0),p(e,t,"queue"))}}),s.fn.extend({queue:function(e,n){return typeof e!="string"&&(n=e,e="fx"),n===t?s.queue(this[0],e):this.each(function(){var t=s.queue(this,e,n);e==="fx"&&t[0]!=="inprogress"&&s.dequeue(this,e)})},dequeue:function(e){return this.each(function(){s.dequeue(this,e)})},delay:function(e,t){return e=s.fx?s.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){function h(){--u||r.resolveWith(i,[i])}typeof e!="string"&&(n=e,e=t),e=e||"fx";var r=s.Deferred(),i=this,o=i.length,u=1,a=e+"defer",f=e+"queue",l=e+"mark",c;while(o--)if(c=s.data(i[o],a,t,!0)||(s.data(i[o],f,t,!0)||s.data(i[o],l,t,!0))&&s.data(i[o],a,s.Callbacks("once memory"),!0))u++,c.add(h);return h(),r.promise()}});var d=/[\n\t\r]/g,v=/\s+/,m=/\r/g,g=/^(?:button|input)$/i,y=/^(?:button|input|object|select|textarea)$/i,b=/^a(?:rea)?$/i,w=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,E=s.support.getSetAttribute,S,x,T;s.fn.extend({attr:function(e,t){return s.access(this,e,t,!0,s.attr)},removeAttr:function(e){return this.each(function(){s.removeAttr(this,e)})},prop:function(e,t){return s.access(this,e,t,!0,s.prop)},removeProp:function(e){return e=s.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,o,u,a;if(s.isFunction(e))return this.each(function(t){s(this).addClass(e.call(this,t,this.className))});if(e&&typeof e=="string"){t=e.split(v);for(n=0,r=this.length;n<r;n++){i=this[n];if(i.nodeType===1)if(!i.className&&t.length===1)i.className=e;else{o=" "+i.className+" ";for(u=0,a=t.length;u<a;u++)~o.indexOf(" "+t[u]+" ")||(o+=t[u]+" ");i.className=s.trim(o)}}}return this},removeClass:function(e){var n,r,i,o,u,a,f;if(s.isFunction(e))return this.each(function(t){s(this).removeClass(e.call(this,t,this.className))});if(e&&typeof e=="string"||e===t){n=(e||"").split(v);for(r=0,i=this.length;r<i;r++){o=this[r];if(o.nodeType===1&&o.className)if(e){u=(" "+o.className+" ").replace(d," ");for(a=0,f=n.length;a<f;a++)u=u.replace(" "+n[a]+" "," ");o.className=s.trim(u)}else o.className=""}}return this},toggleClass:function(e,t){var n=typeof e,r=typeof t=="boolean";return s.isFunction(e)?this.each(function(n){s(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var i,o=0,u=s(this),a=t,f=e.split(v);while(i=f[o++])a=r?a:!u.hasClass(i),u[a?"addClass":"removeClass"](i)}else if(n==="undefined"||n==="boolean")this.className&&s._data(this,"__className__",this.className),this.className=this.className||e===!1?"":s._data(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(d," ").indexOf(t)>-1)return!0;return!1},val:function(e){var n,r,i,o=this[0];if(!arguments.length){if(o)return n=s.valHooks[o.nodeName.toLowerCase()]||s.valHooks[o.type],n&&"get"in n&&(r=n.get(o,"value"))!==t?r:(r=o.value,typeof r=="string"?r.replace(m,""):r==null?"":r);return}return i=s.isFunction(e),this.each(function(r){var o=s(this),u;if(this.nodeType!==1)return;i?u=e.call(this,r,o.val()):u=e,u==null?u="":typeof u=="number"?u+="":s.isArray(u)&&(u=s.map(u,function(e){return e==null?"":e+""})),n=s.valHooks[this.nodeName.toLowerCase()]||s.valHooks[this.type];if(!n||!("set"in n)||n.set(this,u,"value")===t)this.value=u})}}),s.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r,i,o=e.selectedIndex,u=[],a=e.options,f=e.type==="select-one";if(o<0)return null;n=f?o:0,r=f?o+1:a.length;for(;n<r;n++){i=a[n];if(i.selected&&(s.support.optDisabled?!i.disabled:i.getAttribute("disabled")===null)&&(!i.parentNode.disabled||!s.nodeName(i.parentNode,"optgroup"))){t=s(i).val();if(f)return t;u.push(t)}}return f&&!u.length&&a.length?s(a[o]).val():u},set:function(e,t){var n=s.makeArray(t);return s(e).find("option").each(function(){this.selected=s.inArray(s(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(e,n,r,i){var o,u,a,f=e.nodeType;if(!e||f===3||f===8||f===2)return;if(i&&n in s.attrFn)return s(e)[n](r);if(typeof e.getAttribute=="undefined")return s.prop(e,n,r);a=f!==1||!s.isXMLDoc(e),a&&(n=n.toLowerCase(),u=s.attrHooks[n]||(w.test(n)?x:S));if(r!==t){if(r===null){s.removeAttr(e,n);return}return u&&"set"in u&&a&&(o=u.set(e,r,n))!==t?o:(e.setAttribute(n,""+r),r)}return u&&"get"in u&&a&&(o=u.get(e,n))!==null?o:(o=e.getAttribute(n),o===null?t:o)},removeAttr:function(e,t){var n,r,i,o,u=0;if(t&&e.nodeType===1){r=t.toLowerCase().split(v),o=r.length;for(;u<o;u++)i=r[u],i&&(n=s.propFix[i]||i,s.attr(e,i,""),e.removeAttribute(E?i:n),w.test(i)&&n in e&&(e[n]=!1))}},attrHooks:{type:{set:function(e,t){if(g.test(e.nodeName)&&e.parentNode)s.error("type property can't be changed");else if(!s.support.radioValue&&t==="radio"&&s.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return S&&s.nodeName(e,"button")?S.get(e,t):t in e?e.value:null},set:function(e,t,n){if(S&&s.nodeName(e,"button"))return S.set(e,t,n);e.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,o,u,a=e.nodeType;if(!e||a===3||a===8||a===2)return;return u=a!==1||!s.isXMLDoc(e),u&&(n=s.propFix[n]||n,o=s.propHooks[n]),r!==t?o&&"set"in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&"get"in o&&(i=o.get(e,n))!==null?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):y.test(e.nodeName)||b.test(e.nodeName)&&e.href?0:t}}}}),s.attrHooks.tabindex=s.propHooks.tabIndex,x={get:function(e,n){var r,i=s.prop(e,n);return i===!0||typeof i!="boolean"&&(r=e.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var r;return t===!1?s.removeAttr(e,n):(r=s.propFix[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},E||(T={name:!0,id:!0},S=s.valHooks.button={get:function(e,n){var r;return r=e.getAttributeNode(n),r&&(T[n]?r.nodeValue!=="":r.specified)?r.nodeValue:t},set:function(e,t,r){var i=e.getAttributeNode(r);return i||(i=n.createAttribute(r),e.setAttributeNode(i)),i.nodeValue=t+""}},s.attrHooks.tabindex.set=S.set,s.each(["width","height"],function(e,t){s.attrHooks[t]=s.extend(s.attrHooks[t],{set:function(e,n){if(n==="")return e.setAttribute(t,"auto"),n}})}),s.attrHooks.contenteditable={get:S.get,set:function(e,t,n){t===""&&(t="false"),S.set(e,t,n)}}),s.support.hrefNormalized||s.each(["href","src","width","height"],function(e,n){s.attrHooks[n]=s.extend(s.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return r===null?t:r}})}),s.support.style||(s.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=""+t}}),s.support.optSelected||(s.propHooks.selected=s.extend(s.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),s.support.enctype||(s.propFix.enctype="encoding"),s.support.checkOn||s.each(["radio","checkbox"],function(){s.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}}),s.each(["radio","checkbox"],function(){s.valHooks[this]=s.extend(s.valHooks[this],{set:function(e,t){if(s.isArray(t))return e.checked=s.inArray(s(e).val(),t)>=0}})});var N=/^(?:textarea|input|select)$/i,C=/^([^\.]*)?(?:\.(.+))?$/,k=/\bhover(\.\S+)?\b/,L=/^key/,A=/^(?:mouse|contextmenu)|click/,O=/^(?:focusinfocus|focusoutblur)$/,M=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,_=function(e){var t=M.exec(e);return t&&(t[1]=(t[1]||"").toLowerCase(),t[3]=t[3]&&new RegExp("(?:^|\\s)"+t[3]+"(?:\\s|$)")),t},D=function(e,t){var n=e.attributes||{};return(!t[1]||e.nodeName.toLowerCase()===t[1])&&(!t[2]||(n.id||{}).value===t[2])&&(!t[3]||t[3].test((n["class"]||{}).value))},P=function(e){return s.event.special.hover?e:e.replace(k,"mouseenter$1 mouseleave$1")};s.event={add:function(e,n,r,i,o){var u,a,f,l,c,h,p,d,v,m,g,y;if(e.nodeType===3||e.nodeType===8||!n||!r||!(u=s._data(e)))return;r.handler&&(v=r,r=v.handler),r.guid||(r.guid=s.guid++),f=u.events,f||(u.events=f={}),a=u.handle,a||(u.handle=a=function(e){return typeof s=="undefined"||!!e&&s.event.triggered===e.type?t:s.event.dispatch.apply(a.elem,arguments)},a.elem=e),n=s.trim(P(n)).split(" ");for(l=0;l<n.length;l++){c=C.exec(n[l])||[],h=c[1],p=(c[2]||"").split(".").sort(),y=s.event.special[h]||{},h=(o?y.delegateType:y.bindType)||h,y=s.event.special[h]||{},d=s.extend({type:h,origType:c[1],data:i,handler:r,guid:r.guid,selector:o,quick:_(o),namespace:p.join(".")},v),g=f[h];if(!g){g=f[h]=[],g.delegateCount=0;if(!y.setup||y.setup.call(e,i,p,a)===!1)e.addEventListener?e.addEventListener(h,a,!1):e.attachEvent&&e.attachEvent("on"+h,a)}y.add&&(y.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),o?g.splice(g.delegateCount++,0,d):g.push(d),s.event.global[h]=!0}e=null},global:{},remove:function(e,t,n,r,i){var o=s.hasData(e)&&s._data(e),u,a,f,l,c,h,p,d,v,m,g,y;if(!o||!(d=o.events))return;t=s.trim(P(t||"")).split(" ");for(u=0;u<t.length;u++){a=C.exec(t[u])||[],f=l=a[1],c=a[2];if(!f){for(f in d)s.event.remove(e,f+t[u],n,r,!0);continue}v=s.event.special[f]||{},f=(r?v.delegateType:v.bindType)||f,g=d[f]||[],h=g.length,c=c?new RegExp("(^|\\.)"+c.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(p=0;p<g.length;p++)y=g[p],(i||l===y.origType)&&(!n||n.guid===y.guid)&&(!c||c.test(y.namespace))&&(!r||r===y.selector||r==="**"&&y.selector)&&(g.splice(p--,1),y.selector&&g.delegateCount--,v.remove&&v.remove.call(e,y));g.length===0&&h!==g.length&&((!v.teardown||v.teardown.call(e,c)===!1)&&s.removeEvent(e,f,o.handle),delete d[f])}s.isEmptyObject(d)&&(m=o.handle,m&&(m.elem=null),s.removeData(e,["events","handle"],!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,r,i,o){if(!i||i.nodeType!==3&&i.nodeType!==8){var u=n.type||n,a=[],f,l,c,h,p,d,v,m,g,y;if(O.test(u+s.event.triggered))return;u.indexOf("!")>=0&&(u=u.slice(0,-1),l=!0),u.indexOf(".")>=0&&(a=u.split("."),u=a.shift(),a.sort());if((!i||s.event.customEvent[u])&&!s.event.global[u])return;n=typeof n=="object"?n[s.expando]?n:new s.Event(u,n):new s.Event(u),n.type=u,n.isTrigger=!0,n.exclusive=l,n.namespace=a.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+a.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,d=u.indexOf(":")<0?"on"+u:"";if(!i){f=s.cache;for(c in f)f[c].events&&f[c].events[u]&&s.event.trigger(n,r,f[c].handle.elem,!0);return}n.result=t,n.target||(n.target=i),r=r!=null?s.makeArray(r):[],r.unshift(n),v=s.event.special[u]||{};if(v.trigger&&v.trigger.apply(i,r)===!1)return;g=[[i,v.bindType||u]];if(!o&&!v.noBubble&&!s.isWindow(i)){y=v.delegateType||u,h=O.test(y+u)?i:i.parentNode,p=null;for(;h;h=h.parentNode)g.push([h,y]),p=h;p&&p===i.ownerDocument&&g.push([p.defaultView||p.parentWindow||e,y])}for(c=0;c<g.length&&!n.isPropagationStopped();c++)h=g[c][0],n.type=g[c][1],m=(s._data(h,"events")||{})[n.type]&&s._data(h,"handle"),m&&m.apply(h,r),m=d&&h[d],m&&s.acceptData(h)&&m.apply(h,r)===!1&&n.preventDefault();return n.type=u,!o&&!n.isDefaultPrevented()&&(!v._default||v._default.apply(i.ownerDocument,r)===!1)&&(u!=="click"||!s.nodeName(i,"a"))&&s.acceptData(i)&&d&&i[u]&&(u!=="focus"&&u!=="blur"||n.target.offsetWidth!==0)&&!s.isWindow(i)&&(p=i[d],p&&(i[d]=null),s.event.triggered=u,i[u](),s.event.triggered=t,p&&(i[d]=p)),n.result}return},dispatch:function(n){n=s.event.fix(n||e.event);var r=(s._data(this,"events")||{})[n.type]||[],i=r.delegateCount,o=[].slice.call(arguments,0),u=!n.exclusive&&!n.namespace,a=[],f,l,c,h,p,d,v,m,g,y,b;o[0]=n,n.delegateTarget=this;if(i&&!n.target.disabled&&(!n.button||n.type!=="click")){h=s(this),h.context=this.ownerDocument||this;for(c=n.target;c!=this;c=c.parentNode||this){d={},m=[],h[0]=c;for(f=0;f<i;f++)g=r[f],y=g.selector,d[y]===t&&(d[y]=g.quick?D(c,g.quick):h.is(y)),d[y]&&m.push(g);m.length&&a.push({elem:c,matches:m})}}r.length>i&&a.push({elem:this,matches:r.slice(i)});for(f=0;f<a.length&&!n.isPropagationStopped();f++){v=a[f],n.currentTarget=v.elem;for(l=0;l<v.matches.length&&!n.isImmediatePropagationStopped();l++){g=v.matches[l];if(u||!n.namespace&&!g.namespace||n.namespace_re&&n.namespace_re.test(g.namespace))n.data=g.data,n.handleObj=g,p=((s.event.special[g.origType]||{}).handle||g.handler).apply(v.elem,o),p!==t&&(n.result=p,p===!1&&(n.preventDefault(),n.stopPropagation()))}}return n.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,r){var i,s,o,u=r.button,a=r.fromElement;return e.pageX==null&&r.clientX!=null&&(i=e.target.ownerDocument||n,s=i.documentElement,o=i.body,e.pageX=r.clientX+(s&&s.scrollLeft||o&&o.scrollLeft||0)-(s&&s.clientLeft||o&&o.clientLeft||0),e.pageY=r.clientY+(s&&s.scrollTop||o&&o.scrollTop||0)-(s&&s.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?r.toElement:a),!e.which&&u!==t&&(e.which=u&1?1:u&2?3:u&4?2:0),e}},fix:function(e){if(e[s.expando])return e;var r,i,o=e,u=s.event.fixHooks[e.type]||{},a=u.props?this.props.concat(u.props):this.props;e=s.Event(o);for(r=a.length;r;)i=a[--r],e[i]=o[i];return e.target||(e.target=o.srcElement||n),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey===t&&(e.metaKey=e.ctrlKey),u.filter?u.filter(e,o):e},special:{ready:{setup:s.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){s.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=s.extend(new s.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?s.event.trigger(i,null,t):s.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},s.event.handle=s.event.dispatch,s.removeEvent=n.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){e.detachEvent&&e.detachEvent("on"+t,n)},s.Event=function(e,t){if(!(this instanceof s.Event))return new s.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?B:H):this.type=e,t&&s.extend(this,t),this.timeStamp=e&&e.timeStamp||s.now(),this[s.expando]=!0},s.Event.prototype={preventDefault:function(){this.isDefaultPrevented=B;var e=this.originalEvent;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=B;var e=this.originalEvent;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=B,this.stopPropagation()},isDefaultPrevented:H,isPropagationStopped:H,isImmediatePropagationStopped:H},s.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){s.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n=this,r=e.relatedTarget,i=e.handleObj,o=i.selector,u;if(!r||r!==n&&!s.contains(n,r))e.type=i.origType,u=i.handler.apply(this,arguments),e.type=t;return u}}}),s.support.submitBubbles||(s.event.special.submit={setup:function(){if(s.nodeName(this,"form"))return!1;s.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=s.nodeName(n,"input")||s.nodeName(n,"button")?n.form:t;r&&!r._submit_attached&&(s.event.add(r,"submit._submit",function(e){this.parentNode&&!e.isTrigger&&s.event.simulate("submit",this.parentNode,e,!0)}),r._submit_attached=!0)})},teardown:function(){if(s.nodeName(this,"form"))return!1;s.event.remove(this,"._submit")}}),s.support.changeBubbles||(s.event.special.change={setup:function(){if(N.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")s.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),s.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1,s.event.simulate("change",this,e,!0))});return!1}s.event.add(this,"beforeactivate._change",function(e){var t=e.target;N.test(t.nodeName)&&!t._change_attached&&(s.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&s.event.simulate("change",this.parentNode,e,!0)}),t._change_attached=!0)})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return e.handleObj.handler.apply(this,arguments)},teardown:function(){return s.event.remove(this,"._change"),N.test(this.nodeName)}}),s.support.focusinBubbles||s.each({focus:"focusin",blur:"focusout"},function(e,t){var r=0,i=function(e){s.event.simulate(t,e.target,s.event.fix(e),!0)};s.event.special[t]={setup:function(){r++===0&&n.addEventListener(e,i,!0)},teardown:function(){--r===0&&n.removeEventListener(e,i,!0)}}}),s.fn.extend({on:function(e,n,r,i,o){var u,a;if(typeof e=="object"){typeof n!="string"&&(r=n,n=t);for(a in e)this.on(a,n,r,e[a],o);return this}r==null&&i==null?(i=n,r=n=t):i==null&&(typeof n=="string"?(i=r,r=t):(i=r,r=n,n=t));if(i===!1)i=H;else if(!i)return this;return o===1&&(u=i,i=function(e){return s().off(e),u.apply(this,arguments)},i.guid=u.guid||(u.guid=s.guid++)),this.each(function(){s.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on.call(this,e,t,n,r,1)},off:function(e,n,r){if(e&&e.preventDefault&&e.handleObj){var i=e.handleObj;return s(e.delegateTarget).off(i.namespace?i.type+"."+i.namespace:i.type,i.selector,i.handler),this}if(typeof e=="object"){for(var o in e)this.off(o,n,e[o]);return this}if(n===!1||typeof n=="function")r=n,n=t;return r===!1&&(r=H),this.each(function(){s.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return s(this.context).on(e,this.selector,t,n),this},die:function(e,t){return s(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length==1?this.off(e,"**"):this.off(t,e,n)},trigger:function(e,t){return this.each(function(){s.event.trigger(e,t,this)})},triggerHandler:function(e,t){if(this[0])return s.event.trigger(e,t,this[0],!0)},toggle:function(e){var t=arguments,n=e.guid||s.guid++,r=0,i=function(n){var i=(s._data(this,"lastToggle"+e.guid)||0)%r;return s._data(this,"lastToggle"+e.guid,i+1),n.preventDefault(),t[i].apply(this,arguments)||!1};i.guid=n;while(r<t.length)t[r++].guid=n;return this.click(i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),s.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){s.fn[t]=function(e,n){return n==null&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},s.attrFn&&(s.attrFn[t]=!0),L.test(t)&&(s.event.fixHooks[t]=s.event.keyHooks),A.test(t)&&(s.event.fixHooks[t]=s.event.mouseHooks)}),function(){function S(e,t,n,i,s,o){for(var u=0,a=i.length;u<a;u++){var f=i[u];if(f){var l=!1;f=f[e];while(f){if(f[r]===n){l=i[f.sizset];break}f.nodeType===1&&!o&&(f[r]=n,f.sizset=u);if(f.nodeName.toLowerCase()===t){l=f;break}f=f[e]}i[u]=l}}}function x(e,t,n,i,s,o){for(var u=0,a=i.length;u<a;u++){var f=i[u];if(f){var l=!1;f=f[e];while(f){if(f[r]===n){l=i[f.sizset];break}if(f.nodeType===1){o||(f[r]=n,f.sizset=u);if(typeof t!="string"){if(f===t){l=!0;break}}else if(h.filter(t,[f]).length>0){l=f;break}}f=f[e]}i[u]=l}}}var e=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,r="sizcache"+(Math.random()+"").replace(".",""),i=0,o=Object.prototype.toString,u=!1,a=!0,f=/\\/g,l=/\r\n/g,c=/\W/;[0,0].sort(function(){return a=!1,0});var h=function(t,r,i,s){i=i||[],r=r||n;var u=r;if(r.nodeType!==1&&r.nodeType!==9)return[];if(!t||typeof t!="string")return i;var a,f,l,c,p,m,g,b,w=!0,E=h.isXML(r),S=[],x=t;do{e.exec(""),a=e.exec(x);if(a){x=a[3],S.push(a[1]);if(a[2]){c=a[3];break}}}while(a);if(S.length>1&&v.exec(t))if(S.length===2&&d.relative[S[0]])f=T(S[0]+S[1],r,s);else{f=d.relative[S[0]]?[r]:h(S.shift(),r);while(S.length)t=S.shift(),d.relative[t]&&(t+=S.shift()),f=T(t,f,s)}else{!s&&S.length>1&&r.nodeType===9&&!E&&d.match.ID.test(S[0])&&!d.match.ID.test(S[S.length-1])&&(p=h.find(S.shift(),r,E),r=p.expr?h.filter(p.expr,p.set)[0]:p.set[0]);if(r){p=s?{expr:S.pop(),set:y(s)}:h.find(S.pop(),S.length!==1||S[0]!=="~"&&S[0]!=="+"||!r.parentNode?r:r.parentNode,E),f=p.expr?h.filter(p.expr,p.set):p.set,S.length>0?l=y(f):w=!1;while(S.length)m=S.pop(),g=m,d.relative[m]?g=S.pop():m="",g==null&&(g=r),d.relative[m](l,g,E)}else l=S=[]}l||(l=f),l||h.error(m||t);if(o.call(l)==="[object Array]")if(!w)i.push.apply(i,l);else if(r&&r.nodeType===1)for(b=0;l[b]!=null;b++)l[b]&&(l[b]===!0||l[b].nodeType===1&&h.contains(r,l[b]))&&i.push(f[b]);else for(b=0;l[b]!=null;b++)l[b]&&l[b].nodeType===1&&i.push(f[b]);else y(l,i);return c&&(h(c,u,i,s),h.uniqueSort(i)),i};h.uniqueSort=function(e){if(w){u=a,e.sort(w);if(u)for(var t=1;t<e.length;t++)e[t]===e[t-1]&&e.splice(t--,1)}return e},h.matches=function(e,t){return h(e,null,null,t)},h.matchesSelector=function(e,t){return h(t,null,null,[e]).length>0},h.find=function(e,t,n){var r,i,s,o,u,a;if(!e)return[];for(i=0,s=d.order.length;i<s;i++){u=d.order[i];if(o=d.leftMatch[u].exec(e)){a=o[1],o.splice(1,1);if(a.substr(a.length-1)!=="\\"){o[1]=(o[1]||"").replace(f,""),r=d.find[u](o,t,n);if(r!=null){e=e.replace(d.match[u],"");break}}}}return r||(r=typeof t.getElementsByTagName!="undefined"?t.getElementsByTagName("*"):[]),{set:r,expr:e}},h.filter=function(e,n,r,i){var s,o,u,a,f,l,c,p,v,m=e,g=[],y=n,b=n&&n[0]&&h.isXML(n[0]);while(e&&n.length){for(u in d.filter)if((s=d.leftMatch[u].exec(e))!=null&&s[2]){l=d.filter[u],c=s[1],o=!1,s.splice(1,1);if(c.substr(c.length-1)==="\\")continue;y===g&&(g=[]);if(d.preFilter[u]){s=d.preFilter[u](s,y,r,g,i,b);if(!s)o=a=!0;else if(s===!0)continue}if(s)for(p=0;(f=y[p])!=null;p++)f&&(a=l(f,s,p,y),v=i^a,r&&a!=null?v?o=!0:y[p]=!1:v&&(g.push(f),o=!0));if(a!==t){r||(y=g),e=e.replace(d.match[u],"");if(!o)return[];break}}if(e===m){if(o!=null)break;h.error(e)}m=e}return y},h.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};var p=h.getText=function(e){var t,n,r=e.nodeType,i="";if(r){if(r===1||r===9){if(typeof e.textContent=="string")return e.textContent;if(typeof e.innerText=="string")return e.innerText.replace(l,"");for(e=e.firstChild;e;e=e.nextSibling)i+=p(e)}else if(r===3||r===4)return e.nodeValue}else for(t=0;n=e[t];t++)n.nodeType!==8&&(i+=p(n));return i},d=h.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(e){return e.getAttribute("href")},type:function(e){return e.getAttribute("type")}},relative:{"+":function(e,t){var n=typeof t=="string",r=n&&!c.test(t),i=n&&!r;r&&(t=t.toLowerCase());for(var s=0,o=e.length,u;s<o;s++)if(u=e[s]){while((u=u.previousSibling)&&u.nodeType!==1);e[s]=i||u&&u.nodeName.toLowerCase()===t?u||!1:u===t}i&&h.filter(t,e,!0)},">":function(e,t){var n,r=typeof t=="string",i=0,s=e.length;if(r&&!c.test(t)){t=t.toLowerCase();for(;i<s;i++){n=e[i];if(n){var o=n.parentNode;e[i]=o.nodeName.toLowerCase()===t?o:!1}}}else{for(;i<s;i++)n=e[i],n&&(e[i]=r?n.parentNode:n.parentNode===t);r&&h.filter(t,e,!0)}},"":function(e,t,n){var r,s=i++,o=x;typeof t=="string"&&!c.test(t)&&(t=t.toLowerCase(),r=t,o=S),o("parentNode",t,s,e,r,n)},"~":function(e,t,n){var r,s=i++,o=x;typeof t=="string"&&!c.test(t)&&(t=t.toLowerCase(),r=t,o=S),o("previousSibling",t,s,e,r,n)}},find:{ID:function(e,t,n){if(typeof t.getElementById!="undefined"&&!n){var r=t.getElementById(e[1]);return r&&r.parentNode?[r]:[]}},NAME:function(e,t){if(typeof t.getElementsByName!="undefined"){var n=[],r=t.getElementsByName(e[1]);for(var i=0,s=r.length;i<s;i++)r[i].getAttribute("name")===e[1]&&n.push(r[i]);return n.length===0?null:n}},TAG:function(e,t){if(typeof t.getElementsByTagName!="undefined")return t.getElementsByTagName(e[1])}},preFilter:{CLASS:function(e,t,n,r,i,s){e=" "+e[1].replace(f,"")+" ";if(s)return e;for(var o=0,u;(u=t[o])!=null;o++)u&&(i^(u.className&&(" "+u.className+" ").replace(/[\t\n\r]/g," ").indexOf(e)>=0)?n||r.push(u):n&&(t[o]=!1));return!1},ID:function(e){return e[1].replace(f,"")},TAG:function(e,t){return e[1].replace(f,"").toLowerCase()},CHILD:function(e){if(e[1]==="nth"){e[2]||h.error(e[0]),e[2]=e[2].replace(/^\+|\s*/g,"");var t=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(e[2]==="even"&&"2n"||e[2]==="odd"&&"2n+1"||!/\D/.test(e[2])&&"0n+"+e[2]||e[2]);e[2]=t[1]+(t[2]||1)-0,e[3]=t[3]-0}else e[2]&&h.error(e[0]);return e[0]=i++,e},ATTR:function(e,t,n,r,i,s){var o=e[1]=e[1].replace(f,"");return!s&&d.attrMap[o]&&(e[1]=d.attrMap[o]),e[4]=(e[4]||e[5]||"").replace(f,""),e[2]==="~="&&(e[4]=" "+e[4]+" "),e},PSEUDO:function(t,n,r,i,s){if(t[1]==="not"){if(!((e.exec(t[3])||"").length>1||/^\w/.test(t[3]))){var o=h.filter(t[3],n,r,!0^s);return r||i.push.apply(i,o),!1}t[3]=h(t[3],null,null,n)}else if(d.match.POS.test(t[0])||d.match.CHILD.test(t[0]))return!0;return t},POS:function(e){return e.unshift(!0),e}},filters:{enabled:function(e){return e.disabled===!1&&e.type!=="hidden"},disabled:function(e){return e.disabled===!0},checked:function(e){return e.checked===!0},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!!e.firstChild},empty:function(e){return!e.firstChild},has:function(e,t,n){return!!h(n[3],e).length},header:function(e){return/h\d/i.test(e.nodeName)},text:function(e){var t=e.getAttribute("type"),n=e.type;return e.nodeName.toLowerCase()==="input"&&"text"===n&&(t===n||t===null)},radio:function(e){return e.nodeName.toLowerCase()==="input"&&"radio"===e.type},checkbox:function(e){return e.nodeName.toLowerCase()==="input"&&"checkbox"===e.type},file:function(e){return e.nodeName.toLowerCase()==="input"&&"file"===e.type},password:function(e){return e.nodeName.toLowerCase()==="input"&&"password"===e.type},submit:function(e){var t=e.nodeName.toLowerCase();return(t==="input"||t==="button")&&"submit"===e.type},image:function(e){return e.nodeName.toLowerCase()==="input"&&"image"===e.type},reset:function(e){var t=e.nodeName.toLowerCase();return(t==="input"||t==="button")&&"reset"===e.type},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&"button"===e.type||t==="button"},input:function(e){return/input|select|textarea|button/i.test(e.nodeName)},focus:function(e){return e===e.ownerDocument.activeElement}},setFilters:{first:function(e,t){return t===0},last:function(e,t,n,r){return t===r.length-1},even:function(e,t){return t%2===0},odd:function(e,t){return t%2===1},lt:function(e,t,n){return t<n[3]-0},gt:function(e,t,n){return t>n[3]-0},nth:function(e,t,n){return n[3]-0===t},eq:function(e,t,n){return n[3]-0===t}},filter:{PSEUDO:function(e,t,n,r){var i=t[1],s=d.filters[i];if(s)return s(e,n,t,r);if(i==="contains")return(e.textContent||e.innerText||p([e])||"").indexOf(t[3])>=0;if(i==="not"){var o=t[3];for(var u=0,a=o.length;u<a;u++)if(o[u]===e)return!1;return!0}h.error(i)},CHILD:function(e,t){var n,i,s,o,u,a,f,l=t[1],c=e;switch(l){case"only":case"first":while(c=c.previousSibling)if(c.nodeType===1)return!1;if(l==="first")return!0;c=e;case"last":while(c=c.nextSibling)if(c.nodeType===1)return!1;return!0;case"nth":n=t[2],i=t[3];if(n===1&&i===0)return!0;s=t[0],o=e.parentNode;if(o&&(o[r]!==s||!e.nodeIndex)){a=0;for(c=o.firstChild;c;c=c.nextSibling)c.nodeType===1&&(c.nodeIndex=++a);o[r]=s}return f=e.nodeIndex-i,n===0?f===0:f%n===0&&f/n>=0}},ID:function(e,t){return e.nodeType===1&&e.getAttribute("id")===t},TAG:function(e,t){return t==="*"&&e.nodeType===1||!!e.nodeName&&e.nodeName.toLowerCase()===t},CLASS:function(e,t){return(" "+(e.className||e.getAttribute("class"))+" ").indexOf(t)>-1},ATTR:function(e,t){var n=t[1],r=h.attr?h.attr(e,n):d.attrHandle[n]?d.attrHandle[n](e):e[n]!=null?e[n]:e.getAttribute(n),i=r+"",s=t[2],o=t[4];return r==null?s==="!=":!s&&h.attr?r!=null:s==="="?i===o:s==="*="?i.indexOf(o)>=0:s==="~="?(" "+i+" ").indexOf(o)>=0:o?s==="!="?i!==o:s==="^="?i.indexOf(o)===0:s==="$="?i.substr(i.length-o.length)===o:s==="|="?i===o||i.substr(0,o.length+1)===o+"-":!1:i&&r!==!1},POS:function(e,t,n,r){var i=t[2],s=d.setFilters[i];if(s)return s(e,n,t,r)}}},v=d.match.POS,m=function(e,t){return"\\"+(t-0+1)};for(var g in d.match)d.match[g]=new RegExp(d.match[g].source+/(?![^\[]*\])(?![^\(]*\))/.source),d.leftMatch[g]=new RegExp(/(^(?:.|\r|\n)*?)/.source+d.match[g].source.replace(/\\(\d+)/g,m));var y=function(e,t){return e=Array.prototype.slice.call(e,0),t?(t.push.apply(t,e),t):e};try{Array.prototype.slice.call(n.documentElement.childNodes,0)[0].nodeType}catch(b){y=function(e,t){var n=0,r=t||[];if(o.call(e)==="[object Array]")Array.prototype.push.apply(r,e);else if(typeof e.length=="number")for(var i=e.length;n<i;n++)r.push(e[n]);else for(;e[n];n++)r.push(e[n]);return r}}var w,E;n.documentElement.compareDocumentPosition?w=function(e,t){return e===t?(u=!0,0):!e.compareDocumentPosition||!t.compareDocumentPosition?e.compareDocumentPosition?-1:1:e.compareDocumentPosition(t)&4?-1:1}:(w=function(e,t){if(e===t)return u=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,r,i=[],s=[],o=e.parentNode,a=t.parentNode,f=o;if(o===a)return E(e,t);if(!o)return-1;if(!a)return 1;while(f)i.unshift(f),f=f.parentNode;f=a;while(f)s.unshift(f),f=f.parentNode;n=i.length,r=s.length;for(var l=0;l<n&&l<r;l++)if(i[l]!==s[l])return E(i[l],s[l]);return l===n?E(e,s[l],-1):E(i[l],t,1)},E=function(e,t,n){if(e===t)return n;var r=e.nextSibling;while(r){if(r===t)return-1;r=r.nextSibling}return 1}),function(){var e=n.createElement("div"),r="script"+(new Date).getTime(),i=n.documentElement;e.innerHTML="<a name='"+r+"'/>",i.insertBefore(e,i.firstChild),n.getElementById(r)&&(d.find.ID=function(e,n,r){if(typeof n.getElementById!="undefined"&&!r){var i=n.getElementById(e[1]);return i?i.id===e[1]||typeof i.getAttributeNode!="undefined"&&i.getAttributeNode("id").nodeValue===e[1]?[i]:t:[]}},d.filter.ID=function(e,t){var n=typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id");return e.nodeType===1&&n&&n.nodeValue===t}),i.removeChild(e),i=e=null}(),function(){var e=n.createElement("div");e.appendChild(n.createComment("")),e.getElementsByTagName("*").length>0&&(d.find.TAG=function(e,t){var n=t.getElementsByTagName(e[1]);if(e[1]==="*"){var r=[];for(var i=0;n[i];i++)n[i].nodeType===1&&r.push(n[i]);n=r}return n}),e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!="undefined"&&e.firstChild.getAttribute("href")!=="#"&&(d.attrHandle.href=function(e){return e.getAttribute("href",2)}),e=null}(),n.querySelectorAll&&function(){var e=h,t=n.createElement("div"),r="__sizzle__";t.innerHTML="<p class='TEST'></p>";if(t.querySelectorAll&&t.querySelectorAll(".TEST").length===0)return;h=function(t,i,s,o){i=i||n;if(!o&&!h.isXML(i)){var u=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(t);if(u&&(i.nodeType===1||i.nodeType===9)){if(u[1])return y(i.getElementsByTagName(t),s);if(u[2]&&d.find.CLASS&&i.getElementsByClassName)return y(i.getElementsByClassName(u[2]),s)}if(i.nodeType===9){if(t==="body"&&i.body)return y([i.body],s);if(u&&u[3]){var a=i.getElementById(u[3]);if(!a||!a.parentNode)return y([],s);if(a.id===u[3])return y([a],s)}try{return y(i.querySelectorAll(t),s)}catch(f){}}else if(i.nodeType===1&&i.nodeName.toLowerCase()!=="object"){var l=i,c=i.getAttribute("id"),p=c||r,v=i.parentNode,m=/^\s*[+~]/.test(t);c?p=p.replace(/'/g,"\\$&"):i.setAttribute("id",p),m&&v&&(i=i.parentNode);try{if(!m||v)return y(i.querySelectorAll("[id='"+p+"'] "+t),s)}catch(g){}finally{c||l.removeAttribute("id")}}}return e(t,i,s,o)};for(var i in e)h[i]=e[i];t=null}(),function(){var e=n.documentElement,t=e.matchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.msMatchesSelector;if(t){var r=!t.call(n.createElement("div"),"div"),i=!1;try{t.call(n.documentElement,"[test!='']:sizzle")}catch(s){i=!0}h.matchesSelector=function(e,n){n=n.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!h.isXML(e))try{if(i||!d.match.PSEUDO.test(n)&&!/!=/.test(n)){var s=t.call(e,n);if(s||!r||e.document&&e.document.nodeType!==11)return s}}catch(o){}return h(n,null,null,[e]).length>0}}}(),function(){var e=n.createElement("div");e.innerHTML="<div class='test e'></div><div class='test'></div>";if(!e.getElementsByClassName||e.getElementsByClassName("e").length===0)return;e.lastChild.className="e";if(e.getElementsByClassName("e").length===1)return;d.order.splice(1,0,"CLASS"),d.find.CLASS=function(e,t,n){if(typeof t.getElementsByClassName!="undefined"&&!n)return t.getElementsByClassName(e[1])},e=null}(),n.documentElement.contains?h.contains=function(e,t){return e!==t&&(e.contains?e.contains(t):!0)}:n.documentElement.compareDocumentPosition?h.contains=function(e,t){return!!(e.compareDocumentPosition(t)&16)}:h.contains=function(){return!1},h.isXML=function(e){var t=(e?e.ownerDocument||e:0).documentElement;return t?t.nodeName!=="HTML":!1};var T=function(e,t,n){var r,i=[],s="",o=t.nodeType?[t]:t;while(r=d.match.PSEUDO.exec(e))s+=r[0],e=e.replace(d.match.PSEUDO,"");e=d.relative[e]?e+"*":e;for(var u=0,a=o.length;u<a;u++)h(e,o[u],i,n);return h.filter(s,i)};h.attr=s.attr,h.selectors.attrMap={},s.find=h,s.expr=h.selectors,s.expr[":"]=s.expr.filters,s.unique=h.uniqueSort,s.text=h.getText,s.isXMLDoc=h.isXML,s.contains=h.contains}();var j=/Until$/,F=/^(?:parents|prevUntil|prevAll)/,I=/,/,q=/^.[^:#\[\.,]*$/,R=Array.prototype.slice,U=s.expr.match.POS,z={children:!0,contents:!0,next:!0,prev:!0};s.fn.extend({find:function(e){var t=this,n,r;if(typeof e!="string")return s(e).filter(function(){for(n=0,r=t.length;n<r;n++)if(s.contains(t[n],this))return!0});var i=this.pushStack("","find",e),o,u,a;for(n=0,r=this.length;n<r;n++){o=i.length,s.find(e,this[n],i);if(n>0)for(u=o;u<i.length;u++)for(a=0;a<o;a++)if(i[a]===i[u]){i.splice(u--,1);break}}return i},has:function(e){var t=s(e);return this.filter(function(){for(var e=0,n=t.length;e<n;e++)if(s.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(X(this,e,!1),"not",e)},filter:function(e){return this.pushStack(X(this,e,!0),"filter",e)},is:function(e){return!!e&&(typeof e=="string"?U.test(e)?s(e,this.context).index(this[0])>=0:s.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n=[],r,i,o=this[0];if(s.isArray(e)){var u=1;while(o&&o.ownerDocument&&o!==t){for(r=0;r<e.length;r++)s(o).is(e[r])&&n.push({selector:e[r],elem:o,level:u});o=o.parentNode,u++}return n}var a=U.test(e)||typeof e!="string"?s(e,t||this.context):0;for(r=0,i=this.length;r<i;r++){o=this[r];while(o){if(a?a.index(o)>-1:s.find.matchesSelector(o,e)){n.push(o);break}o=o.parentNode;if(!o||!o.ownerDocument||o===t||o.nodeType===11)break}}return n=n.length>1?s.unique(n):n,this.pushStack(n,"closest",e)},index:function(e){return e?typeof e=="string"?s.inArray(this[0],s(e)):s.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?s(e,t):s.makeArray(e&&e.nodeType?[e]:e),r=s.merge(this.get(),n);return this.pushStack(W(n[0])||W(r[0])?r:s.unique(r))},andSelf:function(){return this.add(this.prevObject)}}),s.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return s.dir(e,"parentNode")},parentsUntil:function(e,t,n){return s.dir(e,"parentNode",n)},next:function(e){return s.nth(e,2,"nextSibling")},prev:function(e){return s.nth(e,2,"previousSibling")},nextAll:function(e){return s.dir(e,"nextSibling")},prevAll:function(e){return s.dir(e,"previousSibling")},nextUntil:function(e,t,n){return s.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return s.dir(e,"previousSibling",n)},siblings:function(e){return s.sibling(e.parentNode.firstChild,e)},children:function(e){return s.sibling(e.firstChild)},contents:function(e){return s.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:s.makeArray(e.childNodes)}},function(e,t){s.fn[e]=function(n,r){var i=s.map(this,t,n);return j.test(e)||(r=n),r&&typeof r=="string"&&(i=s.filter(r,i)),i=this.length>1&&!z[e]?s.unique(i):i,(this.length>1||I.test(r))&&F.test(e)&&(i=i.reverse()),this.pushStack(i,e,R.call(arguments).join(","))}}),s.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),t.length===1?s.find.matchesSelector(t[0],e)?[t[0]]:[]:s.find.matches(e,t)},dir:function(e,n,r){var i=[],o=e[n];while(o&&o.nodeType!==9&&(r===t||o.nodeType!==1||!s(o).is(r)))o.nodeType===1&&i.push(o),o=o[n];return i},nth:function(e,t,n,r){t=t||1;var i=0;for(;e;e=e[n])if(e.nodeType===1&&++i===t)break;return e},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var $="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",J=/ jQuery\d+="(?:\d+|null)"/g,K=/^\s+/,Q=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,G=/<([\w:]+)/,Y=/<tbody/i,Z=/<|&#?\w+;/,et=/<(?:script|style)/i,tt=/<(?:script|object|embed|option|style)/i,nt=new RegExp("<(?:"+$+")","i"),rt=/checked\s*(?:[^=]|=\s*.checked.)/i,it=/\/(java|ecma)script/i,st=/^\s*<!(?:\[CDATA\[|\-\-)/,ot={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},ut=V(n);ot.optgroup=ot.option,ot.tbody=ot.tfoot=ot.colgroup=ot.caption=ot.thead,ot.th=ot.td,s.support.htmlSerialize||(ot._default=[1,"div<div>","</div>"]),s.fn.extend({text:function(e){return s.isFunction(e)?this.each(function(t){var n=s(this);n.text(e.call(this,t,n.text()))}):typeof e!="object"&&e!==t?this.empty().append((this[0]&&this[0].ownerDocument||n).createTextNode(e)):s.text(this)},wrapAll:function(e){if(s.isFunction(e))return this.each(function(t){s(this).wrapAll(e.call(this,t))});if(this[0]){var t=s(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return s.isFunction(e)?this.each(function(t){s(this).wrapInner(e.call(this,t))}):this.each(function(){var t=s(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=s.isFunction(e);return this.each(function(n){s(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){s.nodeName(this,"body")||s(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){this.nodeType===1&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){this.nodeType===1&&this.insertBefore(e,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=s.clean(arguments);return e.push.apply(e,this.toArray()),this.pushStack(e,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=this.pushStack(this,"after",arguments);return e.push.apply(e,s.clean(arguments)),e}},remove:function(e,t){for(var n=0,r;(r=this[n])!=null;n++)if(!e||s.filter(e,[r]).length)!t&&r.nodeType===1&&(s.cleanData(r.getElementsByTagName("*")),s.cleanData([r])),r.parentNode&&r.parentNode.removeChild(r);return this},empty:function(){for(var e=0,t;(t=this[e])!=null;e++){t.nodeType===1&&s.cleanData(t.getElementsByTagName("*"));while(t.firstChild)t.removeChild(t.firstChild)}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return s.clone(this,e,t)})},html:function(e){if(e===t)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(J,""):null;if(typeof e=="string"&&!et.test(e)&&(s.support.leadingWhitespace||!K.test(e))&&!ot[(G.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Q,"<$1></$2>");try{for(var n=0,r=this.length;n<r;n++)this[n].nodeType===1&&(s.cleanData(this[n].getElementsByTagName("*")),this[n].innerHTML=e)}catch(i){this.empty().append(e)}}else s.isFunction(e)?this.each(function(t){var n=s(this);n.html(e.call(this,t,n.html()))}):this.empty().append(e);return this},replaceWith:function(e){return this[0]&&this[0].parentNode?s.isFunction(e)?this.each(function(t){var n=s(this),r=n.html();n.replaceWith(e.call(this,t,r))}):(typeof e!="string"&&(e=s(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;s(this).remove(),t?s(t).before(e):s(n).append(e)})):this.length?this.pushStack(s(s.isFunction(e)?e():e),"replaceWith",e):this},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){var i,o,u,a,f=e[0],l=[];if(!s.support.checkClone&&arguments.length===3&&typeof f=="string"&&rt.test(f))return this.each(function(){s(this).domManip(e,n,r,!0)});if(s.isFunction(f))return this.each(function(i){var o=s(this);e[0]=f.call(this,i,n?o.html():t),o.domManip(e,n,r)});if(this[0]){a=f&&f.parentNode,s.support.parentNode&&a&&a.nodeType===11&&a.childNodes.length===this.length?i={fragment:a}:i=s.buildFragment(e,this,l),u=i.fragment,u.childNodes.length===1?o=u=u.firstChild:o=u.firstChild;if(o){n=n&&s.nodeName(o,"tr");for(var c=0,h=this.length,p=h-1;c<h;c++)r.call(n?at(this[c],o):this[c],i.cacheable||h>1&&c<p?s.clone(u,!0,!0):u)}l.length&&s.each(l,vt)}return this}}),s.buildFragment=function(e,t,r){var i,o,u,a,f=e[0];return t&&t[0]&&(a=t[0].ownerDocument||t[0]),a.createDocumentFragment||(a=n),e.length===1&&typeof f=="string"&&f.length<512&&a===n&&f.charAt(0)==="<"&&!tt.test(f)&&(s.support.checkClone||!rt.test(f))&&(s.support.html5Clone||!nt.test(f))&&(o=!0,u=s.fragments[f],u&&u!==1&&(i=u)),i||(i=a.createDocumentFragment(),s.clean(e,a,i,r)),o&&(s.fragments[f]=u?i:1),{fragment:i,cacheable:o}},s.fragments={},s.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){s.fn[e]=function(n){var r=[],i=s(n),o=this.length===1&&this[0].parentNode;if(o&&o.nodeType===11&&o.childNodes.length===1&&i.length===1)return i[t](this[0]),this;for(var u=0,a=i.length;u<a;u++){var f=(u>0?this.clone(!0):this).get();s(i[u])[t](f),r=r.concat(f)}return this.pushStack(r,e,i.selector)}}),s.extend({clone:function(e,t,n){var r,i,o,u=s.support.html5Clone||!nt.test("<"+e.nodeName)?e.cloneNode(!0):dt(e);if((!s.support.noCloneEvent||!s.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!s.isXMLDoc(e)){lt(e,u),r=ct(e),i=ct(u);for(o=0;r[o];++o)i[o]&&lt(r[o],i[o])}if(t){ft(e,u);if(n){r=ct(e),i=ct(u);for(o=0;r[o];++o)ft(r[o],i[o])}}return r=i=null,u},clean:function(e,t,r,i){var o;t=t||n,typeof t.createElement=="undefined"&&(t=t.ownerDocument||t[0]&&t[0].ownerDocument||n);var u=[],a;for(var f=0,l;(l=e[f])!=null;f++){typeof l=="number"&&(l+="");if(!l)continue;if(typeof l=="string")if(!Z.test(l))l=t.createTextNode(l);else{l=l.replace(Q,"<$1></$2>");var c=(G.exec(l)||["",""])[1].toLowerCase(),h=ot[c]||ot._default,p=h[0],d=t.createElement("div");t===n?ut.appendChild(d):V(t).appendChild(d),d.innerHTML=h[1]+l+h[2];while(p--)d=d.lastChild;if(!s.support.tbody){var v=Y.test(l),m=c==="table"&&!v?d.firstChild&&d.firstChild.childNodes:h[1]==="<table>"&&!v?d.childNodes:[];for(a=m.length-1;a>=0;--a)s.nodeName(m[a],"tbody")&&!m[a].childNodes.length&&m[a].parentNode.removeChild(m[a])}!s.support.leadingWhitespace&&K.test(l)&&d.insertBefore(t.createTextNode(K.exec(l)[0]),d.firstChild),l=d.childNodes}var g;if(!s.support.appendChecked)if(l[0]&&typeof (g=l.length)=="number")for(a=0;a<g;a++)pt(l[a]);else pt(l);l.nodeType?u.push(l):u=s.merge(u,l)}if(r){o=function(e){return!e.type||it.test(e.type)};for(f=0;u[f];f++)if(i&&s.nodeName(u[f],"script")&&(!u[f].type||u[f].type.toLowerCase()==="text/javascript"))i.push(u[f].parentNode?u[f].parentNode.removeChild(u[f]):u[f]);else{if(u[f].nodeType===1){var y=s.grep(u[f].getElementsByTagName("script"),o);u.splice.apply(u,[f+1,0].concat(y))}r.appendChild(u[f])}}return u},cleanData:function(e){var t,n,r=s.cache,i=s.event.special,o=s.support.deleteExpando;for(var u=0,a;(a=e[u])!=null;u++){if(a.nodeName&&s.noData[a.nodeName.toLowerCase()])continue;n=a[s.expando];if(n){t=r[n];if(t&&t.events){for(var f in t.events)i[f]?s.event.remove(a,f):s.removeEvent(a,f,t.handle);t.handle&&(t.handle.elem=null)}o?delete a[s.expando]:a.removeAttribute&&a.removeAttribute(s.expando),delete r[n]}}}});var mt=/alpha\([^)]*\)/i,gt=/opacity=([^)]*)/,yt=/([A-Z]|^ms)/g,bt=/^-?\d+(?:px)?$/i,wt=/^-?\d/,Et=/^([\-+])=([\-+.\de]+)/,St={position:"absolute",visibility:"hidden",display:"block"},xt=["Left","Right"],Tt=["Top","Bottom"],Nt,Ct,kt;s.fn.css=function(e,n){return arguments.length===2&&n===t?this:s.access(this,e,n,!0,function(e,n,r){return r!==t?s.style(e,n,r):s.css(e,n)})},s.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Nt(e,"opacity","opacity");return n===""?"1":n}return e.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":s.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var o,u,a=s.camelCase(n),f=e.style,l=s.cssHooks[a];n=s.cssProps[a]||a;if(r===t)return l&&"get"in l&&(o=l.get(e,!1,i))!==t?o:f[n];u=typeof r,u==="string"&&(o=Et.exec(r))&&(r=+(o[1]+1)*+o[2]+parseFloat(s.css(e,n)),u="number");if(r==null||u==="number"&&isNaN(r))return;u==="number"&&!s.cssNumber[a]&&(r+="px");if(!l||!("set"in l)||(r=l.set(e,r))!==t)try{f[n]=r}catch(c){}},css:function(e,n,r){var i,o;n=s.camelCase(n),o=s.cssHooks[n],n=s.cssProps[n]||n,n==="cssFloat"&&(n="float");if(o&&"get"in o&&(i=o.get(e,!0,r))!==t)return i;if(Nt)return Nt(e,n)},swap:function(e,t,n){var r={};for(var i in t)r[i]=e.style[i],e.style[i]=t[i];n.call(e);for(i in t)e.style[i]=r[i]}}),s.curCSS=s.css,s.each(["height","width"],function(e,t){s.cssHooks[t]={get:function(e,n,r){var i;if(n)return e.offsetWidth!==0?Lt(e,t,r):(s.swap(e,St,function(){i=Lt(e,t,r)}),i)},set:function(e,t){if(!bt.test(t))return t;t=parseFloat(t);if(t>=0)return t+"px"}}}),s.support.opacity||(s.cssHooks.opacity={get:function(e,t){return gt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?parseFloat(RegExp.$1)/100+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=s.isNumeric(t)?"alpha(opacity="+t*100+")":"",o=r&&r.filter||n.filter||"";n.zoom=1;if(t>=1&&s.trim(o.replace(mt,""))===""){n.removeAttribute("filter");if(r&&!r.filter)return}n.filter=mt.test(o)?o.replace(mt,i):o+" "+i}}),s(function(){s.support.reliableMarginRight||(s.cssHooks.marginRight={get:function(e,t){var n;return s.swap(e,{display:"inline-block"},function(){t?n=Nt(e,"margin-right","marginRight"):n=e.style.marginRight}),n}})}),n.defaultView&&n.defaultView.getComputedStyle&&(Ct=function(e,t){var n,r,i;return t=t.replace(yt,"-$1").toLowerCase(),(r=e.ownerDocument.defaultView)&&(i=r.getComputedStyle(e,null))&&(n=i.getPropertyValue(t),n===""&&!s.contains(e.ownerDocument.documentElement,e)&&(n=s.style(e,t))),n}),n.documentElement.currentStyle&&(kt=function(e,t){var n,r,i,s=e.currentStyle&&e.currentStyle[t],o=e.style;return s===null&&o&&(i=o[t])&&(s=i),!bt.test(s)&&wt.test(s)&&(n=o.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),o.left=t==="fontSize"?"1em":s||0,s=o.pixelLeft+"px",o.left=n,r&&(e.runtimeStyle.left=r)),s===""?"auto":s}),Nt=Ct||kt,s.expr&&s.expr.filters&&(s.expr.filters.hidden=function(e){var t=e.offsetWidth,n=e.offsetHeight;return t===0&&n===0||!s.support.reliableHiddenOffsets&&(e.style&&e.style.display||s.css(e,"display"))==="none"},s.expr.filters.visible=function(e){return!s.expr.filters.hidden(e)});var At=/%20/g,Ot=/\[\]$/,Mt=/\r?\n/g,_t=/#.*$/,Dt=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,Pt=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Ht=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,Bt=/^(?:GET|HEAD)$/,jt=/^\/\//,Ft=/\?/,It=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,qt=/^(?:select|textarea)/i,Rt=/\s+/,Ut=/([?&])_=[^&]*/,zt=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,Wt=s.fn.load,Xt={},Vt={},$t,Jt,Kt=["*/"]+["*"];try{$t=i.href}catch(Qt){$t=n.createElement("a"),$t.href="",$t=$t.href}Jt=zt.exec($t.toLowerCase())||[],s.fn.extend({load:function(e,n,r){if(typeof e!="string"&&Wt)return Wt.apply(this,arguments);if(!this.length)return this;var i=e.indexOf(" ");if(i>=0){var o=e.slice(i,e.length);e=e.slice(0,i)}var u="GET";n&&(s.isFunction(n)?(r=n,n=t):typeof n=="object"&&(n=s.param(n,s.ajaxSettings.traditional),u="POST"));var a=this;return s.ajax({url:e,type:u,dataType:"html",data:n,complete:function(e,t,n){n=e.responseText,e.isResolved()&&(e.done(function(e){n=e}),a.html(o?s("<div>").append(n.replace(It,"")).find(o):n)),r&&a.each(r,[n,t,e])}}),this},serialize:function(){return s.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?s.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||qt.test(this.nodeName)||Pt.test(this.type))}).map(function(e,t){var n=s(this).val();return n==null?null:s.isArray(n)?s.map(n,function(e,n){return{name:t.name,value:e.replace(Mt,"\r\n")}}):{name:t.name,value:n.replace(Mt,"\r\n")}}).get()}}),s.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){s.fn[t]=function(e){return this.on(t,e)}}),s.each(["get","post"],function(e,n){s[n]=function(e,r,i,o){return s.isFunction(r)&&(o=o||i,i=r,r=t),s.ajax({type:n,url:e,data:r,success:i,dataType:o})}}),s.extend({getScript:function(e,n){return s.get(e,t,n,"script")},getJSON:function(e,t,n){return s.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?Zt(e,s.ajaxSettings):(t=e,e=s.ajaxSettings),Zt(e,t),e},ajaxSettings:{url:$t,isLocal:Ht.test(Jt[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Kt},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":s.parseJSON,"text xml":s.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:Gt(Xt),ajaxTransport:Gt(Vt),ajax:function(e,n){function S(e,n,c,h){if(y===2)return;y=2,m&&clearTimeout(m),v=t,p=h||"",E.readyState=e>0?4:0;var d,g,w,S=n,x=c?tn(r,E,c):t,T,N;if(e>=200&&e<300||e===304){if(r.ifModified){if(T=E.getResponseHeader("Last-Modified"))s.lastModified[l]=T;if(N=E.getResponseHeader("Etag"))s.etag[l]=N}if(e===304)S="notmodified",d=!0;else try{g=nn(r,x),S="success",d=!0}catch(C){S="parsererror",w=C}}else{w=S;if(!S||e)S="error",e<0&&(e=0)}E.status=e,E.statusText=""+(n||S),d?u.resolveWith(i,[g,S,E]):u.rejectWith(i,[E,S,w]),E.statusCode(f),f=t,b&&o.trigger("ajax"+(d?"Success":"Error"),[E,r,d?g:w]),a.fireWith(i,[E,S]),b&&(o.trigger("ajaxComplete",[E,r]),--s.active||s.event.trigger("ajaxStop"))}typeof e=="object"&&(n=e,e=t),n=n||{};var r=s.ajaxSetup({},n),i=r.context||r,o=i!==r&&(i.nodeType||i instanceof s)?s(i):s.event,u=s.Deferred(),a=s.Callbacks("once memory"),f=r.statusCode||{},l,c={},h={},p,d,v,m,g,y=0,b,w,E={readyState:0,setRequestHeader:function(e,t){if(!y){var n=e.toLowerCase();e=h[n]=h[n]||e,c[e]=t}return this},getAllResponseHeaders:function(){return y===2?p:null},getResponseHeader:function(e){var n;if(y===2){if(!d){d={};while(n=Dt.exec(p))d[n[1].toLowerCase()]=n[2]}n=d[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return y||(r.mimeType=e),this},abort:function(e){return e=e||"abort",v&&v.abort(e),S(0,e),this}};u.promise(E),E.success=E.done,E.error=E.fail,E.complete=a.add,E.statusCode=function(e){if(e){var t;if(y<2)for(t in e)f[t]=[f[t],e[t]];else t=e[E.status],E.then(t,t)}return this},r.url=((e||r.url)+"").replace(_t,"").replace(jt,Jt[1]+"//"),r.dataTypes=s.trim(r.dataType||"*").toLowerCase().split(Rt),r.crossDomain==null&&(g=zt.exec(r.url.toLowerCase()),r.crossDomain=!(!g||g[1]==Jt[1]&&g[2]==Jt[2]&&(g[3]||(g[1]==="http:"?80:443))==(Jt[3]||(Jt[1]==="http:"?80:443)))),r.data&&r.processData&&typeof r.data!="string"&&(r.data=s.param(r.data,r.traditional)),Yt(Xt,r,n,E);if(y===2)return!1;b=r.global,r.type=r.type.toUpperCase(),r.hasContent=!Bt.test(r.type),b&&s.active++===0&&s.event.trigger("ajaxStart");if(!r.hasContent){r.data&&(r.url+=(Ft.test(r.url)?"&":"?")+r.data,delete r.data),l=r.url;if(r.cache===!1){var x=s.now(),T=r.url.replace(Ut,"$1_="+x);r.url=T+(T===r.url?(Ft.test(r.url)?"&":"?")+"_="+x:"")}}(r.data&&r.hasContent&&r.contentType!==!1||n.contentType)&&E.setRequestHeader("Content-Type",r.contentType),r.ifModified&&(l=l||r.url,s.lastModified[l]&&E.setRequestHeader("If-Modified-Since",s.lastModified[l]),s.etag[l]&&E.setRequestHeader("If-None-Match",s.etag[l])),E.setRequestHeader("Accept",r.dataTypes[0]&&r.accepts[r.dataTypes[0]]?r.accepts[r.dataTypes[0]]+(r.dataTypes[0]!=="*"?", "+Kt+"; q=0.01":""):r.accepts["*"]);for(w in r.headers)E.setRequestHeader(w,r.headers[w]);if(!r.beforeSend||r.beforeSend.call(i,E,r)!==!1&&y!==2){for(w in{success:1,error:1,complete:1})E[w](r[w]);v=Yt(Vt,r,n,E);if(!v)S(-1,"No Transport");else{E.readyState=1,b&&o.trigger("ajaxSend",[E,r]),r.async&&r.timeout>0&&(m=setTimeout(function(){E.abort("timeout")},r.timeout));try{y=1,v.send(c,S)}catch(N){if(!(y<2))throw N;S(-1,N)}}return E}return E.abort(),!1},param:function(e,n){var r=[],i=function(e,t){t=s.isFunction(t)?t():t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};n===t&&(n=s.ajaxSettings.traditional);if(s.isArray(e)||e.jquery&&!s.isPlainObject(e))s.each(e,function(){i(this.name,this.value)});else for(var o in e)en(o,e[o],n,i);return r.join("&").replace(At,"+")}}),s.extend({active:0,lastModified:{},etag:{}});var rn=s.now(),sn=/(\=)\?(&|$)|\?\?/i;s.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return s.expando+"_"+rn++}}),s.ajaxPrefilter("json jsonp",function(t,n,r){var i=t.contentType==="application/x-www-form-urlencoded"&&typeof t.data=="string";if(t.dataTypes[0]==="jsonp"||t.jsonp!==!1&&(sn.test(t.url)||i&&sn.test(t.data))){var o,u=t.jsonpCallback=s.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a=e[u],f=t.url,l=t.data,c="$1"+u+"$2";return t.jsonp!==!1&&(f=f.replace(sn,c),t.url===f&&(i&&(l=l.replace(sn,c)),t.data===l&&(f+=(/\?/.test(f)?"&":"?")+t.jsonp+"="+u))),t.url=f,t.data=l,e[u]=function(e){o=[e]},r.always(function(){e[u]=a,o&&s.isFunction(a)&&e[u](o[0])}),t.converters["script json"]=function(){return o||s.error(u+" was not called"),o[0]},t.dataTypes[0]="json","script"}}),s.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return s.globalEval(e),e}}}),s.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),s.ajaxTransport("script",function(e){if(e.crossDomain){var r,i=n.head||n.getElementsByTagName("head")[0]||n.documentElement;return{send:function(s,o){r=n.createElement("script"),r.async="async",e.scriptCharset&&(r.charset=e.scriptCharset),r.src=e.url,r.onload=r.onreadystatechange=function(e,n){if(n||!r.readyState||/loaded|complete/.test(r.readyState))r.onload=r.onreadystatechange=null,i&&r.parentNode&&i.removeChild(r),r=t,n||o(200,"success")},i.insertBefore(r,i.firstChild)},abort:function(){r&&r.onload(0,1)}}}});var on=e.ActiveXObject?function(){for(var e in an)an[e](0,1)}:!1,un=0,an;s.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&fn()||ln()}:fn,function(e){s.extend(s.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(s.ajaxSettings.xhr()),s.support.ajax&&s.ajaxTransport(function(n){if(!n.crossDomain||s.support.cors){var r;return{send:function(i,o){var u=n.xhr(),a,f;n.username?u.open(n.type,n.url,n.async,n.username,n.password):u.open(n.type,n.url,n.async);if(n.xhrFields)for(f in n.xhrFields)u[f]=n.xhrFields[f];n.mimeType&&u.overrideMimeType&&u.overrideMimeType(n.mimeType),!n.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");try{for(f in i)u.setRequestHeader(f,i[f])}catch(l){}u.send(n.hasContent&&n.data||null),r=function(e,i){var f,l,c,h,p;try{if(r&&(i||u.readyState===4)){r=t,a&&(u.onreadystatechange=s.noop,on&&delete an[a]);if(i)u.readyState!==4&&u.abort();else{f=u.status,c=u.getAllResponseHeaders(),h={},p=u.responseXML,p&&p.documentElement&&(h.xml=p),h.text=u.responseText;try{l=u.statusText}catch(d){l=""}!f&&n.isLocal&&!n.crossDomain?f=h.text?200:404:f===1223&&(f=204)}}}catch(v){i||o(-1,v)}h&&o(f,l,h,c)},!n.async||u.readyState===4?r():(a=++un,on&&(an||(an={},s(e).unload(on)),an[a]=r),u.onreadystatechange=r)},abort:function(){r&&r(0,1)}}}});var cn={},hn,pn,dn=/^(?:toggle|show|hide)$/,vn=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,mn,gn=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],yn;s.fn.extend({show:function(e,t,n){var r,i;if(e||e===0)return this.animate(En("show",3),e,t,n);for(var o=0,u=this.length;o<u;o++)r=this[o],r.style&&(i=r.style.display,!s._data(r,"olddisplay")&&i==="none"&&(i=r.style.display=""),i===""&&s.css(r,"display")==="none"&&s._data(r,"olddisplay",Sn(r.nodeName)));for(o=0;o<u;o++){r=this[o];if(r.style){i=r.style.display;if(i===""||i==="none")r.style.display=s._data(r,"olddisplay")||""}}return this},hide:function(e,t,n){if(e||e===0)return this.animate(En("hide",3),e,t,n);var r,i,o=0,u=this.length;for(;o<u;o++)r=this[o],r.style&&(i=s.css(r,"display"),i!=="none"&&!s._data(r,"olddisplay")&&s._data(r,"olddisplay",i));for(o=0;o<u;o++)this[o].style&&(this[o].style.display="none");return this},_toggle:s.fn.toggle,toggle:function(e,t,n){var r=typeof e=="boolean";return s.isFunction(e)&&s.isFunction(t)?this._toggle.apply(this,arguments):e==null||r?this.each(function(){var t=r?e:s(this).is(":hidden");s(this)[t?"show":"hide"]()}):this.animate(En("toggle",3),e,t,n),this},fadeTo:function(e,t,n,r){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){function o(){i.queue===!1&&s._mark(this);var t=s.extend({},i),n=this.nodeType===1,r=n&&s(this).is(":hidden"),o,u,a,f,l,c,h,p,d;t.animatedProperties={};for(a in e){o=s.camelCase(a),a!==o&&(e[o]=e[a],delete e[a]),u=e[o],s.isArray(u)?(t.animatedProperties[o]=u[1],u=e[o]=u[0]):t.animatedProperties[o]=t.specialEasing&&t.specialEasing[o]||t.easing||"swing";if(u==="hide"&&r||u==="show"&&!r)return t.complete.call(this);n&&(o==="height"||o==="width")&&(t.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],s.css(this,"display")==="inline"&&s.css(this,"float")==="none"&&(!s.support.inlineBlockNeedsLayout||Sn(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1))}t.overflow!=null&&(this.style.overflow="hidden");for(a in e)f=new s.fx(this,t,a),u=e[a],dn.test(u)?(d=s._data(this,"toggle"+a)||(u==="toggle"?r?"show":"hide":0),d?(s._data(this,"toggle"+a,d==="show"?"hide":"show"),f[d]()):f[u]()):(l=vn.exec(u),c=f.cur(),l?(h=parseFloat(l[2]),p=l[3]||(s.cssNumber[a]?"":"px"),p!=="px"&&(s.style(this,a,(h||1)+p),c=(h||1)/f.cur()*c,s.style(this,a,c+p)),l[1]&&(h=(l[1]==="-="?-1:1)*h+c),f.custom(c,h,p)):f.custom(c,u,""));return!0}var i=s.speed(t,n,r);return s.isEmptyObject(e)?this.each(i.complete,[!1]):(e=s.extend({},e),i.queue===!1?this.each(o):this.queue(i.queue,o))},stop:function(e,n,r){return typeof e!="string"&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){function u(e,t,n){var i=t[n];s.removeData(e,n,!0),i.stop(r)}var t,n=!1,i=s.timers,o=s._data(this);r||s._unmark(!0,this);if(e==null)for(t in o)o[t]&&o[t].stop&&t.indexOf(".run")===t.length-4&&u(this,o,t);else o[t=e+".run"]&&o[t].stop&&u(this,o,t);for(t=i.length;t--;)i[t].elem===this&&(e==null||i[t].queue===e)&&(r?i[t](!0):i[t].saveState(),n=!0,i.splice(t,1));(!r||!n)&&s.dequeue(this,e)})}}),s.each({slideDown:En("show",1),slideUp:En("hide",1),slideToggle:En("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){s.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),s.extend({speed:function(e,t,n){var r=e&&typeof e=="object"?s.extend({},e):{complete:n||!n&&t||s.isFunction(e)&&e,duration:e,easing:n&&t||t&&!s.isFunction(t)&&t};r.duration=s.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in s.fx.speeds?s.fx.speeds[r.duration]:s.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(e){s.isFunction(r.old)&&r.old.call(this),r.queue?s.dequeue(this,r.queue):e!==!1&&s._unmark(this)},r},easing:{linear:function(e,t,n,r){return n+r*e},swing:function(e,t,n,r){return(-Math.cos(e*Math.PI)/2+.5)*r+n}},timers:[],fx:function(e,t,n){this.options=t,this.elem=e,this.prop=n,t.orig=t.orig||{}}}),s.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(s.fx.step[this.prop]||s.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]==null||!!this.elem.style&&this.elem.style[this.prop]!=null){var e,t=s.css(this.elem,this.prop);return isNaN(e=parseFloat(t))?!t||t==="auto"?0:t:e}return this.elem[this.prop]},custom:function(e,n,r){function u(e){return i.step(e)}var i=this,o=s.fx;this.startTime=yn||bn(),this.end=n,this.now=this.start=e,this.pos=this.state=0,this.unit=r||this.unit||(s.cssNumber[this.prop]?"":"px"),u.queue=this.options.queue,u.elem=this.elem,u.saveState=function(){i.options.hide&&s._data(i.elem,"fxshow"+i.prop)===t&&s._data(i.elem,"fxshow"+i.prop,i.start)},u()&&s.timers.push(u)&&!mn&&(mn=setInterval(o.tick,o.interval))},show:function(){var e=s._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=e||s.style(this.elem,this.prop),this.options.show=!0,e!==t?this.custom(this.cur(),e):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),s(this.elem).show()},hide:function(){this.options.orig[this.prop]=s._data(this.elem,"fxshow"+this.prop)||s.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(e){var t,n,r,i=yn||bn(),o=!0,u=this.elem,a=this.options;if(e||i>=a.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),a.animatedProperties[this.prop]=!0;for(t in a.animatedProperties)a.animatedProperties[t]!==!0&&(o=!1);if(o){a.overflow!=null&&!s.support.shrinkWrapBlocks&&s.each(["","X","Y"],function(e,t){u.style["overflow"+t]=a.overflow[e]}),a.hide&&s(u).hide();if(a.hide||a.show)for(t in a.animatedProperties)s.style(u,t,a.orig[t]),s.removeData(u,"fxshow"+t,!0),s.removeData(u,"toggle"+t,!0);r=a.complete,r&&(a.complete=!1,r.call(u))}return!1}return a.duration==Infinity?this.now=i:(n=i-this.startTime,this.state=n/a.duration,this.pos=s.easing[a.animatedProperties[this.prop]](this.state,n,0,1,a.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update(),!0}},s.extend(s.fx,{tick:function(){var e,t=s.timers,n=0;for(;n<t.length;n++)e=t[n],!e()&&t[n]===e&&t.splice(n--,1);t.length||s.fx.stop()},interval:13,stop:function(){clearInterval(mn),mn=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(e){s.style(e.elem,"opacity",e.now)},_default:function(e){e.elem.style&&e.elem.style[e.prop]!=null?e.elem.style[e.prop]=e.now+e.unit:e.elem[e.prop]=e.now}}}),s.each(["width","height"],function(e,t){s.fx.step[t]=function(e){s.style(e.elem,t,Math.max(0,e.now)+e.unit)}}),s.expr&&s.expr.filters&&(s.expr.filters.animated=function(e){return s.grep(s.timers,function(t){return e===t.elem}).length});var xn=/^t(?:able|d|h)$/i,Tn=/^(?:body|html)$/i;"getBoundingClientRect"in n.documentElement?s.fn.offset=function(e){var t=this[0],n;if(e)return this.each(function(t){s.offset.setOffset(this,e,t)});if(!t||!t.ownerDocument)return null;if(t===t.ownerDocument.body)return s.offset.bodyOffset(t);try{n=t.getBoundingClientRect()}catch(r){}var i=t.ownerDocument,o=i.documentElement;if(!n||!s.contains(o,t))return n?{top:n.top,left:n.left}:{top:0,left:0};var u=i.body,a=Nn(i),f=o.clientTop||u.clientTop||0,l=o.clientLeft||u.clientLeft||0,c=a.pageYOffset||s.support.boxModel&&o.scrollTop||u.scrollTop,h=a.pageXOffset||s.support.boxModel&&o.scrollLeft||u.scrollLeft,p=n.top+c-f,d=n.left+h-l;return{top:p,left:d}}:s.fn.offset=function(e){var t=this[0];if(e)return this.each(function(t){s.offset.setOffset(this,e,t)});if(!t||!t.ownerDocument)return null;if(t===t.ownerDocument.body)return s.offset.bodyOffset(t);var n,r=t.offsetParent,i=t,o=t.ownerDocument,u=o.documentElement,a=o.body,f=o.defaultView,l=f?f.getComputedStyle(t,null):t.currentStyle,c=t.offsetTop,h=t.offsetLeft;while((t=t.parentNode)&&t!==a&&t!==u){if(s.support.fixedPosition&&l.position==="fixed")break;n=f?f.getComputedStyle(t,null):t.currentStyle,c-=t.scrollTop,h-=t.scrollLeft,t===r&&(c+=t.offsetTop,h+=t.offsetLeft,s.support.doesNotAddBorder&&(!s.support.doesAddBorderForTableAndCells||!xn.test(t.nodeName))&&(c+=parseFloat(n.borderTopWidth)||0,h+=parseFloat(n.borderLeftWidth)||0),i=r,r=t.offsetParent),s.support.subtractsBorderForOverflowNotVisible&&n.overflow!=="visible"&&(c+=parseFloat(n.borderTopWidth)||0,h+=parseFloat(n.borderLeftWidth)||0),l=n}if(l.position==="relative"||l.position==="static")c+=a.offsetTop,h+=a.offsetLeft;return s.support.fixedPosition&&l.position==="fixed"&&(c+=Math.max(u.scrollTop,a.scrollTop),h+=Math.max(u.scrollLeft,a.scrollLeft)),{top:c,left:h}},s.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return s.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(s.css(e,"marginTop"))||0,n+=parseFloat(s.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=s.css(e,"position");r==="static"&&(e.style.position="relative");var i=s(e),o=i.offset(),u=s.css(e,"top"),a=s.css(e,"left"),f=(r==="absolute"||r==="fixed")&&s.inArray("auto",[u,a])>-1,l={},c={},h,p;f?(c=i.position(),h=c.top,p=c.left):(h=parseFloat(u)||0,p=parseFloat(a)||0),s.isFunction(t)&&(t=t.call(e,n,o)),t.top!=null&&(l.top=t.top-o.top+h),t.left!=null&&(l.left=t.left-o.left+p),"using"in t?t.using.call(e,l):i.css(l)}},s.fn.extend({position:function(){if(!this[0])return null;var e=this[0],t=this.offsetParent(),n=this.offset(),r=Tn.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(s.css(e,"marginTop"))||0,n.left-=parseFloat(s.css(e,"marginLeft"))||0,r.top+=parseFloat(s.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(s.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||n.body;while(e&&!Tn.test(e.nodeName)&&s.css(e,"position")==="static")e=e.offsetParent;return e})}}),s.each(["Left","Top"],function(e,n){var r="scroll"+n;s.fn[r]=function(n){var i,o;return n===t?(i=this[0],i?(o=Nn(i),o?"pageXOffset"in o?o[e?"pageYOffset":"pageXOffset"]:s.support.boxModel&&o.document.documentElement[r]||o.document.body[r]:i[r]):null):this.each(function(){o=Nn(this),o?o.scrollTo(e?s(o).scrollLeft():n,e?n:s(o).scrollTop()):this[r]=n})}}),s.each(["Height","Width"],function(e,n){var r=n.toLowerCase();s.fn["inner"+n]=function(){var e=this[0];return e?e.style?parseFloat(s.css(e,r,"padding")):this[r]():null},s.fn["outer"+n]=function(e){var t=this[0];return t?t.style?parseFloat(s.css(t,r,e?"margin":"border")):this[r]():null},s.fn[r]=function(e){var i=this[0];if(!i)return e==null?null:this;if(s.isFunction(e))return this.each(function(t){var n=s(this);n[r](e.call(this,t,n[r]()))});if(s.isWindow(i)){var o=i.document.documentElement["client"+n],u=i.document.body;return i.document.compatMode==="CSS1Compat"&&o||u&&u["client"+n]||o}if(i.nodeType===9)return Math.max(i.documentElement["client"+n],i.body["scroll"+n],i.documentElement["scroll"+n],i.body["offset"+n],i.documentElement["offset"+n]);if(e===t){var a=s.css(i,r),f=parseFloat(a);return s.isNumeric(f)?f:a}return this.css(r,typeof e=="string"?e:e+"px")}}),e.jQuery=e.$=s,typeof pen.define=="function"&&pen.define.amd&&pen.define.amd.jQuery&&pen.define("jquery",[],function(){return s})})(window),pen.define("cdf/jquery",function(e){return function(){var t,n;return t||e.$}}(this)),function(e){e.prompt=function(t,n){n=e.extend({},e.prompt.defaults,n),e.prompt.currentPrefix=n.prefix;var r=e.browser.msie&&e.browser.version<7,i=e(document.body),s=e(window);n.classes=e.trim(n.classes),n.classes!=""&&(n.classes=" "+n.classes);var o='<div class="'+n.prefix+"box"+n.classes+'" id="'+n.prefix+'box">';n.useiframe&&(e("object, applet").length>0||r)?o+='<iframe src="javascript:false;" style="display:block;position:absolute;z-index:-1;" class="'+n.prefix+'fade" id="'+n.prefix+'fade"></iframe>':(r&&e("select").css("visibility","hidden"),o+='<div class="'+n.prefix+'fade" id="'+n.prefix+'fade"></div>'),o+='<div class="'+n.prefix+'" id="'+n.prefix+'"><div class="'+n.prefix+'container"><div class="',o+=n.prefix+'close">X</div><div id="'+n.prefix+'states"></div>',o+="</div></div></div>";var u=e(o).appendTo(i),a=u.children("#"+n.prefix),f=u.children("#"+n.prefix+"fade");t.constructor==String&&(t={state0:{html:t,buttons:n.buttons,focus:n.focus,submit:n.submit}});var l="";e.each(t,function(r,i){i=e.extend({},e.prompt.defaults.state,i),t[r]=i,l+='<div id="'+n.prefix+"_state_"+r+'" class="'+n.prefix+'_state" style="display:none;"><div class="'+n.prefix+'message">'+i.html+'</div><div class="'+n.prefix+'buttons">',e.each(i.buttons,function(e,t){typeof t=="object"?l+='<button name="'+n.prefix+"_"+r+"_button"+t.title.replace(/[^a-z0-9]+/gi,"")+'" id="'+n.prefix+"_"+r+"_button"+t.title.replace(/[^a-z0-9]+/gi,"")+'" value="'+t.value+'">'+t.title+"</button>":l+='<button name="'+n.prefix+"_"+r+"_button"+e+'" id="'+n.prefix+"_"+r+"_button"+e+'" value="'+t+'">'+e+"</button>"}),l+="</div></div>"}),a.find("#"+n.prefix+"states").html(l).children("."+n.prefix+"_state:first").css("display","block"),a.find("."+n.prefix+"buttons:empty").css("display","none"),e.each(t,function(t,r){var i=a.find("#"+n.prefix+"_state_"+t);i.children("."+n.prefix+"buttons").children("button").click(function(){var t=i.children("."+n.prefix+"message"),s=r.buttons[e(this).text()];if(s==undefined)for(var o in r.buttons)r.buttons[o].title==e(this).text()&&(s=r.buttons[o].value);typeof s=="object"&&(s=s.value);var u={};e.each(a.find("#"+n.prefix+"states :input").serializeArray(),function(e,t){u[t.name]===undefined?u[t.name]=t.value:typeof u[t.name]==Array||typeof u[t.name]=="object"?u[t.name].push(t.value):u[t.name]=[u[t.name],t.value]});var f=r.submit(s,t,u);(f===undefined||f)&&m(!0,s,t,u)}),i.find("."+n.prefix+"buttons button:eq("+r.focus+")").addClass(n.prefix+"defaultbutton")});var c=function(){u.css({top:s.scrollTop()})},h=function(){if(n.persistent){var e=0;u.addClass(n.prefix+"warning");var t=setInterval(function(){u.toggleClass(n.prefix+"warning"),e++>1&&(clearInterval(t),u.removeClass(n.prefix+"warning"))},100)}else m()},p=function(t){var n=window.event?event.keyCode:t.keyCode;n==27&&h();if(n==9){var r=e(":input:enabled:visible",u),i=!t.shiftKey&&t.target==r[r.length-1],s=t.shiftKey&&t.target==r[0];if(i||s)return setTimeout(function(){if(!r)return;var e=r[s===!0?r.length-1:0];e&&e.focus()},10),!1}},d=function(){u.css({position:r?"absolute":"fixed",height:s.height(),width:"100%",top:r?s.scrollTop():0,left:0,right:0,bottom:0}),f.css({position:"absolute",height:s.height(),width:"100%",top:0,left:0,right:0,bottom:0}),a.css({position:"absolute",top:n.top,left:"50%",marginLeft:a.outerWidth()/2*-1})},v=function(){f.css({zIndex:n.zIndex,display:"none",opacity:n.opacity}),a.css({zIndex:n.zIndex+1,display:"none"}),u.css({zIndex:n.zIndex})},m=function(t,o,l,v){a.remove(),r&&i.unbind("scroll",c),s.unbind("resize",d),f.fadeOut(n.overlayspeed,function(){f.unbind("click",h),f.remove(),t&&n.callback(o,l,v),u.unbind("keypress",p),u.remove(),r&&!n.useiframe&&e("select").css("visibility","visible")})};return d(),v(),r&&s.scroll(c),f.click(h),s.resize(d),u.bind("keydown keypress",p),a.find("."+n.prefix+"close").click(m),f.fadeIn(n.overlayspeed),a[n.show](n.promptspeed,n.loaded),a.find("#"+n.prefix+"states ."+n.prefix+"_state:first ."+n.prefix+"defaultbutton").focus(),n.timeout>0&&setTimeout(e.prompt.close,n.timeout),u},e.prompt.defaults={prefix:"jqi",classes:"",buttons:{Ok:!0},loaded:function(){},submit:function(){return!0},callback:function(){},opacity:.6,zIndex:999,overlayspeed:"slow",promptspeed:"fast",show:"fadeIn",focus:0,useiframe:!1,top:"15%",persistent:!0,timeout:0,state:{html:"",buttons:{Ok:!0},focus:0,submit:function(){return!0}}},e.prompt.currentPrefix=e.prompt.defaults.prefix,e.prompt.setDefaults=function(t){e.prompt.defaults=e.extend({},e.prompt.defaults,t)},e.prompt.setStateDefaults=function(t){e.prompt.defaults.state=e.extend({},e.prompt.defaults.state,t)},e.prompt.getStateContent=function(t){return e("#"+e.prompt.currentPrefix+"_state_"+t)},e.prompt.getCurrentState=function(){return e("."+e.prompt.currentPrefix+"_state:visible")},e.prompt.getCurrentStateName=function(){var t=e.prompt.getCurrentState().attr("id");return t.replace(e.prompt.currentPrefix+"_state_","")},e.prompt.goToState=function(t,n){e("."+e.prompt.currentPrefix+"_state").slideUp("slow"),e("#"+e.prompt.currentPrefix+"_state_"+t).slideDown("slow",function(){e(this).find("."+e.prompt.currentPrefix+"defaultbutton").focus(),typeof n=="function"&&n()})},e.prompt.nextState=function(t){var n=e("."+e.prompt.currentPrefix+"_state:visible").next();e("."+e.prompt.currentPrefix+"_state").slideUp("slow"),n.slideDown("slow",function(){n.find("."+e.prompt.currentPrefix+"defaultbutton").focus(),typeof t=="function"&&t()})},e.prompt.prevState=function(t){var n=e("."+e.prompt.currentPrefix+"_state:visible").prev();e("."+e.prompt.currentPrefix+"_state").slideUp("slow"),n.slideDown("slow",function(){n.find("."+e.prompt.currentPrefix+"defaultbutton").focus(),typeof t=="function"&&t()})},e.prompt.close=function(){e("#"+e.prompt.currentPrefix+"box").fadeOut("fast",function(){e(this).remove()})},e.fn.prompt=function(t){t==undefined&&(t={}),t.withDataAndEvents==undefined&&(t.withDataAndEvents=!1),e.prompt(e(this).clone(t.withDataAndEvents).html(),t)}}(jQuery),pen.define("cdf/jquery-impromptu.3.1",function(){}),function(e,t){function n(t,n){var i=t.nodeName.toLowerCase();if("area"===i){var s=t.parentNode,o=s.name,u;return!t.href||!o||s.nodeName.toLowerCase()!=="map"?!1:(u=e("img[usemap=#"+o+"]")[0],!!u&&r(u))}return(/input|select|textarea|button|object/.test(i)?!t.disabled:"a"==i?t.href||n:n)&&r(t)}function r(t){return!e(t).parents().andSelf().filter(function(){return e.curCSS(this,"visibility")==="hidden"||e.expr.filters.hidden(this)}).length}e.ui=e.ui||{};if(e.ui.version)return;e.extend(e.ui,{version:"1.8.14",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),e.fn.extend({_focus:e.fn.focus,focus:function(t,n){return typeof t=="number"?this.each(function(){var r=this;setTimeout(function(){e(r).focus(),n&&n.call(r)},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;return e.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?t=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.curCSS(this,"position",1))&&/(auto|scroll)/.test(e.curCSS(this,"overflow",1)+e.curCSS(this,"overflow-y",1)+e.curCSS(this,"overflow-x",1))}).eq(0):t=this.parents().filter(function(){return/(auto|scroll)/.test(e.curCSS(this,"overflow",1)+e.curCSS(this,"overflow-y",1)+e.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length){var r=e(this[0]),i,s;while(r.length&&r[0]!==document){i=r.css("position");if(i==="absolute"||i==="relative"||i==="fixed"){s=parseInt(r.css("zIndex"),10);if(!isNaN(s)&&s!==0)return s}r=r.parent()}}return 0},disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.each(["Width","Height"],function(n,r){function u(t,n,r,s){return e.each(i,function(){n-=parseFloat(e.curCSS(t,"padding"+this,!0))||0,r&&(n-=parseFloat(e.curCSS(t,"border"+this+"Width",!0))||0),s&&(n-=parseFloat(e.curCSS(t,"margin"+this,!0))||0)}),n}var i=r==="Width"?["Left","Right"]:["Top","Bottom"],s=r.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?o["inner"+r].call(this):this.each(function(){e(this).css(s,u(this,n)+"px")})},e.fn["outer"+r]=function(t,n){return typeof t!="number"?o["outer"+r].call(this,t):this.each(function(){e(this).css(s,u(this,t,!0,n)+"px")})}}),e.extend(e.expr[":"],{data:function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var r=e.attr(t,"tabindex"),i=isNaN(r);return(i||r>=0)&&n(t,!i)}}),e(function(){var t=document.body,n=t.appendChild(n=document.createElement("div"));e.extend(n.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),e.support.minHeight=n.offsetHeight===100,e.support.selectstart="onselectstart"in n,t.removeChild(n).style.display="none"}),e.extend(e.ui,{plugin:{add:function(t,n,r){var i=e.ui[t].prototype;for(var s in r)i.plugins[s]=i.plugins[s]||[],i.plugins[s].push([n,r[s]])},call:function(e,t,n){var r=e.plugins[t];if(!r||!e.element[0].parentNode)return;for(var i=0;i<r.length;i++)e.options[r[i][0]]&&r[i][1].apply(e.element,n)}},contains:function(e,t){return document.compareDocumentPosition?e.compareDocumentPosition(t)&16:e!==t&&e.contains(t)},hasScroll:function(t,n){if(e(t).css("overflow")==="hidden")return!1;var r=n&&n==="left"?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)},isOverAxis:function(e,t,n){return e>t&&e<t+n},isOver:function(t,n,r,i,s,o){return e.ui.isOverAxis(t,r,s)&&e.ui.isOverAxis(n,i,o)}})}(jQuery),function(e,t){if(e.cleanData){var n=e.cleanData;e.cleanData=function(t){for(var r=0,i;(i=t[r])!=null;r++)e(i).triggerHandler("remove");n(t)}}else{var r=e.fn.remove;e.fn.remove=function(t,n){return this.each(function(){return n||(!t||e.filter(t,[this]).length)&&e("*",this).add([this]).each(function(){e(this).triggerHandler("remove")}),r.call(e(this),t,n)})}}e.widget=function(t,n,r){var i=t.split(".")[0],s;t=t.split(".")[1],s=i+"-"+t,r||(r=n,n=e.Widget),e.expr[":"][s]=function(n){return!!e.data(n,t)},e[i]=e[i]||{},e[i][t]=function(e,t){arguments.length&&this._createWidget(e,t)};var o=new n;o.options=e.extend(!0,{},o.options),e[i][t].prototype=e.extend(!0,o,{namespace:i,widgetName:t,widgetEventPrefix:e[i][t].prototype.widgetEventPrefix||t,widgetBaseClass:s},r),e.widget.bridge(t,e[i][t])},e.widget.bridge=function(n,r){e.fn[n]=function(i){var s=typeof i=="string",o=Array.prototype.slice.call(arguments,1),u=this;return i=!s&&o.length?e.extend.apply(null,[!0,i].concat(o)):i,s&&i.charAt(0)==="_"?u:(s?this.each(function(){var r=e.data(this,n),s=r&&e.isFunction(r[i])?r[i].apply(r,o):r;if(s!==r&&s!==t)return u=s,!1}):this.each(function(){var t=e.data(this,n);t?t.option(i||{})._init():e.data(this,n,new r(i,this))}),u)}},e.Widget=function(e,t){arguments.length&&this._createWidget(e,t)},e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(t,n){e.data(n,this.widgetName,this),this.element=e(n),this.options=e.extend(!0,{},this.options,this._getCreateOptions(),t);var r=this;this.element.bind("remove."+this.widgetName,function(){r.destroy()}),this._create(),this._trigger("create"),this._init()},_getCreateOptions:function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled "+"ui-state-disabled")},widget:function(){return this.element},option:function(n,r){var i=n;if(arguments.length===0)return e.extend({},this.options);if(typeof n=="string"){if(r===t)return this.options[n];i={},i[n]=r}return this._setOptions(i),this},_setOptions:function(t){var n=this;return e.each(t,function(e,t){n._setOption(e,t)}),this},_setOption:function(e,t){return this.options[e]=t,e==="disabled"&&this.widget()[t?"addClass":"removeClass"](this.widgetBaseClass+"-disabled"+" "+"ui-state-disabled").attr("aria-disabled",t),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(t,n,r){var i=this.options[t];n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),r=r||{};if(n.originalEvent)for(var s=e.event.props.length,o;s;)o=e.event.props[--s],n[o]=n.originalEvent[o];return this.element.trigger(n,r),!(e.isFunction(i)&&i.call(this.element[0],n,r)===!1||n.isDefaultPrevented())}}}(jQuery),function(e,t){var n=!1;e(document).mousedown(function(e){n=!1}),e.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(t){if(n)return;this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var r=this,i=t.which==1,s=typeof this.options.cancel=="string"?e(t.target).closest(this.options.cancel).length:!1;if(!i||s||!this._mouseCapture(t))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)){this._mouseStarted=this._mouseStart(t)!==!1;if(!this._mouseStarted)return t.preventDefault(),!0}return!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return r._mouseMove(e)},this._mouseUpDelegate=function(e){return r._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),n=!0,!0},_mouseMove:function(t){return!e.browser.msie||document.documentMode>=9||!!t.button?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target==this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(e){return this.mouseDelayMet},_mouseStart:function(e){},_mouseDrag:function(e){},_mouseStop:function(e){},_mouseCapture:function(e){return!0}})}(jQuery),function(e,t){e.ui=e.ui||{};var n=/left|center|right/,r=/top|center|bottom/,i="center",s=e.fn.position,o=e.fn.offset;e.fn.position=function(t){if(!t||!t.of)return s.apply(this,arguments);t=e.extend({},t);var o=e(t.of),u=o[0],a=(t.collision||"flip").split(" "),f=t.offset?t.offset.split(" "):[0,0],l,c,h;return u.nodeType===9?(l=o.width(),c=o.height(),h={top:0,left:0}):u.setTimeout?(l=o.width(),c=o.height(),h={top:o.scrollTop(),left:o.scrollLeft()}):u.preventDefault?(t.at="left top",l=c=0,h={top:t.of.pageY,left:t.of.pageX}):(l=o.outerWidth(),c=o.outerHeight(),h=o.offset()),e.each(["my","at"],function(){var e=(t[this]||"").split(" ");e.length===1&&(e=n.test(e[0])?e.concat([i]):r.test(e[0])?[i].concat(e):[i,i]),e[0]=n.test(e[0])?e[0]:i,e[1]=r.test(e[1])?e[1]:i,t[this]=e}),a.length===1&&(a[1]=a[0]),f[0]=parseInt(f[0],10)||0,f.length===1&&(f[1]=f[0]),f[1]=parseInt(f[1],10)||0,t.at[0]==="right"?h.left+=l:t.at[0]===i&&(h.left+=l/2),t.at[1]==="bottom"?h.top+=c:t.at[1]===i&&(h.top+=c/2),h.left+=f[0],h.top+=f[1],this.each(function(){var n=e(this),r=n.outerWidth(),s=n.outerHeight(),o=parseInt(e.curCSS(this,"marginLeft",!0))||0,u=parseInt(e.curCSS(this,"marginTop",!0))||0,p=r+o+(parseInt(e.curCSS(this,"marginRight",!0))||0),d=s+u+(parseInt(e.curCSS(this,"marginBottom",!0))||0),v=e.extend({},h),m;t.my[0]==="right"?v.left-=r:t.my[0]===i&&(v.left-=r/2),t.my[1]==="bottom"?v.top-=s:t.my[1]===i&&(v.top-=s/2),v.left=Math.round(v.left),v.top=Math.round(v.top),m={left:v.left-o,top:v.top-u},e.each(["left","top"],function(n,i){e.ui.position[a[n]]&&e.ui.position[a[n]][i](v,{targetWidth:l,targetHeight:c,elemWidth:r,elemHeight:s,collisionPosition:m,collisionWidth:p,collisionHeight:d,offset:f,my:t.my,at:t.at})}),e.fn.bgiframe&&n.bgiframe(),n.offset(e.extend(v,{using:t.using}))})},e.ui.position={fit:{left:function(t,n){var r=e(window),i=n.collisionPosition.left+n.collisionWidth-r.width()-r.scrollLeft();t.left=i>0?t.left-i:Math.max(t.left-n.collisionPosition.left,t.left)},top:function(t,n){var r=e(window),i=n.collisionPosition.top+n.collisionHeight-r.height()-r.scrollTop();t.top=i>0?t.top-i:Math.max(t.top-n.collisionPosition.top,t.top)}},flip:{left:function(t,n){if(n.at[0]===i)return;var r=e(window),s=n.collisionPosition.left+n.collisionWidth-r.width()-r.scrollLeft(),o=n.my[0]==="left"?-n.elemWidth:n.my[0]==="right"?n.elemWidth:0,u=n.at[0]==="left"?n.targetWidth:-n.targetWidth,a=-2*n.offset[0];t.left+=n.collisionPosition.left<0?o+u+a:s>0?o+u+a:0},top:function(t,n){if(n.at[1]===i)return;var r=e(window),s=n.collisionPosition.top+n.collisionHeight-r.height()-r.scrollTop(),o=n.my[1]==="top"?-n.elemHeight:n.my[1]==="bottom"?n.elemHeight:0,u=n.at[1]==="top"?n.targetHeight:-n.targetHeight,a=-2*n.offset[1];t.top+=n.collisionPosition.top<0?o+u+a:s>0?o+u+a:0}}},e.offset.setOffset||(e.offset.setOffset=function(t,n){/static/.test(e.curCSS(t,"position"))&&(t.style.position="relative");var r=e(t),i=r.offset(),s=parseInt(e.curCSS(t,"top",!0),10)||0,o=parseInt(e.curCSS(t,"left",!0),10)||0,u={top:n.top-i.top+s,left:n.left-i.left+o};"using"in n?n.using.call(t,u):r.css(u)},e.fn.offset=function(t){var n=this[0];return!n||!n.ownerDocument?null:t?this.each(function(){e.offset.setOffset(this,t)}):o.call(this)})}(jQuery),function(e,t){e.widget("ui.draggable",e.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},destroy:function(){if(!this.element.data("draggable"))return;return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this},_mouseCapture:function(t){var n=this.options;return this.helper||n.disabled||e(t.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),n.containment&&this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.helper.addClass("ui-draggable-dragging"),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute");if(!n){var r=this._uiHash();if(this._trigger("drag",t,r)===!1)return this._mouseUp({}),!1;this.position=r.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";return e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=!1;e.ui.ddmanager&&!this.options.dropBehaviour&&(n=e.ui.ddmanager.drop(this,t)),this.dropped&&(n=this.dropped,this.dropped=!1);if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return!1;if(this.options.revert=="invalid"&&!n||this.options.revert=="valid"&&n||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)){var r=this;e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){r._trigger("stop",t)!==!1&&r._clear()})}else this._trigger("stop",t)!==!1&&this._clear();return!1},_mouseUp:function(t){return this.options.iframeFix===!0&&e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){var n=!this.options.handle||!e(this.options.handle,this.element).length?!0:!1;return e(this.options.handle,this.element).find("*").andSelf().each(function(){this==t.target&&(n=!0)}),n},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):n.helper=="clone"?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo(n.appendTo=="parent"?this.element[0].parentNode:n.appendTo),r[0]!=this.element[0]&&!/(fixed|absolute)/.test(r.css("position"))&&r.css("position","absolute"),r},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&e.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&e.browser.msie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;t.containment=="parent"&&(t.containment=this.helper[0].parentNode);if(t.containment=="document"||t.containment=="window")this.containment=[t.containment=="document"?0:e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t.containment=="document"?0:e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(t.containment=="document"?0:e(window).scrollLeft())+e(t.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(t.containment=="document"?0:e(window).scrollTop())+(e(t.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(t.containment)&&t.containment.constructor!=Array){var n=e(t.containment),r=n[0];if(!r)return;var i=n.offset(),s=e(r).css("overflow")!="hidden";this.containment=[(parseInt(e(r).css("borderLeftWidth"),10)||0)+(parseInt(e(r).css("paddingLeft"),10)||0),(parseInt(e(r).css("borderTopWidth"),10)||0)+(parseInt(e(r).css("paddingTop"),10)||0),(s?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(e(r).css("borderLeftWidth"),10)||0)-(parseInt(e(r).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(s?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(e(r).css("borderTopWidth"),10)||0)-(parseInt(e(r).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n}else t.containment.constructor==Array&&(this.containment=t.containment)},_convertPositionTo:function(t,n){n||(n=this.position);var r=t=="absolute"?1:-1,i=this.options,s=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!e.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(s[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-(e.browser.safari&&e.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():o?0:s.scrollTop())*r),left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-(e.browser.safari&&e.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():o?0:s.scrollLeft())*r)}},_generatePosition:function(t){var n=this.options,r=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!e.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(r[0].tagName),s=t.pageX,o=t.pageY;if(this.originalPosition){var u;if(this.containment){if(this.relative_container){var a=this.relative_container.offset();u=[this.containment[0]+a.left,this.containment[1]+a.top,this.containment[2]+a.left,this.containment[3]+a.top]}else u=this.containment;t.pageX-this.offset.click.left<u[0]&&(s=u[0]+this.offset.click.left),t.pageY-this.offset.click.top<u[1]&&(o=u[1]+this.offset.click.top),t.pageX-this.offset.click.left>u[2]&&(s=u[2]+this.offset.click.left),t.pageY-this.offset.click.top>u[3]&&(o=u[3]+this.offset.click.top)}if(n.grid){var f=n.grid[1]?this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1]:this.originalPageY;o=u?f-this.offset.click.top<u[1]||f-this.offset.click.top>u[3]?f-this.offset.click.top<u[1]?f+n.grid[1]:f-n.grid[1]:f:f;var l=n.grid[0]?this.originalPageX+Math.round((s-this.originalPageX)/n.grid[0])*n.grid[0]:this.originalPageX;s=u?l-this.offset.click.left<u[0]||l-this.offset.click.left>u[2]?l-this.offset.click.left<u[0]?l+n.grid[0]:l-n.grid[0]:l:l}}return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(e.browser.safari&&e.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():i?0:r.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(e.browser.safari&&e.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():i?0:r.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,r){return r=r||this._uiHash(),e.ui.plugin.call(this,t,[n,r]),t=="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,r)},plugins:{},_uiHash:function(e){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.extend(e.ui.draggable,{version:"1.8.14"}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var r=e(this).data("draggable"),i=r.options,s=e.extend({},n,{item:r.element});r.sortables=[],e(i.connectToSortable).each(function(){var n=e.data(this,"sortable");n&&!n.options.disabled&&(r.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,s))})},stop:function(t,n){var r=e(this).data("draggable"),i=e.extend({},n,{item:r.element});e.each(r.sortables,function(){this.instance.isOver?(this.instance.isOver=0,r.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,r.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,i))})},drag:function(t,n){var r=e(this).data("draggable"),i=this,s=function(t){var n=this.offset.click.top,r=this.offset.click.left,i=this.positionAbs.top,s=this.positionAbs.left,o=t.height,u=t.width,a=t.top,f=t.left;return e.ui.isOver(i+n,s+r,a,f,o,u)};e.each(r.sortables,function(s){this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(i).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=r.offset.click.top,this.instance.offset.click.left=r.offset.click.left,this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top,r._trigger("toSortable",t),r.dropped=this.instance.element,r.currentItem=r.element,this.instance.fromOutside=r),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),r._trigger("fromSortable",t),r.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,n){var r=e("body"),i=e(this).data("draggable").options;r.css("cursor")&&(i._cursor=r.css("cursor")),r.css("cursor",i.cursor)},stop:function(t,n){var r=e(this).data("draggable").options;r._cursor&&e("body").css("cursor",r._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var r=e(n.helper),i=e(this).data("draggable").options;r.css("opacity")&&(i._opacity=r.css("opacity")),r.css("opacity",i.opacity)},stop:function(t,n){var r=e(this).data("draggable").options;r._opacity&&e(n.helper).css("opacity",r._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(t,n){var r=e(this).data("draggable");r.scrollParent[0]!=document&&r.scrollParent[0].tagName!="HTML"&&(r.overflowOffset=r.scrollParent.offset())},drag:function(t,n){var r=e(this).data("draggable"),i=r.options,s=!1;if(r.scrollParent[0]!=document&&r.scrollParent[0].tagName!="HTML"){if(!i.axis||i.axis!="x")r.overflowOffset.top+r.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?r.scrollParent[0].scrollTop=s=r.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-r.overflowOffset.top<i.scrollSensitivity&&(r.scrollParent[0].scrollTop=s=r.scrollParent[0].scrollTop-i.scrollSpeed);if(!i.axis||i.axis!="y")r.overflowOffset.left+r.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?r.scrollParent[0].scrollLeft=s=r.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-r.overflowOffset.left<i.scrollSensitivity&&(r.scrollParent[0].scrollLeft=s=r.scrollParent[0].scrollLeft-i.scrollSpeed)}else{if(!i.axis||i.axis!="x")t.pageY-e(document).scrollTop()<i.scrollSensitivity?s=e(document).scrollTop(e(document).scrollTop()-i.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<i.scrollSensitivity&&(s=e(document).scrollTop(e(document).scrollTop()+i.scrollSpeed));if(!i.axis||i.axis!="y")t.pageX-e(document).scrollLeft()<i.scrollSensitivity?s=e(document).scrollLeft(e(document).scrollLeft()-i.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<i.scrollSensitivity&&(s=e(document).scrollLeft(e(document).scrollLeft()+i.scrollSpeed))}s!==!1&&e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(r,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,n){var r=e(this).data("draggable"),i=r.options;r.snapElements=[],e(i.snap.constructor!=String?i.snap.items||":data(draggable)":i.snap).each(function(){var t=e(this),n=t.offset();this!=r.element[0]&&r.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:n.top,left:n.left})})},drag:function(t,n){var r=e(this).data("draggable"),i=r.options,s=i.snapTolerance,o=n.offset.left,u=o+r.helperProportions.width,a=n.offset.top,f=a+r.helperProportions.height;for(var l=r.snapElements.length-1;l>=0;l--){var c=r.snapElements[l].left,h=c+r.snapElements[l].width,p=r.snapElements[l].top,d=p+r.snapElements[l].height;if(!(c-s<o&&o<h+s&&p-s<a&&a<d+s||c-s<o&&o<h+s&&p-s<f&&f<d+s||c-s<u&&u<h+s&&p-s<a&&a<d+s||c-s<u&&u<h+s&&p-s<f&&f<d+s)){r.snapElements[l].snapping&&r.options.snap.release&&r.options.snap.release.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[l].item})),r.snapElements[l].snapping=!1;continue}if(i.snapMode!="inner"){var v=Math.abs(p-f)<=s,m=Math.abs(d-a)<=s,g=Math.abs(c-u)<=s,y=Math.abs(h-o)<=s;v&&(n.position.top=r._convertPositionTo("relative",{top:p-r.helperProportions.height,left:0}).top-r.margins.top),m&&(n.position.top=r._convertPositionTo("relative",{top:d,left:0}).top-r.margins.top),g&&(n.position.left=r._convertPositionTo("relative",{top:0,left:c-r.helperProportions.width}).left-r.margins.left),y&&(n.position.left=r._convertPositionTo("relative",{top:0,left:h}).left-r.margins.left)}var b=v||m||g||y;if(i.snapMode!="outer"){var v=Math.abs(p-a)<=s,m=Math.abs(d-f)<=s,g=Math.abs(c-o)<=s,y=Math.abs(h-u)<=s;v&&(n.position.top=r._convertPositionTo("relative",{top:p,left:0}).top-r.margins.top),m&&(n.position.top=r._convertPositionTo("relative",{top:d-r.helperProportions.height,left:0}).top-r.margins.top),g&&(n.position.left=r._convertPositionTo("relative",{top:0,left:c}).left-r.margins.left),y&&(n.position.left=r._convertPositionTo("relative",{top:0,left:h-r.helperProportions.width}).left-r.margins.left)}!r.snapElements[l].snapping&&(v||m||g||y||b)&&r.options.snap.snap&&r.options.snap.snap.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[l].item})),r.snapElements[l].snapping=v||m||g||y||b}}}),e.ui.plugin.add("draggable","stack",{start:function(t,n){var r=e(this).data("draggable").options,i=e.makeArray(e(r.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});if(!i.length)return;var s=parseInt(i[0].style.zIndex)||0;e(i).each(function(e){this.style.zIndex=s+e}),this[0].style.zIndex=s+i.length}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var r=e(n.helper),i=e(this).data("draggable").options;r.css("zIndex")&&(i._zIndex=r.css("zIndex")),r.css("zIndex",i.zIndex)},stop:function(t,n){var r=e(this).data("draggable").options;r._zIndex&&e(n.helper).css("zIndex",r._zIndex)}})}(jQuery),function(e,t){e.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var t=this.options,n=t.accept;this.isover=0,this.isout=1,this.accept=e.isFunction(n)?n:function(e){return e.is(n)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},e.ui.ddmanager.droppables[t.scope]=e.ui.ddmanager.droppables[t.scope]||[],e.ui.ddmanager.droppables[t.scope].push(this),t.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];for(var n=0;n<t.length;n++)t[n]==this&&t.splice(n,1);return this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable"),this},_setOption:function(t,n){t=="accept"&&(this.accept=e.isFunction(n)?n:function(e){return e.is(n)}),e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),n&&this._trigger("activate",t,this.ui(n))},_deactivate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),n&&this._trigger("deactivate",t,this.ui(n))},_over:function(t){var n=e.ui.ddmanager.current;if(!n||(n.currentItem||n.element)[0]==this.element[0])return;this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(n)))},_out:function(t){var n=e.ui.ddmanager.current;if(!n||(n.currentItem||n.element)[0]==this.element[0])return;this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(n)))},_drop:function(t,n){var r=n||e.ui.ddmanager.current;if(!r||(r.currentItem||r.element)[0]==this.element[0])return!1;var i=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var t=e.data(this,"droppable");if(t.options.greedy&&!t.options.disabled&&t.options.scope==r.options.scope&&t.accept.call(t.element[0],r.currentItem||r.element)&&e.ui.intersect(r,e.extend(t,{offset:t.element.offset()}),t.options.tolerance))return i=!0,!1}),i?!1:this.accept.call(this.element[0],r.currentItem||r.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(r)),this.element):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.extend(e.ui.droppable,{version:"1.8.14"}),e.ui.intersect=function(t,n,r){if(!n.offset)return!1;var i=(t.positionAbs||t.position.absolute).left,s=i+t.helperProportions.width,o=(t.positionAbs||t.position.absolute).top,u=o+t.helperProportions.height,a=n.offset.left,f=a+n.proportions.width,l=n.offset.top,c=l+n.proportions.height;switch(r){case"fit":return a<=i&&s<=f&&l<=o&&u<=c;case"intersect":return a<i+t.helperProportions.width/2&&s-t.helperProportions.width/2<f&&l<o+t.helperProportions.height/2&&u-t.helperProportions.height/2<c;case"pointer":var h=(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,p=(t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,d=e.ui.isOver(p,h,l,a,n.proportions.height,n.proportions.width);return d;case"touch":return(o>=l&&o<=c||u>=l&&u<=c||o<l&&u>c)&&(i>=a&&i<=f||s>=a&&s<=f||i<a&&s>f);default:return!1}},e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,n){var r=e.ui.ddmanager.droppables[t.options.scope]||[],i=n?n.type:null,s=(t.currentItem||t.element).find(":data(droppable)").andSelf();e:for(var o=0;o<r.length;o++){if(r[o].options.disabled||t&&!r[o].accept.call(r[o].element[0],t.currentItem||t.element))continue;for(var u=0;u<s.length;u++)if(s[u]==r[o].element[0]){r[o].proportions.height=0;continue e}r[o].visible=r[o].element.css("display")!="none";if(!r[o].visible)continue;i=="mousedown"&&r[o]._activate.call(r[o],n),r[o].offset=r[o].element.offset(),r[o].proportions={width:r[o].element[0].offsetWidth,height:r[o].element[0].offsetHeight}}},drop:function(t,n){var r=!1;return e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options)return;!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(r=r||this._drop.call(this,n)),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,n))}),r},dragStart:function(t,n){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)})},drag:function(t,n){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,n),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible)return;var r=e.ui.intersect(t,this,this.options.tolerance),i=!r&&this.isover==1?"isout":r&&this.isover==0?"isover":null;if(!i)return;var s;if(this.options.greedy){var o=this.element.parents(":data(droppable):eq(0)");o.length&&(s=e.data(o[0],"droppable"),s.greedyChild=i=="isover"?1:0)}s&&i=="isover"&&(s.isover=0,s.isout=1,s._out.call(s,n)),this[i]=1,this[i=="isout"?"isover":"isout"]=0,this[i=="isover"?"_over":"_out"].call(this,n),s&&i=="isout"&&(s.isout=0,s.isover=1,s._over.call(s,n))})},dragStop:function(t,n){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)}}}(jQuery),function(e,t){e.widget("ui.resizable",e.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1e3},_create:function(){var t=this,n=this.options;this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!n.aspectRatio,aspectRatio:n.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:n.helper||n.ghost||n.animate?n.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(/relative/.test(this.element.css("position"))&&e.browser.opera&&this.element.css({position:"relative",top:"auto",left:"auto"}),this.element.wrap(e('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=n.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor==String){this.handles=="all"&&(this.handles="n,e,s,w,se,sw,ne,nw");var r=this.handles.split(",");this.handles={};for(var i=0;i<r.length;i++){var s=e.trim(r[i]),o="ui-resizable-"+s,u=e('<div class="ui-resizable-handle '+o+'"></div>');/sw|se|ne|nw/.test(s)&&u.css({zIndex:++n.zIndex}),"se"==s&&u.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[s]=".ui-resizable-"+s,this.element.append(u)}}this._renderAxis=function(t){t=t||this.element;for(var n in this.handles){this.handles[n].constructor==String&&(this.handles[n]=e(this.handles[n],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var r=e(this.handles[n],this.element),i=0;i=/sw|ne|nw|se|n|s/.test(n)?r.outerHeight():r.outerWidth();var s=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join("");t.css(s,i),this._proportionallyResize()}if(!e(this.handles[n]).length)continue}},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){if(!t.resizing){if(this.className)var e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);t.axis=e&&e[1]?e[1]:"se"}}),n.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").hover(function(){if(n.disabled)return;e(this).removeClass("ui-resizable-autohide"),t._handles.show()},function(){if(n.disabled)return;t.resizing||(e(this).addClass("ui-resizable-autohide"),t._handles.hide())})),this._mouseInit()},destroy:function(){this._mouseDestroy();var t=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){t(this.element);var n=this.element;n.after(this.originalElement.css({position:n.css("position"),width:n.outerWidth(),height:n.outerHeight(),top:n.css("top"),left:n.css("left")})).remove()}return this.originalElement.css("resize",this.originalResizeStyle),t(this.originalElement),this},_mouseCapture:function(t){var n=!1;for(var r in this.handles)e(this.handles[r])[0]==t.target&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(t){var r=this.options,i=this.element.position(),s=this.element;this.resizing=!0,this.documentScroll={top:e(document).scrollTop(),left:e(document).scrollLeft()},(s.is(".ui-draggable")||/absolute/.test(s.css("position")))&&s.css({position:"absolute",top:i.top,left:i.left}),e.browser.opera&&/relative/.test(s.css("position"))&&s.css({position:"relative",top:"auto",left:"auto"}),this._renderProxy();var o=n(this.helper.css("left")),u=n(this.helper.css("top"));r.containment&&(o+=e(r.containment).scrollLeft()||0,u+=e(r.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:o,top:u},this.size=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.originalSize=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.originalPosition={left:o,top:u},this.sizeDiff={width:s.outerWidth()-s.width(),height:s.outerHeight()-s.height()},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio=typeof r.aspectRatio=="number"?r.aspectRatio:this.originalSize.width/this.originalSize.height||1;var a=e(".ui-resizable-"+this.axis).css("cursor");return e("body").css("cursor",a=="auto"?this.axis+"-resize":a),s.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var n=this.helper,r=this.options,i={},s=this,o=this.originalMousePosition,u=this.axis,a=t.pageX-o.left||0,f=t.pageY-o.top||0,l=this._change[u];if(!l)return!1;var c=l.apply(this,[t,a,f]),h=e.browser.msie&&e.browser.version<7,p=this.sizeDiff;this._updateVirtualBoundaries(t.shiftKey);if(this._aspectRatio||t.shiftKey)c=this._updateRatio(c,t);return c=this._respectSize(c,t),this._propagate("resize",t),n.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(c),this._trigger("resize",t,this.ui()),!1},_mouseStop:function(t){this.resizing=!1;var n=this.options,r=this;if(this._helper){var i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),o=s&&e.ui.hasScroll(i[0],"left")?0:r.sizeDiff.height,u=s?0:r.sizeDiff.width,a={width:r.helper.width()-u,height:r.helper.height()-o},f=parseInt(r.element.css("left"),10)+(r.position.left-r.originalPosition.left)||null,l=parseInt(r.element.css("top"),10)+(r.position.top-r.originalPosition.top)||null;n.animate||this.element.css(e.extend(a,{top:l,left:f})),r.helper.height(r.size.height),r.helper.width(r.size.width),this._helper&&!n.animate&&this._proportionallyResize()}return e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t=this.options,n,i,s,o,u;u={minWidth:r(t.minWidth)?t.minWidth:0,maxWidth:r(t.maxWidth)?t.maxWidth:Infinity,minHeight:r(t.minHeight)?t.minHeight:0,maxHeight:r(t.maxHeight)?t.maxHeight:Infinity};if(this._aspectRatio||e)n=u.minHeight*this.aspectRatio,s=u.minWidth/this.aspectRatio,i=u.maxHeight*this.aspectRatio,o=u.maxWidth/this.aspectRatio,n>u.minWidth&&(u.minWidth=n),s>u.minHeight&&(u.minHeight=s),i<u.maxWidth&&(u.maxWidth=i),o<u.maxHeight&&(u.maxHeight=o);this._vBoundaries=u},_updateCache:function(e){var t=this.options;this.offset=this.helper.offset(),r(e.left)&&(this.position.left=e.left),r(e.top)&&(this.position.top=e.top),r(e.height)&&(this.size.height=e.height),r(e.width)&&(this.size.width=e.width)},_updateRatio:function(e,t){var n=this.options,i=this.position,s=this.size,o=this.axis;return r(e.height)?e.width=e.height*this.aspectRatio:r(e.width)&&(e.height=e.width/this.aspectRatio),o=="sw"&&(e.left=i.left+(s.width-e.width),e.top=null),o=="nw"&&(e.top=i.top+(s.height-e.height),e.left=i.left+(s.width-e.width)),e},_respectSize:function(e,t){var n=this.helper,i=this._vBoundaries,s=this._aspectRatio||t.shiftKey,o=this.axis,u=r(e.width)&&i.maxWidth&&i.maxWidth<e.width,a=r(e.height)&&i.maxHeight&&i.maxHeight<e.height,f=r(e.width)&&i.minWidth&&i.minWidth>e.width,l=r(e.height)&&i.minHeight&&i.minHeight>e.height;f&&(e.width=i.minWidth),l&&(e.height=i.minHeight),u&&(e.width=i.maxWidth),a&&(e.height=i.maxHeight);var c=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,p=/sw|nw|w/.test(o),d=/nw|ne|n/.test(o);f&&p&&(e.left=c-i.minWidth),u&&p&&(e.left=c-i.maxWidth),l&&d&&(e.top=h-i.minHeight),a&&d&&(e.top=h-i.maxHeight);var v=!e.width&&!e.height;return v&&!e.left&&e.top?e.top=null:v&&!e.top&&e.left&&(e.left=null),e},_proportionallyResize:function(){var t=this.options;if(!this._proportionallyResizeElements.length)return;var n=this.helper||this.element;for(var r=0;r<this._proportionallyResizeElements.length;r++){var i=this._proportionallyResizeElements[r];if(!this.borderDif){var s=[i.css("borderTopWidth"),i.css("borderRightWidth"),i.css("borderBottomWidth"),i.css("borderLeftWidth")],o=[i.css("paddingTop"),i.css("paddingRight"),i.css("paddingBottom"),i.css("paddingLeft")];this.borderDif=e.map(s,function(e,t){var n=parseInt(e,10)||0,r=parseInt(o[t],10)||0;return n+r})}if(!(!e.browser.msie||!e(n).is(":hidden")&&!e(n).parents(":hidden").length))continue;i.css({height:n.height()-this.borderDif[0]-this.borderDif[2]||0,width:n.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var t=this.element,n=this.options;this.elementOffset=t.offset();if(this._helper){this.helper=this.helper||e('<div style="overflow:hidden;"></div>');var r=e.browser.msie&&e.browser.version<7,i=r?1:0,s=r?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+s,height:this.element.outerHeight()+s,position:"absolute",left:this.elementOffset.left-i+"px",top:this.elementOffset.top-i+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(e,t,n){return{width:this.originalSize.width+t}},w:function(e,t,n){var r=this.options,i=this.originalSize,s=this.originalPosition;return{left:s.left+t,width:i.width-t}},n:function(e,t,n){var r=this.options,i=this.originalSize,s=this.originalPosition;return{top:s.top+n,height:i.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},sw:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,r]))},ne:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},nw:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,r]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),t!="resize"&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.extend(e.ui.resizable,{version:"1.8.14"}),e.ui.plugin.add("resizable","alsoResize",{start:function(t,n){var r=e(this).data("resizable"),i=r.options,s=function(t){e(t).each(function(){var t=e(this);t.data("resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10),position:t.css("position")})})};typeof i.alsoResize=="object"&&!i.alsoResize.parentNode?i.alsoResize.length?(i.alsoResize=i.alsoResize[0],s(i.alsoResize)):e.each(i.alsoResize,function(e){s(e)}):s(i.alsoResize)},resize:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.originalSize,o=r.originalPosition,u={height:r.size.height-s.height||0,width:r.size.width-s.width||0,top:r.position.top-o.top||0,left:r.position.left-o.left||0},a=function(t,i){e(t).each(function(){var t=e(this),s=e(this).data("resizable-alsoresize"),o={},a=i&&i.length?i:t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(a,function(e,t){var n=(s[t]||0)+(u[t]||0);n&&n>=0&&(o[t]=n||null)}),e.browser.opera&&/relative/.test(t.css("position"))&&(r._revertToRelativePosition=!0,t.css({position:"absolute",top:"auto",left:"auto"})),t.css(o)})};typeof i.alsoResize=="object"&&!i.alsoResize.nodeType?e.each(i.alsoResize,function(e,t){a(e,t)}):a(i.alsoResize)},stop:function(t,n){var r=e(this).data("resizable"),i=r.options,s=function(t){e(t).each(function(){var t=e(this);t.css({position:t.data("resizable-alsoresize").position})})};r._revertToRelativePosition&&(r._revertToRelativePosition=!1,typeof i.alsoResize=="object"&&!i.alsoResize.nodeType?e.each(i.alsoResize,function(e){s(e)}):s(i.alsoResize)),e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","animate",{stop:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r._proportionallyResizeElements,o=s.length&&/textarea/i.test(s[0].nodeName),u=o&&e.ui.hasScroll(s[0],"left")?0:r.sizeDiff.height,a=o?0:r.sizeDiff.width,f={width:r.size.width-a,height:r.size.height-u},l=parseInt(r.element.css("left"),10)+(r.position.left-r.originalPosition.left)||null,c=parseInt(r.element.css("top"),10)+(r.position.top-r.originalPosition.top)||null;r.element.animate(e.extend(f,c&&l?{top:c,left:l}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var n={width:parseInt(r.element.css("width"),10),height:parseInt(r.element.css("height"),10),top:parseInt(r.element.css("top"),10),left:parseInt(r.element.css("left"),10)};s&&s.length&&e(s[0]).css({width:n.width,height:n.height}),r._updateCache(n),r._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(t,r){var i=e(this).data("resizable"),s=i.options,o=i.element,u=s.containment,a=u instanceof e?u.get(0):/parent/.test(u)?o.parent().get(0):u;if(!a)return;i.containerElement=e(a);if(/document/.test(u)||u==document)i.containerOffset={left:0,top:0},i.containerPosition={left:0,top:0},i.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight};else{var f=e(a),l=[];e(["Top","Right","Left","Bottom"]).each(function(e,t){l[e]=n(f.css("padding"+t))}),i.containerOffset=f.offset(),i.containerPosition=f.position(),i.containerSize={height:f.innerHeight()-l[3],width:f.innerWidth()-l[1]};var c=i.containerOffset,h=i.containerSize.height,p=i.containerSize.width,d=e.ui.hasScroll(a,"left")?a.scrollWidth:p,v=e.ui.hasScroll(a)?a.scrollHeight:h;i.parentData={element:a,left:c.left,top:c.top,width:d,height:v}}},resize:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.containerSize,o=r.containerOffset,u=r.size,a=r.position,f=r._aspectRatio||t.shiftKey,l={top:0,left:0},c=r.containerElement;c[0]!=document&&/static/.test(c.css("position"))&&(l=o),a.left<(r._helper?o.left:0)&&(r.size.width=r.size.width+(r._helper?r.position.left-o.left:r.position.left-l.left),f&&(r.size.height=r.size.width/i.aspectRatio),r.position.left=i.helper?o.left:0),a.top<(r._helper?o.top:0)&&(r.size.height=r.size.height+(r._helper?r.position.top-o.top:r.position.top),f&&(r.size.width=r.size.height*i.aspectRatio),r.position.top=r._helper?o.top:0),r.offset.left=r.parentData.left+r.position.left,r.offset.top=r.parentData.top+r.position.top;var h=Math.abs((r._helper?r.offset.left-l.left:r.offset.left-l.left)+r.sizeDiff.width),p=Math.abs((r._helper?r.offset.top-l.top:r.offset.top-o.top)+r.sizeDiff.height),d=r.containerElement.get(0)==r.element.parent().get(0),v=/relative|absolute/.test(r.containerElement.css("position"));d&&v&&(h-=r.parentData.left),h+r.size.width>=r.parentData.width&&(r.size.width=r.parentData.width-h,f&&(r.size.height=r.size.width/r.aspectRatio)),p+r.size.height>=r.parentData.height&&(r.size.height=r.parentData.height-p,f&&(r.size.width=r.size.height*r.aspectRatio))},stop:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.position,o=r.containerOffset,u=r.containerPosition,a=r.containerElement,f=e(r.helper),l=f.offset(),c=f.outerWidth()-r.sizeDiff.width,h=f.outerHeight()-r.sizeDiff.height;r._helper&&!i.animate&&/relative/.test(a.css("position"))&&e(this).css({left:l.left-u.left-o.left,width:c,height:h}),r._helper&&!i.animate&&/static/.test(a.css("position"))&&e(this).css({left:l.left-u.left-o.left,width:c,height:h})}}),e.ui.plugin.add("resizable","ghost",{start:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.size;r.ghost=r.originalElement.clone(),r.ghost.css({opacity:.25,display:"block",position:"relative",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof i.ghost=="string"?i.ghost:""),r.ghost.appendTo(r.helper)},resize:function(t,n){var r=e(this).data("resizable"),i=r.options;r.ghost&&r.ghost.css({position:"relative",height:r.size.height,width:r.size.width})},stop:function(t,n){var r=e(this).data("resizable"),i=r.options;r.ghost&&r.helper&&r.helper.get(0).removeChild(r.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.size,o=r.originalSize,u=r.originalPosition,a=r.axis,f=i._aspectRatio||t.shiftKey;i.grid=typeof i.grid=="number"?[i.grid,i.grid]:i.grid;var l=Math.round((s.width-o.width)/(i.grid[0]||1))*(i.grid[0]||1),c=Math.round((s.height-o.height)/(i.grid[1]||1))*(i.grid[1]||1);/^(se|s|e)$/.test(a)?(r.size.width=o.width+l,r.size.height=o.height+c):/^(ne)$/.test(a)?(r.size.width=o.width+l,r.size.height=o.height+c,r.position.top=u.top-c):/^(sw)$/.test(a)?(r.size.width=o.width+l,r.size.height=o.height+c,r.position.left=u.left-l):(r.size.width=o.width+l,r.size.height=o.height+c,r.position.top=u.top-c,r.position.left=u.left-l)}});var n=function(e){return parseInt(e,10)||0},r=function(e){return!isNaN(parseInt(e,10))}}(jQuery),function(e,t){e.widget("ui.selectable",e.ui.mouse,{options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var t=this;this.element.addClass("ui-selectable"),this.dragged=!1;var n;this.refresh=function(){n=e(t.options.filter,t.element[0]),n.each(function(){var t=e(this),n=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:n.left,top:n.top,right:n.left+t.outerWidth(),bottom:n.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=n.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},destroy:function(){return this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable"),this._mouseDestroy(),this},_mouseStart:function(t){var n=this;this.opos=[t.pageX,t.pageY];if(this.options.disabled)return;var r=this.options;this.selectees=e(r.filter,this.element[0]),this._trigger("start",t),e(r.appendTo).append(this.helper),this.helper.css({left:t.clientX,top:t.clientY,width:0,height:0}),r.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var r=e.data(this,"selectable-item");r.startselected=!0,t.ctrlKey||(r.$element.removeClass("ui-selected"),r.selected=!1,r.$element.addClass("ui-unselecting"),r.unselecting=!0,n._trigger("unselecting",t,{unselecting:r.element}))}),e(t.target).parents().andSelf().each(function(){var r=e.data(this,"selectable-item");if(r){var i=!t.ctrlKey||!r.$element.hasClass("ui-selected");return r.$element.removeClass(i?"ui-unselecting":"ui-selected").addClass(i?"ui-selecting":"ui-unselecting"),r.unselecting=!i,r.selecting=i,r.selected=i,i?n._trigger("selecting",t,{selecting:r.element}):n._trigger("unselecting",t,{unselecting:r.element}),!1}})},_mouseDrag:function(t){var n=this;this.dragged=!0;if(this.options.disabled)return;var r=this.options,i=this.opos[0],s=this.opos[1],o=t.pageX,u=t.pageY;if(i>o){var a=o;o=i,i=a}if(s>u){var a=u;u=s,s=a}return this.helper.css({left:i,top:s,width:o-i,height:u-s}),this.selectees.each(function(){var a=e.data(this,"selectable-item");if(!a||a.element==n.element[0])return;var f=!1;r.tolerance=="touch"?f=!(a.left>o||a.right<i||a.top>u||a.bottom<s):r.tolerance=="fit"&&(f=a.left>i&&a.right<o&&a.top>s&&a.bottom<u),f?(a.selected&&(a.$element.removeClass("ui-selected"),a.selected=!1),a.unselecting&&(a.$element.removeClass("ui-unselecting"),a.unselecting=!1),a.selecting||(a.$element.addClass("ui-selecting"),a.selecting=!0,n._trigger("selecting",t,{selecting:a.element}))):(a.selecting&&(t.metaKey&&a.startselected?(a.$element.removeClass("ui-selecting"),a.selecting=!1,a.$element.addClass("ui-selected"),a.selected=!0):(a.$element.removeClass("ui-selecting"),a.selecting=!1,a.startselected&&(a.$element.addClass("ui-unselecting"),a.unselecting=!0),n._trigger("unselecting",t,{unselecting:a.element}))),a.selected&&!t.metaKey&&!a.startselected&&(a.$element.removeClass("ui-selected"),a.selected=!1,a.$element.addClass("ui-unselecting"),a.unselecting=!0,n._trigger("unselecting",t,{unselecting:a.element})))}),!1},_mouseStop:function(t){var n=this;this.dragged=!1;var r=this.options;return e(".ui-unselecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-unselecting"),r.unselecting=!1,r.startselected=!1,n._trigger("unselected",t,{unselected:r.element})}),e(".ui-selecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-selecting").addClass("ui-selected"),r.selecting=!1,r.selected=!0,r.startselected=!0,n._trigger("selected",t,{selected:r.element})}),this._trigger("stop",t),this.helper.remove(),!1}}),e.extend(e.ui.selectable,{version:"1.8.14"})}(jQuery),function(e,t){e.widget("ui.sortable",e.ui.mouse,{widgetEventPrefix:"sort",options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?e.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData("sortable-item");return this},_setOption:function(t,n){t==="disabled"?(this.options[t]=n,this.widget()[n?"addClass":"removeClass"]("ui-sortable-disabled")):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,n){if(this.reverting)return!1;if(this.options.disabled||this.options.type=="static")return!1;this._refreshItems(t);var r=null,i=this,s=e(t.target).parents().each(function(){if(e.data(this,"sortable-item")==i)return r=e(this),!1});e.data(t.target,"sortable-item")==i&&(r=e(t.target));if(!r)return!1;if(this.options.handle&&!n){var o=!1;e(this.options.handle,r).find("*").andSelf().each(function(){this==t.target&&(o=!0)});if(!o)return!1}return this.currentItem=r,this._removeCurrentsFromItems(),!0},_mouseStart:function(t,n,r){var i=this.options,s=this;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),i.containment&&this._setContainment(),i.cursor&&(e("body").css("cursor")&&(this._storedCursor=e("body").css("cursor")),e("body").css("cursor",i.cursor)),i.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",i.opacity)),i.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",i.zIndex)),this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!r)for(var o=this.containers.length-1;o>=0;o--)this.containers[o]._trigger("activate",t,s._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var n=this.options,r=!1;this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<n.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+n.scrollSpeed:t.pageY-this.overflowOffset.top<n.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-n.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<n.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+n.scrollSpeed:t.pageX-this.overflowOffset.left<n.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-n.scrollSpeed)):(t.pageY-e(document).scrollTop()<n.scrollSensitivity?r=e(document).scrollTop(e(document).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<n.scrollSensitivity&&(r=e(document).scrollTop(e(document).scrollTop()+n.scrollSpeed)),t.pageX-e(document).scrollLeft()<n.scrollSensitivity?r=e(document).scrollLeft(e(document).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<n.scrollSensitivity&&(r=e(document).scrollLeft(e(document).scrollLeft()+n.scrollSpeed))),r!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";for(var i=this.items.length-1;i>=0;i--){var s=this.items[i],o=s.item[0],u=this._intersectsWithPointer(s);if(!u)continue;if(o!=this.currentItem[0]&&this.placeholder[u==1?"next":"prev"]()[0]!=o&&!e.ui.contains(this.placeholder[0],o)&&(this.options.type=="semi-dynamic"?!e.ui.contains(this.element[0],o):!0)){this.direction=u==1?"down":"up";if(this.options.tolerance!="pointer"&&!this._intersectsWithSides(s))break;this._rearrange(t,s),this._trigger("change",t,this._uiHash());break}}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(!t)return;e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t);if(this.options.revert){var r=this,i=r.placeholder.offset();r.reverting=!0,e(this.helper).animate({left:i.left-this.offset.parent.left-r.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:i.top-this.offset.parent.top-r.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){r._clear(t)})}else this._clear(t,n);return!1},cancel:function(){var t=this;if(this.dragging){this._mouseUp({target:null}),this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("deactivate",null,t._uiHash(this)),this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",null,t._uiHash(this)),this.containers[n].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[-=_](.+)/);n&&r.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!r.length&&t.key&&r.push(t.key+"="),r.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},n.each(function(){r.push(e(t.item||this).attr(t.attribute||"id")||"")}),r},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,r=this.positionAbs.top,i=r+this.helperProportions.height,s=e.left,o=s+e.width,u=e.top,a=u+e.height,f=this.offset.click.top,l=this.offset.click.left,c=r+f>u&&r+f<a&&t+l>s&&t+l<o;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?c:s<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<o&&u<r+this.helperProportions.height/2&&i-this.helperProportions.height/2<a},_intersectsWithPointer:function(t){var n=e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),r=e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),i=n&&r,s=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return i?this.floating?o&&o=="right"||s=="down"?2:1:s&&(s=="down"?2:1):!1},_intersectsWithSides:function(t){var n=e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),r=e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),i=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return this.floating&&s?s=="right"&&r||s=="left"&&!r:i&&(i=="down"&&n||i=="up"&&!n)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return e!=0&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return e!=0&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor==String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var n=this,r=[],i=[],s=this._connectWith();if(s&&t)for(var o=s.length-1;o>=0;o--){var u=e(s[o]);for(var a=u.length-1;a>=0;a--){var f=e.data(u[a],"sortable");f&&f!=this&&!f.options.disabled&&i.push([e.isFunction(f.options.items)?f.options.items.call(f.element):e(f.options.items,f.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),f])}}i.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var o=i.length-1;o>=0;o--)i[o][0].each(function(){r.push(this)});return e(r)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data(sortable-item)");for(var t=0;t<this.items.length;t++)for(var n=0;n<e.length;n++)e[n]==this.items[t].item[0]&&this.items.splice(t,1)},_refreshItems:function(t){this.items=[],this.containers=[this];var n=this.items,r=this,i=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],s=this._connectWith();if(s)for(var o=s.length-1;o>=0;o--){var u=e(s[o]);for(var a=u.length-1;a>=0;a--){var f=e.data(u[a],"sortable");f&&f!=this&&!f.options.disabled&&(i.push([e.isFunction(f.options.items)?f.options.items.call(f.element[0],t,{item:this.currentItem}):e(f.options.items,f.element),f]),this.containers.push(f))}}for(var o=i.length-1;o>=0;o--){var l=i[o][1],c=i[o][0];for(var a=0,h=c.length;a<h;a++){var p=e(c[a]);p.data("sortable-item",l),n.push({item:p,instance:l,width:0,height:0,left:0,top:0})}}},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var n=this.items.length-1;n>=0;n--){var r=this.items[n];if(r.instance!=this.currentContainer&&this.currentContainer&&r.item[0]!=this.currentItem[0])continue;var i=this.options.toleranceElement?e(this.options.toleranceElement,r.item):r.item;t||(r.width=i.outerWidth(),r.height=i.outerHeight());var s=i.offset();r.left=s.left,r.top=s.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(var n=this.containers.length-1;n>=0;n--){var s=this.containers[n].element.offset();this.containers[n].containerCache.left=s.left,this.containers[n].containerCache.top=s.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight()}return this},_createPlaceholder:function(t){var n=t||this,r=n.options;if(!r.placeholder||r.placeholder.constructor==String){var i=r.placeholder;r.placeholder={element:function(){var t=e(document.createElement(n.currentItem[0].nodeName)).addClass(i||n.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return i||(t.style.visibility="hidden"),t},update:function(e,t){if(i&&!r.forcePlaceholderSize)return;t.height()||t.height(n.currentItem.innerHeight()-parseInt(n.currentItem.css("paddingTop")||0,10)-parseInt(n.currentItem.css("paddingBottom")||0,10)),t.width()||t.width(n.currentItem.innerWidth()-parseInt(n.currentItem.css("paddingLeft")||0,10)-parseInt(n.currentItem.css("paddingRight")||0,10))}}}n.placeholder=e(r.placeholder.element.call(n.element,n.currentItem)),n.currentItem.after(n.placeholder),r.placeholder.update(n,n.placeholder)},_contactContainers:function(t){var n=null,r=null;for(var i=this.containers.length-1;i>=0;i--){if(e.ui.contains(this.currentItem[0],this.containers[i].element[0]))continue;if(this._intersectsWith(this.containers[i].containerCache)){if(n&&e.ui.contains(this.containers[i].element[0],n.element[0]))continue;n=this.containers[i],r=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0)}if(!n)return;if(this.containers.length===1)this.containers[r]._trigger("over",t,this._uiHash(this)),this.containers[r].containerCache.over=1;else if(this.currentContainer!=this.containers[r]){var s=1e4,o=null,u=this.positionAbs[this.containers[r].floating?"left":"top"];for(var a=this.items.length-1;a>=0;a--){if(!e.ui.contains(this.containers[r].element[0],this.items[a].item[0]))continue;var f=this.items[a][this.containers[r].floating?"left":"top"];Math.abs(f-u)<s&&(s=Math.abs(f-u),o=this.items[a])}if(!o&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[r],o?this._rearrange(t,o,null,!0):this._rearrange(t,null,this.containers[r].element,!0),this._trigger("change",t,this._uiHash()),this.containers[r]._trigger("change",t,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[r]._trigger("over",t,this._uiHash(this)),this.containers[r].containerCache.over=1}},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):n.helper=="clone"?this.currentItem.clone():this.currentItem;return r.parents("body").length||e(n.appendTo!="parent"?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(r[0]),r[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(r[0].style.width==""||n.forceHelperSize)&&r.width(this.currentItem.width()),(r[0].style.height==""||n.forceHelperSize)&&r.height(this.currentItem.height()),r},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&e.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&e.browser.msie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;t.containment=="parent"&&(t.containment=this.helper[0].parentNode);if(t.containment=="document"||t.containment=="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e(t.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(e(t.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(t.containment)){var n=e(t.containment)[0],r=e(t.containment).offset(),i=e(n).css("overflow")!="hidden";this.containment=[r.left+(parseInt(e(n).css("borderLeftWidth"),10)||0)+(parseInt(e(n).css("paddingLeft"),10)||0)-this.margins.left,r.top+(parseInt(e(n).css("borderTopWidth"),10)||0)+(parseInt(e(n).css("paddingTop"),10)||0)-this.margins.top,r.left+(i?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(e(n).css("borderLeftWidth"),10)||0)-(parseInt(e(n).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,r.top+(i?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(e(n).css("borderTopWidth"),10)||0)-(parseInt(e(n).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(t,n){n||(n=this.position);var r=t=="absolute"?1:-1,i=this.options,s=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!e.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(s[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-(e.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():o?0:s.scrollTop())*r),left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-(e.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():o?0:s.scrollLeft())*r)}},_generatePosition:function(t){var n=this.options,r=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!e.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(r[0].tagName);this.cssPosition=="relative"&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var s=t.pageX,o=t.pageY;if(this.originalPosition){this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top));if(n.grid){var u=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1];o=this.containment?u-this.offset.click.top<this.containment[1]||u-this.offset.click.top>this.containment[3]?u-this.offset.click.top<this.containment[1]?u+n.grid[1]:u-n.grid[1]:u:u;var a=this.originalPageX+Math.round((s-this.originalPageX)/n.grid[0])*n.grid[0];s=this.containment?a-this.offset.click.left<this.containment[0]||a-this.offset.click.left>this.containment[2]?a-this.offset.click.left<this.containment[0]?a+n.grid[0]:a-n.grid[0]:a:a}}return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(e.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():i?0:r.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(e.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():i?0:r.scrollLeft())}},_rearrange:function(e,t,n,r){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var i=this,s=this.counter;window.setTimeout(function(){s==i.counter&&i.refreshPositions(!r)},0)},_clear:function(t,n){this.reverting=!1;var r=[],i=this;!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var s in this._storedCSS)if(this._storedCSS[s]=="auto"||this._storedCSS[s]=="static")this._storedCSS[s]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!n&&r.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!n&&r.push(function(e){this._trigger("update",e,this._uiHash())});if(!e.ui.contains(this.element[0],this.currentItem[0])){n||r.push(function(e){this._trigger("remove",e,this._uiHash())});for(var s=this.containers.length-1;s>=0;s--)e.ui.contains(this.containers[s].element[0],this.currentItem[0])&&!n&&(r.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.containers[s])),r.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.containers[s])))}for(var s=this.containers.length-1;s>=0;s--)n||r.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[s])),this.containers[s].containerCache.over&&(r.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[s])),this.containers[s].containerCache.over=0);this._storedCursor&&e("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!n){this._trigger("beforeStop",t,this._uiHash());for(var s=0;s<r.length;s++)r[s].call(this,t);this._trigger("stop",t,this._uiHash())}return!1}n||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!n){for(var s=0;s<r.length;s++)r[s].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}}),e.extend(e.ui.sortable,{version:"1.8.14"})}(jQuery),function(e,t){e.widget("ui.accordion",{options:{active:0,animated:"slide",autoHeight:!0,clearStyle:!1,collapsible:!1,event:"click",fillSpace:!1,header:"> li > :first-child,> :not(li):even",icons:{header:"ui-icon-triangle-1-e",headerSelected:"ui-icon-triangle-1-s"},navigation:!1,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}},_create:function(){var t=this,n=t.options;t.running=0,t.element.addClass("ui-accordion ui-widget ui-helper-reset").children("li").addClass("ui-accordion-li-fix"),t.headers=t.element.find(n.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion",function(){if(n.disabled)return;e(this).addClass("ui-state-hover")}).bind("mouseleave.accordion",function(){if(n.disabled)return;e(this).removeClass("ui-state-hover")}).bind("focus.accordion",function(){if(n.disabled)return;e(this).addClass("ui-state-focus")}).bind("blur.accordion",function(){if(n.disabled)return;e(this).removeClass("ui-state-focus")}),t.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");if(n.navigation){var r=t.element.find("a").filter(n.navigationFilter).eq(0);if(r.length){var i=r.closest(".ui-accordion-header");i.length?t.active=i:t.active=r.closest(".ui-accordion-content").prev()}}t.active=t._findActive(t.active||n.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top"),t.active.next().addClass("ui-accordion-content-active"),t._createIcons(),t.resize(),t.element.attr("role","tablist"),t.headers.attr("role","tab").bind("keydown.accordion",function(e){return t._keydown(e)}).next().attr("role","tabpanel"),t.headers.not(t.active||"").attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).next().hide(),t.active.length?t.active.attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}):t.headers.eq(0).attr("tabIndex",0),e.browser.safari||t.headers.find("a").attr("tabIndex",-1),n.event&&t.headers.bind(n.event.split(" ").join(".accordion ")+".accordion",function(e){t._clickHandler.call(t,e,this),e.preventDefault()})},_createIcons:function(){var t=this.options;t.icons&&(e("<span></span>").addClass("ui-icon "+t.icons.header).prependTo(this.headers),this.active.children(".ui-icon").toggleClass(t.icons.header).toggleClass(t.icons.headerSelected),this.element.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.children(".ui-icon").remove(),this.element.removeClass("ui-accordion-icons")},destroy:function(){var t=this.options;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex"),this.headers.find("a").removeAttr("tabIndex"),this._destroyIcons();var n=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");return(t.autoHeight||t.fillHeight)&&n.css("height",""),e.Widget.prototype.destroy.call(this)},_setOption:function(t,n){e.Widget.prototype._setOption.apply(this,arguments),t=="active"&&this.activate(n),t=="icons"&&(this._destroyIcons(),n&&this._createIcons()),t=="disabled"&&this.headers.add(this.headers.next())[n?"addClass":"removeClass"]("ui-accordion-disabled ui-state-disabled")},_keydown:function(t){if(this.options.disabled||t.altKey||t.ctrlKey)return;var n=e.ui.keyCode,r=this.headers.length,i=this.headers.index(t.target),s=!1;switch(t.keyCode){case n.RIGHT:case n.DOWN:s=this.headers[(i+1)%r];break;case n.LEFT:case n.UP:s=this.headers[(i-1+r)%r];break;case n.SPACE:case n.ENTER:this._clickHandler({target:t.target},t.target),t.preventDefault()}return s?(e(t.target).attr("tabIndex",-1),e(s).attr("tabIndex",0),s.focus(),!1):!0},resize:function(){var t=this.options,n;if(t.fillSpace){if(e.browser.msie){var r=this.element.parent().css("overflow");this.element.parent().css("overflow","hidden")}n=this.element.parent().height(),e.browser.msie&&this.element.parent().css("overflow",r),this.headers.each(function(){n-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,n-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")}else t.autoHeight&&(n=0,this.headers.next().each(function(){n=Math.max(n,e(this).height("").height())}).height(n));return this},activate:function(e){this.options.active=e;var t=this._findActive(e)[0];return this._clickHandler({target:t},t),this},_findActive:function(t){return t?typeof t=="number"?this.headers.filter(":eq("+t+")"):this.headers.not(this.headers.not(t)):t===!1?e([]):this.headers.filter(":eq(0)")},_clickHandler:function(t,n){var r=this.options;if(r.disabled)return;if(!t.target){if(!r.collapsible)return;this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(r.icons.headerSelected).addClass(r.icons.header),this.active.next().addClass("ui-accordion-content-active");var i=this.active.next(),s={options:r,newHeader:e([]),oldHeader:r.active,newContent:e([]),oldContent:i},o=this.active=e([]);this._toggle(o,i,s);return}var u=e(t.currentTarget||n),a=u[0]===this.active[0];r.active=r.collapsible&&a?!1:this.headers.index(u);if(this.running||!r.collapsible&&a)return;var f=this.active,o=u.next(),i=this.active.next(),s={options:r,newHeader:a&&r.collapsible?e([]):u,oldHeader:this.active,newContent:a&&r.collapsible?e([]):o,oldContent:i},l=this.headers.index(this.active[0])>this.headers.index(u[0]);this.active=a?e([]):u,this._toggle(o,i,s,a,l),f.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(r.icons.headerSelected).addClass(r.icons.header),a||(u.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-icon").removeClass(r.icons.header).addClass(r.icons.headerSelected),u.next().addClass("ui-accordion-content-active"));return},_toggle:function(t,n,r,i,s){var o=this,u=o.options;o.toShow=t,o.toHide=n,o.data=r;var a=function(){if(!o)return;return o._completed.apply(o,arguments)};o._trigger("changestart",null,o.data),o.running=n.size()===0?t.size():n.size();if(u.animated){var f={};u.collapsible&&i?f={toShow:e([]),toHide:n,complete:a,down:s,autoHeight:u.autoHeight||u.fillSpace}:f={toShow:t,toHide:n,complete:a,down:s,autoHeight:u.autoHeight||u.fillSpace},u.proxied||(u.proxied=u.animated),u.proxiedDuration||(u.proxiedDuration=u.duration),u.animated=e.isFunction(u.proxied)?u.proxied(f):u.proxied,u.duration=e.isFunction(u.proxiedDuration)?u.proxiedDuration(f):u.proxiedDuration;var l=e.ui.accordion.animations,c=u.duration,h=u.animated;h&&!l[h]&&!e.easing[h]&&(h="slide"),l[h]||(l[h]=function(e){this.slide(e,{easing:h,duration:c||700})}),l[h](f)}else u.collapsible&&i?t.toggle():(n.hide(),t.show()),a(!0);n.prev().attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).blur(),t.prev().attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}).focus()},_completed:function(e){this.running=e?0:--this.running;if(this.running)return;this.options.clearStyle&&this.toShow.add(this.toHide).css({height:"",overflow:""}),this.toHide.removeClass("ui-accordion-content-active"),this.toHide.length&&(this.toHide.parent()[0].className=this.toHide.parent()[0].className),this._trigger("change",null,this.data)}}),e.extend(e.ui.accordion,{version:"1.8.14",animations:{slide:function(t,n){t=e.extend({easing:"swing",duration:300},t,n);if(!t.toHide.size()){t.toShow.animate({height:"show",paddingTop:"show",paddingBottom:"show"},t);return}if(!t.toShow.size()){t.toHide.animate({height:"hide",paddingTop:"hide",paddingBottom:"hide"},t);return}var r=t.toShow.css("overflow"),i=0,s={},o={},u=["height","paddingTop","paddingBottom"],a,f=t.toShow;a=f[0].style.width,f.width(parseInt(f.parent().width(),10)-parseInt(f.css("paddingLeft"),10)-parseInt(f.css("paddingRight"),10)-(parseInt(f.css("borderLeftWidth"),10)||0)-(parseInt(f.css("borderRightWidth"),10)||0)),e.each(u,function(n,r){o[r]="hide";var i=(""+e.css(t.toShow[0],r)).match(/^([\d+-.]+)(.*)$/);s[r]={value:i[1],unit:i[2]||"px"}}),t.toShow.css({height:0,overflow:"hidden"}).show(),t.toHide.filter(":hidden").each(t.complete).end().filter(":visible").animate(o,{step:function(e,n){n.prop=="height"&&(i=n.end-n.start===0?0:(n.now-n.start)/(n.end-n.start)),t.toShow[0].style[n.prop]=i*s[n.prop].value+s[n.prop].unit},duration:t.duration,easing:t.easing,complete:function(){t.autoHeight||t.toShow.css("height",""),t.toShow.css({width:a,overflow:r}),t.complete()}})},bounceslide:function(e){this.slide(e,{easing:e.down?"easeOutBounce":"swing",duration:e.down?1e3:200})}}})}(jQuery),function(e,t){var n=0;e.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var t=this,n=this.element[0].ownerDocument,r;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(n){if(t.options.disabled||t.element.attr("readonly"))return;r=!1;var i=e.ui.keyCode;switch(n.keyCode){case i.PAGE_UP:t._move("previousPage",n);break;case i.PAGE_DOWN:t._move("nextPage",n);break;case i.UP:t._move("previous",n),n.preventDefault();break;case i.DOWN:t._move("next",n),n.preventDefault();break;case i.ENTER:case i.NUMPAD_ENTER:t.menu.active&&(r=!0,n.preventDefault());case i.TAB:if(!t.menu.active)return;t.menu.select(n);break;case i.ESCAPE:t.element.val(t.term),t.close(n);break;default:clearTimeout(t.searching),t.searching=setTimeout(function(){t.term!=t.element.val()&&(t.selectedItem=null,t.search(null,n))},t.options.delay)}}).bind("keypress.autocomplete",function(e){r&&(r=!1,e.preventDefault())}).bind("focus.autocomplete",function(){if(t.options.disabled)return;t.selectedItem=null,t.previous=t.element.val()}).bind("blur.autocomplete",function(e){if(t.options.disabled)return;clearTimeout(t.searching),t.closing=setTimeout(function(){t.close(e),t._change(e)},150)}),this._initSource(),this.response=function(){return t._response.apply(t,arguments)},this.menu=e("<ul></ul>").addClass("ui-autocomplete").appendTo(e(this.options.appendTo||"body",n)[0]).mousedown(function(n){var r=t.menu.element[0];e(n.target).closest(".ui-menu-item").length||setTimeout(function(){e(document).one("mousedown",function(n){n.target!==t.element[0]&&n.target!==r&&!e.ui.contains(r,n.target)&&t.close()})},1),setTimeout(function(){clearTimeout(t.closing)},13)}).menu({focus:function(e,n){var r=n.item.data("item.autocomplete");!1!==t._trigger("focus",e,{item:r})&&/^key/.test(e.originalEvent.type)&&t.element.val(r.value)},selected:function(e,r){var i=r.item.data("item.autocomplete"),s=t.previous;t.element[0]!==n.activeElement&&(t.element.focus(),t.previous=s,setTimeout(function(){t.previous=s,t.selectedItem=i},1)),!1!==t._trigger("select",e,{item:i})&&t.element.val(i.value),t.term=t.element.val(),t.close(e),t.selectedItem=i},blur:function(e,n){t.menu.element.is(":visible")&&t.element.val()!==t.term&&t.element.val(t.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu"),e.fn.bgiframe&&this.menu.element.bgiframe()},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup"),this.menu.element.remove(),e.Widget.prototype.destroy.call(this)},_setOption:function(t,n){e.Widget.prototype._setOption.apply(this,arguments),t==="source"&&this._initSource(),t==="appendTo"&&this.menu.element.appendTo(e(n||"body",this.element[0].ownerDocument)[0]),t==="disabled"&&n&&this.xhr&&this.xhr.abort()},_initSource:function(){var t=this,r,i;e.isArray(this.options.source)?(r=this.options.source,this.source=function(t,n){n(e.ui.autocomplete.filter(r,t.term))}):typeof this.options.source=="string"?(i=this.options.source,this.source=function(r,s){t.xhr&&t.xhr.abort(),t.xhr=e.ajax({url:i,data:r,dataType:"json",autocompleteRequest:++n,success:function(e,t){this.autocompleteRequest===n&&s(e)},error:function(){this.autocompleteRequest===n&&s([])}})}):this.source=this.options.source},search:function(e,t){e=e!=null?e:this.element.val(),this.term=this.element.val();if(e.length<this.options.minLength)return this.close(t);clearTimeout(this.closing);if(this._trigger("search",t)===!1)return;return this._search(e)},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.source({term:e},this.response)},_response:function(e){!this.options.disabled&&e&&e.length?(e=this._normalize(e),this._suggest(e),this._trigger("open")):this.close(),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},close:function(e){clearTimeout(this.closing),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.deactivate(),this._trigger("close",e))},_change:function(e){this.previous!==this.element.val()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return typeof t=="string"?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var n=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(n,t),this.menu.deactivate(),this.menu.refresh(),n.show(),this._resizeMenu(),n.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(new e.Event("mouseover"))},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(t,n){var r=this;e.each(n,function(e,n){r._renderItem(t,n)})},_renderItem:function(t,n){return e("<li></li>").data("item.autocomplete",n).append(e("<a></a>").text(n.label)).appendTo(t)},_move:function(e,t){if(!this.menu.element.is(":visible")){this.search(null,t);return}if(this.menu.first()&&/^previous/.test(e)||this.menu.last()&&/^next/.test(e)){this.element.val(this.term),this.menu.deactivate();return}this.menu[e](t)},widget:function(){return this.menu.element}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(t,n){var r=new RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(e){return r.test(e.label||e.value||e)})}})}(jQuery),function(e){e.widget("ui.menu",{_create:function(){var t=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(n){if(!e(n.target).closest(".ui-menu-item a").length)return;n.preventDefault(),t.select(n)}),this.refresh()},refresh:function(){var t=this,n=this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem");n.children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(n){t.activate(n,e(this).parent())}).mouseleave(function(){t.deactivate()})},activate:function(e,t){this.deactivate();if(this.hasScroll()){var n=t.offset().top-this.element.offset().top,r=this.element.scrollTop(),i=this.element.height();n<0?this.element.scrollTop(r+n):n>=i&&this.element.scrollTop(r+n-i+t.height())}this.active=t.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end(),this._trigger("focus",e,{item:t})},deactivate:function(){if(!this.active)return;this.active.children("a").removeClass("ui-state-hover").removeAttr("id"),this._trigger("blur"),this.active=null},next:function(e){this.move("next",".ui-menu-item:first",e)},previous:function(e){this.move("prev",".ui-menu-item:last",e)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(e,t,n){if(!this.active){this.activate(n,this.element.children(t));return}var r=this.active[e+"All"](".ui-menu-item").eq(0);r.length?this.activate(n,r):this.activate(n,this.element.children(t))},nextPage:function(t){if(this.hasScroll()){if(!this.active||this.last()){this.activate(t,this.element.children(".ui-menu-item:first"));return}var n=this.active.offset().top,r=this.element.height(),i=this.element.children(".ui-menu-item").filter(function(){var t=e(this).offset().top-n-r+e(this).height();return t<10&&t>-10});i.length||(i=this.element.children(".ui-menu-item:last")),this.activate(t,i)}else this.activate(t,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))},previousPage:function(t){if(this.hasScroll()){if(!this.active||this.first()){this.activate(t,this.element.children(".ui-menu-item:last"));return}var n=this.active.offset().top,r=this.element.height();result=this.element.children(".ui-menu-item").filter(function(){var t=e(this).offset().top-n+r-e(this).height();return t<10&&t>-10}),result.length||(result=this.element.children(".ui-menu-item:first")),this.activate(t,result)}else this.activate(t,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element[e.fn.prop?"prop":"attr"]("scrollHeight")},select:function(e){this._trigger("selected",e,{item:this.active})}})}(jQuery),function(e,t){var n,r,i,s,o="ui-button ui-widget ui-state-default ui-corner-all",u="ui-state-hover ui-state-active ",a="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",f=function(){var t=e(this).find(":ui-button");setTimeout(function(){t.button("refresh")},1)},l=function(t){var n=t.name,r=t.form,i=e([]);return n&&(r?i=e(r).find("[name='"+n+"']"):i=e("[name='"+n+"']",t.ownerDocument).filter(function(){return!this.form})),i};e.widget("ui.button",{options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",f),typeof this.options.disabled!="boolean"&&(this.options.disabled=this.element.attr("disabled")),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,u=this.options,a=this.type==="checkbox"||this.type==="radio",c="ui-state-hover"+(a?"":" ui-state-active"),h="ui-state-focus";u.label===null&&(u.label=this.buttonElement.html()),this.element.is(":disabled")&&(u.disabled=!0),this.buttonElement.addClass(o).attr("role","button").bind("mouseenter.button",function(){if(u.disabled)return;e(this).addClass("ui-state-hover"),this===n&&e(this).addClass("ui-state-active")}).bind("mouseleave.button",function(){if(u.disabled)return;e(this).removeClass(c)}).bind("click.button",function(e){u.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this.element.bind("focus.button",function(){t.buttonElement.addClass(h)}).bind("blur.button",function(){t.buttonElement.removeClass(h)}),a&&(this.element.bind("change.button",function(){if(s)return;t.refresh()}),this.buttonElement.bind("mousedown.button",function(e){if(u.disabled)return;s=!1,r=e.pageX,i=e.pageY}).bind("mouseup.button",function(e){if(u.disabled)return;if(r!==e.pageX||i!==e.pageY)s=!0})),this.type==="checkbox"?this.buttonElement.bind("click.button",function(){if(u.disabled||s)return!1;e(this).toggleClass("ui-state-active"),t.buttonElement.attr("aria-pressed",t.element[0].checked)}):this.type==="radio"?this.buttonElement.bind("click.button",function(){if(u.disabled||s)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed",!0);var n=t.element[0];l(n).not(n).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed",!1)}):(this.buttonElement.bind("mousedown.button",function(){if(u.disabled)return!1;e(this).addClass("ui-state-active"),n=this,e(document).one("mouseup",function(){n=null})}).bind("mouseup.button",function(){if(u.disabled)return!1;e(this).removeClass("ui-state-active")}).bind("keydown.button",function(t){if(u.disabled)return!1;(t.keyCode==e.ui.keyCode.SPACE||t.keyCode==e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active")}).bind("keyup.button",function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",u.disabled),this._resetButton()},_determineButtonType:function(){this.element.is(":checkbox")?this.type="checkbox":this.element.is(":radio")?this.type="radio":this.element.is("input")?this.type="input":this.type="button";if(this.type==="checkbox"||this.type==="radio"){var e=this.element.parents().filter(":last"),t="label[for="+this.element.attr("id")+"]";this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible");var n=this.element.is(":checked");n&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.attr("aria-pressed",n)}else this.buttonElement=this.element},widget:function(){return this.buttonElement},destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(o+" "+u+" "+a).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title"),e.Widget.prototype.destroy.call(this)},_setOption:function(t,n){e.Widget.prototype._setOption.apply(this,arguments);if(t==="disabled"){n?this.element.attr("disabled",!0):this.element.removeAttr("disabled");return}this._resetButton()},refresh:function(){var t=this.element.is(":disabled");t!==this.options.disabled&&this._setOption("disabled",t),this.type==="radio"?l(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed",!0):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed",!1)}):this.type==="checkbox"&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed",!0):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed",!1))},_resetButton:function(){if(this.type==="input"){this.options.label&&this.element.val(this.options.label);return}var t=this.buttonElement.removeClass(a),n=e("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),r=this.options.icons,i=r.primary&&r.secondary,s=[];r.primary||r.secondary?(this.options.text&&s.push("ui-button-text-icon"+(i?"s":r.primary?"-primary":"-secondary")),r.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+r.primary+"'></span>"),r.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+r.secondary+"'></span>"),this.options.text||(s.push(i?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",n))):s.push("ui-button-text-only"),t.addClass(s.join(" "))}}),e.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(t,n){t==="disabled"&&this.buttons.button("option",t,n),e.Widget.prototype._setOption.apply(this,arguments)},refresh:function(){var t=this.element.css("direction")==="ltr";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-left":"ui-corner-right").end().filter(":last").addClass(t?"ui-corner-right":"ui-corner-left").end().end()},destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy"),e.Widget.prototype.destroy.call(this)}})}(jQuery),function(e,t){var n="ui-dialog ui-widget ui-widget-content ui-corner-all ",r={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},i={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},s=e.attrFn||{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0,click:!0};e.widget("ui.dialog",{options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",collision:"fit",using:function(t){var n=e(this).css(t).offset().top;n<0&&e(this).css("top",t.top-n)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1e3},_create:function(){this.originalTitle=this.element.attr("title"),typeof this.originalTitle!="string"&&(this.originalTitle=""),this.options.title=this.options.title||this.originalTitle;var t=this,r=t.options,i=r.title||"&#160;",s=e.ui.dialog.getTitleId(t.element),o=(t.uiDialog=e("<div></div>")).appendTo(document.body).hide().addClass(n+r.dialogClass).css({zIndex:r.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(n){r.closeOnEscape&&n.keyCode&&n.keyCode===e.ui.keyCode.ESCAPE&&(t.close(n),n.preventDefault())}).attr({role:"dialog","aria-labelledby":s}).mousedown(function(e){t.moveToTop(!1,e)}),u=t.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(o),a=(t.uiDialogTitlebar=e("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(o),f=e('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role","button").hover(function(){f.addClass("ui-state-hover")},function(){f.removeClass("ui-state-hover")}).focus(function(){f.addClass("ui-state-focus")}).blur(function(){f.removeClass("ui-state-focus")}).click(function(e){return t.close(e),!1}).appendTo(a),l=(t.uiDialogTitlebarCloseText=e("<span></span>")).addClass("ui-icon ui-icon-closethick").text(r.closeText).appendTo(f),c=e("<span></span>").addClass("ui-dialog-title").attr("id",s).html(i).prependTo(a);e.isFunction(r.beforeclose)&&!e.isFunction(r.beforeClose)&&(r.beforeClose=r.beforeclose),a.find("*").add(a).disableSelection(),r.draggable&&e.fn.draggable&&t._makeDraggable(),r.resizable&&e.fn.resizable&&t._makeResizable(),t._createButtons(r.buttons),t._isOpen=!1,e.fn.bgiframe&&o.bgiframe()},_init:function(){this.options.autoOpen&&this.open()},destroy:function(){var e=this;return e.overlay&&e.overlay.destroy(),e.uiDialog.hide(),e.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"),e.uiDialog.remove(),e.originalTitle&&e.element.attr("title",e.originalTitle),e},widget:function(){return this.uiDialog},close:function(t){var n=this,r,i;if(!1===n._trigger("beforeClose",t))return;return n.overlay&&n.overlay.destroy(),n.uiDialog.unbind("keypress.ui-dialog"),n._isOpen=!1,n.options.hide?n.uiDialog.hide(n.options.hide,function(){n._trigger("close",t)}):(n.uiDialog.hide(),n._trigger("close",t)),e.ui.dialog.overlay.resize(),n.options.modal&&(r=0,e(".ui-dialog").each(function(){this!==n.uiDialog[0]&&(i=e(this).css("z-index"),isNaN(i)||(r=Math.max(r,i)))}),e.ui.dialog.maxZ=r),n},isOpen:function(){return this._isOpen},moveToTop:function(t,n){var r=this,i=r.options,s;return i.modal&&!t||!i.stack&&!i.modal?r._trigger("focus",n):(i.zIndex>e.ui.dialog.maxZ&&(e.ui.dialog.maxZ=i.zIndex),r.overlay&&(e.ui.dialog.maxZ+=1,r.overlay.$el.css("z-index",e.ui.dialog.overlay.maxZ=e.ui.dialog.maxZ)),s={scrollTop:r.element.attr("scrollTop"),scrollLeft:r.element.attr("scrollLeft")},e.ui.dialog.maxZ+=1,r.uiDialog.css("z-index",e.ui.dialog.maxZ),r.element.attr(s),r._trigger("focus",n),r)},open:function(){if(this._isOpen)return;var t=this,n=t.options,r=t.uiDialog;return t.overlay=n.modal?new e.ui.dialog.overlay(t):null,t._size(),t._position(n.position),r.show(n.show),t.moveToTop(!0),n.modal&&r.bind("keypress.ui-dialog",function(t){if(t.keyCode!==e.ui.keyCode.TAB)return;var n=e(":tabbable",this),r=n.filter(":first"),i=n.filter(":last");if(t.target===i[0]&&!t.shiftKey)return r.focus(1),!1;if(t.target===r[0]&&t.shiftKey)return i.focus(1),!1}),e(t.element.find(":tabbable").get().concat(r.find(".ui-dialog-buttonpane :tabbable").get().concat(r.get()))).eq(0).focus(),t._isOpen=!0,t._trigger("open"),t},_createButtons:function(t){var n=this,r=!1,i=e("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),o=e("<div></div>").addClass("ui-dialog-buttonset").appendTo(i);n.uiDialog.find(".ui-dialog-buttonpane").remove(),typeof t=="object"&&t!==null&&e.each(t,function(){return!(r=!0)}),r&&(e.each(t,function(t,r){r=e.isFunction(r)?{click:r,text:t}:r;var i=e('<button type="button"></button>').click(function(){r.click.apply(n.element[0],arguments)}).appendTo(o);e.each(r,function(e,t){if(e==="click")return;e in s?i[e](t):i.attr(e,t)}),e.fn.button&&i.button()}),i.appendTo(n.uiDialog))},_makeDraggable:function(){function s(e){return{position:e.position,offset:e.offset}}var t=this,n=t.options,r=e(document),i;t.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(r,o){i=n.height==="auto"?"auto":e(this).height(),e(this).height(e(this).height()).addClass("ui-dialog-dragging"),t._trigger("dragStart",r,s(o))},drag:function(e,n){t._trigger("drag",e,s(n))},stop:function(o,u){n.position=[u.position.left-r.scrollLeft(),u.position.top-r.scrollTop()],e(this).removeClass("ui-dialog-dragging").height(i),t._trigger("dragStop",o,s(u)),e.ui.dialog.overlay.resize()}})},_makeResizable:function(n){function u(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}n=n===t?this.options.resizable:n;var r=this,i=r.options,s=r.uiDialog.css("position"),o=typeof n=="string"?n:"n,e,s,w,se,sw,ne,nw";r.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:r.element,maxWidth:i.maxWidth,maxHeight:i.maxHeight,minWidth:i.minWidth,minHeight:r._minHeight(),handles:o,start:function(t,n){e(this).addClass("ui-dialog-resizing"),r._trigger("resizeStart",t,u(n))},resize:function(e,t){r._trigger("resize",e,u(t))},stop:function(t,n){e(this).removeClass("ui-dialog-resizing"),i.height=e(this).height(),i.width=e(this).width(),r._trigger("resizeStop",t,u(n)),e.ui.dialog.overlay.resize()}}).css("position",s).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var e=this.options;return e.height==="auto"?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(t){var n=[],r=[0,0],i;if(t){if(typeof t=="string"||typeof t=="object"&&"0"in t)n=t.split?t.split(" "):[t[0],t[1]],n.length===1&&(n[1]=n[0]),e.each(["left","top"],function(e,t){+n[e]===n[e]&&(r[e]=n[e],n[e]=t)}),t={my:n.join(" "),at:n.join(" "),offset:r.join(" ")};t=e.extend({},e.ui.dialog.prototype.options.position,t)}else t=e.ui.dialog.prototype.options.position;i=this.uiDialog.is(":visible"),i||this.uiDialog.show(),this.uiDialog.css({top:0,left:0}).position(e.extend({of:window},t)),i||this.uiDialog.hide()},_setOptions:function(t){var n=this,s={},o=!1;e.each(t,function(e,t){n._setOption(e,t),e in r&&(o=!0),e in i&&(s[e]=t)}),o&&this._size(),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",s)},_setOption:function(t,r){var i=this,s=i.uiDialog;switch(t){case"beforeclose":t="beforeClose";break;case"buttons":i._createButtons(r);break;case"closeText":i.uiDialogTitlebarCloseText.text(""+r);break;case"dialogClass":s.removeClass(i.options.dialogClass).addClass(n+r);break;case"disabled":r?s.addClass("ui-dialog-disabled"):s.removeClass("ui-dialog-disabled");break;case"draggable":var o=s.is(":data(draggable)");o&&!r&&s.draggable("destroy"),!o&&r&&i._makeDraggable();break;case"position":i._position(r);break;case"resizable":var u=s.is(":data(resizable)");u&&!r&&s.resizable("destroy"),u&&typeof r=="string"&&s.resizable("option","handles",r),!u&&r!==!1&&i._makeResizable(r);break;case"title":e(".ui-dialog-title",i.uiDialogTitlebar).html(""+(r||"&#160;"))}e.Widget.prototype._setOption.apply(i,arguments)},_size:function(){var t=this.options,n,r,i=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0}),t.minWidth>t.width&&(t.width=t.minWidth),n=this.uiDialog.css({height:"auto",width:t.width}).height(),r=Math.max(0,t.minHeight-n);if(t.height==="auto")if(e.support.minHeight)this.element.css({minHeight:r,height:"auto"});else{this.uiDialog.show();var s=this.element.css("height","auto").height();i||this.uiDialog.hide(),this.element.height(Math.max(s,r))}else this.element.height(Math.max(t.height-n,0));this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}}),e.extend(e.ui.dialog,{version:"1.8.14",uuid:0,maxZ:0,getTitleId:function(e){var t=e.attr("id");return t||(this.uuid+=1,t=this.uuid),"ui-dialog-title-"+t},overlay:function(t){this.$el=e.ui.dialog.overlay.create(t)}}),e.extend(e.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:e.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(e){return e+".dialog-overlay"}).join(" "),create:function(t){this.instances.length===0&&(setTimeout(function(){e.ui.dialog.overlay.instances.length&&e(document).bind(e.ui.dialog.overlay.events,function(t){if(e(t.target).zIndex()<e.ui.dialog.overlay.maxZ)return!1})},1),e(document).bind("keydown.dialog-overlay",function(n){t.options.closeOnEscape&&n.keyCode&&n.keyCode===e.ui.keyCode.ESCAPE&&(t.close(n),n.preventDefault())}),e(window).bind("resize.dialog-overlay",e.ui.dialog.overlay.resize));var n=(this.oldInstances.pop()||e("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});return e.fn.bgiframe&&n.bgiframe(),this.instances.push(n),n},destroy:function(t){var n=e.inArray(t,this.instances);n!=-1&&this.oldInstances.push(this.instances.splice(n,1)[0]),this.instances.length===0&&e([document,window]).unbind(".dialog-overlay"),t.remove();var r=0;e.each(this.instances,function(){r=Math.max(r,this.css("z-index"))}),this.maxZ=r},height:function(){var t,n;return e.browser.msie&&e.browser.version<7?(t=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),n=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),t<n?e(window).height()+"px":t+"px"):e(document).height()+"px"},width:function(){var t,n;return e.browser.msie?(t=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),n=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),t<n?e(window).width()+"px":t+"px"):e(document).width()+"px"},resize:function(){var t=e([]);e.each(e.ui.dialog.overlay.instances,function(){t=t.add(this)}),t.css({width:0,height:0}).css({width:e.ui.dialog.overlay.width(),height:e.ui.dialog.overlay.height()})}}),e.extend(e.ui.dialog.overlay.prototype,{destroy:function(){e.ui.dialog.overlay.destroy(this.$el)}})}(jQuery),function(e,t){var n=5;e.widget("ui.slider",e.ui.mouse,{widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var t=this,r=this.options,i=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),s="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",o=r.values&&r.values.length||1,u=[];this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"+(r.disabled?" ui-slider-disabled ui-disabled":"")),this.range=e([]),r.range&&(r.range===!0&&(r.values||(r.values=[this._valueMin(),this._valueMin()]),r.values.length&&r.values.length!==2&&(r.values=[r.values[0],r.values[0]])),this.range=e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(r.range==="min"||r.range==="max"?" ui-slider-range-"+r.range:"")));for(var a=i.length;a<o;a+=1)u.push(s);this.handles=i.add(e(u.join("")).appendTo(t.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(e){e.preventDefault()}).hover(function(){r.disabled||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}).focus(function(){r.disabled?e(this).blur():(e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),e(this).addClass("ui-state-focus"))}).blur(function(){e(this).removeClass("ui-state-focus")}),this.handles.each(function(t){e(this).data("index.ui-slider-handle",t)}),this.handles.keydown(function(r){var i=!0,s=e(this).data("index.ui-slider-handle"),o,u,a,f;if(t.options.disabled)return;switch(r.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:i=!1;if(!t._keySliding){t._keySliding=!0,e(this).addClass("ui-state-active"),o=t._start(r,s);if(o===!1)return}}f=t.options.step,t.options.values&&t.options.values.length?u=a=t.values(s):u=a=t.value();switch(r.keyCode){case e.ui.keyCode.HOME:a=t._valueMin();break;case e.ui.keyCode.END:a=t._valueMax();break;case e.ui.keyCode.PAGE_UP:a=t._trimAlignValue(u+(t._valueMax()-t._valueMin())/n);break;case e.ui.keyCode.PAGE_DOWN:a=t._trimAlignValue(u-(t._valueMax()-t._valueMin())/n);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(u===t._valueMax())return;a=t._trimAlignValue(u+f);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(u===t._valueMin())return;a=t._trimAlignValue(u-f)}return t._slide(r,s,a),i}).keyup(function(n){var r=e(this).data("index.ui-slider-handle");t._keySliding&&(t._keySliding=!1,t._stop(n,r),t._change(n,r),e(this).removeClass("ui-state-active"))}),this._refreshValue(),this._animateOff=!1},destroy:function(){return this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider"),this._mouseDestroy(),this},_mouseCapture:function(t){var n=this.options,r,i,s,o,u,a,f,l,c;return n.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),r={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(r),s=this._valueMax()-this._valueMin()+1,u=this,this.handles.each(function(t){var n=Math.abs(i-u.values(t));s>n&&(s=n,o=e(this),a=t)}),n.range===!0&&this.values(1)===n.min&&(a+=1,o=e(this.handles[a])),f=this._start(t,a),f===!1?!1:(this._mouseSliding=!0,u._handleIndex=a,o.addClass("ui-state-active").focus(),l=o.offset(),c=!e(t.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=c?{left:0,top:0}:{left:t.pageX-l.left-o.width()/2,top:t.pageY-l.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,a,i),this._animateOff=!0,!0))},_mouseStart:function(e){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,r,i,s;return this.orientation==="horizontal"?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),r=n/t,r>1&&(r=1),r<0&&(r=0),this.orientation==="vertical"&&(r=1-r),i=this._valueMax()-this._valueMin(),s=this._valueMin()+r*i,this._trimAlignValue(s)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var r,i,s;this.options.values&&this.options.values.length?(r=this.values(t?0:1),this.options.values.length===2&&this.options.range===!0&&(t===0&&n>r||t===1&&n<r)&&(n=r),n!==this.values(t)&&(i=this.values(),i[t]=n,s=this._trigger("slide",e,{handle:this.handles[t],value:n,values:i}),r=this.values(t?0:1),s!==!1&&this.values(t,n,!0))):n!==this.value()&&(s=this._trigger("slide",e,{handle:this.handles[t],value:n}),s!==!1&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("change",e,n)}},value:function(e){if(arguments.length){this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0);return}return this._value()},values:function(t,n){var r,i,s;if(arguments.length>1){this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),this._change(null,t);return}if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();r=this.options.values,i=arguments[0];for(s=0;s<r.length;s+=1)r[s]=this._trimAlignValue(i[s]),this._change(null,s);this._refreshValue()},_setOption:function(t,n){var r,i=0;e.isArray(this.options.values)&&(i=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments);switch(t){case"disabled":n?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.attr("disabled","disabled"),this.element.addClass("ui-disabled")):(this.handles.removeAttr("disabled"),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":this._animateOff=!0,this._refreshValue();for(r=0;r<i;r+=1)this._change(null,r);this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e),e},_values:function(e){var t,n,r;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t),t;n=this.options.values.slice();for(r=0;r<n.length;r+=1)n[r]=this._trimAlignValue(n[r]);return n},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t;return alignValue=e-n,Math.abs(n)*2>=t&&(alignValue+=n>0?t:-t),parseFloat(alignValue.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t=this.options.range,n=this.options,r=this,i=this._animateOff?!1:n.animate,s,o={},u,a,f,l;this.options.values&&this.options.values.length?this.handles.each(function(t,a){s=(r.values(t)-r._valueMin())/(r._valueMax()-r._valueMin())*100,o[r.orientation==="horizontal"?"left":"bottom"]=s+"%",e(this).stop(1,1)[i?"animate":"css"](o,n.animate),r.options.range===!0&&(r.orientation==="horizontal"?(t===0&&r.range.stop(1,1)[i?"animate":"css"]({left:s+"%"},n.animate),t===1&&r.range[i?"animate":"css"]({width:s-u+"%"},{queue:!1,duration:n.animate})):(t===0&&r.range.stop(1,1)[i?"animate":"css"]({bottom:s+"%"},n.animate),t===1&&r.range[i?"animate":"css"]({height:s-u+"%"},{queue:!1,duration:n.animate}))),u=s}):(a=this.value(),f=this._valueMin(),l=this._valueMax(),s=l!==f?(a-f)/(l-f)*100:0,o[r.orientation==="horizontal"?"left":"bottom"]=s+"%",this.handle.stop(1,1)[i?"animate":"css"](o,n.animate),t==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[i?"animate":"css"]({width:s+"%"},n.animate),t==="max"&&this.orientation==="horizontal"&&this.range[i?"animate":"css"]({width:100-s+"%"},{queue:!1,duration:n.animate}),t==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[i?"animate":"css"]({height:s+"%"},n.animate),t==="max"&&this.orientation==="vertical"&&this.range[i?"animate":"css"]({height:100-s+"%"},{queue:!1,duration:n.animate}))}}),e.extend(e.ui.slider,{version:"1.8.14"})}(jQuery),function(e,n){function s(){return++r}function o(){return++i}var r=0,i=0;e.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:!1,cookie:null,collapsible:!1,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},_create:function(){this._tabify(!0)},_setOption:function(e,t){if(e=="selected"){if(this.options.collapsible&&t==this.options.selected)return;this.select(t)}else this.options[e]=t,this._tabify()},_tabId:function(e){return e.title&&e.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+s()},_sanitizeSelector:function(e){return e.replace(/:/g,"\\:")},_cookie:function(){var t=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+o());return e.cookie.apply(null,[t].concat(e.makeArray(arguments)))},_ui:function(e,t){return{tab:e,panel:t,index:this.anchors.index(e)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var t=e(this);t.html(t.data("label.tabs")).removeData("label.tabs")})},_tabify:function(t){function h(t,n){t.css("display",""),!e.support.opacity&&n.opacity&&t[0].style.removeAttribute("filter")}var r=this,i=this.options,s=/^#.+/;this.list=this.element.find("ol,ul").eq(0),this.lis=e(" > li:has(a[href])",this.list),this.anchors=this.lis.map(function(){return e("a",this)[0]}),this.panels=e([]),this.anchors.each(function(t,n){var o=e(n).attr("href"),u=o.split("#")[0],a;u&&(u===location.toString().split("#")[0]||(a=e("base")[0])&&u===a.href)&&(o=n.hash,n.href=o);if(s.test(o))r.panels=r.panels.add(r.element.find(r._sanitizeSelector(o)));else if(o&&o!=="#"){e.data(n,"href.tabs",o),e.data(n,"load.tabs",o.replace(/#.*$/,""));var f=r._tabId(n);n.href="#"+f;var l=r.element.find("#"+f);l.length||(l=e(i.panelTemplate).attr("id",f).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(r.panels[t-1]||r.list),l.data("destroy.tabs",!0)),r.panels=r.panels.add(l)}else i.disabled.push(t)}),t?(this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all"),this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"),this.lis.addClass("ui-state-default ui-corner-top"),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom"),i.selected===n?(location.hash&&this.anchors.each(function(e,t){if(t.hash==location.hash)return i.selected=e,!1}),typeof i.selected!="number"&&i.cookie&&(i.selected=parseInt(r._cookie(),10)),typeof i.selected!="number"&&this.lis.filter(".ui-tabs-selected").length&&(i.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))),i.selected=i.selected||(this.lis.length?0:-1)):i.selected===null&&(i.selected=-1),i.selected=i.selected>=0&&this.anchors[i.selected]||i.selected<0?i.selected:0,i.disabled=e.unique(i.disabled.concat(e.map(this.lis.filter(".ui-state-disabled"),function(e,t){return r.lis.index(e)}))).sort(),e.inArray(i.selected,i.disabled)!=-1&&i.disabled.splice(e.inArray(i.selected,i.disabled),1),this.panels.addClass("ui-tabs-hide"),this.lis.removeClass("ui-tabs-selected ui-state-active"),i.selected>=0&&this.anchors.length&&(r.element.find(r._sanitizeSelector(r.anchors[i.selected].hash)).removeClass("ui-tabs-hide"),this.lis.eq(i.selected).addClass("ui-tabs-selected ui-state-active"),r.element.queue("tabs",function(){r._trigger("show",null,r._ui(r.anchors[i.selected],r.element.find(r._sanitizeSelector(r.anchors[i.selected].hash))[0]))}),this.load(i.selected)),e(window).bind("unload",function(){r.lis.add(r.anchors).unbind(".tabs"),r.lis=r.anchors=r.panels=null})):i.selected=this.lis.index(this.lis.filter(".ui-tabs-selected")),this.element[i.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible"),i.cookie&&this._cookie(i.selected,i.cookie);for(var o=0,u;u=this.lis[o];o++)e(u)[e.inArray(o,i.disabled)!=-1&&!e(u).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled");i.cache===!1&&this.anchors.removeData("cache.tabs"),this.lis.add(this.anchors).unbind(".tabs");if(i.event!=="mouseover"){var a=function(e,t){t.is(":not(.ui-state-disabled)")&&t.addClass("ui-state-"+e)},f=function(e,t){t.removeClass("ui-state-"+e)};this.lis.bind("mouseover.tabs",function(){a("hover",e(this))}),this.lis.bind("mouseout.tabs",function(){f("hover",e(this))}),this.anchors.bind("focus.tabs",function(){a("focus",e(this).closest("li"))}),this.anchors.bind("blur.tabs",function(){f("focus",e(this).closest("li"))})}var l,c;i.fx&&(e.isArray(i.fx)?(l=i.fx[0],c=i.fx[1]):l=c=i.fx);var p=c?function(t,n){e(t).closest("li").addClass("ui-tabs-selected ui-state-active"),n.hide().removeClass("ui-tabs-hide").animate(c,c.duration||"normal",function(){h(n,c),r._trigger("show",null,r._ui(t,n[0]))})}:function(t,n){e(t).closest("li").addClass("ui-tabs-selected ui-state-active"),n.removeClass("ui-tabs-hide"),r._trigger("show",null,r._ui(t,n[0]))},d=l?function(e,t){t.animate(l,l.duration||"normal",function(){r.lis.removeClass("ui-tabs-selected ui-state-active"),t.addClass("ui-tabs-hide"),h(t,l),r.element.dequeue("tabs")})}:function(e,t,n){r.lis.removeClass("ui-tabs-selected ui-state-active"),t.addClass("ui-tabs-hide"),r.element.dequeue("tabs")};this.anchors.bind(i.event+".tabs",function(){var t=this,n=e(t).closest("li"),s=r.panels.filter(":not(.ui-tabs-hide)"),o=r.element.find(r._sanitizeSelector(t.hash));if(n.hasClass("ui-tabs-selected")&&!i.collapsible||n.hasClass("ui-state-disabled")||n.hasClass("ui-state-processing")||r.panels.filter(":animated").length||r._trigger("select",null,r._ui(this,o[0]))===!1)return this.blur(),!1;i.selected=r.anchors.index(this),r.abort();if(i.collapsible){if(n.hasClass("ui-tabs-selected"))return i.selected=-1,i.cookie&&r._cookie(i.selected,i.cookie),r.element.queue("tabs",function(){d(t,s)}).dequeue("tabs"),this.blur(),!1;if(!s.length)return i.cookie&&r._cookie(i.selected,i.cookie),r.element.queue("tabs",function(){p(t,o)}),r.load(r.anchors.index(this)),this.blur(),!1}i.cookie&&r._cookie(i.selected,i.cookie);if(!o.length)throw"jQuery UI Tabs: Mismatching fragment identifier.";s.length&&r.element.queue("tabs",function(){d(t,s)}),r.element.queue("tabs",function(){p(t,o)}),r.load(r.anchors.index(this)),e.browser.msie&&this.blur()}),this.anchors.bind("click.tabs",function(){return!1})},_getIndex:function(e){return typeof e=="string"&&(e=this.anchors.index(this.anchors.filter("[href$="+e+"]"))),e},destroy:function(){var t=this.options;return this.abort(),this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs"),this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"),this.anchors.each(function(){var t=e.data(this,"href.tabs");t&&(this.href=t);var n=e(this).unbind(".tabs");e.each(["href","load","cache"],function(e,t){n.removeData(t+".tabs")})}),this.lis.unbind(".tabs").add(this.panels).each(function(){e.data(this,"destroy.tabs")?e(this).remove():e(this).removeClass(["ui-state-default","ui-corner-top","ui-tabs-selected","ui-state-active","ui-state-hover","ui-state-focus","ui-state-disabled","ui-tabs-panel","ui-widget-content","ui-corner-bottom","ui-tabs-hide"].join(" "))}),t.cookie&&this._cookie(null,t.cookie),this},add:function(t,r,i){i===n&&(i=this.anchors.length);var s=this,o=this.options,u=e(o.tabTemplate.replace(/#\{href\}/g,t).replace(/#\{label\}/g,r)),a=t.indexOf("#")?this._tabId(e("a",u)[0]):t.replace("#","");u.addClass("ui-state-default ui-corner-top").data("destroy.tabs",!0);var f=s.element.find("#"+a);return f.length||(f=e(o.panelTemplate).attr("id",a).data("destroy.tabs",!0)),f.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"),i>=this.lis.length?(u.appendTo(this.list),f.appendTo(this.list[0].parentNode)):(u.insertBefore(this.lis[i]),f.insertBefore(this.panels[i])),o.disabled=e.map(o.disabled,function(e,t){return e>=i?++e:e}),this._tabify(),this.anchors.length==1&&(o.selected=0,u.addClass("ui-tabs-selected ui-state-active"),f.removeClass("ui-tabs-hide"),this.element.queue("tabs",function(){s._trigger("show",null,s._ui(s.anchors[0],s.panels[0]))}),this.load(0)),this._trigger("add",null,this._ui(this.anchors[i],this.panels[i])),this},remove:function(t){t=this._getIndex(t);var n=this.options,r=this.lis.eq(t).remove(),i=this.panels.eq(t).remove();return r.hasClass("ui-tabs-selected")&&this.anchors.length>1&&this.select(t+(t+1<this.anchors.length?1:-1)),n.disabled=e.map(e.grep(n.disabled,function(e,n){return e!=t}),function(e,n){return e>=t?--e:e}),this._tabify(),this._trigger("remove",null,this._ui(r.find("a")[0],i[0])),this},enable:function(t){t=this._getIndex(t);var n=this.options;if(e.inArray(t,n.disabled)==-1)return;return this.lis.eq(t).removeClass("ui-state-disabled"),n.disabled=e.grep(n.disabled,function(e,n){return e!=t}),this._trigger("enable",null,this._ui(this.anchors[t],this.panels[t])),this},disable:function(e){e=this._getIndex(e);var t=this,n=this.options;return e!=n.selected&&(this.lis.eq(e).addClass("ui-state-disabled"),n.disabled.push(e),n.disabled.sort(),this._trigger("disable",null,this._ui(this.anchors[e],this.panels[e]))),this},select:function(e){e=this._getIndex(e);if(e==-1){if(!this.options.collapsible||this.options.selected==-1)return this;e=this.options.selected}return this.anchors.eq(e).trigger(this.options.event+".tabs"),this},load:function(t){t=this._getIndex(t);var n=this,r=this.options,i=this.anchors.eq(t)[0],s=e.data(i,"load.tabs");this.abort();if(!s||this.element.queue("tabs").length!==0&&e.data(i,"cache.tabs")){this.element.dequeue("tabs");return}this.lis.eq(t).addClass("ui-state-processing");if(r.spinner){var o=e("span",i);o.data("label.tabs",o.html()).html(r.spinner)}return this.xhr=e.ajax(e.extend({},r.ajaxOptions,{url:s,success:function(s,o){n.element.find(n._sanitizeSelector(i.hash)).html(s),n._cleanup(),r.cache&&e.data(i,"cache.tabs",!0),n._trigger("load",null,n._ui(n.anchors[t],n.panels[t]));try{r.ajaxOptions.success(s,o)}catch(u){}},error:function(e,s,o){n._cleanup(),n._trigger("load",null,n._ui(n.anchors[t],n.panels[t]));try{r.ajaxOptions.error(e,s,t,i)}catch(o){}}})),n.element.dequeue("tabs"),this},abort:function(){return this.element.queue([]),this.panels.stop(!1,!0),this.element.queue("tabs",this.element.queue("tabs").splice(-2,2)),this.xhr&&(this.xhr.abort(),delete this.xhr),this._cleanup(),this},url:function(e,t){return this.anchors.eq(e).removeData("cache.tabs").data("load.tabs",t),this},length:function(){return this.anchors.length}}),e.extend(e.ui.tabs,{version:"1.8.14"}),e.extend(e.ui.tabs.prototype,{rotation:null,rotate:function(e,n){var r=this,i=this.options,s=r._rotate||(r._rotate=function(t){clearTimeout(r.rotation),r.rotation=setTimeout(function(){var e=i.selected;r.select(++e<r.anchors.length?e:0)},e),t&&t.stopPropagation()}),o=r._unrotate||(r._unrotate=n?function(e){t=i.selected,s()}:function(e){e.clientX&&r.rotate(null)});return e?(this.element.bind("tabsshow",s),this.anchors.bind(i.event+".tabs",o),s()):(clearTimeout(r.rotation),this.element.unbind("tabsshow",s),this.anchors.unbind(i.event+".tabs",o),delete this._rotate,delete this._unrotate),this}})}(jQuery),function($,undefined){function Datepicker(){this.debug=!1,this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1},$.extend(this._defaults,this.regional[""]),this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function bindHover(e){var t="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.bind("mouseout",function(e){var n=$(e.target).closest(t);if(!n.length)return;n.removeClass("ui-state-hover ui-datepicker-prev-hover ui-datepicker-next-hover")}).bind("mouseover",function(n){var r=$(n.target).closest(t);if($.datepicker._isDisabledDatepicker(instActive.inline?e.parent()[0]:instActive.input[0])||!r.length)return;r.parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),r.addClass("ui-state-hover"),r.hasClass("ui-datepicker-prev")&&r.addClass("ui-datepicker-prev-hover"),r.hasClass("ui-datepicker-next")&&r.addClass("ui-datepicker-next-hover")})}function extendRemove(e,t){$.extend(e,t);for(var n in t)if(t[n]==null||t[n]==undefined)e[n]=t[n];return e}function isArray(e){return e&&($.browser.safari&&typeof e=="object"&&e.length||e.constructor&&e.constructor.toString().match(/\Array\(\)/))}$.extend($.ui,{datepicker:{version:"1.8.14"}});var PROP_NAME="datepicker",dpuuid=(new Date).getTime(),instActive;$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return extendRemove(this._defaults,e||{}),this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase(),inline=nodeName=="div"||nodeName=="span";target.id||(this.uuid+=1,target.id="dp"+this.uuid);var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{}),nodeName=="input"?this._connectDatepicker(target,inst):inline&&this._inlineDatepicker(target,inst)},_newInst:function(e,t){var n=e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:n,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:t,dpDiv:t?bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(e,t){var n=$(e);t.append=$([]),t.trigger=$([]);if(n.hasClass(this.markerClassName))return;this._attachments(n,t),n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(e,n,r){t.settings[n]=r}).bind("getData.datepicker",function(e,n){return this._get(t,n)}),this._autoSize(t),$.data(e,PROP_NAME,t)},_attachments:function(e,t){var n=this._get(t,"appendText"),r=this._get(t,"isRTL");t.append&&t.append.remove(),n&&(t.append=$('<span class="'+this._appendClass+'">'+n+"</span>"),e[r?"before":"after"](t.append)),e.unbind("focus",this._showDatepicker),t.trigger&&t.trigger.remove();var i=this._get(t,"showOn");(i=="focus"||i=="both")&&e.focus(this._showDatepicker);if(i=="button"||i=="both"){var s=this._get(t,"buttonText"),o=this._get(t,"buttonImage");t.trigger=$(this._get(t,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:o,alt:s,title:s}):$('<button type="button"></button>').addClass(this._triggerClass).html(o==""?s:$("<img/>").attr({src:o,alt:s,title:s}))),e[r?"before":"after"](t.trigger),t.trigger.click(function(){return $.datepicker._datepickerShowing&&$.datepicker._lastInput==e[0]?$.datepicker._hideDatepicker():$.datepicker._showDatepicker(e[0]),!1})}},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t=new Date(2009,11,20),n=this._get(e,"dateFormat");if(n.match(/[DM]/)){var r=function(e){var t=0,n=0;for(var r=0;r<e.length;r++)e[r].length>t&&(t=e[r].length,n=r);return n};t.setMonth(r(this._get(e,n.match(/MM/)?"monthNames":"monthNamesShort"))),t.setDate(r(this._get(e,n.match(/DD/)?"dayNames":"dayNamesShort"))+20-t.getDay())}e.input.attr("size",this._formatDate(e,t).length)}},_inlineDatepicker:function(e,t){var n=$(e);if(n.hasClass(this.markerClassName))return;n.addClass(this.markerClassName).append(t.dpDiv).bind("setData.datepicker",function(e,n,r){t.settings[n]=r}).bind("getData.datepicker",function(e,n){return this._get(t,n)}),$.data(e,PROP_NAME,t),this._setDate(t,this._getDefaultDate(t),!0),this._updateDatepicker(t),this._updateAlternate(t),t.dpDiv.show()},_dialogDatepicker:function(e,t,n,r,i){var s=this._dialogInst;if(!s){this.uuid+=1;var o="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+o+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>'),this._dialogInput.keydown(this._doKeyDown),$("body").append(this._dialogInput),s=this._dialogInst=this._newInst(this._dialogInput,!1),s.settings={},$.data(this._dialogInput[0],PROP_NAME,s)}extendRemove(s.settings,r||{}),t=t&&t.constructor==Date?this._formatDate(s,t):t,this._dialogInput.val(t),this._pos=i?i.length?i:[i.pageX,i.pageY]:null;if(!this._pos){var u=document.documentElement.clientWidth,a=document.documentElement.clientHeight,f=document.documentElement.scrollLeft||document.body.scrollLeft,l=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[u/2-100+f,a/2-150+l]}return this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),s.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],PROP_NAME,s),this},_destroyDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(!t.hasClass(this.markerClassName))return;var r=e.nodeName.toLowerCase();$.removeData(e,PROP_NAME),r=="input"?(n.append.remove(),n.trigger.remove(),t.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):(r=="div"||r=="span")&&t.removeClass(this.markerClassName).empty()},_enableDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(!t.hasClass(this.markerClassName))return;var r=e.nodeName.toLowerCase();if(r=="input")e.disabled=!1,n.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if(r=="div"||r=="span"){var i=t.children("."+this._inlineClass);i.children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled")}this._disabledInputs=$.map(this._disabledInputs,function(t){return t==e?null:t})},_disableDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(!t.hasClass(this.markerClassName))return;var r=e.nodeName.toLowerCase();if(r=="input")e.disabled=!0,n.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if(r=="div"||r=="span"){var i=t.children("."+this._inlineClass);i.children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled","disabled")}this._disabledInputs=$.map(this._disabledInputs,function(t){return t==e?null:t}),this._disabledInputs[this._disabledInputs.length]=e},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]==e)return!0;return!1},_getInst:function(e){try{return $.data(e,PROP_NAME)}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,t,n){var r=this._getInst(e);if(arguments.length==2&&typeof t=="string")return t=="defaults"?$.extend({},$.datepicker._defaults):r?t=="all"?$.extend({},r.settings):this._get(r,t):null;var i=t||{};typeof t=="string"&&(i={},i[t]=n);if(r){this._curInst==r&&this._hideDatepicker();var s=this._getDateDatepicker(e,!0),o=this._getMinMaxDate(r,"min"),u=this._getMinMaxDate(r,"max");extendRemove(r.settings,i),o!==null&&i.dateFormat!==undefined&&i.minDate===undefined&&(r.settings.minDate=this._formatDate(r,o)),u!==null&&i.dateFormat!==undefined&&i.maxDate===undefined&&(r.settings.maxDate=this._formatDate(r,u)),this._attachments($(e),r),this._autoSize(r),this._setDate(r,s),this._updateAlternate(r),this._updateDatepicker(r)}},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(e){var t=$.datepicker._getInst(e.target),n=!0,r=t.dpDiv.is(".ui-datepicker-rtl");t._keyEvent=!0;if($.datepicker._datepickerShowing)switch(e.keyCode){case 9:$.datepicker._hideDatepicker(),n=!1;break;case 13:var i=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",t.dpDiv);return i[0]?$.datepicker._selectDay(e.target,t.selectedMonth,t.selectedYear,i[0]):$.datepicker._hideDatepicker(),!1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(e.target,e.ctrlKey?-$.datepicker._get(t,"stepBigMonths"):-$.datepicker._get(t,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(e.target,e.ctrlKey?+$.datepicker._get(t,"stepBigMonths"):+$.datepicker._get(t,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&$.datepicker._clearDate(e.target),n=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&$.datepicker._gotoToday(e.target),n=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,r?1:-1,"D"),n=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&$.datepicker._adjustDate(e.target,e.ctrlKey?-$.datepicker._get(t,"stepBigMonths"):-$.datepicker._get(t,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,-7,"D"),n=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,r?-1:1,"D"),n=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&$.datepicker._adjustDate(e.target,e.ctrlKey?+$.datepicker._get(t,"stepBigMonths"):+$.datepicker._get(t,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,7,"D"),n=e.ctrlKey||e.metaKey;break;default:n=!1}else e.keyCode==36&&e.ctrlKey?$.datepicker._showDatepicker(this):n=!1;n&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var t=$.datepicker._getInst(e.target);if($.datepicker._get(t,"constrainInput")){var n=$.datepicker._possibleChars($.datepicker._get(t,"dateFormat")),r=String.fromCharCode(e.charCode==undefined?e.keyCode:e.charCode);return e.ctrlKey||e.metaKey||r<" "||!n||n.indexOf(r)>-1}},_doKeyUp:function(e){var t=$.datepicker._getInst(e.target);if(t.input.val()!=t.lastVal)try{var n=$.datepicker.parseDate($.datepicker._get(t,"dateFormat"),t.input?t.input.val():null,$.datepicker._getFormatConfig(t));n&&($.datepicker._setDateFromField(t),$.datepicker._updateAlternate(t),$.datepicker._updateDatepicker(t))}catch(e){$.datepicker.log(e)}return!0},_showDatepicker:function(e){e=e.target||e,e.nodeName.toLowerCase()!="input"&&(e=$("input",e.parentNode)[0]);if($.datepicker._isDisabledDatepicker(e)||$.datepicker._lastInput==e)return;var t=$.datepicker._getInst(e);$.datepicker._curInst&&$.datepicker._curInst!=t&&($.datepicker._datepickerShowing&&$.datepicker._triggerOnClose($.datepicker._curInst),$.datepicker._curInst.dpDiv.stop(!0,!0));var n=$.datepicker._get(t,"beforeShow");extendRemove(t.settings,n?n.apply(e,[e,t]):{}),t.lastVal=null,$.datepicker._lastInput=e,$.datepicker._setDateFromField(t),$.datepicker._inDialog&&(e.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(e),$.datepicker._pos[1]+=e.offsetHeight);var r=!1;$(e).parents().each(function(){return r|=$(this).css("position")=="fixed",!r}),r&&$.browser.opera&&($.datepicker._pos[0]-=document.documentElement.scrollLeft,$.datepicker._pos[1]-=document.documentElement.scrollTop);var i={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null,t.dpDiv.empty(),t.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(t),i=$.datepicker._checkOffset(t,i,r),t.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":r?"fixed":"absolute",display:"none",left:i.left+"px",top:i.top+"px"});if(!t.inline){var s=$.datepicker._get(t,"showAnim"),o=$.datepicker._get(t,"duration"),u=function(){var e=t.dpDiv.find("iframe.ui-datepicker-cover");if(!!e.length){var n=$.datepicker._getBorders(t.dpDiv);e.css({left:-n[0],top:-n[1],width:t.dpDiv.outerWidth(),height:t.dpDiv.outerHeight()})}};t.dpDiv.zIndex($(e).zIndex()+1),$.datepicker._datepickerShowing=!0,$.effects&&$.effects[s]?t.dpDiv.show(s,$.datepicker._get(t,"showOptions"),o,u):t.dpDiv[s||"show"](s?o:null,u),(!s||!o)&&u(),t.input.is(":visible")&&!t.input.is(":disabled")&&t.input.focus(),$.datepicker._curInst=t}},_updateDatepicker:function(e){var t=this;t.maxRows=4;var n=$.datepicker._getBorders(e.dpDiv);instActive=e,e.dpDiv.empty().append(this._generateHTML(e));var r=e.dpDiv.find("iframe.ui-datepicker-cover");!r.length||r.css({left:-n[0],top:-n[1],width:e.dpDiv.outerWidth(),height:e.dpDiv.outerHeight()}),e.dpDiv.find("."+this._dayOverClass+" a").mouseover();var i=this._getNumberOfMonths(e),s=i[1],o=17;e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),s>1&&e.dpDiv.addClass("ui-datepicker-multi-"+s).css("width",o*s+"em"),e.dpDiv[(i[0]!=1||i[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e==$.datepicker._curInst&&$.datepicker._datepickerShowing&&e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&e.input[0]!=document.activeElement&&e.input.focus();if(e.yearshtml){var u=e.yearshtml;setTimeout(function(){u===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),u=e.yearshtml=null},0)}},_getBorders:function(e){var t=function(e){return{thin:1,medium:2,thick:3}[e]||e};return[parseFloat(t(e.css("border-left-width"))),parseFloat(t(e.css("border-top-width")))]},_checkOffset:function(e,t,n){var r=e.dpDiv.outerWidth(),i=e.dpDiv.outerHeight(),s=e.input?e.input.outerWidth():0,o=e.input?e.input.outerHeight():0,u=document.documentElement.clientWidth+$(document).scrollLeft(),a=document.documentElement.clientHeight+$(document).scrollTop();return t.left-=this._get(e,"isRTL")?r-s:0,t.left-=n&&t.left==e.input.offset().left?$(document).scrollLeft():0,t.top-=n&&t.top==e.input.offset().top+o?$(document).scrollTop():0,t.left-=Math.min(t.left,t.left+r>u&&u>r?Math.abs(t.left+r-u):0),t.top-=Math.min(t.top,t.top+i>a&&a>i?Math.abs(i+o):0),t},_findPos:function(e){var t=this._getInst(e),n=this._get(t,"isRTL");while(e&&(e.type=="hidden"||e.nodeType!=1||$.expr.filters.hidden(e)))e=e[n?"previousSibling":"nextSibling"];var r=$(e).offset();return[r.left,r.top]},_triggerOnClose:function(e){var t=this._get(e,"onClose");t&&t.apply(e.input?e.input[0]:null,[e.input?e.input.val():"",e])},_hideDatepicker:function(e){var t=this._curInst;if(!t||e&&t!=$.data(e,PROP_NAME))return;if(this._datepickerShowing){var n=this._get(t,"showAnim"),r=this._get(t,"duration"),i=function(){$.datepicker._tidyDialog(t),this._curInst=null};$.effects&&$.effects[n]?t.dpDiv.hide(n,$.datepicker._get(t,"showOptions"),r,i):t.dpDiv[n=="slideDown"?"slideUp":n=="fadeIn"?"fadeOut":"hide"](n?r:null,i),n||i(),$.datepicker._triggerOnClose(t),this._datepickerShowing=!1,this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1}},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(!$.datepicker._curInst)return;var t=$(e.target);t[0].id!=$.datepicker._mainDivId&&t.parents("#"+$.datepicker._mainDivId).length==0&&!t.hasClass($.datepicker.markerClassName)&&!t.hasClass($.datepicker._triggerClass)&&$.datepicker._datepickerShowing&&(!$.datepicker._inDialog||!$.blockUI)&&$.datepicker._hideDatepicker()},_adjustDate:function(e,t,n){var r=$(e),i=this._getInst(r[0]);if(this._isDisabledDatepicker(r[0]))return;this._adjustInstDate(i,t+(n=="M"?this._get(i,"showCurrentAtPos"):0),n),this._updateDatepicker(i)},_gotoToday:function(e){var t=$(e),n=this._getInst(t[0]);if(this._get(n,"gotoCurrent")&&n.currentDay)n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear;else{var r=new Date;n.selectedDay=r.getDate(),n.drawMonth=n.selectedMonth=r.getMonth(),n.drawYear=n.selectedYear=r.getFullYear()}this._notifyChange(n),this._adjustDate(t)},_selectMonthYear:function(e,t,n){var r=$(e),i=this._getInst(r[0]);i._selectingMonthYear=!1,i["selected"+(n=="M"?"Month":"Year")]=i["draw"+(n=="M"?"Month":"Year")]=parseInt(t.options[t.selectedIndex].value,10),this._notifyChange(i),this._adjustDate(r)},_clickMonthYear:function(e){var t=$(e),n=this._getInst(t[0]);n.input&&n._selectingMonthYear&&setTimeout(function(){n.input.focus()},0),n._selectingMonthYear=!n._selectingMonthYear},_selectDay:function(e,t,n,r){var i=$(e);if($(r).hasClass(this._unselectableClass)||this._isDisabledDatepicker(i[0]))return;var s=this._getInst(i[0]);s.selectedDay=s.currentDay=$("a",r).html(),s.selectedMonth=s.currentMonth=t,s.selectedYear=s.currentYear=n,this._selectDate(e,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear))},_clearDate:function(e){var t=$(e),n=this._getInst(t[0]);this._selectDate(t,"")},_selectDate:function(e,t){var n=$(e),r=this._getInst(n[0]);t=t!=null?t:this._formatDate(r),r.input&&r.input.val(t),this._updateAlternate(r);var i=this._get(r,"onSelect");i?i.apply(r.input?r.input[0]:null,[t,r]):r.input&&r.input.trigger("change"),r.inline?this._updateDatepicker(r):(this._hideDatepicker(),this._lastInput=r.input[0],typeof r.input[0]!="object"&&r.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var t=this._get(e,"altField");if(t){var n=this._get(e,"altFormat")||this._get(e,"dateFormat"),r=this._getDate(e),i=this.formatDate(n,r,this._getFormatConfig(e));$(t).each(function(){$(this).val(i)})}},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t=new Date(e.getTime());t.setDate(t.getDate()+4-(t.getDay()||7));var n=t.getTime();return t.setMonth(0),t.setDate(1),Math.floor(Math.round((n-t)/864e5)/7)+1},parseDate:function(e,t,n){if(e==null||t==null)throw"Invalid arguments";t=typeof t=="object"?t.toString():t+"";if(t=="")return null;var r=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff;r=typeof r!="string"?r:(new Date).getFullYear()%100+parseInt(r,10);var i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,s=(n?n.dayNames:null)||this._defaults.dayNames,o=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,u=(n?n.monthNames:null)||this._defaults.monthNames,a=-1,f=-1,l=-1,c=-1,h=!1,p=function(t){var n=y+1<e.length&&e.charAt(y+1)==t;return n&&y++,n},d=function(e){var n=p(e),r=e=="@"?14:e=="!"?20:e=="y"&&n?4:e=="o"?3:2,i=new RegExp("^\\d{1,"+r+"}"),s=t.substring(g).match(i);if(!s)throw"Missing number at position "+g;return g+=s[0].length,parseInt(s[0],10)},v=function(e,n,r){var i=$.map(p(e)?r:n,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)}),s=-1;$.each(i,function(e,n){var r=n[1];if(t.substr(g,r.length).toLowerCase()==r.toLowerCase())return s=n[0],g+=r.length,!1});if(s!=-1)return s+1;throw"Unknown name at position "+g},m=function(){if(t.charAt(g)!=e.charAt(y))throw"Unexpected literal at position "+g;g++},g=0;for(var y=0;y<e.length;y++)if(h)e.charAt(y)=="'"&&!p("'")?h=!1:m();else switch(e.charAt(y)){case"d":l=d("d");break;case"D":v("D",i,s);break;case"o":c=d("o");break;case"m":f=d("m");break;case"M":f=v("M",o,u);break;case"y":a=d("y");break;case"@":var b=new Date(d("@"));a=b.getFullYear(),f=b.getMonth()+1,l=b.getDate();break;case"!":var b=new Date((d("!")-this._ticksTo1970)/1e4);a=b.getFullYear(),f=b.getMonth()+1,l=b.getDate();break;case"'":p("'")?m():h=!0;break;default:m()}if(g<t.length)throw"Extra/unparsed characters found in date: "+t.substring(g);a==-1?a=(new Date).getFullYear():a<100&&(a+=(new Date).getFullYear()-(new Date).getFullYear()%100+(a<=r?0:-100));if(c>-1){f=1,l=c;do{var w=this._getDaysInMonth(a,f-1);if(l<=w)break;f++,l-=w}while(!0)}var b=this._daylightSavingAdjust(new Date(a,f-1,l));if(b.getFullYear()!=a||b.getMonth()+1!=f||b.getDate()!=l)throw"Invalid date";return b},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1e7,formatDate:function(e,t,n){if(!t)return"";var r=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,i=(n?n.dayNames:null)||this._defaults.dayNames,s=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,o=(n?n.monthNames:null)||this._defaults.monthNames,u=function(t){var n=h+1<e.length&&e.charAt(h+1)==t;return n&&h++,n},a=function(e,t,n){var r=""+t;if(u(e))while(r.length<n)r="0"+r;return r},f=function(e,t,n,r){return u(e)?r[t]:n[t]},l="",c=!1;if(t)for(var h=0;h<e.length;h++)if(c)e.charAt(h)=="'"&&!u("'")?c=!1:l+=e.charAt(h);else switch(e.charAt(h)){case"d":l+=a("d",t.getDate(),2);break;case"D":l+=f("D",t.getDay(),r,i);break;case"o":l+=a("o",Math.round(((new Date(t.getFullYear(),t.getMonth(),t.getDate())).getTime()-(new Date(t.getFullYear(),0,0)).getTime())/864e5),3);break;case"m":l+=a("m",t.getMonth()+1,2);break;case"M":l+=f("M",t.getMonth(),s,o);break;case"y":l+=u("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":l+=t.getTime();break;case"!":l+=t.getTime()*1e4+this._ticksTo1970;break;case"'":u("'")?l+="'":c=!0;break;default:l+=e.charAt(h)}return l},_possibleChars:function(e){var t="",n=!1,r=function(t){var n=i+1<e.length&&e.charAt(i+1)==t;return n&&i++,n};for(var i=0;i<e.length;i++)if(n)e.charAt(i)=="'"&&!r("'")?n=!1:t+=e.charAt(i);else switch(e.charAt(i)){case"d":case"m":case"y":case"@":t+="0123456789";break;case"D":case"M":return null;case"'":r("'")?t+="'":n=!0;break;default:t+=e.charAt(i)}return t},_get:function(e,t){return e.settings[t]!==undefined?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()==e.lastVal)return;var n=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,i,s;i=s=this._getDefaultDate(e);var o=this._getFormatConfig(e);try{i=this.parseDate(n,r,o)||s}catch(u){this.log(u),r=t?"":r}e.selectedDay=i.getDate(),e.drawMonth=e.selectedMonth=i.getMonth(),e.drawYear=e.selectedYear=i.getFullYear(),e.currentDay=r?i.getDate():0,e.currentMonth=r?i.getMonth():0,e.currentYear=r?i.getFullYear():0,this._adjustInstDate(e)},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(e,t,n){var r=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},i=function(t){try{return $.datepicker.parseDate($.datepicker._get(e,"dateFormat"),t,$.datepicker._getFormatConfig(e))}catch(n){}var r=(t.toLowerCase().match(/^c/)?$.datepicker._getDate(e):null)||new Date,i=r.getFullYear(),s=r.getMonth(),o=r.getDate(),u=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,a=u.exec(t);while(a){switch(a[2]||"d"){case"d":case"D":o+=parseInt(a[1],10);break;case"w":case"W":o+=parseInt(a[1],10)*7;break;case"m":case"M":s+=parseInt(a[1],10),o=Math.min(o,$.datepicker._getDaysInMonth(i,s));break;case"y":case"Y":i+=parseInt(a[1],10),o=Math.min(o,$.datepicker._getDaysInMonth(i,s))}a=u.exec(t)}return new Date(i,s,o)},s=t==null||t===""?n:typeof t=="string"?i(t):typeof t=="number"?isNaN(t)?n:r(t):new Date(t.getTime());return s=s&&s.toString()=="Invalid Date"?n:s,s&&(s.setHours(0),s.setMinutes(0),s.setSeconds(0),s.setMilliseconds(0)),this._daylightSavingAdjust(s)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var r=!t,i=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),(i!=e.selectedMonth||s!=e.selectedYear)&&!n&&this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(r?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&e.input.val()==""?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_generateHTML:function(e){var t=new Date;t=this._daylightSavingAdjust(new Date(t.getFullYear(),t.getMonth(),t.getDate()));var n=this._get(e,"isRTL"),r=this._get(e,"showButtonPanel"),i=this._get(e,"hideIfNoPrevNext"),s=this._get(e,"navigationAsDateFormat"),o=this._getNumberOfMonths(e),u=this._get(e,"showCurrentAtPos"),a=this._get(e,"stepMonths"),f=o[0]!=1||o[1]!=1,l=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),c=this._getMinMaxDate(e,"min"),h=this._getMinMaxDate(e,"max"),p=e.drawMonth-u,d=e.drawYear;p<0&&(p+=12,d--);if(h){var v=this._daylightSavingAdjust(new Date(h.getFullYear(),h.getMonth()-o[0]*o[1]+1,h.getDate()));v=c&&v<c?c:v;while(this._daylightSavingAdjust(new Date(d,p,1))>v)p--,p<0&&(p=11,d--)}e.drawMonth=p,e.drawYear=d;var m=this._get(e,"prevText");m=s?this.formatDate(m,this._daylightSavingAdjust(new Date(d,p-a,1)),this._getFormatConfig(e)):m;var g=this._canAdjustMonth(e,-1,d,p)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._adjustDate('#"+e.id+"', -"+a+", 'M');\""+' title="'+m+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"e":"w")+'">'+m+"</span></a>":i?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+m+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"e":"w")+'">'+m+"</span></a>",y=this._get(e,"nextText");y=s?this.formatDate(y,this._daylightSavingAdjust(new Date(d,p+a,1)),this._getFormatConfig(e)):y;var b=this._canAdjustMonth(e,1,d,p)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._adjustDate('#"+e.id+"', +"+a+", 'M');\""+' title="'+y+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"w":"e")+'">'+y+"</span></a>":i?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+y+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"w":"e")+'">'+y+"</span></a>",w=this._get(e,"currentText"),E=this._get(e,"gotoCurrent")&&e.currentDay?l:t;w=s?this.formatDate(w,E,this._getFormatConfig(e)):w;var S=e.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+dpuuid+'.datepicker._hideDatepicker();">'+this._get(e,"closeText")+"</button>",x=r?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(n?S:"")+(this._isInRange(e,E)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._gotoToday('#"+e.id+"');\""+">"+w+"</button>":"")+(n?"":S)+"</div>":"",T=parseInt(this._get(e,"firstDay"),10);T=isNaN(T)?0:T;var N=this._get(e,"showWeek"),C=this._get(e,"dayNames"),k=this._get(e,"dayNamesShort"),L=this._get(e,"dayNamesMin"),A=this._get(e,"monthNames"),O=this._get(e,"monthNamesShort"),M=this._get(e,"beforeShowDay"),_=this._get(e,"showOtherMonths"),D=this._get(e,"selectOtherMonths"),P=this._get(e,"calculateWeek")||this.iso8601Week,H=this._getDefaultDate(e),B="";for(var j=0;j<o[0];j++){var F="";this.maxRows=4;for(var I=0;I<o[1];I++){var q=this._daylightSavingAdjust(new Date(d,p,e.selectedDay)),R=" ui-corner-all",U="";if(f){U+='<div class="ui-datepicker-group';if(o[1]>1)switch(I){case 0:U+=" ui-datepicker-group-first",R=" ui-corner-"+(n?"right":"left");break;case o[1]-1:U+=" ui-datepicker-group-last",R=" ui-corner-"+(n?"left":"right");break;default:U+=" ui-datepicker-group-middle",R=""}U+='">'}U+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+R+'">'+(/all|left/.test(R)&&j==0?n?b:g:"")+(/all|right/.test(R)&&j==0?n?g:b:"")+this._generateMonthYearHeader(e,p,d,c,h,j>0||I>0,A,O)+'</div><table class="ui-datepicker-calendar"><thead>'+"<tr>";var z=N?'<th class="ui-datepicker-week-col">'+this._get(e,"weekHeader")+"</th>":"";for(var W=0;W<7;W++){var X=(W+T)%7;z+="<th"+((W+T+6)%7>=5?' class="ui-datepicker-week-end"':"")+">"+'<span title="'+C[X]+'">'+L[X]+"</span></th>"}U+=z+"</tr></thead><tbody>";var V=this._getDaysInMonth(d,p);d==e.selectedYear&&p==e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,V));var J=(this._getFirstDayOfMonth(d,p)-T+7)%7,K=Math.ceil((J+V)/7),Q=f?this.maxRows>K?this.maxRows:K:K;this.maxRows=Q;var G=this._daylightSavingAdjust(new Date(d,p,1-J));for(var Y=0;Y<Q;Y++){U+="<tr>";var Z=N?'<td class="ui-datepicker-week-col">'+this._get(e,"calculateWeek")(G)+"</td>":"";for(var W=0;W<7;W++){var et=M?M.apply(e.input?e.input[0]:null,[G]):[!0,""],tt=G.getMonth()!=p,nt=tt&&!D||!et[0]||c&&G<c||h&&G>h;Z+='<td class="'+((W+T+6)%7>=5?" ui-datepicker-week-end":"")+(tt?" ui-datepicker-other-month":"")+(G.getTime()==q.getTime()&&p==e.selectedMonth&&e._keyEvent||H.getTime()==G.getTime()&&H.getTime()==q.getTime()?" "+this._dayOverClass:"")+(nt?" "+this._unselectableClass+" ui-state-disabled":"")+(tt&&!_?"":" "+et[1]+(G.getTime()==l.getTime()?" "+this._currentClass:"")+(G.getTime()==t.getTime()?" ui-datepicker-today":""))+'"'+((!tt||_)&&et[2]?' title="'+et[2]+'"':"")+(nt?"":' onclick="DP_jQuery_'+dpuuid+".datepicker._selectDay('#"+e.id+"',"+G.getMonth()+","+G.getFullYear()+', this);return false;"')+">"+(tt&&!_?"&#xa0;":nt?'<span class="ui-state-default">'+G.getDate()+"</span>":'<a class="ui-state-default'+(G.getTime()==t.getTime()?" ui-state-highlight":"")+(G.getTime()==l.getTime()?" ui-state-active":"")+(tt?" ui-priority-secondary":"")+'" href="#">'+G.getDate()+"</a>")+"</td>",G.setDate(G.getDate()+1),G=this._daylightSavingAdjust(G)}U+=Z+"</tr>"}p++,p>11&&(p=0,d++),U+="</tbody></table>"+(f?"</div>"+(o[0]>0&&I==o[1]-1?'<div class="ui-datepicker-row-break"></div>':""):""),F+=U}B+=F}return B+=x+($.browser.msie&&parseInt($.browser.version,10)<7&&!e.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':""),e._keyEvent=!1,B},_generateMonthYearHeader:function(e,t,n,r,i,s,o,u){var a=this._get(e,"changeMonth"),f=this._get(e,"changeYear"),l=this._get(e,"showMonthAfterYear"),c='<div class="ui-datepicker-title">',h="";if(s||!a)h+='<span class="ui-datepicker-month">'+o[t]+"</span>";else{var p=r&&r.getFullYear()==n,d=i&&i.getFullYear()==n;h+='<select class="ui-datepicker-month" onchange="DP_jQuery_'+dpuuid+".datepicker._selectMonthYear('#"+e.id+"', this, 'M');\" "+'onclick="DP_jQuery_'+dpuuid+".datepicker._clickMonthYear('#"+e.id+"');\""+">";for(var v=0;v<12;v++)(!p||v>=r.getMonth())&&(!d||v<=i.getMonth())&&(h+='<option value="'+v+'"'+(v==t?' selected="selected"':"")+">"+u[v]+"</option>");h+="</select>"}l||(c+=h+(s||!a||!f?"&#xa0;":""));if(!e.yearshtml){e.yearshtml="";if(s||!f)c+='<span class="ui-datepicker-year">'+n+"</span>";else{var m=this._get(e,"yearRange").split(":"),g=(new Date).getFullYear(),y=function(e){var t=e.match(/c[+-].*/)?n+parseInt(e.substring(1),10):e.match(/[+-].*/)?g+parseInt(e,10):parseInt(e,10);return isNaN(t)?g:t},b=y(m[0]),w=Math.max(b,y(m[1]||""));b=r?Math.max(b,r.getFullYear()):b,w=i?Math.min(w,i.getFullYear()):w,e.yearshtml+='<select class="ui-datepicker-year" onchange="DP_jQuery_'+dpuuid+".datepicker._selectMonthYear('#"+e.id+"', this, 'Y');\" "+'onclick="DP_jQuery_'+dpuuid+".datepicker._clickMonthYear('#"+e.id+"');\""+">";for(;b<=w;b++)e.yearshtml+='<option value="'+b+'"'+(b==n?' selected="selected"':"")+">"+b+"</option>";e.yearshtml+="</select>",c+=e.yearshtml,e.yearshtml=null}}return c+=this._get(e,"yearSuffix"),l&&(c+=(s||!a||!f?"&#xa0;":"")+h),c+="</div>",c},_adjustInstDate:function(e,t,n){var r=e.drawYear+(n=="Y"?t:0),i=e.drawMonth+(n=="M"?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(r,i))+(n=="D"?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,i,s)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),(n=="M"||n=="Y")&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),i=n&&t<n?n:t;return i=r&&i>r?r:i,i},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return t==null?[1,1]:typeof t=="number"?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return(new Date(e,t,1)).getDay()},_canAdjustMonth:function(e,t,n,r){var i=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(n,r+(t<0?t:i[0]*i[1]),1));return t<0&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max");return(!n||t.getTime()>=n.getTime())&&(!r||t.getTime()<=r.getTime())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t=typeof t!="string"?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,r){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var i=t?typeof t=="object"?t:this._daylightSavingAdjust(new Date(r,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),i,this._getFormatConfig(e))}}),$.fn.datepicker=function(e){if(!this.length)return this;$.datepicker.initialized||($(document).mousedown($.datepicker._checkExternalClick).find("body").append($.datepicker.dpDiv),$.datepicker.initialized=!0);var t=Array.prototype.slice.call(arguments,1);return typeof e!="string"||e!="isDisabled"&&e!="getDate"&&e!="widget"?e=="option"&&arguments.length==2&&typeof arguments[1]=="string"?$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this[0]].concat(t)):this.each(function(){typeof e=="string"?$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this].concat(t)):$.datepicker._attachDatepicker(this,e)}):$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this[0]].concat(t))},$.datepicker=new Datepicker,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.8.14",window["DP_jQuery_"+dpuuid]=$}(jQuery),function(e,t){e.widget("ui.progressbar",{options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this.oldValue=this._value(),this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove(),e.Widget.prototype.destroy.apply(this,arguments)},value:function(e){return e===t?this._value():(this._setOption("value",e),this)},_setOption:function(t,n){t==="value"&&(this.options.value=n,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete")),e.Widget.prototype._setOption.apply(this,arguments)},_value:function(){var e=this.options.value;return typeof e!="number"&&(e=0),Math.min(this.options.max,Math.max(this.min,e))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var e=this.value(),t=this._percentage();this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),this.valueDiv.toggle(e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(t.toFixed(0)+"%"),this.element.attr("aria-valuenow",e)}}),e.extend(e.ui.progressbar,{version:"1.8.14"})}(jQuery),jQuery.effects||function(e,t){function n(t){var n;return t&&t.constructor==Array&&t.length==3?t:(n=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(t))?[parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10)]:(n=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(t))?[parseFloat(n[1])*2.55,parseFloat(n[2])*2.55,parseFloat(n[3])*2.55]:(n=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(t))?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:(n=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(t))?[parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16)]:(n=/rgba\(0, 0, 0, 0\)/.exec(t))?i.transparent:i[e.trim(t).toLowerCase()]}function r(t,r){var i;do{i=e.curCSS(t,r);if(i!=""&&i!="transparent"||e.nodeName(t,"body"))break;r="backgroundColor"}while(t=t.parentNode);return n(i)}function u(){var e=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,t={},n,r;if(e&&e.length&&e[0]&&e[e[0]]){var i=e.length;while(i--)n=e[i],typeof e[n]=="string"&&(r=n.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),t[r]=e[n])}else for(n in e)typeof e[n]=="string"&&(t[n]=e[n]);return t}function a(t){var n,r;for(n in t)r=t[n],(r==null||e.isFunction(r)||n in o||/scrollbar/.test(n)||!/color/i.test(n)&&isNaN(parseFloat(r)))&&delete t[n];return t}function f(e,t){var n={_:0},r;for(r in t)e[r]!=t[r]&&(n[r]=t[r]);return n}function l(t,n,r,i){typeof t=="object"&&(i=n,r=null,n=t,t=n.effect),e.isFunction(n)&&(i=n,r=null,n={});if(typeof n=="number"||e.fx.speeds[n])i=r,r=n,n={};return e.isFunction(r)&&(i=r,r=null),n=n||{},r=r||n.duration,r=e.fx.off?0:typeof r=="number"?r:r in e.fx.speeds?e.fx.speeds[r]:e.fx.speeds._default,i=i||n.complete,[t,n,r,i]}function c(t){return!t||typeof t=="number"||e.fx.speeds[t]?!0:typeof t=="string"&&!e.effects[t]?!0:!1}e.effects={},e.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],function(t,i){e.fx.step[i]=function(e){e.colorInit||(e.start=r(e.elem,i),e.end=n(e.end),e.colorInit=!0),e.elem.style[i]="rgb("+Math.max(Math.min(parseInt(e.pos*(e.end[0]-e.start[0])+e.start[0],10),255),0)+","+Math.max(Math.min(parseInt(e.pos*(e.end[1]-e.start[1])+e.start[1],10),255),0)+","+Math.max(Math.min(parseInt(e.pos*(e.end[2]-e.start[2])+e.start[2],10),255),0)+")"}});var i={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},s=["add","remove","toggle"],o={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.effects.animateClass=function(t,n,r,i){return e.isFunction(r)&&(i=r,r=null),this.queue(function(){var o=e(this),l=o.attr("style")||" ",c=a(u.call(this)),h,p=o.attr("class");e.each(s,function(e,n){t[n]&&o[n+"Class"](t[n])}),h=a(u.call(this)),o.attr("class",p),o.animate(f(c,h),{queue:!1,duration:n,easing:r,complete:function(){e.each(s,function(e,n){t[n]&&o[n+"Class"](t[n])}),typeof o.attr("style")=="object"?(o.attr("style").cssText="",o.attr("style").cssText=l):o.attr("style",l),i&&i.apply(this,arguments),e.dequeue(this)}})})},e.fn.extend({_addClass:e.fn.addClass,addClass:function(t,n,r,i){return n?e.effects.animateClass.apply(this,[{add:t},n,r,i]):this._addClass(t)},_removeClass:e.fn.removeClass,removeClass:function(t,n,r,i){return n?e.effects.animateClass.apply(this,[{remove:t},n,r,i]):this._removeClass(t)},_toggleClass:e.fn.toggleClass,toggleClass:function(n,r,i,s,o){return typeof r=="boolean"||r===t?i?e.effects.animateClass.apply(this,[r?{add:n}:{remove:n},i,s,o]):this._toggleClass(n,r):e.effects.animateClass.apply(this,[{toggle:n},r,i,s])},switchClass:function(t,n,r,i,s){return e.effects.animateClass.apply(this,[{add:n,remove:t},r,i,s])}}),e.extend(e.effects,{version:"1.8.14",save:function(e,t){for(var n=0;n<t.length;n++)t[n]!==null&&e.data("ec.storage."+t[n],e[0].style[t[n]])},restore:function(e,t){for(var n=0;n<t.length;n++)t[n]!==null&&e.css(t[n],e.data("ec.storage."+t[n]))},setMode:function(e,t){return t=="toggle"&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var n,r;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":r=0;break;case"center":r=.5;break;case"right":r=1;break;default:r=e[1]/t.width}return{x:r,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},r=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0});return t.wrap(r),r=t.parent(),t.css("position")=="static"?(r.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,r){n[r]=t.css(r),isNaN(parseInt(n[r],10))&&(n[r]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),r.css(n).show()},removeWrapper:function(e){return e.parent().is(".ui-effects-wrapper")?e.parent().replaceWith(e):e},setTransition:function(t,n,r,i){return i=i||{},e.each(n,function(e,n){unit=t.cssUnit(n),unit[0]>0&&(i[n]=unit[0]*r+unit[1])}),i}}),e.fn.extend({effect:function(t,n,r,i){var s=l.apply(this,arguments),o={options:s[1],duration:s[2],callback:s[3]},u=o.options.mode,a=e.effects[t];return e.fx.off||!a?u?this[u](o.duration,o.callback):this.each(function(){o.callback&&o.callback.call(this)}):a.call(this,o)},_show:e.fn.show,show:function(e){if(c(e))return this._show.apply(this,arguments);var t=l.apply(this,arguments);return t[1].mode="show",this.effect.apply(this,t)},_hide:e.fn.hide,hide:function(e){if(c(e))return this._hide.apply(this,arguments);var t=l.apply(this,arguments);return t[1].mode="hide",this.effect.apply(this,t)},__toggle:e.fn.toggle,toggle:function(t){if(c(t)||typeof t=="boolean"||e.isFunction(t))return this.__toggle.apply(this,arguments);var n=l.apply(this,arguments);return n[1].mode="toggle",this.effect.apply(this,n)},cssUnit:function(t){var n=this.css(t),r=[];return e.each(["em","px","%","pt"],function(e,t){n.indexOf(t)>0&&(r=[parseFloat(n),t])}),r}}),e.easing.jswing=e.easing.swing,e.extend(e.easing,{def:"easeOutQuad",swing:function(t,n,r,i,s){return e.easing[e.easing.def](t,n,r,i,s)},easeInQuad:function(e,t,n,r,i){return r*(t/=i)*t+n},easeOutQuad:function(e,t,n,r,i){return-r*(t/=i)*(t-2)+n},easeInOutQuad:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t+n:-r/2*(--t*(t-2)-1)+n},easeInCubic:function(e,t,n,r,i){return r*(t/=i)*t*t+n},easeOutCubic:function(e,t,n,r,i){return r*((t=t/i-1)*t*t+1)+n},easeInOutCubic:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t+n:r/2*((t-=2)*t*t+2)+n},easeInQuart:function(e,t,n,r,i){return r*(t/=i)*t*t*t+n},easeOutQuart:function(e,t,n,r,i){return-r*((t=t/i-1)*t*t*t-1)+n},easeInOutQuart:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t*t+n:-r/2*((t-=2)*t*t*t-2)+n},easeInQuint:function(e,t,n,r,i){return r*(t/=i)*t*t*t*t+n},easeOutQuint:function(e,t,n,r,i){return r*((t=t/i-1)*t*t*t*t+1)+n},easeInOutQuint:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t*t*t+n:r/2*((t-=2)*t*t*t*t+2)+n},easeInSine:function(e,t,n,r,i){return-r*Math.cos(t/i*(Math.PI/2))+r+n},easeOutSine:function(e,t,n,r,i){return r*Math.sin(t/i*(Math.PI/2))+n},easeInOutSine:function(e,t,n,r,i){return-r/2*(Math.cos(Math.PI*t/i)-1)+n},easeInExpo:function(e,t,n,r,i){return t==0?n:r*Math.pow(2,10*(t/i-1))+n},easeOutExpo:function(e,t,n,r,i){return t==i?n+r:r*(-Math.pow(2,-10*t/i)+1)+n},easeInOutExpo:function(e,t,n,r,i){return t==0?n:t==i?n+r:(t/=i/2)<1?r/2*Math.pow(2,10*(t-1))+n:r/2*(-Math.pow(2,-10*--t)+2)+n},easeInCirc:function(e,t,n,r,i){return-r*(Math.sqrt(1-(t/=i)*t)-1)+n},easeOutCirc:function(e,t,n,r,i){return r*Math.sqrt(1-(t=t/i-1)*t)+n},easeInOutCirc:function(e,t,n,r,i){return(t/=i/2)<1?-r/2*(Math.sqrt(1-t*t)-1)+n:r/2*(Math.sqrt(1-(t-=2)*t)+1)+n},easeInElastic:function(e,t,n,r,i){var s=1.70158,o=0,u=r;if(t==0)return n;if((t/=i)==1)return n+r;o||(o=i*.3);if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return-(u*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o))+n},easeOutElastic:function(e,t,n,r,i){var s=1.70158,o=0,u=r;if(t==0)return n;if((t/=i)==1)return n+r;o||(o=i*.3);if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return u*Math.pow(2,-10*t)*Math.sin((t*i-s)*2*Math.PI/o)+r+n},easeInOutElastic:function(e,t,n,r,i){var s=1.70158,o=0,u=r;if(t==0)return n;if((t/=i/2)==2)return n+r;o||(o=i*.3*1.5);if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return t<1?-0.5*u*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o)+n:u*Math.pow(2,-10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o)*.5+r+n},easeInBack:function(e,n,r,i,s,o){return o==t&&(o=1.70158),i*(n/=s)*n*((o+1)*n-o)+r},easeOutBack:function(e,n,r,i,s,o){return o==t&&(o=1.70158),i*((n=n/s-1)*n*((o+1)*n+o)+1)+r},easeInOutBack:function(e,n,r,i,s,o){return o==t&&(o=1.70158),(n/=s/2)<1?i/2*n*n*(((o*=1.525)+1)*n-o)+r:i/2*((n-=2)*n*(((o*=1.525)+1)*n+o)+2)+r},easeInBounce:function(t,n,r,i,s){return i-e.easing.easeOutBounce(t,s-n,0,i,s)+r},easeOutBounce:function(e,t,n,r,i){return(t/=i)<1/2.75?r*7.5625*t*t+n:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+n:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+n:r*(7.5625*(t-=2.625/2.75)*t+.984375)+n},easeInOutBounce:function(t,n,r,i,s){return n<s/2?e.easing.easeInBounce(t,n*2,0,i,s)*.5+r:e.easing.easeOutBounce(t,n*2-s,0,i,s)*.5+i*.5+r}})}(jQuery),function(e,t){e.effects.blind=function(t){return this.queue(function(){var n=e(this),r=["position","top","bottom","left","right"],i=e.effects.setMode(n,t.options.mode||"hide"),s=t.options.direction||"vertical";e.effects.save(n,r),n.show();var u=e.effects.createWrapper(n).css({overflow:"hidden"}),a=s=="vertical"?"height":"width",f=s=="vertical"?u.height():u.width();i=="show"&&u.css(a,0);var l={};l[a]=i=="show"?f:0,u.animate(l,t.duration,t.options.easing,function(){i=="hide"&&n.hide(),e.effects.restore(n,r),e.effects.removeWrapper(n),t.callback&&t.callback.apply(n[0],arguments),n.dequeue()})})}}(jQuery),function(e,t){e.effects.bounce=function(t){return this.queue(function(){var n=e(this),r=["position","top","bottom","left","right"],i=e.effects.setMode(n,t.options.mode||"effect"),s=t.options.direction||"up",u=t.options.distance||20,a=t.options.times||5,f=t.duration||250;/show|hide/.test(i)&&r.push("opacity"),e.effects.save(n,r),n.show(),e.effects.createWrapper(n);var l=s=="up"||s=="down"?"top":"left",c=s=="up"||s=="left"?"pos":"neg",u=t.options.distance||(l=="top"?n.outerHeight({margin:!0})/3:n.outerWidth({margin:!0})/3);i=="show"&&n.css("opacity",0).css(l,c=="pos"?-u:u),i=="hide"&&(u/=a*2),i!="hide"&&a--;if(i=="show"){var h={opacity:1};h[l]=(c=="pos"?"+=":"-=")+u,n.animate(h,f/2,t.options.easing),u/=2,a--}for(var p=0;p<a;p++){var d={},v={};d[l]=(c=="pos"?"-=":"+=")+u,v[l]=(c=="pos"?"+=":"-=")+u,n.animate(d,f/2,t.options.easing).animate(v,f/2,t.options.easing),u=i=="hide"?u*2:u/2}if(i=="hide"){var h={opacity:0};h[l]=(c=="pos"?"-=":"+=")+u,n.animate(h,f/2,t.options.easing,function(){n.hide(),e.effects.restore(n,r),e.effects.removeWrapper(n),t.callback&&t.callback.apply(this,arguments)})}else{var d={},v={};d[l]=(c=="pos"?"-=":"+=")+u,v[l]=(c=="pos"?"+=":"-=")+u,n.animate(d,f/2,t.options.easing).animate(v,f/2,t.options.easing,function(){e.effects.restore(n,r),e.effects.removeWrapper(n),t.callback&&t.callback.apply(this,arguments)})}n.queue("fx",function(){n.dequeue()}),n.dequeue()})}}(jQuery),function(e,t){e.effects.clip=function(t){return this.queue(function(){var n=e(this),r=["position","top","bottom","left","right","height","width"],i=e.effects.setMode(n,t.options.mode||"hide"),s=t.options.direction||"vertical";e.effects.save(n,r),n.show();var u=e.effects.createWrapper(n).css({overflow:"hidden"}),a=n[0].tagName=="IMG"?u:n,f={size:s=="vertical"?"height":"width",position:s=="vertical"?"top":"left"},l=s=="vertical"?a.height():a.width();i=="show"&&(a.css(f.size,0),a.css(f.position,l/2));var c={};c[f.size]=i=="show"?l:0,c[f.position]=i=="show"?0:l/2,a.animate(c,{queue:!1,duration:t.duration,easing:t.options.easing,complete:function(){i=="hide"&&n.hide(),e.effects.restore(n,r),e.effects.removeWrapper(n),t.callback&&t.callback.apply(n[0],arguments),n.dequeue()}})})}}(jQuery),function(e,t){e.effects.drop=function(t){return this.queue(function(){var n=e(this),r=["position","top","bottom","left","right","opacity"],i=e.effects.setMode(n,t.options.mode||"hide"),s=t.options.direction||"left";e.effects.save(n,r),n.show(),e.effects.createWrapper(n);var u=s=="up"||s=="down"?"top":"left",a=s=="up"||s=="left"?"pos":"neg",f=t.options.distance||(u=="top"?n.outerHeight({margin:!0})/2:n.outerWidth({margin:!0})/2);i=="show"&&n.css("opacity",0).css(u,a=="pos"?-f:f);var l={opacity:i=="show"?1:0};l[u]=(i=="show"?a=="pos"?"+=":"-=":a=="pos"?"-=":"+=")+f,n.animate(l,{queue:!1,duration:t.duration,easing:t.options.easing,complete:function(){i=="hide"&&n.hide(),e.effects.restore(n,r),e.effects.removeWrapper(n),t.callback&&t.callback.apply(this,arguments),n.dequeue()}})})}}(jQuery),function(e,t){e.effects.explode=function(t){return this.queue(function(){var n=t.options.pieces?Math.round(Math.sqrt(t.options.pieces)):3,r=t.options.pieces?Math.round(Math.sqrt(t.options.pieces)):3;t.options.mode=t.options.mode=="toggle"?e(this).is(":visible")?"hide":"show":t.options.mode;var i=e(this).show().css("visibility","hidden"),s=i.offset();s.top-=parseInt(i.css("marginTop"),10)||0,s.left-=parseInt(i.css("marginLeft"),10)||0;var u=i.outerWidth(!0),a=i.outerHeight(!0);for(var f=0;f<n;f++)for(var l=0;l<r;l++)i.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-l*(u/r),top:-f*(a/n)}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:u/r,height:a/n,left:s.left+l*(u/r)+(t.options.mode=="show"?(l-Math.floor(r/2))*(u/r):0),top:s.top+f*(a/n)+(t.options.mode=="show"?(f-Math.floor(n/2))*(a/n):0),opacity:t.options.mode=="show"?0:1}).animate({left:s.left+l*(u/r)+(t.options.mode=="show"?0:(l-Math.floor(r/2))*(u/r)),top:s.top+f*(a/n)+(t.options.mode=="show"?0:(f-Math.floor(n/2))*(a/n)),opacity:t.options.mode=="show"?1:0},t.duration||500);setTimeout(function(){t.options.mode=="show"?i.css({visibility:"visible"}):i.css({visibility:"visible"}).hide(),t.callback&&t.callback.apply(i[0]),i.dequeue(),e("div.ui-effects-explode").remove()},t.duration||500)})}}(jQuery),function(e,t){e.effects.fade=function(t){return this.queue(function(){var n=e(this),r=e.effects.setMode(n,t.options.mode||"hide");n.animate({opacity:r},{queue:!1,duration:t.duration,easing:t.options.easing,complete:function(){t.callback&&t.callback.apply(this,arguments),n.dequeue()}})})}}(jQuery),function(e,t){e.effects.fold=function(t){return this.queue(function(){var n=e(this),r=["position","top","bottom","left","right"],i=e.effects.setMode(n,t.options.mode||"hide"),s=t.options.size||15,u=!!t.options.horizFirst,a=t.duration?t.duration/2:e.fx.speeds._default/2;e.effects.save(n,r),n.show();var f=e.effects.createWrapper(n).css({overflow:"hidden"}),l=i=="show"!=u,c=l?["width","height"]:["height","width"],h=l?[f.width(),f.height()]:[f.height(),f.width()],p=/([0-9]+)%/.exec(s);p&&(s=parseInt(p[1],10)/100*h[i=="hide"?0:1]),i=="show"&&f.css(u?{height:0,width:s}:{height:s,width:0});var d={},v={};d[c[0]]=i=="show"?h[0]:s,v[c[1]]=i=="show"?h[1]:0,f.animate(d,a,t.options.easing).animate(v,a,t.options.easing,function(){i=="hide"&&n.hide(),e.effects.restore(n,r),e.effects.removeWrapper(n),t.callback&&t.callback.apply(n[0],arguments),n.dequeue()})})}}(jQuery),function(e,t){e.effects.highlight=function(t){return this.queue(function(){var n=e(this),r=["backgroundImage","backgroundColor","opacity"],i=e.effects.setMode(n,t.options.mode||"show"),s={backgroundColor:n.css("backgroundColor")};i=="hide"&&(s.opacity=0),e.effects.save(n,r),n.show().css({backgroundImage:"none",backgroundColor:t.options.color||"#ffff99"}).animate(s,{queue:!1,duration:t.duration,easing:t.options.easing,complete:function(){i=="hide"&&n.hide(),e.effects.restore(n,r),i=="show"&&!e.support.opacity&&this.style.removeAttribute("filter"),t.callback&&t.callback.apply(this,arguments),n.dequeue()}})})}}(jQuery),function(e,t){e.effects.pulsate=function(t){return this.queue(function(){var n=e(this),r=e.effects.setMode(n,t.options.mode||"show");times=(t.options.times||5)*2-1,duration=t.duration?t.duration/2:e.fx.speeds._default/2,isVisible=n.is(":visible"),animateTo=0,isVisible||(n.css("opacity",0).show(),animateTo=1),(r=="hide"&&isVisible||r=="show"&&!isVisible)&&times--;for(var i=0;i<times;i++)n.animate({opacity:animateTo},duration,t.options.easing),animateTo=(animateTo+1)%2;n.animate({opacity:animateTo},duration,t.options.easing,function(){animateTo==0&&n.hide(),t.callback&&t.callback.apply(this,arguments)}),n.queue("fx",function(){n.dequeue()}).dequeue()})}}(jQuery),function(e,t){e.effects.puff=function(t){return this.queue(function(){var n=e(this),r=e.effects.setMode(n,t.options.mode||"hide"),i=parseInt(t.options.percent,10)||150,s=i/100,u={height:n.height(),width:n.width()};e.extend(t.options,{fade:!0,mode:r,percent:r=="hide"?i:100,from:r=="hide"?u:{height:u.height*s,width:u.width*s}}),n.effect("scale",t.options,t.duration,t.callback),n.dequeue()})},e.effects.scale=function(t){return this.queue(function(){var n=e(this),r=e.extend(!0,{},t.options),i=e.effects.setMode(n,t.options.mode||"effect"),s=parseInt(t.options.percent,10)||(parseInt(t.options.percent,10)==0?0:i=="hide"?0:100),u=t.options.direction||"both",a=t.options.origin;i!="effect"&&(r.origin=a||["middle","center"],r.restore=!0);var f={height:n.height(),width:n.width()};n.from=t.options.from||(i=="show"?{height:0,width:0}:f);var l={y:u!="horizontal"?s/100:1,x:u!="vertical"?s/100:1};n.to={height:f.height*l.y,width:f.width*l.x},t.options.fade&&(i=="show"&&(n.from.opacity=0,n.to.opacity=1),i=="hide"&&(n.from.opacity=1,n.to.opacity=0)),r.from=n.from,r.to=n.to,r.mode=i,n.effect("size",r,t.duration,t.callback),n.dequeue()})},e.effects.size=function(t){return this.queue(function(){var n=e(this),r=["position","top","bottom","left","right","width","height","overflow","opacity"],i=["position","top","bottom","left","right","overflow","opacity"],s=["width","height","overflow"],u=["fontSize"],a=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],f=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],l=e.effects.setMode(n,t.options.mode||"effect"),c=t.options.restore||!1,h=t.options.scale||"both",p=t.options.origin,d={height:n.height(),width:n.width()};n.from=t.options.from||d,n.to=t.options.to||d;if(p){var v=e.effects.getBaseline(p,d);n.from.top=(d.height-n.from.height)*v.y,n.from.left=(d.width-n.from.width)*v.x,n.to.top=(d.height-n.to.height)*v.y,n.to.left=(d.width-n.to.width)*v.x}var m={from:{y:n.from.height/d.height,x:n.from.width/d.width},to:{y:n.to.height/d.height,x:n.to.width/d.width}};if(h=="box"||h=="both")m.from.y!=m.to.y&&(r=r.concat(a),n.from=e.effects.setTransition(n,a,m.from.y,n.from),n.to=e.effects.setTransition(n,a,m.to.y,n.to)),m.from.x!=m.to.x&&(r=r.concat(f),n.from=e.effects.setTransition(n,f,m.from.x,n.from),n.to=e.effects.setTransition(n,f,m.to.x,n.to));(h=="content"||h=="both")&&m.from.y!=m.to.y&&(r=r.concat(u),n.from=e.effects.setTransition(n,u,m.from.y,n.from),n.to=e.effects.setTransition(n,u,m.to.y,n.to)),e.effects.save(n,c?r:i),n.show(),e.effects.createWrapper(n),n.css("overflow","hidden").css(n.from);if(h=="content"||h=="both")a=a.concat(["marginTop","marginBottom"]).concat(u),f=f.concat(["marginLeft","marginRight"]),s=r.concat(a).concat(f),n.find("*[width]").each(function(){child=e(this),c&&e.effects.save(child,s);var n={height:child.height(),width:child.width()};child.from={height:n.height*m.from.y,width:n.width*m.from.x},child.to={height:n.height*m.to.y,width:n.width*m.to.x},m.from.y!=m.to.y&&(child.from=e.effects.setTransition(child,a,m.from.y,child.from),child.to=e.effects.setTransition(child,a,m.to.y,child.to)),m.from.x!=m.to.x&&(child.from=e.effects.setTransition(child,f,m.from.x,child.from),child.to=e.effects.setTransition(child,f,m.to.x,child.to)),child.css(child.from),child.animate(child.to,t.duration,t.options.easing,function(){c&&e.effects.restore(child,s)})});n.animate(n.to,{queue:!1,duration:t.duration,easing:t.options.easing,complete:function(){n.to.opacity===0&&n.css("opacity",n.from.opacity),l=="hide"&&n.hide(),e.effects.restore(n,c?r:i),e.effects.removeWrapper(n),t.callback&&t.callback.apply(this,arguments),n.dequeue()}})})}}(jQuery),function(e,t){e.effects.shake=function(t){return this.queue(function(){var n=e(this),r=["position","top","bottom","left","right"],i=e.effects.setMode(n,t.options.mode||"effect"),s=t.options.direction||"left",u=t.options.distance||20,a=t.options.times||3,f=t.duration||t.options.duration||140;e.effects.save(n,r),n.show(),e.effects.createWrapper(n);var l=s=="up"||s=="down"?"top":"left",c=s=="up"||s=="left"?"pos":"neg",h={},p={},d={};h[l]=(c=="pos"?"-=":"+=")+u,p[l]=(c=="pos"?"+=":"-=")+u*2,d[l]=(c=="pos"?"-=":"+=")+u*2,n.animate(h,f,t.options.easing);for(var v=1;v<a;v++)n.animate(p,f,t.options.easing).animate(d,f,t.options.easing);n.animate(p,f,t.options.easing).animate(h,f/2,t.options.easing,function(){e.effects.restore(n,r),e.effects.removeWrapper(n),t.callback&&t.callback.apply(this,arguments)}),n.queue("fx",function(){n.dequeue()}),n.dequeue()})}}(jQuery),function(e,t){e.effects.slide=function(t){return this.queue(function(){var n=e(this),r=["position","top","bottom","left","right"],i=e.effects.setMode(n,t.options.mode||"show"),s=t.options.direction||"left";e.effects.save(n,r),n.show(),e.effects.createWrapper(n).css({overflow:"hidden"});var u=s=="up"||s=="down"?"top":"left",a=s=="up"||s=="left"?"pos":"neg",f=t.options.distance||(u=="top"?n.outerHeight({margin:!0}):n.outerWidth({margin:!0}));i=="show"&&n.css(u,a=="pos"?isNaN(f)?"-"+f:-f:f);var l={};l[u]=(i=="show"?a=="pos"?"+=":"-=":a=="pos"?"-=":"+=")+f,n.animate(l,{queue:!1,duration:t.duration,easing:t.options.easing,complete:function(){i=="hide"&&n.hide(),e.effects.restore(n,r),e.effects.removeWrapper(n),t.callback&&t.callback.apply(this,arguments),n.dequeue()}})})}}(jQuery),function(e,t){e.effects.transfer=function(t){return this.queue(function(){var n=e(this),r=e(t.options.to),i=r.offset(),s={top:i.top,left:i.left,height:r.innerHeight(),width:r.innerWidth()},u=n.offset(),a=e('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(t.options.className).css({top:u.top,left:u.left,height:n.innerHeight(),width:n.innerWidth(),position:"absolute"}).animate(s,t.duration,t.options.easing,function(){a.remove(),t.callback&&t.callback.apply(n[0],arguments),n.dequeue()})})}}(jQuery),pen.define("cdf/jquery.ui",function(){}),function(e){e.fn.bgIframe=e.fn.bgiframe=function(t){if(e.browser.msie&&/MSIE 6.0/.test(navigator.userAgent)){t=e.extend({top:"auto",left:"auto",width:"auto",height:"auto",opacity:!0,src:"javascript:false;"},t||{});var n=function(e){return e&&e.constructor==Number?e+"px":e},r='<iframe class="bgiframe"frameborder="0"tabindex="-1"src="'+t.src+'"'+'style="display:block;position:absolute;z-index:-1;'+(t.opacity!==!1?"filter:Alpha(Opacity='0');":"")+"top:"+(t.top=="auto"?"expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+'px')":n(t.top))+";"+"left:"+(t.left=="auto"?"expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+'px')":n(t.left))+";"+"width:"+(t.width=="auto"?"expression(this.parentNode.offsetWidth+'px')":n(t.width))+";"+"height:"+(t.height=="auto"?"expression(this.parentNode.offsetHeight+'px')":n(t.height))+";"+'"/>';return this.each(function(){e("> iframe.bgiframe",this).length==0&&this.insertBefore(document.createElement(r),this.firstChild)})}return this}}(jQuery),pen.define("cdf/jquery.bgiframe",function(){}),function(e){function t(t){var i=e.data(e(t).parents().andSelf().filter("ul.jd_menu")[0],"jdMenuSettings");e("> li",t).bind("mouseenter.jdmenu mouseleave.jdmenu",function(t){e(this).toggleClass("jdm_hover");var s=e("> ul",this);if(s.length==1){clearTimeout(this.$jdTimer);var o=t.type=="mouseenter",u=o?n:r;this.$jdTimer=setTimeout(function(){u(s[0],i.onAnimate,i.isVertical)},o?i.showDelay:i.hideDelay)}}).bind("click.jdmenu",function(t){var r=e("> ul",this);if(!(r.length!=1||i.disableLinks!=1&&!e(this).hasClass("accessible")))return n(r,i.onAnimate,i.isVertical),!1;if(t.target==this){var s=e("> a",t.target).not(".accessible");if(s.length>0){var o=s[0];o.onclick?e(o).trigger("click"):window.open(o.href,o.target||"_self")}}if(i.disableLinks||!i.disableLinks&&!e(this).parent().hasClass("jd_menu"))e(this).parent().jdMenuHide(),t.stopPropagation()}).find("> a").bind("focus.jdmenu blur.jdmenu",function(t){var n=e(this).parents("li:eq(0)");t.type=="focus"?n.addClass("jdm_hover"):n.removeClass("jdm_hover")}).filter(".accessible").bind("click.jdmenu",function(e){e.preventDefault()})}function n(n,i,s){var n=e(n);if(n.is(":visible"))return;n.bgiframe();var o=n.parent();n.trigger("jdMenuShow").positionBy({target:o[0],targetPos:s===!0||!o.parent().hasClass("jd_menu")?1:3,elementPos:0,hideAfterPosition:!0}),n.hasClass("jdm_events")||(n.addClass("jdm_events"),t(n)),o.addClass("jdm_active").siblings("li").find("> ul:eq(0):visible").each(function(){r(this)}),i===undefined?n.show():i.apply(n[0],[!0])}function r(t,n){var t=e(t);e(".bgiframe",t).remove(),t.filter(":not(.jd_menu)").find("> li > ul:eq(0):visible").each(function(){r(this)}).end(),n===undefined?t.hide():n.apply(t[0],[!1]),t.trigger("jdMenuHide").parents("li:eq(0)").removeClass("jdm_active jdm_hover").end().find("> li").removeClass("jdm_active jdm_hover")}e.fn.jdMenu=function(n){var n=e.extend({showDelay:200,hideDelay:500,disableLinks:!0},n);return e.isFunction(n.onAnimate)||(n.onAnimate=undefined),this.filter("ul.jd_menu").each(function(){e.data(this,"jdMenuSettings",e.extend({isVertical:e(this).hasClass("jd_menu_vertical")},n)),t(this)})},e.fn.jdMenuUnbind=function(){e("ul.jdm_events",this).unbind(".jdmenu").find("> a").unbind(".jdmenu")},e.fn.jdMenuHide=function(){return this.filter("ul").each(function(){r(this)})},e(window).bind("click.jdmenu",function(){e("ul.jd_menu ul:visible").jdMenuHide()})}(jQuery),$(function(){$("ul.jd_menu").jdMenu()}),pen.define("cdf/jquery.jdMenu",function(){}),function(e){var t=function(e,t,n,r){this.x1=e,this.x2=n,this.y1=t,this.y2=r};t.prototype.contains=function(e){return this.x1<=e.x1&&e.x2<=this.x2&&this.y1<=e.y1&&e.y2<=this.y2},t.prototype.transform=function(e,n){return new t(this.x1+e,this.y1+n,this.x2+e,this.y2+n)},e.fn.positionBy=function(n){var r=new Date;if(this.length==0)return this;var n=e.extend({target:null,targetPos:null,elementPos:null,x:null,y:null,positions:null,addClass:!1,force:!1,container:window,hideAfterPosition:!1},n);if(n.x!=null)var i=n.x,s=n.y,o=0,u=0;else var a=e(e(n.target)[0]),o=a.outerWidth(),u=a.outerHeight(),f=a.offset(),i=f.left,s=f.top;var l=i+o,c=s+u;return this.each(function(){var r=e(this);r.is(":visible")||r.css({left:-3e3,top:-3e3}).show();var o=r.outerWidth(),u=r.outerHeight(),a=[],f=[];a[0]=new t(l,s,l+o,s+u),f[0]=[1,7,4],a[1]=new t(l,c-u,l+o,c),f[1]=[0,6,4],a[2]=new t(l,c,l+o,c+u),f[2]=[1,3,10],a[3]=new t(l-o,c,l,c+u),f[3]=[1,6,10],a[4]=new t(i,c,i+o,c+u),f[4]=[1,6,9],a[5]=new t(i-o,c,i,c+u),f[5]=[6,4,9],a[6]=new t(i-o,c-u,i,c),f[6]=[7,1,4],a[7]=new t(i-o,s,i,s+u),f[7]=[6,0,4],a[8]=new t(i-o,s-u,i,s),f[8]=[7,9,4],a[9]=new t(i,s-u,i+o,s),f[9]=[0,7,4],a[10]=new t(l-o,s-u,l,s),f[10]=[0,7,3],a[11]=new t(l,s-u,l+o,s),f[11]=[0,10,3],a[12]=new t(l-o,s,l,s+u),f[12]=[13,7,10],a[13]=new t(l-o,c-u,l,c),f[13]=[12,6,3],a[14]=new t(i,c-u,i+o,c),f[14]=[15,1,4],a[15]=new t(i,s,i+o,s+u),f[15]=[14,0,9];if(n.positions!==null)var h=n.positions[0];else if(n.targetPos!=null&&n.elementPos!=null){var h=[];h[0]=[],h[0][0]=15,h[0][1]=7,h[0][2]=8,h[0][3]=9,h[1]=[],h[1][0]=0,h[1][1]=12,h[1][2]=10,h[1][3]=11,h[2]=[],h[2][0]=2,h[2][1]=3,h[2][2]=13,h[2][3]=1,h[3]=[],h[3][0]=4,h[3][1]=5,h[3][2]=6,h[3][3]=14;var h=h[n.targetPos][n.elementPos]}var p=a[h],d=h;if(!n.force){$window=e(window);var v=$window.scrollLeft(),m=$window.scrollTop(),g=new t(v,m,v+$window.width(),m+$window.height()),y;n.positions?y=n.positions:y=[h];var b=[];while(y.length>0){var w=y.shift();if(b[w])continue;b[w]=!0;if(!!g.contains(a[w])){p=a[w];break}n.positions===null&&(y=jQuery.merge(y,f[w]))}}r.parents().each(function(){var t=e(this);if(t.css("position")!="static"){var n=t.offset();return p=p.transform(-n.left,-n.top),!1}});var E={left:p.x1,top:p.y1};n.hideAfterPosition&&(E.display="none"),r.css(E),n.addClass&&r.removeClass("positionBy0 positionBy1 positionBy2 positionBy3 positionBy4 positionBy5 positionBy6 positionBy7 positionBy8 positionBy9 positionBy10 positionBy11 positionBy12 positionBy13 positionBy14 positionBy15").addClass("positionBy"+w)})}}(jQuery),pen.define("cdf/jquery.positionBy",function(){}),function(e){function u(n){if(t.parent)return;t.parent=e('<div id="'+n.id+'"><h3></h3><div class="body"></div><div class="url"></div></div>').appendTo(document.body).hide(),e.fn.bgiframe&&t.parent.bgiframe(),t.title=e("h3",t.parent),t.body=e("div.body",t.parent),t.url=e("div.url",t.parent)}function a(t){return e.data(t,"tooltip")}function f(t){a(this).delay?i=setTimeout(c,a(this).delay):c(),o=!!a(this).track,e(document.body).bind("mousemove",h),h(t)}function l(){if(e.tooltip.blocked||this==n||!this.tooltipText&&!a(this).bodyHandler)return;n=this,r=this.tooltipText;if(a(this).bodyHandler){t.title.hide();var i=a(this).bodyHandler.call(this);i.nodeType||i.jquery?t.body.empty().append(i):t.body.html(i),t.body.show()}else if(a(this).showBody){var s=r.split(a(this).showBody);t.title.html(s.shift()).show(),t.body.empty();for(var o=0,u;u=s[o];o++)o>0&&t.body.append("<br/>"),t.body.append(u);t.body.hideWhenEmpty()}else t.title.html(r).show(),t.body.hide();a(this).showURL&&e(this).url()?t.url.html(e(this).url().replace("http://","")).show():t.url.hide(),t.parent.addClass(a(this).extraClass),a(this).fixPNG&&t.parent.fixPNG(),f.apply(this,arguments)}function c(){i=null,(!s||!e.fn.bgiframe)&&a(n).fade?t.parent.is(":animated")?t.parent.stop().show().fadeTo(a(n).fade,n.tOpacity):t.parent.is(":visible")?t.parent.fadeTo(a(n).fade,n.tOpacity):t.parent.fadeIn(a(n).fade):t.parent.show(),h()}function h(r){if(e.tooltip.blocked)return;if(r&&r.target.tagName=="OPTION")return;!o&&t.parent.is(":visible")&&e(document.body).unbind("mousemove",h);if(n==null){e(document.body).unbind("mousemove",h);return}t.parent.removeClass("viewport-right").removeClass("viewport-bottom");var i=t.parent[0].offsetLeft,s=t.parent[0].offsetTop;if(r){i=r.pageX+a(n).left,s=r.pageY+a(n).top;var u="auto";a(n).positionLeft&&(u=e(window).width()-i,i="auto"),t.parent.css({left:i,right:u,top:s})}var f=p(),l=t.parent[0];f.x+f.cx<l.offsetLeft+l.offsetWidth&&(i-=l.offsetWidth+20+a(n).left,t.parent.css({left:i+"px"}).addClass("viewport-right")),f.y+f.cy<l.offsetTop+l.offsetHeight&&(s-=l.offsetHeight+20+a(n).top,t.parent.css({top:s+"px"}).addClass("viewport-bottom"))}function p(){return{x:e(window).scrollLeft(),y:e(window).scrollTop(),cx:e(window).width(),cy:e(window).height()}}function d(r){function u(){t.parent.removeClass(o.extraClass).hide().css("opacity","")}if(e.tooltip.blocked)return;i&&clearTimeout(i),n=null;var o=a(this);(!s||!e.fn.bgiframe)&&o.fade?t.parent.is(":animated")?t.parent.stop().fadeTo(o.fade,0,u):t.parent.stop().fadeOut(o.fade,u):u(),a(this).fixPNG&&t.parent.unfixPNG()}var t={},n,r,i,s=e.browser.msie&&/MSIE\s(5\.5|6\.)/.test(navigator.userAgent),o=!1;e.tooltip={blocked:!1,defaults:{delay:200,fade:!1,showURL:!0,extraClass:"",top:15,left:15,id:"tooltip"},block:function(){e.tooltip.blocked=!e.tooltip.blocked}},e.fn.extend({tooltip:function(n){return n=e.extend({},e.tooltip.defaults,n),u(n),this.each(function(){e.data(this,"tooltip",n),this.tOpacity=t.parent.css("opacity"),this.tooltipText=this.title,e(this).removeAttr("title"),this.alt=""}).mouseover(l).mouseout(d).click(d)},fixPNG:s?function(){return this.each(function(){var t=e(this).css("backgroundImage");t.match(/^url\(["']?(.*\.png)["']?\)$/i)&&(t=RegExp.$1,e(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+t+"')"}).each(function(){var t=e(this).css("position");t!="absolute"&&t!="relative"&&e(this).css("position","relative")}))})}:function(){return this},unfixPNG:s?function(){return this.each(function(){e(this).css({filter:"",backgroundImage:""})})}:function(){return this},hideWhenEmpty:function(){return this.each(function(){e(this)[e(this).html()?"show":"hide"]()})},url:function(){return this.attr("href")||this.attr("src")}})}(jQuery),pen.define("cdf/jquery.tooltip",function(){}),function(e){function u(n,u){var f=n==window,c=u&&u.message!==undefined?u.message:undefined;u=e.extend({},e.blockUI.defaults,u||{}),u.overlayCSS=e.extend({},e.blockUI.defaults.overlayCSS,u.overlayCSS||{});var v=e.extend({},e.blockUI.defaults.css,u.css||{}),m=e.extend({},e.blockUI.defaults.themedCSS,u.themedCSS||{});c=c===undefined?u.message:c,f&&s&&a(window,{fadeOut:0});if(c&&typeof c!="string"&&(c.parentNode||c.jquery)){var g=c.jquery?c[0]:c,y={};e(n).data("blockUI.history",y),y.el=g,y.parent=g.parentNode,y.display=g.style.display,y.position=g.style.position,y.parent&&y.parent.removeChild(g)}var b=u.baseZ,w=e.browser.msie||u.forceIframe?e('<iframe class="blockUI" style="z-index:'+b++ +';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+u.iframeSrc+'"></iframe>'):e('<div class="blockUI" style="display:none"></div>'),E=e('<div class="blockUI blockOverlay" style="z-index:'+b++ +';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>'),S,x;u.theme&&f?x='<div class="blockUI blockMsg blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+b+';display:none;position:fixed">'+'<div class="ui-widget-header ui-dialog-titlebar blockTitle">'+(u.title||"&nbsp;")+"</div>"+'<div class="ui-widget-content ui-dialog-content"></div>'+"</div>":u.theme?x='<div class="blockUI blockMsg blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+b+';display:none;position:absolute">'+'<div class="ui-widget-header ui-dialog-titlebar blockTitle">'+(u.title||"&nbsp;")+"</div>"+'<div class="ui-widget-content ui-dialog-content"></div>'+"</div>":f?x='<div class="blockUI blockMsg blockPage" style="z-index:'+b+';display:none;position:fixed"></div>':x='<div class="blockUI blockMsg blockElement" style="z-index:'+b+';display:none;position:absolute"></div>',S=e(x),c&&(u.theme?(S.css(m),S.addClass("ui-widget-content")):S.css(v)),(!u.applyPlatformOpacityRules||!e.browser.mozilla||!/Linux/.test(navigator.platform))&&E.css(u.overlayCSS),E.css("position",f?"fixed":"absolute"),(e.browser.msie||u.forceIframe)&&w.css("opacity",0);var T=[w,E,S],N=f?e("body"):e(n);e.each(T,function(){this.appendTo(N)}),u.theme&&u.draggable&&e.fn.draggable&&S.draggable({handle:".ui-dialog-titlebar",cancel:"li"});var C=r&&(!e.boxModel||e("object,embed",f?null:n).length>0);if(i||C){f&&u.allowBodyStretch&&e.boxModel&&e("html,body").css("height","100%");if((i||!e.boxModel)&&!f)var k=d(n,"borderTopWidth"),L=d(n,"borderLeftWidth"),A=k?"(0 - "+k+")":0,O=L?"(0 - "+L+")":0;e.each([w,E,S],function(e,t){var n=t[0].style;n.position="absolute";if(e<2)f?n.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.boxModel?0:"+u.quirksmodeOffsetHack+') + "px"'):n.setExpression("height",'this.parentNode.offsetHeight + "px"'),f?n.setExpression("width",'jQuery.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):n.setExpression("width",'this.parentNode.offsetWidth + "px"'),O&&n.setExpression("left",O),A&&n.setExpression("top",A);else if(u.centerY)f&&n.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"'),n.marginTop=0;else if(!u.centerY&&f){var r=u.css&&u.css.top?parseInt(u.css.top):0,i="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+r+') + "px"';n.setExpression("top",i)}})}c&&(u.theme?S.find(".ui-widget-content").append(c):S.append(c),(c.jquery||c.nodeType)&&e(c).show()),(e.browser.msie||u.forceIframe)&&u.showOverlay&&w.show();if(u.fadeIn){var M=u.onBlock?u.onBlock:t,_=u.showOverlay&&!c?M:t,D=c?M:t;u.showOverlay&&E._fadeIn(u.fadeIn,_),c&&S._fadeIn(u.fadeIn,D)}else u.showOverlay&&E.show(),c&&S.show(),u.onBlock&&u.onBlock();l(1,n,u),f?(s=S[0],o=e(":input:enabled:visible",s),u.focusInput&&setTimeout(h,20)):p(S[0],u.centerX,u.centerY);if(u.timeout){var P=setTimeout(function(){f?e.unblockUI(u):e(n).unblock(u)},u.timeout);e(n).data("blockUI.timeout",P)}}function a(t,n){var r=t==window,i=e(t),u=i.data("blockUI.history"),a=i.data("blockUI.timeout");a&&(clearTimeout(a),i.removeData("blockUI.timeout")),n=e.extend({},e.blockUI.defaults,n||{}),l(0,t,n);var c;r?c=e("body").children().filter(".blockUI").add("body > .blockUI"):c=e(".blockUI",t),r&&(s=o=null),n.fadeOut?(c.fadeOut(n.fadeOut),setTimeout(function(){f(c,u,n,t)},n.fadeOut)):f(c,u,n,t)}function f(t,n,r,i){t.each(function(e,t){this.parentNode&&this.parentNode.removeChild(this)}),n&&n.el&&(n.el.style.display=n.display,n.el.style.position=n.position,n.parent&&n.parent.appendChild(n.el),e(i).removeData("blockUI.history")),typeof r.onUnblock=="function"&&r.onUnblock(i,r)}function l(t,n,r){var i=n==window,o=e(n);if(!t&&(i&&!s||!i&&!o.data("blockUI.isBlocked")))return;i||o.data("blockUI.isBlocked",t);if(!r.bindEvents||t&&!r.showOverlay)return;var u="mousedown mouseup keydown keypress";t?e(document).bind(u,r,c):e(document).unbind(u,c)}function c(t){if(t.keyCode&&t.keyCode==9&&s&&t.data.constrainTabKey){var n=o,r=!t.shiftKey&&t.target==n[n.length-1],i=t.shiftKey&&t.target==n[0];if(r||i)return setTimeout(function(){h(i)},10),!1}return e(t.target).parents("div.blockMsg").length>0?!0:e(t.target).parents().children().filter("div.blockUI").length==0}function h(e){if(!o)return;var t=o[e===!0?o.length-1:0];t&&t.focus()}function p(e,t,n){var r=e.parentNode,i=e.style,s=(r.offsetWidth-e.offsetWidth)/2-d(r,"borderLeftWidth"),o=(r.offsetHeight-e.offsetHeight)/2-d(r,"borderTopWidth");t&&(i.left=s>0?s+"px":"0"),n&&(i.top=o>0?o+"px":"0")}function d(t,n){return parseInt(e.css(t,n))||0}if(/1\.(0|1|2)\.(0|1|2)/.test(e.fn.jquery)||/^1.1/.test(e.fn.jquery)){alert("blockUI requires jQuery v1.2.3 or later!  You are using v"+e.fn.jquery);return}e.fn._fadeIn=e.fn.fadeIn;var t=function(){},n=document.documentMode||0,r=e.browser.msie&&(e.browser.version<8&&!n||n<8),i=e.browser.msie&&/MSIE 6.0/.test(navigator.userAgent)&&!n;e.blockUI=function(e){u(window,e)},e.unblockUI=function(e){a(window,e)},e.growlUI=function(t,n,r,i){var s=e('<div class="growlUI"></div>');t&&s.append("<h1>"+t+"</h1>"),n&&s.append("<h2>"+n+"</h2>"),r==undefined&&(r=3e3),e.blockUI({message:s,fadeIn:700,fadeOut:1e3,centerY:!1,timeout:r,showOverlay:!1,onUnblock:i,css:e.blockUI.defaults.growlCSS})},e.fn.block=function(t){return this.unblock({fadeOut:0}).each(function(){e.css(this,"position")=="static"&&(this.style.position="relative"),e.browser.msie&&(this.style.zoom=1),u(this,t)})},e.fn.unblock=function(e){return this.each(function(){a(this,e)})},e.blockUI.version=2.33,e.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:!0,theme:!1,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:.6,cursor:"wait"},growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:!1,baseZ:1e3,centerX:!0,centerY:!0,allowBodyStretch:!0,bindEvents:!0,constrainTabKey:!0,fadeIn:200,fadeOut:400,timeout:0,showOverlay:!0,focusInput:!0,applyPlatformOpacityRules:!0,onBlock:null,onUnblock:null,quirksmodeOffsetHack:4};var s=null,o=[]}(jQuery),pen.define("cdf/jquery.blockUI",function(){}),jQuery.fn.extend({reverse:function(e){var t=$(this).data("events"),n=new Array;for(var r in t[e])n.unshift(t[e][r]);return t[e]=n,this},stack:function(e,t,n){return this.reverse(e).bind(e,t,n).reverse(e)},hover:function(e,t,n){return n?this.stack("mouseenter",e).stack("mouseout",t):this.bind("mouseenter",e).bind("mouseout",t)}}),jQuery.each("blur,focus,load,resize,scroll,unload,click,dblclick,mousedown,mouseup,mousemove,mouseover,mouseout,change,select,submit,keydown,keypress,keyup,error".split(","),function(e,t){jQuery.fn[t]=function(e,n){return e?n?this.stack(t,e):this.bind(t,e):this.trigger(t)}}),pen.define("cdf/jquery.eventstack",function(){});var Base=function(){};Base.extend=function(e,t){var n=Base.prototype.extend;Base._prototyping=!0;var r=new this;n.call(r,e),r.base=function(){},delete Base._prototyping;var i=r.constructor,s=r.constructor=function(){if(!Base._prototyping)if(this._constructing||this.constructor==s)this._constructing=!0,i.apply(this,arguments),delete this._constructing;else if(arguments[0]!=null)return(arguments[0].extend||n).call(arguments[0],r)};return s.ancestor=this,s.extend=this.extend,s.forEach=this.forEach,s.implement=this.implement,s.prototype=r,s.toString=this.toString,s.valueOf=function(e){return e=="object"?s:i.valueOf()},n.call(s,t),typeof s.init=="function"&&s.init(),s},Base.prototype={extend:function(e,t){if(arguments.length>1){var n=this[e];if(n&&typeof t=="function"&&(!n.valueOf||n.valueOf()!=t.valueOf())&&/\bbase\b/.test(t)){var r=t.valueOf();t=function(){var e=this.base||Base.prototype.base;this.base=n;var t=r.apply(this,arguments);return this.base=e,t},t.valueOf=function(e){return e=="object"?t:r},t.toString=Base.toString}this[e]=t}else if(e){var i=Base.prototype.extend;!Base._prototyping&&typeof this!="function"&&(i=this.extend||i);var s={toSource:null},o=["constructor","toString","valueOf"],u=Base._prototyping?0:1;while(a=o[u++])e[a]!=s[a]&&i.call(this,a,e[a]);for(var a in e)s[a]||i.call(this,a,e[a])}return this}},Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(e,t,n){for(var r in e)this.prototype[r]===undefined&&t.call(n,e[r],r,e)},implement:function(){for(var e=0;e<arguments.length;e++)typeof arguments[e]=="function"?arguments[e](this.prototype):this.prototype.extend(arguments[e]);return this},toString:function(){return String(this.valueOf())}}),pen.define("cdf/Base",function(){}),function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){if(e instanceof x)return e;if(!(this instanceof x))return new x(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.5.2";var T=x.each=x.forEach=function(e,t,r){if(e==null)return;if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else{var o=x.keys(e);for(var i=0,s=o.length;i<s;i++)if(t.call(r,e[o[i]],o[i],e)===n)return}};x.map=x.collect=function(e,t,n){var r=[];return e==null?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},x.filter=x.select=function(e,t,n){var r=[];return e==null?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return e==null?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return e==null?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};x.contains=x.include=function(e,t){return e==null?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,n){return x.isEmpty(t)?n?void 0:[]:x[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-Infinity;var r={computed:-Infinity,value:-Infinity};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>r.computed&&(r={value:e,computed:o})}),r.value},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return Infinity;var r={computed:Infinity,value:Infinity};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r},x.sample=function(e,t,n){return arguments.length<2||n?e[x.random(e.length-1)]:x.shuffle(e).slice(0,Math.max(0,t))};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,n){var r=k(t);return x.pluck(x.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index-t.index}),"value")};var L=function(e){return function(t,n,r){var i={},s=n==null?x.identity:k(n);return T(t,function(n,o){var u=s.call(r,n,o,t);e(i,u,n)}),i}};x.groupBy=L(function(e,t,n){(x.has(e,t)?e[t]:e[t]=[]).push(n)}),x.indexBy=L(function(e,t,n){e[t]=n}),x.countBy=L(function(e,t){x.has(e,t)?e[t]++:e[t]=1}),x.sortedIndex=function(e,t,n,r){n=n==null?x.identity:k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return e==null?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return e==null?void 0:t==null||n?e[0]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},x.last=function(e,t,n){return e==null?void 0:t==null||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return t&&x.every(e,x.isArray)?a.apply(n,e):(T(e,function(e){x.isArray(e)||x.isArguments(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n)};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){if(t?!r||o[o.length-1]!==n:!x.contains(o,n))o.push(n),s.push(e[r])}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){var e=x.max(x.pluck(arguments,"length").concat(0)),t=new Array(e);for(var n=0;n<e;n++)t[n]=x.pluck(arguments,""+n);return t},x.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(S&&e.bind===S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){return e.apply(this,t.concat(u.call(arguments)))}},x.bindAll=function(e){var t=u.call(arguments,1);if(t.length===0)throw new Error("bindAll must be passed function names");return T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:new Date,o=null,s=e.apply(r,i)};return function(){var f=new Date;!u&&n.leading===!1&&(u=f);var l=t-(f-u);return r=this,i=arguments,l<=0?(clearTimeout(o),o=null,u=f,s=e.apply(r,i)):!o&&n.trailing!==!1&&(o=setTimeout(a,l)),s}},x.debounce=function(e,t,n){var r,i,s,o,u;return function(){s=this,i=arguments,o=new Date;var a=function(){var f=new Date-o;f<t?r=setTimeout(a,t-f):(r=null,n||(u=e.apply(s,i)))},f=n&&!r;return r||(r=setTimeout(a,t)),f&&(u=e.apply(s,i)),u}},x.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},x.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},x.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},x.keys=E||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)x.has(e,n)&&t.push(n);return t},x.values=function(e){var t=x.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=e[t[i]];return r},x.pairs=function(e){var t=x.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},x.invert=function(e){var t={},n=x.keys(e);for(var r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;var o=e.constructor,u=t.constructor;if(o!==u&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(u)&&u instanceof u))return!1;n.push(e),r.push(t);var a=0,l=!0;if(i=="[object Array]"){a=e.length,l=a==t.length;if(l)while(a--)if(!(l=M(e[a],t[a],n,r)))break}else{for(var c in e)if(x.has(e,c)){a++;if(!(l=x.has(t,c)&&M(e[c],t[c],n,r)))break}if(l){for(c in t)if(x.has(t,c)&&!(a--))break;l=!a}}return n.pop(),r.pop(),l};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(e==null)return!0;if(x.isArray(e)||x.isString(e))return e.length===0;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&e.nodeType===1},x.isArray=w||function(e){return f.call(e)=="[object Array]"},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),typeof /./!="function"&&(x.isFunction=function(e){return typeof e=="function"}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||f.call(e)=="[object Boolean]"},x.isNull=function(e){return e===null},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,n){var r=Array(Math.max(0,e));for(var i=0;i<e;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};_.unescape=x.invert(_.escape);var D={escape:new RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(e==null)return void 0;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=++P+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(j,function(e){return"\\"+B[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),pen.define("cdf/underscore",function(){}),function(){var e=this,t=e.Backbone,n=[],r=n.push,i=n.slice,s=n.splice,o;typeof exports!="undefined"?o=exports:o=e.Backbone={},o.VERSION="1.1.0";var u=e._;!u&&typeof require!="undefined"&&(u=require("underscore")),o.$=e.jQuery||e.Zepto||e.ender||e.$,o.noConflict=function(){return e.Backbone=t,this},o.emulateHTTP=!1,o.emulateJSON=!1;var a=o.Events={on:function(e,t,n){if(!l(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!l(this,"once",e,[t,n])||!t)return this;var r=this,i=u.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n)},off:function(e,t,n){var r,i,s,o,a,f,c,h;if(!this._events||!l(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;o=e?[e]:u.keys(this._events);for(a=0,f=o.length;a<f;a++){e=o[a];if(s=this._events[e]){this._events[e]=r=[];if(t||n)for(c=0,h=s.length;c<h;c++)i=s[c],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=i.call(arguments,1);if(!l(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&c(n,t),r&&c(r,arguments),this},stopListening:function(e,t,n){var r=this._listeningTo;if(!r)return this;var i=!t&&!n;!n&&typeof t=="object"&&(n=this),e&&((r={})[e._listenId]=e);for(var s in r)e=r[s],e.off(t,n,this),(i||u.isEmpty(e._events))&&delete this._listeningTo[s];return this}},f=/\s+/,l=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(f.test(n)){var s=n.split(f);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},c=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t)}},h={listenTo:"on",listenToOnce:"once"};u.each(h,function(e,t){a[t]=function(t,n,r){var i=this._listeningTo||(this._listeningTo={}),s=t._listenId||(t._listenId=u.uniqueId("l"));return i[s]=t,!r&&typeof n=="object"&&(r=this),t[e](n,r,this),this}}),a.bind=a.on,a.unbind=a.off,u.extend(o,a);var p=o.Model=function(e,t){var n=e||{};t||(t={}),this.cid=u.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{}),n=u.defaults({},n,u.result(this,"defaults")),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};u.extend(p.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return u.clone(this.attributes)},sync:function(){return o.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return u.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,s,o,a,f,l,c;if(e==null)return this;typeof e=="object"?(i=e,n=t):(i={})[e]=t,n||(n={});if(!this._validate(i,n))return!1;s=n.unset,a=n.silent,o=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=u.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)t=i[r],u.isEqual(c[r],t)||o.push(r),u.isEqual(l[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete c[r]:c[r]=t;if(!a){o.length&&(this._pending=!0);for(var h=0,p=o.length;h<p;h++)this.trigger("change:"+o[h],this,c[o[h]],n)}if(f)return this;if(!a)while(this._pending)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,u.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,u.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!u.isEmpty(this.changed):u.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?u.clone(this.changed):!1;var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var i in e){if(u.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return u.clone(this._previousAttributes)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r){if(!t.set(t.parse(r,e),e))return!1;n&&n(t,r,e),t.trigger("sync",t,r,e)},F(this,e),this.sync("read",this,e)},save:function(e,t,n){var r,i,s,o=this.attributes;e==null||typeof e=="object"?(r=e,n=t):(r={})[e]=t,n=u.extend({validate:!0},n);if(r&&!n.wait){if(!this.set(r,n))return!1}else if(!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=u.extend({},o,r)),n.parse===void 0&&(n.parse=!0);var a=this,f=n.success;return n.success=function(e){a.attributes=o;var t=a.parse(e,n);n.wait&&(t=u.extend(r||{},t));if(u.isObject(t)&&!a.set(t,n))return!1;f&&f(a,e,n),a.trigger("sync",a,e,n)},F(this,n),i=this.isNew()?"create":n.patch?"patch":"update",i==="patch"&&(n.attrs=r),s=this.sync(i,this,n),r&&n.wait&&(this.attributes=o),s},destroy:function(e){e=e?u.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(i){(e.wait||t.isNew())&&r(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)};if(this.isNew())return e.success(),!1;F(this,e);var i=this.sync("delete",this,e);return e.wait||r(),i},url:function(){var e=u.result(this,"urlRoot")||u.result(this.collection,"url")||j();return this.isNew()?e:e+(e.charAt(e.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(e){return this._validate({},u.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=u.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,u.extend(t,{validationError:n})),!1):!0}});var d=["keys","values","pairs","invert","pick","omit"];u.each(d,function(e){p.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.attributes),u[e].apply(u,t)}});var v=o.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,u.extend({silent:!0},t))},m={add:!0,remove:!0,merge:!0},g={add:!0,remove:!1};u.extend(v.prototype,a,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return o.sync.apply(this,arguments)},add:function(e,t){return this.set(e,u.extend({merge:!1},t,g))},remove:function(e,t){var n=!u.isArray(e);e=n?[e]:u.clone(e),t||(t={});var r,i,s,o;for(r=0,i=e.length;r<i;r++){o=e[r]=this.get(e[r]);if(!o)continue;delete this._byId[o.id],delete this._byId[o.cid],s=this.indexOf(o),this.models.splice(s,1),this.length--,t.silent||(t.index=s,o.trigger("remove",o,this,t)),this._removeReference(o)}return n?e[0]:e},set:function(e,t){t=u.defaults({},t,m),t.parse&&(e=this.parse(e,t));var n=!u.isArray(e);e=n?e?[e]:[]:u.clone(e);var r,i,s,o,a,f,l,c=t.at,h=this.model,d=this.comparator&&c==null&&t.sort!==!1,v=u.isString(this.comparator)?this.comparator:null,g=[],y=[],b={},w=t.add,E=t.merge,S=t.remove,x=!d&&w&&S?[]:!1;for(r=0,i=e.length;r<i;r++){a=e[r],a instanceof p?s=o=a:s=a[h.prototype.idAttribute];if(f=this.get(s))S&&(b[f.cid]=!0),E&&(a=a===o?o.attributes:a,t.parse&&(a=f.parse(a,t)),f.set(a,t),d&&!l&&f.hasChanged(v)&&(l=!0)),e[r]=f;else if(w){o=e[r]=this._prepareModel(a,t);if(!o)continue;g.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,o.id!=null&&(this._byId[o.id]=o)}x&&x.push(f||o)}if(S){for(r=0,i=this.length;r<i;++r)b[(o=this.models[r]).cid]||y.push(o);y.length&&this.remove(y,t)}if(g.length||x&&x.length){d&&(l=!0),this.length+=g.length;if(c!=null)for(r=0,i=g.length;r<i;r++)this.models.splice(c+r,0,g[r]);else{x&&(this.models.length=0);var T=x||g;for(r=0,i=T.length;r<i;r++)this.models.push(T[r])}}l&&this.sort({silent:!0});if(!t.silent){for(r=0,i=g.length;r<i;r++)(o=g[r]).trigger("add",o,this,t);(l||x&&x.length)&&this.trigger("sort",this,t)}return n?e[0]:e},reset:function(e,t){t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return t.previousModels=this.models,this._reset(),e=this.add(e,u.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,u.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,u.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return i.apply(this.models,arguments)},get:function(e){return e==null?void 0:this._byId[e.id]||this._byId[e.cid]||this._byId[e]},at:function(e){return this.models[e]},where:function(e,t){return u.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),u.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(u.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return u.invoke(this.models,"get",e)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,n=this;return e.success=function(r){var i=e.reset?"reset":"set";n[i](r,e),t&&t(n,r,e),n.trigger("sync",n,r,e)},F(this,e),this.sync("read",this,e)},create:function(e,t){t=t?u.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(e,t,i){i.wait&&n.add(e,i),r&&r(e,t,i)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t=t?u.clone(t):{},t.collection=this;var n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];u.each(y,function(e){v.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.models),u[e].apply(u,t)}});var b=["groupBy","countBy","sortBy"];u.each(b,function(e){v.prototype[e]=function(t,n){var r=u.isFunction(t)?t:function(e){return e.get(t)};return u[e](this.models,r,n)}});var w=o.View=function(e){this.cid=u.uniqueId("view"),e||(e={}),u.extend(this,u.pick(e,S)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},E=/^(\S+)\s*(.*)$/,S=["model","collection","el","id","attributes","className","tagName","events"];u.extend(w.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o.$?e:o.$(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=u.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];u.isFunction(n)||(n=this[e[t]]);if(!n)continue;var r=t.match(E),i=r[1],s=r[2];n=u.bind(n,this),i+=".delegateEvents"+this.cid,s===""?this.$el.on(i,n):this.$el.on(i,s,n)}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(!this.el){var e=u.extend({},u.result(this,"attributes"));this.id&&(e.id=u.result(this,"id")),this.className&&(e["class"]=u.result(this,"className"));var t=o.$("<"+u.result(this,"tagName")+">").attr(e);this.setElement(t,!1)}else this.setElement(u.result(this,"el"),!1)}}),o.sync=function(e,t,n){var r=T[e];u.defaults(n||(n={}),{emulateHTTP:o.emulateHTTP,emulateJSON:o.emulateJSON});var i={type:r,dataType:"json"};n.url||(i.url=u.result(t,"url")||j()),n.data==null&&t&&(e==="create"||e==="update"||e==="patch")&&(i.contentType="application/json",i.data=JSON.stringify(n.attrs||t.toJSON(n))),n.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{});if(n.emulateHTTP&&(r==="PUT"||r==="DELETE"||r==="PATCH")){i.type="POST",n.emulateJSON&&(i.data._method=r);var s=n.beforeSend;n.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r);if(s)return s.apply(this,arguments)}}i.type!=="GET"&&!n.emulateJSON&&(i.processData=!1),i.type==="PATCH"&&x&&(i.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=n.xhr=o.ajax(u.extend(i,n));return t.trigger("request",t,a,n),a};var x=typeof window!="undefined"&&!!window.ActiveXObject&&(!window.XMLHttpRequest||!(new XMLHttpRequest).dispatchEvent),T={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};o.ajax=function(){return o.$.ajax.apply(o.$,arguments)};var N=o.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,k=/(\(\?)?:\w+/g,L=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;u.extend(N.prototype,a,{initialize:function(){},route:function(e,t,n){u.isRegExp(e)||(e=this._routeToRegExp(e)),u.isFunction(t)&&(n=t,t=""),n||(n=this[t]);var r=this;return o.history.route(e,function(i){var s=r._extractParameters(e,i);n&&n.apply(r,s),r.trigger.apply(r,["route:"+t].concat(s)),r.trigger("route",t,s),o.history.trigger("route",r,t,s)}),this},navigate:function(e,t){return o.history.navigate(e,t),this},_bindRoutes:function(){if(!this.routes)return;this.routes=u.result(this,"routes");var e,t=u.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(A,"\\$&").replace(C,"(?:$1)?").replace(k,function(e,t){return t?e:"([^/]+)"}).replace(L,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return u.map(n,function(e){return e?decodeURIComponent(e):null})}});var O=o.History=function(){this.handlers=[],u.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},M=/^[#\/]|\s+$/g,_=/^\/+|\/+$/g,D=/msie [\w.]+/,P=/\/$/,H=/[?#].*$/;O.started=!1,u.extend(O.prototype,a,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(P,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace(M,"")},start:function(e){if(O.started)throw new Error("Backbone.history has already been started");O.started=!0,this.options=u.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),n=document.documentMode,r=D.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);this.root=("/"+this.root+"/").replace(_,"/"),r&&this._wantsHashChange&&(this.iframe=o.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=this.location,s=i.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&s&&i.hash&&(this.fragment=this.getHash().replace(M,""),this.history.replaceState({},document.title,this.root+this.fragment+i.search))}if(!this.options.silent)return this.loadUrl()},stop:function(){o.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),O.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),u.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(e,t){if(!O.started)return!1;if(!t||t===!0)t={trigger:!!t};var n=this.root+(e=this.getFragment(e||""));e=e.replace(H,"");if(this.fragment===e)return;this.fragment=e,e===""&&n!=="/"&&(n=n.slice(0,-1));if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}if(t.trigger)return this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),o.history=new O;var B=function(e,t){var n=this,r;e&&u.has(e,"constructor")?r=e.constructor:r=function(){return n.apply(this,arguments)},u.extend(r,n,t);var i=function(){this.constructor=r};return i.prototype=n.prototype,r.prototype=new i,e&&u.extend(r.prototype,e),r.__super__=n.prototype,r};p.extend=v.extend=N.extend=w.extend=O.extend=B;var j=function(){throw new Error('A "url" property or function must be specified')},F=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}}}.call(this),pen.define("cdf/backbone",function(){});var Mustache=typeof module!="undefined"&&module.exports||{};(function(e){function a(e){return u.test(e)}function p(e){return String(e).replace(/&(?!\w+;)|[<>"']/g,function(e){return h[e]||e})}function d(e,t,n,r){r=r||"<template>";var i=t.split("\n"),s=Math.max(n-3,0),o=Math.min(i.length,n+3),u=i.slice(s,o),a;for(var f=0,l=u.length;f<l;++f)a=f+s+1,u[f]=(a===n?" >> ":"    ")+u[f];return e.template=t,e.line=n,e.file=r,e.message=[r+":"+n,u.join("\n"),"",e.message].join("\n"),e}function v(e,t,n){if(e===".")return t[t.length-1];var r=e.split("."),i=r.length-1,s=r[i],o,u,a=t.length,f,l;while(a){l=t.slice(0),u=t[--a],f=0;while(f<i){u=u[r[f++]];if(u==null)break;l.push(u)}if(u&&typeof u=="object"&&s in u){o=u[s];break}}return typeof o=="function"&&(o=o.call(l[l.length-1])),o==null?n:o}function m(e,t,n,r){var i="",u=v(e,t);if(r){if(u==null||u===!1||s(u)&&u.length===0)i+=n()}else if(s(u))o(u,function(e){t.push(e),i+=n(),t.pop()});else if(typeof u=="object")t.push(u),i+=n(),t.pop();else if(typeof u=="function"){var a=t[t.length-1],f=function(e){return S(e,a)};i+=u.call(a,n(),f)||""}else u&&(i+=n());return i}function g(t,n){n=n||{};var r=n.tags||e.tags,i=r[0],s=r[r.length-1],o=['var buffer = "";',"\nvar line = 1;","\ntry {",'\nbuffer += "'],u=[],l=!1,c=!1,h=function(){if(l&&!c&&!n.space)while(u.length)o.splice(u.pop(),1);else u=[];l=!1,c=!1},p=[],v,m,g,y=function(e){r=f(e).split(/\s+/),m=r[0],g=r[r.length-1]},b=function(e){o.push('";',v,'\nvar partial = partials["'+f(e)+'"];',"\nif (partial) {","\n  buffer += render(partial,stack[stack.length - 1],partials);","\n}",'\nbuffer += "')},w=function(e,r){var i=f(e);if(i==="")throw d(new Error("Section name may not be empty"),t,N,n.file);p.push({name:i,inverted:r}),o.push('";',v,'\nvar name = "'+i+'";',"\nvar callback = (function () {","\n  return function () {",'\n    var buffer = "";','\nbuffer += "')},E=function(e){w(e,!0)},S=function(e){var r=f(e),i=p.length!=0&&p[p.length-1].name;if(!i||r!=i)throw d(new Error('Section named "'+r+'" was never opened'),t,N,n.file);var s=p.pop();o.push('";',"\n    return buffer;","\n  };","\n})();"),s.inverted?o.push("\nbuffer += renderSection(name,stack,callback,true);"):o.push("\nbuffer += renderSection(name,stack,callback);"),o.push('\nbuffer += "')},x=function(e){o.push('";',v,'\nbuffer += lookup("'+f(e)+'",stack,"");','\nbuffer += "')},T=function(e){o.push('";',v,'\nbuffer += escapeHTML(lookup("'+f(e)+'",stack,""));','\nbuffer += "')},N=1,C,k;for(var L=0,A=t.length;L<A;++L)if(t.slice(L,L+i.length)===i){L+=i.length,C=t.substr(L,1),v="\nline = "+N+";",m=i,g=s,l=!0;switch(C){case"!":L++,k=null;break;case"=":L++,s="="+s,k=y;break;case">":L++,k=b;break;case"#":L++,k=w;break;case"^":L++,k=E;break;case"/":L++,k=S;break;case"{":s="}"+s;case"&":L++,c=!0,k=x;break;default:c=!0,k=T}var O=t.indexOf(s,L);if(O===-1)throw d(new Error('Tag "'+i+'" was not closed properly'),t,N,n.file);var M=t.substring(L,O);k&&k(M);var _=0;while(~(_=M.indexOf("\n",_)))N++,_++;L=O+s.length-1,i=m,s=g}else{C=t.substr(L,1);switch(C){case'"':case"\\":c=!0,o.push("\\"+C);break;case"\r":break;case"\n":u.push(o.length),o.push("\\n"),h(),N++;break;default:a(C)?u.push(o.length):c=!0,o.push(C)}}if(p.length!=0)throw d(new Error('Section "'+p[p.length-1].name+'" was not closed properly'),t,N,n.file);h(),o.push('";',"\nreturn buffer;","\n} catch (e) { throw {error: e, line: line}; }");var D=o.join("").replace(/buffer \+= "";\n/g,"");return n.debug&&(typeof console!="undefined"&&console.log?console.log(D):typeof print=="function"&&print(D)),D}function y(e,t){var n="view,partials,stack,lookup,escapeHTML,renderSection,render",r=g(e,t),i=new Function(n,r);return function(n,r){r=r||{};var s=[n];try{return i(n,r,s,v,p,m,S)}catch(o){throw d(o.error,e,o.line,t.file)}}}function w(){b={}}function E(e,t){return t=t||{},t.cache!==!1?(b[e]||(b[e]=y(e,t)),b[e]):y(e,t)}function S(e,t,n){return E(e)(t,n)}e.name="mustache.js",e.version="0.5.0-dev",e.tags=["{{","}}"],e.parse=g,e.compile=E,e.render=S,e.clearCache=w,e.to_html=function(e,t,n,r){var i=S(e,t,n);if(typeof r!="function")return i;r(i)};var t=Object.prototype.toString,n=Array.isArray,r=Array.prototype.forEach,i=String.prototype.trim,s;n?s=n:s=function(e){return t.call(e)==="[object Array]"};var o;r?o=function(e,t,n){return r.call(e,t,n)}:o=function(e,t,n){for(var r=0,i=e.length;r<i;++r)t.call(n,e[r],r,e)};var u=/^\s*$/,f;if(i)f=function(e){return e==null?"":i.call(e)};else{var l,c;a(" ")?(l=/^\s+/,c=/\s+$/):(l=/^[\s\xA0]+/,c=/[\s\xA0]+$/),f=function(e){return e==null?"":String(e).replace(l,"").replace(c,"")}}var h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},b={}})(Mustache),pen.define("cdf/mustache",function(){}),Object.create||(Object.create=function(){function n(n){e.prototype=n||{};var r=new e;return e.prototype=t,r}var e=function(){},t=e.prototype;return n}()),String.prototype.endsWith||(String.prototype.endsWith=function(e){return this.match(e+"$")==e}),Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(i){if(typeof i!="object"&&typeof i!="function"||i===null)throw new TypeError("Object.keys called on non-object");var s=[];for(var o in i)e.call(i,o)&&s.push(o);if(t)for(var u=0;u<r;u++)e.call(i,n[u])&&s.push(n[u]);return s}}()),Array.prototype.map||(Array.prototype.map=function(e,t){var n,r,i;if(this==null)throw new TypeError(" this is null or not defined");var s=Object(this),o=s.length>>>0;if({}.toString.call(e)!="[object Function]")throw new TypeError(e+" is not a function");t&&(n=t),r=new Array(o),i=0;while(i<o){var u,a;i in s&&(u=s[i],a=e.call(n,u,i,s),r[i]=a),i++}return r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(this==null)throw new TypeError;var t=Object(this),n=t.length>>>0;if(n===0)return-1;var r=0;arguments.length>0&&(r=Number(arguments[1]),r!=r?r=0:r!=0&&r!=Infinity&&r!=-Infinity&&(r=(r>0||-1)*Math.floor(Math.abs(r))));if(r>=n)return-1;var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++)if(i in t&&t[i]===e)return i;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(e){if(this==null)throw new TypeError;var t=Object(this),n=t.length>>>0;if(n===0)return-1;var r=n;arguments.length>1&&(r=Number(arguments[1]),r!=r?r=0:r!=0&&r!=1/0&&r!=-(1/0)&&(r=(r>0||-1)*Math.floor(Math.abs(r))));var i=r>=0?Math.min(r,n-1):n-Math.abs(r);for(;i>=0;i--)if(i in t&&t[i]===e)return i;return-1}),Array.prototype.reduce||(Array.prototype.reduce=function(t){var n,r=this.length,i;if(typeof t!="function")throw new TypeError("First argument is not callable");if((r==0||r===null)&&arguments.length<=1)throw new TypeError("Array length is 0 and no second argument");arguments.length<=1?(i=this[0],n=1):i=arguments[1];for(n=n||0;n<r;++n)n in this&&(i=t.call(undefined,i,this[n],n,this));return i}),Date.prototype.toISOString||function(){function e(e){return e<10?"0"+e:e}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),pen.define("cdf/lib/shims",function(){}),$.ajaxSetup({type:"POST",async:!1,traditional:!0,scriptCharset:"utf-8",contentType:"application/x-www-form-urlencoded;charset=UTF-8",dataFilter:function(e,t){return typeof Dashboards!="undefined"&&(Dashboards.lastServerResponse=Date.now()),e}});var pathArray=window.location.pathname.split("/"),webAppPath;typeof CONTEXT_PATH!="undefined"&&(webAppPath=CONTEXT_PATH),webAppPath==undefined&&(webAppPath="/"+pathArray[1]),webAppPath.endsWith("/")&&(webAppPath=webAppPath.substr(0,webAppPath.length-1)),$.blockUI&&($.blockUI.defaults.fadeIn=0,$.blockUI.defaults.message='<div class="blockUIDefaultImg"></div>',$.blockUI.defaults.css.left="50%",$.blockUI.defaults.css.top="40%",$.blockUI.defaults.css.marginLeft="-16px",$.blockUI.defaults.css.width="32px",$.blockUI.defaults.css.background="none",$.blockUI.defaults.overlayCSS={backgroundColor:"#FFFFFF",opacity:.8,cursor:"wait"},$.blockUI.defaults.css.border="none"),typeof $.SetImpromptuDefaults=="function"&&$.SetImpromptuDefaults({prefix:"colsJqi",show:"slideDown"}),pen.define("cdf/Dashboards.Startup",function(){}),Array.prototype.map||(Array.prototype.map=function(e){var t=this.length;if(typeof e!="function")throw new TypeError;var n=new Array(t),r=arguments[1];for(var i=0;i<t;i++)i in this&&(n[i]=e.call(r,this[i],i,this));return n}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(this==null)throw new TypeError;var t=Object(this),n=t.length>>>0;if(n===0)return-1;var r=0;arguments.length>0&&(r=Number(arguments[1]),r!=r?r=0:r!=0&&r!=Infinity&&r!=-Infinity&&(r=(r>0||-1)*Math.floor(Math.abs(r))));if(r>=n)return-1;var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++)if(i in t&&t[i]===e)return i;return-1}),Function.prototype.method=Function.prototype.method||function(e,t){return this.prototype[e]=t,this};var wd=wd||{};wd.loglevels=["debug","info","warn","error","exception"],wd.loglevel="debug",wd.log=function(e,t){t=t||"info";if(wd.loglevels.indexOf(t)<wd.loglevels.indexOf(wd.loglevel))return;typeof console!="undefined"&&(t&&console[t]?console[t]("["+t+"] WD: "+e):t==="exception"&&!console.exception?console.error("["+t+"] WD: "+(e.stack||e)):console.log("WD: "+e))},wd.warn=function(e){return wd.log(e,"warn")},wd.error=function(e){return wd.log(e,"error")},wd.info=function(e){return wd.log(e,"info")},wd.debug=function(e){return wd.log(e,"debug")},pen.define("cdf/wd",function(){});var CDF_PLUGIN_NAME="pentaho-cdf",SAMPLES_BASE_PATH="/public/plugin-samples/";wd=wd||{},wd.cdf=wd.cdf||{},wd.cdf.helper={getTimestamp:function(){return"ts="+(new Date).getTime()},getFullPath:function(e,t){e=e||"",t=t||"";var n=e.indexOf(CDF_PLUGIN_NAME)==0?SAMPLES_BASE_PATH+e:e;return n+=(t?"/"+t:"").replace(/\/\//g,"/"),n},composePath:function(e){var t=function(e){return e.charAt(0)=="/"&&(e=e.substring(1,e.length)),e.charAt(e.length-1)=="/"&&(e=e.substring(0,e.length-1)),e},n="/";return e.solution&&(n+=t(solution)+"/"),e.path&&(n+=t(e.path)),e.action&&(n+="/"+t(action)),n}},wd.cdf.endpoints={getWebapp:function(){return webAppPath},getPing:function(){return wd.cdf.endpoints.getCdfBase()+"/ping"},getXmla:function(){return wd.cdf.endpoints.getWebapp()+"/Xmla"},getPluginBase:function(e){return wd.cdf.endpoints.getWebapp()+"/plugin/"+e+"/api"},getCdfBase:function(){return wd.cdf.endpoints.getPluginBase(CDF_PLUGIN_NAME)},getCdaBase:function(){return wd.cdf.endpoints.getPluginBase("cda")},getPluginEndpoint:function(e,t){return wd.cdf.endpoints.getPluginBase(e)+"/"+t},getStorage:function(e){return wd.cdf.endpoints.getCdfBase()+"/storage/"+e},getSettings:function(e,t){return t?wd.cdf.endpoints.getCdfBase()+"/settings/"+e+"?"+$.param({key:t}):wd.cdf.endpoints.getCdfBase()+"/settings/"+e},getViewAction:function(){return wd.cdf.endpoints.getCdfBase()+"/viewAction"},getJSONSolution:function(){return wd.cdf.endpoints.getCdfBase()+"/getJSONSolution"},getRenderHTML:function(){return wd.cdf.endpoints.getCdfBase()+"/RenderHtml"},getExport:function(){return wd.cdf.endpoints.getCdfBase()+"/Export"},getResource:function(){return wd.cdf.endpoints.getCdfBase()+"/getResource"},getStaticResource:function(e){return wd.cdf.endpoints.getCdfBase()+"/resources/"+e},getCdfXaction:function(e,t,n,r){if(r){var i={};for(var s in r)i[s]=typeof r[s]=="function"?r[s]():r[s];return Encoder.encode(wd.cdf.endpoints.getViewAction(),null,$.extend({path:wd.cdf.helper.getFullPath(e,t),ts:(new Date).getTime()},i))}return Encoder.encode(wd.cdf.endpoints.getViewAction(),null,{path:wd.cdf.helper.getFullPath(e,t),ts:(new Date).getTime()})},getServiceAction:function(e,t,n,r){var i={};return i.wrapper=!1,i.action=r,i.url=Encoder.encode(wd.cdf.endpoints.getWebapp()+"/api/repos/{0}/generatedContent",Encoder.encodeRepositoryPath(wd.cdf.helper.getFullPath(n,r))),i},getComments:function(e){var t="";return e=="LIST_ALL"||e=="LIST_ACTIVE"||e=="GET_LAST"?t="list":e=="DELETE_COMMENT"?t="delete":e=="ARCHIVE_COMMENT"?t="archive":e=="ADD_COMMENT"&&(t="add"),wd.cdf.endpoints.getCdfBase()+"/comments/"+t},getScheduledJob:function(){return wd.cdf.endpoints.getWebapp()+"/api/scheduler/job"},getEmailConfig:function(){return wd.cdf.endpoints.getWebapp()+"/api/emailconfig"},getPivot:function(e,t,n){return Encoder.encode(wd.cdf.endpoints.getWebapp()+"/Pivot",null,{solution:e||"system",path:Encoder.encodeRepositoryPath(t),action:n})},getAnalyzer:function(){return wd.cdf.endpoints.getWebapp()+"/content/analyzer/"},getReport:function(e,t,n){return typeof e=="string"||e instanceof String?Encoder.encode(wd.cdf.endpoints.getWebapp()+"/api/repos/{0}/"+t,Encoder.encodeRepositoryPath(e),n):Encoder.encode(wd.cdf.endpoints.getWebapp()+"/api/repos/{0}/"+t,Encoder.encodeRepositoryPath(wd.cdf.helper.composePath(e)),n)},getCaptifyZoom:function(){return wd.cdf.endpoints.getStaticResource("js/captify/zoom.html")},getDoQuery:function(){return wd.cdf.endpoints.getCdaBase()+"/doQuery?"},getUnwrapQuery:function(e){return wd.cdf.endpoints.getCdaBase()+"/unwrapQuery?"+$.param(e)}},pen.define("cdf/cdf-base",function(){});var dash,Dashboards=dash={ERROR_CODES:{QUERY_TIMEOUT:{msg:"Query timeout reached"},COMPONENT_ERROR:{msg:"Error processing component"}},CDF_BASE_PATH:wd.cdf.endpoints.getCdfBase(),parameterModel:new Backbone.Model,viewFlags:{UNUSED:"unused",UNBOUND:"unbound",VIEW:"view"},globalContext:!0,escapeParameterValues:!0,runningCalls:0,components:[],parameters:[],context:{},initCounter:0,legacyPriority:-1e3,logLifecycle:!0,args:[],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],lastServerResponse:Date.now?Date.now():(new Date).valueOf(),serverCheckResponseTimeout:18e5,i18nCurrentLanguageCode:null,i18nSupport:null};_.extend(Dashboards,Backbone.Events),Dashboards.log=function(e,t){typeof console!="undefined"&&(t&&console[t]?console[t]("CDF: "+e):t==="exception"&&!console.exception?console.error(e.stack):console.log("CDF: "+e))},Dashboards.error=function(e){this.log(e,"error")},Dashboards.getWebAppPath=function(){return webAppPath},Dashboards.setGlobalContext=function(e){this.globalContext=e},Dashboards.showProgressIndicator=function(){$.blockUI&&this.blockUIwithDrag()},Dashboards.hideProgressIndicator=function(e){e&&(this.runningCalls=0),$.unblockUI&&$.unblockUI(),this.showErrorTooltip()},Dashboards.resetRunningCalls=function(){this.runningCalls=0,setTimeout(_.bind(function(){this.hideProgressIndicator()},this),10)},Dashboards.getRunningCalls=function(){return this.runningCalls},Dashboards.incrementRunningCalls=function(){this.runningCalls++,this.showProgressIndicator()},Dashboards.decrementRunningCalls=function(){this.runningCalls--,setTimeout(_.bind(function(){this.runningCalls<=0&&(this.hideProgressIndicator(),this.runningCalls=0)},this),10)},Dashboards.bindControl=function(e){var t=this._getControlClass(e);return t?this._castControlToClass(e,t):this.log("Object type "+e.type+" can't be mapped to a valid class","error"),this.bindExistingControl(e,t)},Dashboards.bindExistingControl=function(e,t){if(!e.dashboard){e.dashboard=this,delete e.initInstance,this._castControlToComponent(e,t),typeof e.off=="function"&&e.off("all"),e.on||$.extend(e,Backbone.Events),this._addLogLifecycleToControl(e);if(e.priority==null||e.priority==="")e.priority=this.legacyPriority++}return e},Dashboards._castControlToClass=function(e,t){if(!(e instanceof t)){var n=this._makeInstance(t);$.extend(e,n)}},Dashboards._getControlClass=function(e){var t=e.type;typeof t=="function"&&(t=t.call(e));var n=t.substring(0,1).toUpperCase()+t.substring(1),r=[n+"Component",t,n];for(var i=0,s=r.length;i<s;i++){var o=window[r[i]];if(o&&typeof o=="function")return o}},Dashboards._makeInstance=function(e,t){var n=Object.create(e.prototype);return t?e.apply(n,t):e.apply(n),n},Dashboards._castControlToComponent=function(e,t){if(!(e instanceof BaseComponent)&&(!t||!(t.prototype instanceof BaseComponent))){var n=BaseComponent.prototype;for(var r in n)if(n.hasOwnProperty(r)&&e[r]===undefined&&typeof n[r]=="function")switch(r){case"base":break;default:e[r]=n[r]}}},Dashboards._addLogLifecycleToControl=function(e){e.on("all",function(e){var t=this.dashboard;if(t&&t.logLifecycle&&e!=="cdf"&&this.name!=="PostInitMarker"&&typeof console!="undefined"){var n,r=e.substr(4);switch(r){case"preExecution":n=">Start";break;case"postExecution":n="<End  ";break;case"error":n="!Error";break;default:n="      "}var i=Mustache.render("Timing: {{elapsedSinceStartDesc}} since start, {{elapsedSinceStartDesc}} since last event",this.splitTimer());console.log("%c          [Lifecycle "+n+"] "+this.name+" ["+this.type+"]"+" (P: "+this.priority+" ): "+r+" "+i+" (Running: "+this.dashboard.runningCalls+")","color: "+this.getLogColor())}})},Dashboards.restoreDuplicates=function(){var e=this.components.filter(function(e){return e.type=="duplicate"}),t={},n=this.getBookmarkState().params||{};Object.keys(n).filter(function(e){return/(_[0-9]+)+$/.test(e)}).map(function(e){var r=e.match(/(.*?)((_[0-9]+)+)$/),i=r[1],s=r[2];return t[s]||(t[s]={}),t[s][i]=n[e],e});var r=this;for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];$.each(e,function(e,t){var i;for(i=0;i<t.parameters.length;i++)if(!n.hasOwnProperty(t.parameters[i])&&r.isBookmarkable(t.parameters[i]))return;t.duplicate(n)})}},Dashboards.blockUIwithDrag=function(){typeof this.i18nSupport!="undefined"&&this.i18nSupport!=null&&($.blockUI.defaults.message='<div class="img blockUIDefaultImg" style="padding: 0px;"></div>'),$.blockUI();var e=$('<div id="blockUIDragHandle"></div>');$("div.blockUI.blockMsg").prepend(e),$("div.blockUI.blockMsg").draggable({handle:"#blockUIDragHandle"})},Dashboards.updateLifecycle=function(e){var t=e.lifecycle?!!e.lifecycle.silent:!1;if(e.disabled)return;t||this.incrementRunningCalls();var n=_.bind(function(){try{var n;typeof e.preExecution!="undefined"&&(n=e.preExecution.apply(e)),n=typeof n!="undefined"?!!n:!0,e.trigger("cdf cdf:preExecution",e,n);if(!n)return;e.tooltip!=undefined&&(e._tooltip=typeof e["tooltip"]=="function"?e.tooltip():e.tooltip),e.update!=undefined&&typeof e["update"]=="function"&&(e.update(),this.refreshEngine.processComponent(e)),typeof e.postExecution!="undefined"&&e.postExecution.apply(e),e._tooltip!=undefined&&$("#"+e.htmlObject).attr("title",e._tooltip).tooltip({delay:0,track:!0,fade:250})}catch(r){var i=e.htmlObject?$("#"+e.htmlObject):undefined,s=Dashboards.getErrorObj("COMPONENT_ERROR").msg+" ("+e.name.replace("render_","")+")";this.errorNotification({msg:s},i),this.log("Error updating "+e.name+":","error"),this.log(r,"exception")}finally{t||this.decrementRunningCalls()}e.trigger("cdf cdf:postExecution",e)},this);setTimeout(n,1)},Dashboards.update=function(e){this.updateQueue||(this.updateQueue=[]),this.updateQueue.push(e),this.updateTimeout&&clearTimeout(this.updateTimeout);var t=_.bind(function(){this.updateAll(this.updateQueue),delete this.updateQueue},this);this.updateTimeout=setTimeout(t,5)},Dashboards.updateComponent=function(e){if(Date.now()-Dashboards.lastServerResponse>Dashboards.serverCheckResponseTimeout&&!Dashboards.checkServer())throw Dashboards.hideProgressIndicator(),Dashboards.loginAlert(),"not logged in";e.isManaged===!1&&e.update?(e.update(),this.refreshEngine.processComponent(e)):this.updateLifecycle(e)},Dashboards.getComponent=dash.getComp=function(e){for(var t in this.components)if(this.components[t].name==e)return this.components[t]},Dashboards.getComponentByName=function(name){return this.globalContext?eval(name):this.getComponent(name)},Dashboards.addComponents=function(e){e.forEach(function(e){this.bindControl(e),this.components.push(e)},this)},Dashboards.addComponent=function(e,t){this.removeComponent(e),this.bindControl(e);var n=t&&t.index,r=this.components.length;if(n==null||n<0||n>r)n=r;this.components[n]=e},Dashboards.getComponentIndex=function(e){if(e!=null)switch(typeof e){case"string":for(var t=0,n=this.components,r=n.length;t<r;t++)if(n[t].name===e)return t;break;case"number":if(e>=0&&e<this.components.length)return e;break;default:return this.components.indexOf(e)}return-1},Dashboards.removeComponent=function(e){var t=this.getComponentIndex(e),n=null;if(t>=0){var r=this.components;n=r[t],r.splice(t,1),n.dashboard=null,n.off("cdf:postExecution"),n.off("cdf:preExecution"),n.off("cdf:error"),n.off("all")}return n},Dashboards.registerEvent=function(e,t){typeof this.events=="undefined"&&(this.events={}),this.events[e]=t},Dashboards.addArgs=function(e){e!=undefined&&(this.args=getURLParameters(e))},Dashboards.setI18nSupport=function(e,t){t!=="undefined"&&e!=="undefined"&&(this.i18nCurrentLanguageCode=e,this.i18nSupport=t)},Dashboards.init=function(e){var t=this,n=Dashboards.initCounter++;Dashboards.log("InitInstance "+n),n==0&&(this.syncDebugLevel(),this.initialStorage?_.extend(this.storage,this.initialStorage):this.loadStorage(),this.context!=null&&this.context.sessionTimeout!=null&&(Dashboards.serverCheckResponseTimeout=this.context.sessionTimeout*900),this.restoreBookmarkables(),this.restoreView(),this.syncParametersInit()),$.isArray(e)&&this.addComponents(e),_.chain(Dashboards.components).where({initInstance:undefined}).each(function(e){e.initInstance=n}),$(function(){t.initEngine(n)})},Dashboards.syncParameters=function(e,t){this.setParameter(t,this.getParameterValue(e)),this.parameterModel.on("change:"+e,function(e,n,r){this[r.notify?"fireChange":"setParameter"](t,n)},this),this.parameterModel.on("change:"+t,function(t,n,r){this[r.notify?"fireChange":"setParameter"](e,n)},this)},Dashboards.chains=[],Dashboards.syncedParameters={},Dashboards.syncParametersOnInit=function(e,t){var n=this.syncedParameters,r,i,s,o,u;n[e]||(n[e]=[]),n[e].push(t);for(u=0;u<this.chains.length;u++)r=this.chains[u],r.indexOf(e)>-1&&(i=r),r.indexOf(t)>-1&&(s=r,o=u);s&&i?i!=s&&(args=s.slice(),args.unshift(0),args.unshift(i.length),[].splice.apply(i,args),this.chains.splice(o,1)):s?s.unshift(e):i?i.push(t):this.chains.push([e,t])},Dashboards.syncParametersInit=function(){var e=this.syncedParameters,t,n,r,i,s;for(t=0;t<this.chains.length;t++)for(n=0;n<this.chains[t].length;n++){var i=this.chains[t][n];if(!e[i])continue;for(r=0;r<e[i].length;r++)s=e[i][r],this.syncParameters(i,s)}},Dashboards.initEngine=function(e){this.waitingForInit&&this.waitingForInit.length&&this.log("Overlapping initEngine!","warn");var t=this,n=e!=null?_.where(this.components,{initInstance:e}):this.components;(!this.waitingForInit||this.waitingForInit.length===0)&&!this.finishedInit&&this.incrementRunningCalls(),this.logLifecycle&&typeof console!="undefined"&&console.log("%c          [Lifecycle >Start] Init["+e+"] (Running: "+this.getRunningCalls()+")","color: #ddd "),this.createAndCleanErrorDiv(),typeof this.preInit=="function"&&this.preInit(),this.trigger("cdf cdf:preInit",this),$(window).trigger("cdfAboutToLoad");var t=this,r=[],i;for(i=0;i<n.length;i++)n[i].executeAtStart&&r.push(n[i]);if(!r.length){this.handlePostInit();return}var s={name:"PostInitMarker",type:"unmanaged",lifecycle:{silent:!0},executeAtStart:!0,priority:999999999};this.bindControl(s),r.push(s),this.waitingForInit=r.slice();var o=function(t,n){if(arguments.length==2&&n)return;this.waitingForInit=_(this.waitingForInit).without(t),t.off("cdf:postExecution",o),t.off("cdf:preExecution",o),t.off("cdf:error",o),this.handlePostInit(e)};for(var i=0,u=r.length;i<u;i++){var a=r[i];a.on("cdf:postExecution cdf:preExecution cdf:error",o,t)}Dashboards.updateAll(r),n.length>0&&t.handlePostInit(e)},Dashboards.handlePostInit=function(e){(!this.waitingForInit||this.waitingForInit.length===0)&&!this.finishedInit&&(this.trigger("cdf cdf:postInit",this),$(window).trigger("cdfLoaded"),typeof this.postInit=="function"&&this.postInit(),this.restoreDuplicates(),this.finishedInit=!0,this.decrementRunningCalls(),this.logLifecycle&&typeof console!="undefined"&&console.log("%c          [Lifecycle <End  ] Init["+e+"] (Running: "+this.getRunningCalls()+")","color: #ddd "))},Dashboards.debug=1,Dashboards.syncDebugLevel=function(){var e=1;try{var t=function(e){return e&&/\bdebug=true\b/.test(e)?e:null},n=t(window.location.href)||t(window.top.location.href);if(n){var r=/\bdebugLevel=(\d+)/.exec(n);e=r?+r[1]:3}}catch(i){}return this.debug=e},Dashboards.resetAll=function(){this.createAndCleanErrorDiv();var e=this.components.length;for(var t=0,n=this.components.length;t<n;t++)this.components[t].clear();var e=this.components.length;for(var t=0,n=this.components.length;t<n;t++)this.components[t].executeAtStart&&this.update(this.components[t])},Dashboards.processChange=function(e){var t=this.getComponentByName(e),n=t.parameter,r;typeof t["getValue"]=="function"&&(r=t.getValue());if(r==null)return;if(typeof t.preChange!="undefined"){var i=t.preChange(r);r=i!=undefined?i:r}n&&this.fireChange(n,r),typeof t.postChange!="undefined"&&t.postChange(r)},Dashboards.fireChange=function(e,t){var n=this;this.createAndCleanErrorDiv(),this.setParameter(e,t,!0);var r=[],i=!1;for(var s=0,o=this.components.length;s<o;s++)if($.isArray(this.components[s].listeners))for(var u=0;u<this.components[s].listeners.length;u++){var a=this.components[s];if(a.listeners[u]==e&&!a.disabled){r.push(a);break}}n.updateAll(r)},Dashboards.updateAll=function(e){this.updating||(this.updating={tiers:{},current:null});if(e&&_.isArray(e)&&!_.isArray(e[0])){var t={};_.each(e,function(e){var n=e.priority||0;t[n]||(t[n]=[]),t[n].push(e)}),e=t}this.mergePriorityLists(this.updating.tiers,e);var n=this.updating.current;if(n===null||n.components.length==0){var r=this.getFirstTier(this.updating.tiers);if(!r)return;this.updating.current=r;var i=function(e,t){if(arguments.length==2&&typeof t=="boolean"&&t)return;e.off("cdf:postExecution",i),e.off("cdf:preExecution",i),e.off("cdf:error",i);var n=this.updating.current;n.components=_.without(n.components,e);var r=this.updating.tiers;r[n.priority]=_.without(r[n.priority],e),this.updateAll()},t=this.updating.current.components.slice();for(var s=0;s<t.length;s++)component=t[s],component.startTimer(),component.on("cdf:postExecution cdf:preExecution cdf:error",i,this),this.updateComponent(component)}},Dashboards.getFirstTier=function(e){var t=_.keys(e).sort(function(e,t){return parseInt(e,10)-parseInt(t,10)}),n;for(var r=0;r<t.length;r++){n=e[t[r]];if(n.length>0)return{priority:t[r],components:n.slice()}}return null},Dashboards.mergePriorityLists=function(e,t){if(!t)return;for(var n in t)t.hasOwnProperty(n)&&(_.isArray(e[n])?e[n]=_.union(e[n],t[n]):e[n]=t[n])},Dashboards.restoreView=function(){var e,t;if(!this.view)return;t=JSON.parse(Base64.decode(this.view.params));for(e in t)t.hasOwnProperty(e)&&this.setParameter(e,t[e])},Dashboards.setParameterViewMode=function(e,t){this.viewParameters||(this.viewParameters={}),arguments.length===1&&(t=this.viewFlags.VIEW),this.viewParameters[e]=t},Dashboards.isViewParameter=function(e){return this.viewParameters?this.viewParameters[e]:!1},Dashboards.getViewParameters=function(){if(!this.viewParameters)return{};var e=this.viewParameters,t={};for(var n in e)e.hasOwnProperty(n)&&(e[n]==this.viewFlags.VIEW||e[n]==this.viewFlags.UNBOUND)&&(t[n]=this.getParameterValue(n));return t},Dashboards.getUnboundParameters=function(){if(!this.viewParameters)return[];var e=this.viewParameters,t=[];for(var n in e)if(e.hasOwnProperty(n))return e[n]==this.viewFlags.UNBOUND&&t.push(n),t},Dashboards.getParameterValue=dash.getParam=function(parameterName){if(!this.globalContext)return this.parameters[parameterName];try{return eval(parameterName)}catch(e){this.error(e)}},Dashboards.setParameter=dash.setParam=function(parameterName,parameterValue,isNotified){if(parameterName==undefined||parameterName=="undefined"){this.log("Dashboards.setParameter: trying to set undefined!!","warn");return}this.globalContext?eval(parameterName+" = "+JSON.stringify(parameterValue)):this.escapeParameterValues?this.parameters[parameterName]=encode_prepare_arr(parameterValue):this.parameters[parameterName]=parameterValue,this.parameterModel.set(parameterName,parameterValue,{notify:isNotified}),this.persistBookmarkables(parameterName)},Dashboards.post=function(e,t){var n='<form action="'+e+'" method="post">';for(var r in t){var i=typeof t[r]=="function"?t[r]():t[r];typeof i=="string"&&(i=i.replace(/"/g,"'")),n+='"<input type="hidden" name="'+r+'" value="'+i+'"/>'}n+="</form>",jQuery(n).appendTo("body").submit().remove()},Dashboards.clone=function(t){var n=t instanceof Array?[]:{};for(var r in t){var i=t[r];if(typeof i=="object")if(i instanceof Array){n[r]=[];for(var s=0;s<i.length;s++)typeof i[s]!="object"?n[r].push(i[s]):n[r].push(this.clone(i[s]))}else n[r]=this.clone(i);else n[r]=i}return n},Dashboards.getArgValue=function(e){for(i=0;i<this.args.length;i++)if(this.args[i][0]==e)return this.args[i][1];return undefined},Dashboards.ev=function(e){return typeof e=="function"?e():e},Dashboards.storage={},Dashboards.loadStorage=function(){var e=this;if(this.context&&this.context.user==="anonymousUser")return;var t={action:"read",_:(new Date).getTime()};$.getJSON(wd.cdf.endpoints.getStorage(t.action),t,function(t){$.extend(e.storage,t)})},Dashboards.saveStorage=function(){var e=this;if(this.context&&this.context.user==="anonymousUser")return;var t={action:"store",storageValue:JSON.stringify(this.storage),_:(new Date).getTime()};$.getJSON(wd.cdf.endpoints.getStorage(t.action),t,function(t){t.result!=1&&e.log("Error saving storage","error")})},Dashboards.cleanStorage=function(){var e=this;this.storage={};if(this.context&&this.context.user==="anonymousUser")return;var t={action:"delete"};$.getJSON(wd.cdf.endpoints.getStorage(t.action),t,function(t){t.result!=1&&e.log("Error deleting storage","error")})},pen.define("cdf/Dashboards.Main",function(){}),function(e){function t(){function t(t,n){if(!t)throw new Error("Argument 'type' is required.");if(typeof t!="string")throw new Error("Argument 'type' must be a string.");var r=e[t];if(!n&&(!r||o(r)))throw new Error("There are no registrations for type '"+t+"'.");return r}function i(e,n,r){var i,s=t(e,r);if(s){i=s[n||""];if(!i&&!r)throw new Error("There is no registration for type '"+e+"'"+(n?" and name '"+n+"'":"")+".")}return i}function s(e,t,n,r,s){typeof t!="string"&&(n=t,t="");var o=i(e,t,s);return n?r=!0:r||(n={}),o?o.build(n,r):null}function u(e,n){var r=t(e,n),i=[];for(var s in r)i.push(r[s].build({},!1));return i}this.register=function(t,i,s,o){if(!t)throw new Error("Argument 'type' is required.");if(typeof t!="string")throw new Error("Argument 'type' must be a string.");i!=null&&(typeof i!="string"?(o=s,s=i,i=null):i||(i=null));if(!s)throw new Error("Argument 'what' is required.");var u;switch(typeof s){case"function":u=new n(this,s,o);break;case"object":u=new r(this,s,o);break;default:throw new Error("Argument 'what' is of an invalid type.")}i||(i="");var a=e[t]||(e[t]={}),f=a[i];f&&f.dispose(),a[i]=u},this.has=function(e,t){return!!i(e,t,!0)},this.canNew=function(e,t){return i(e,t,!1)instanceof n},this.get=function(e,t){return s(e,t,null,!1,!1)},this.tryGet=function(e,t){return s(e,t,null,!1,!0)},this.getNew=function(e,t,n){return s(e,t,n,!0,!1)},this.tryGetNew=function(e,t,n){return s(e,t,n,!0,!0)},this.getAll=function(e){return u(e,!1)},this.tryGetAll=function(e){return u(e,!0)},this.listType=function(e){return t(e,!1)},this.tryListType=function(e){return t(e,!0)},this.dispose=function(){if(e){for(var t in e){var n=e[t];for(var r in n)n[r].dispose()}e=null}};var e={}}function n(e,t,n){var r;n||(n="instance"),this.build=function(i,s){if(r&&!s)return r;var o=t(e,i);return!s&&n==="singleton"&&(r=o),o},this.dispose=function(){r&&(i(r),r=null)}}function r(e,t,n){n||(n="external"),this.build=function(){return t},this.dispose=function(){t&&(n==="singleton"&&i(t),t=null)}}function i(e){typeof e.dispose=="function"&&e.dispose()}function o(e){for(var t in e)if(s.call(e,t))return!1;return!0}var s=Object.prototype.hasOwnProperty;e.Container=t}(Dashboards),function(e){function t(t){function s(e,t){t=t||{},l(e,t.reader),c(e,t.writer),h(e,t.validator)}function o(e){return n(i._interfaces,e,"reader",i._libraries.mappers.identity)}function u(e){return n(i._interfaces,e,"writer",i._libraries.mappers.identity)}function a(e){return n(i._interfaces,e,"validator",i._libraries.predicates.tautology)}function f(e){return n(i._options,e,"value")}function l(e,t){var n=i._libraries.mappers;return t=_.isFunction(t)&&t||_.isString(t)&&n[t]||o(e)||n.identity,r(i._interfaces,e,"reader",t)}function c(e,t){var n=i._libraries.mappers;return t=_.isFunction(t)&&t||_.isString(t)&&n[t]||u(e)||n.identity,r(i._interfaces,e,"writer",t)}function h(e,t){var n=i._libraries.predicates;return t=_.isFunction(t)&&t||_.isString(t)&&n[t]||a(e)||n.tautology,r(i._interfaces,e,"validator",t)}function p(e,t){return r(i._options,e,"value",t)}var i=this;this._options={},this._interfaces={},this._libraries={predicates:{tautology:function(e){return!0},isFunction:_.isFunction,isPositive:function(e){return _.isNumber(e)&&e>0},isObjectOrPropertiesArray:function(e){return _.isArray(e)||_.isObject(e)},isObject:_.isObject,isArray:_.isArray},mappers:{identity:_.identity,propertiesObject:function(t){return _.isArray(t)?e.propertiesArrayToObject(t):t}}},this.mixin=function(e){e.getOption=this.getOption,e.setOption=this.setOption},this.init=function(e,t,n){var r=this;e=$.extend(!0,{},e),t=$.extend(!0,{},t),this._libraries=$.extend(!0,{},this._libraries,n),_.each(t,function(e,t){s(t,e)}),_.each(e,function(e,n){var r=t&&t[n]||{};s(n,r),p(n,e)})},this.setOption=function(e,t,n){s(e,n);var r=o(e),i=a(e);if(i(t))return t=r(t),p(e,t),!0;throw new Error("Invalid Option "+e.charAt(0).toUpperCase()+e.slice(1))},this.getOption=function(e){var t=u(e),n=f(e);return t(n)},this.init(t.defaults,t.interfaces,t.libraries)}function n(e,t,n,r){var i=r||undefined;return e&&e[t]&&e[t].hasOwnProperty(n)&&(i=e[t][n]),i}function r(e,t,n,r){e&&t&&n&&(e[t]=e[t]||{},e[t][n]=r)}e.OptionsManager=t}(Dashboards),function(e){var t=Base;e.getBaseQuery=function(){return t},e.setBaseQuery=function(e){_.isFunction(e)&&e.extend&&(t=e)},e.queryFactories=new e.Container,e.registerQuery=function(e,t){var n=this.getBaseQuery();if(!_.isFunction(t)&&_.isObject(t)){var r={};_.each(n.prototype.deepProperties,function(e){r[e]=_.extend({},n.prototype[e],t[e])})}var i=_.isFunction(t)&&t||_.isObject(t)&&n.extend(_.extend({},t,r));this.queryFactories.register("Query",e,function(e,t){return new i(t)})},e.hasQuery=function(e){return Boolean(this.queryFactories&&this.queryFactories.has("Query",e))},e.detectQueryType=function(e){if(e){var t=e.queryType?e.queryType:e.query?"legacy":e.path&&e.dataAccessId?"cda":undefined;return e.queryType=t,this.hasQuery(t)?t:undefined}},e.getQuery=function(e,t){_.isUndefined(e)?e="cda":_.isObject(e)&&(t=e,e=t.queryType||"cda");var n=this.queryFactories.getNew("Query",e,t);return n},e.listQueries=function(){return _.keys(this.queryFactories.listType("Query"))}}(Dashboards),Query=function(e,t){var n,r;_.isObject(e)?(n=$.extend(!0,{},e),r=_.isString(e.queryType)&&e.queryType||!_.isUndefined(e.query)&&"legacy"||!_.isUndefined(e.path)&&!_.isUndefined(e.dataAccessId)&&"cda"||undefined):_.isString(e)&&_.isString(t)&&(r="cda",n={path:e,dataAccessId:t});if(!r)throw"InvalidQuery";return Dashboards.getQuery(r,n)},pen.define("cdf/Dashboards.Query",function(){}),function(e){e.addIns=new e.Container,e.normalizeAddInKey=function(e,t){return e.indexOf("Component",e.length-"Component".length)!==-1&&(e=e.substring(0,e.length-"Component".length)),e=e.charAt(0).toUpperCase()+e.substring(1),t&&(e+="."+t),e},e.registerAddIn=function(e,t,n){var e=this.normalizeAddInKey(e,t),r=n.getName?n.getName():null;this.addIns.register(e,r,n)},e.hasAddIn=function(e,t,n){var e=this.normalizeAddInKey(e,t);return Boolean(this.addIns&&this.addIns.has(e,n))},e.getAddIn=function(e,t,n){var e=this.normalizeAddInKey(e,t);try{var r=this.addIns.get(e,n);return r}catch(i){return null}},e.setAddInDefaults=function(e,t,n,r){var i=this.getAddIn(e,t,n);i&&i.setDefaults(r)},e.listAddIns=function(e,t){var e=this.normalizeAddInKey(e,t),n=[];try{return this.addIns.listType(e)}catch(r){return[]}}}(Dashboards),Dashboards.safeClone=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;typeof o=="boolean"&&(f=o,o=arguments[1]||{},u=2),typeof o!="object"&&!jQuery.isFunction(o)&&(o={});for(;u<a;u++)if((e=arguments[u])!=null)for(t in e)if(e.hasOwnProperty(t)){n=o[t],r=e[t];if(o===r)continue;f&&r&&(jQuery.isPlainObject(r)||(i=jQuery.isArray(r)))?(i?(i=!1,s=n&&jQuery.isArray(n)?n:[]):s=n&&jQuery.isPlainObject(n)?n:{},o[t]=this.safeClone(f,s,r)):r!==undefined&&(o[t]=r)}return o},pen.define("cdf/Dashboards.AddIns",function(){}),Dashboards.getHashValue=function(e){var t=window.location.hash,n;try{n=JSON.parse(t.slice(1))}catch(r){n={}}return arguments.length===0?n:n[e]},Dashboards.setHashValue=function(e,t){var n=this.getHashValue(),r;arguments.length==1?n=e:n[e]=t,r=JSON.stringify(n),r!="{}"?window.location.hash=r:window.location.hash&&(window.location.hash="")},Dashboards.deleteHashValue=function(e){var t=this.getHashValue();arguments.length===0?window.location.hash="":(delete t[e],this.setHashValue(t))},Dashboards.setBookmarkable=function(e,t){this.bookmarkables||(this.bookmarkables={}),arguments.length===1&&(t=!0),this.bookmarkables[e]=t},Dashboards.isBookmarkable=function(e){return this.bookmarkables?Boolean(this.bookmarkables[e]):!1},Dashboards.generateBookmarkState=function(){var e={},t=this.bookmarkables;for(var n in t)t.hasOwnProperty(n)&&t[n]&&(e[n]=this.getParameterValue(n));return e},Dashboards.persistBookmarkables=function(e){var t=this.bookmarkables,n={};if(!t||!t[e])return;if(!this.finishedInit)return;n=this.generateBookmarkState(),this.setBookmarkState({impl:"client",params:n})},Dashboards.setBookmarkState=function(e){if(window.history&&window.history.replaceState){var t=window.location.pathname.split("/").pop(),n=window.location.search.slice(1).split("&").map(function(e){var t=e.split("=");return t[1]=decodeURIComponent(t[1]),t}),r;n=this.propertiesArrayToObject(n),n.bookmarkState=JSON.stringify(e),r=t+"?"+$.param(n),window.history.replaceState({},"",r),this.deleteHashValue("bookmark")}else this.setHashValue("bookmark",e)},Dashboards.getBookmarkState=function(){if(window.location.hash.length>1)try{return this.getHashValue("bookmark")||{}}catch(e){}var t=window.location.search.slice(1).split("&").map(function(e){var t=e.split("=");return t[1]=decodeURIComponent(t[1]),t}),n=this.propertiesArrayToObject(t);return n.bookmarkState?JSON.parse(decodeURIComponent(n.bookmarkState.replace(/\+/g," ")))||{}:{}},Dashboards.restoreBookmarkables=function(){var e;this.bookmarkables=this.bookmarkables||{};try{e=this.getBookmarkState().params;for(var t in e)e.hasOwnProperty(t)&&this.setParameter(t,e[t])}catch(n){this.log(n,"error")}},pen.define("cdf/Dashboards.Bookmarks",function(){}),Dashboards.callPentahoAction=function(e,t,n,r,i,s){var o=this;return typeof s=="function"?this.pentahoAction(t,n,r,i,function(t){s(o.parseXActionResult(e,t))}):this.parseXActionResult(e,this.pentahoAction(t,n,r,i,s))},Dashboards.urlAction=function(e,t,n){return this.executeAjax("xml",e,t,n)},Dashboards.executeAjax=function(e,t,n,r){var i=this;if(typeof r=="function")return $.ajax({url:t,type:"POST",dataType:e,async:!0,data:n,complete:function(e,t){r(e.responseXML)},error:function(e,t,n){i.log("Found error: "+e+" - "+t+", Error: "+n,"error")}});var s=$.ajax({url:t,type:"POST",dataType:e,async:!1,data:n,error:function(e,t,n){i.log("Found error: "+e+" - "+t+", Error: "+n,"error")}});return e=="xml"?s.responseXML:s.responseText},Dashboards.pentahoAction=function(e,t,n,r,i){return this.pentahoServiceAction("ServiceAction","xml",e,t,n,r,i)},Dashboards.pentahoServiceAction=function(e,t,n,r,i,s,o){var u=wd.cdf.endpoints.getServiceAction(e,n,r,i),a=u.url;return delete u.url,$.each(s,function(e,t){u[t[0]]=t[1]}),this.executeAjax(t,a,u,o)},Dashboards.CDF_ERROR_DIV="cdfErrorDiv",Dashboards.createAndCleanErrorDiv=function(){$("#"+Dashboards.CDF_ERROR_DIV).length==0&&$("body").append("<div id='"+Dashboards.CDF_ERROR_DIV+"'></div>"),$("#"+Dashboards.CDF_ERROR_DIV).empty()},Dashboards.showErrorTooltip=function(){$(function(){$.tooltip&&$(".cdf_error").tooltip({delay:0,track:!0,fade:250,showBody:" -- "})})},Dashboards.parseXActionResult=function(e,t){var n=$(t),r=n.find("SOAP-ENV\\:Fault");if(r.length==0)return n;var i="Error executing component "+e.name,s=new Array;s[0]=" Error details for component execution "+e.name+" -- ",s[1]=r.find("SOAP-ENV\\:faultstring").find("SOAP-ENV\\:Text:eq(0)").text(),r.find("SOAP-ENV\\:Detail").find("message").each(function(){s.push($(this).text())}),s.length>8&&(s=s.slice(0,7),s.push("..."));var o="<table class='errorMessageTable' border='0'><tr><td class='errorIcon'></td><td><span class='cdf_error' title=\""+s.join("<br/>").replace(/"/g,"'")+'" >'+i+" </span></td></tr></table/>";return e.visible==0?$("#"+Dashboards.CDF_ERROR_DIV).append("<br />"+o):$("#"+e.htmlObject).html(o),null},Dashboards.setSettingsValue=function(e,t){var n={method:"set",key:e,value:JSON.stringify(t)};$.post(wd.cdf.endpoints.getSettings("set",null),n,function(){})},Dashboards.getSettingsValue=function(e,t){var n=typeof t=="function"?t:function(e){t=e};$.getJSON(wd.cdf.endpoints.getSettings("get",e),n)},Dashboards.fetchData=function(e,t,n){this.log("Dashboards.fetchData() is deprecated. Use Query objects instead","warn");if(e!=undefined&&e.dataAccessId!=undefined){for(var r in t)e["param"+t[r][0]]=this.getParameterValue(t[r][1]);$.post(wd.cdf.endpoints.getDoQuery(),e,function(e){n(e)},"json").error(Dashboards.handleServerError)}else if(e!=undefined){var i=e.queryType=="cda"?"jtable-cda.xaction":"jtable.xaction";$.post(wd.cdf.endpoints.getCdfXaction("pentaho-cdf/actions",i),e,function(e){n(e.values)},"json")}else n([])},pen.define("cdf/Dashboards.Legacy",function(){}),Dashboards.getErrorObj=function(e){return Dashboards.ERROR_CODES[e]||{}},Dashboards.parseServerError=function(e,t,n){var r={},i=[{match:/Query timeout/,msg:Dashboards.getErrorObj("QUERY_TIMEOUT").msg}];r.error=n,r.msg=Dashboards.getErrorObj("COMPONENT_ERROR").msg;var s=$("<div/>").html(e.responseText).find("h1").text();return _.find(i,function(e){return s.match(e.match)?(r.msg=e.msg,!0):!1}),r.errorStatus=t,r},Dashboards.handleServerError=function(){var e=Dashboards.parseServerError.apply(this,arguments);Dashboards.errorNotification(e),Dashboards.trigger("cdf cdf:serverError",this),Dashboards.resetRunningCalls()},Dashboards.errorNotification=function(e,t){t?wd.cdf.notifications.component.render($(t),{title:e.msg,desc:""}):wd.cdf.notifications.growl.render({title:e.msg,desc:""})},Dashboards.loginAlert=function(e){var t={header:"Warning",desc:"You are no longer logged in or the connection to the server timed out",button:"Click to reload this page",callback:function(){window.location.reload(!0)}};t=_.extend({},t,e),wd.cdf.popups.okPopup.show(t),this.trigger("cdf cdf:loginError",this)},Dashboards.checkServer=function(){var e=!1;return $.ajax({type:"POST",async:!1,dataType:"json",url:wd.cdf.endpoints.getPing(),success:function(t){t&&t.ping=="ok"?e=!0:e=!1},error:function(){e=!1}}),e};var wd=wd||{};wd.cdf=wd.cdf||{},wd.cdf.popups=wd.cdf.popups||{},wd.cdf.popups.okPopup={template:Mustache.compile("<div class='cdfPopup'>  <div class='cdfPopupHeader'>{{{header}}}</div>  <div class='cdfPopupBody'>    <div class='cdfPopupDesc'>{{{desc}}}</div>    <div class='cdfPopupButton'>{{{button}}}</div>  </div></div>"),defaults:{header:"Title",desc:"Description Text",button:"Button Text",callback:function(){return!0}},$el:undefined,show:function(e){(e||this.firstRender)&&this.render(e),this.$el.show()},hide:function(){this.$el.hide()},render:function(e){var t=_.extend({},this.defaults,e),n=this;this.firstRender&&(this.$el=$("<div/>").addClass("cdfPopupContainer").hide().appendTo("body"),this.firstRender=!1),this.$el.empty().html(this.template(t)),this.$el.find(".cdfPopupButton").click(function(){t.callback(),n.hide()})},firstRender:!0},wd.cdf.notifications=wd.cdf.notifications||{},wd.cdf.notifications.component={template:Mustache.compile("<div class='cdfNotification component {{#isSmallComponent}}small{{/isSmallComponent}}'>  <div class='cdfNotificationBody'>    <div class='cdfNotificationImg'>&nbsp;</div>    <div class='cdfNotificationTitle' title='{{title}}'>{{{title}}}</div>    <div class='cdfNotificationDesc' title='{{desc}}'>{{{desc}}}</div>  </div></div>"),defaults:{title:"Component Error",desc:"Error processing component."},render:function(e,t){var n=_.extend({},this.defaults,t);n.isSmallComponent=$(e).width()<300,$(e).empty().html(this.template(n));var r=$(e).find(".cdfNotification");r.css({"line-height":r.height()+"px"})}},wd.cdf.notifications.growl={template:Mustache.compile("<div class='cdfNotification growl'>  <div class='cdfNotificationBody'>    <h1 class='cdfNotificationTitle' title='{{title}}'>{{{title}}}</h1>    <h2 class='cdfNotificationDesc' title='{{desc}}'>{{{desc}}}</h2>  </div></div>"),defaults:{title:"Title",desc:"Default CDF notification.",timeout:4e3,onUnblock:function(){return!0},css:$.extend({},$.blockUI.defaults.growlCSS,{position:"absolute",width:"100%",top:"10px"}),showOverlay:!1,fadeIn:700,fadeOut:1e3,centerY:!1},render:function(e){var t=_.extend({},this.defaults,e),n=$(this.template(t)),r=this;t.message=n;var i=t.onUnblock;t.onUnblock=function(){r.$el.hide(),i.call(this)},this.firstRender&&(this.$el=$("<div/>").addClass("cdfNotificationContainer").hide().appendTo("body"),this.firstRender=!1),this.$el.show().block(t)},firstRender:!0},pen.define("cdf/Dashboards.Notifications",function(){}),Dashboards.RefreshEngine=function(){var e=0,t=new Array,n=null,r=e,s=null;Dashboards.RefreshEngine.QueueItem=function(){return{nextRefresh:0,component:null}};var o=function(t){s!=null&&(clearInterval(s),s=null),r=t>0?t:e,r!=e&&(s=setInterval("Dashboards.refreshEngine.fireGlobalRefresh()",r*1e3))},u=function(e){for(var n=0;n<t.length;n++)t[n].component==e&&(t.splice(n,1),n--)},a=function(){t.length>0&&t.splice(0,t.length)},f=function(e,t){var n=e.length-1,r=0,i;while(r<=n){i=parseInt((r+n)/2);if(e[i].nextRefresh>t.nextRefresh)n=i-1;else{if(!(e[i].nextRefresh<t.nextRefresh))return i;r=i+1}}return r},l=function(e,t){var n=f(e,t);e.splice(n,0,t)},c=function(){n!=null&&(clearTimeout(n),n=null)},h=function(){c(),Dashboards.refreshEngine.fireRefresh()},p=function(){var e=new Date;return e.getTime()},d=function(e){return t.length>0&&t[0].component==e},v=function(e){Dashboards.update(e)},m=function(n){var r=p();n.refreshPeriod>0||(n.refreshPeriod=e);if(n.refreshPeriod!=e){var i=new Dashboards.RefreshEngine.QueueItem;i.nextRefresh=r+n.refreshPeriod*1e3,i.component=n,l(t,i)}};return{registerComponent:function(t,n){if(!t)return!1;t.refreshPeriod=n>0?n:e;var r=d(t);return u(t),r&&h(),!0},getRefreshPeriod:function(t){return t&&t.refreshPeriod>0?t.refreshPeriod:e},processComponent:function(e){return u(e),m(e),d(e)&&h(),!0},processComponents:function(){a();for(var e=0;e<Dashboards.components.length;e++)m(Dashboards.components[e]);return h(),!0},fireRefresh:function(){n=null;var e=p();while(t.length>0&&t[0].nextRefresh<=e){var r=t.shift();v(r.component)}t.length>0&&(n=setTimeout("Dashboards.refreshEngine.fireRefresh()",t[0].nextRefresh-e))},fireGlobalRefresh:function(){for(i=0;i<Dashboards.components.length;i++){var e=Dashboards.components[i];!(e.refreshPeriod>0)&&e.type!="select"&&v(e)}},setGlobalRefresh:function(e){o(e)},getQueue:function(){return t}}},Dashboards.refreshEngine=new Dashboards.RefreshEngine,pen.define("cdf/Dashboards.RefreshEngine",function(){}),Dashboards.escapeHtml=function(e){var t=/&#([0-9][0-9]?[0-9]?[0-9]?);/,n=/&([a-zA-Z]+);/,r=/&#x[A-F0-9][A-F0-9];/;if(t.test(e)||n.test(e)||r.test(e))return e;var i=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&#34;");return i},Dashboards.getPathParameter=function(e){e=e||window.location.pathname,e=decodeURIComponent(e);var t=e.match("/:(.[^/]+)(.*)/");if(t.length>1)return(":"+t[1]).replace(/:/g,"/")},Dashboards.getQueryParameter=function(e){var t=window.location.search.substring(1),e=e+"=";if(t.length>0){var n=t.indexOf(e);if(n!=-1){n+=e.length;var r=t.indexOf("&",n);return r==-1&&(r=t.length),decodeURIComponent(t.substring(n,r))}}return""},function(e){function t(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];t[r[0]]=r[1]}return t}function n(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push([n,e[n]]);return t}e.propertiesArrayToObject=function(e){return _.isArray(e)&&t(e)||_.isObject(e)&&e||undefined},e.objectToPropertiesArray=function(e){return _.isArray(e)&&e||_.isObject(e)&&n(e)||undefined}}(Dashboards),Dashboards.eachValuesArray=function(e,t,n,r){typeof t=="function"&&(r=n,n=t,t=null);var i=!!t&&!!t.valueAsId;for(var s=0,o=0,u=e.length;s<u;s++){var a=e[s];if(a&&a.length){var f=a[0],l,c,h=undefined;a.length>1?(i&&(h=f),c=""+a[1],l=i||f==null?c:""+f):l=c=""+f;if(n.call(r,l,c,h,o,s)===!1)return!1;o++}}return!0},Dashboards.parseMultipleValues=function(e){if(e!=null&&e!==""){if(this.isArray(e))return e;if(typeof e=="string")return e.split("|")}return null},Dashboards.normalizeValue=function(e){return e===""||e==null?null:this.isArray(e)&&!e.length?null:e},Dashboards.isArray=function(e){return!!e&&(e instanceof Array||typeof e=="object"&&e.join&&e.length!=null)},Dashboards.equalValues=function(e,t){e=this.normalizeValue(e),t=this.normalizeValue(t);if(e===t)return!0;if(this.isArray(e)&&this.isArray(t)){var n=e.length;if(n!==t.length)return!1;while(n--)if(!this.equalValues(e[n],t[n]))return!1;return!0}return e==t},Dashboards.hsvToRgb=function(e,t,n){n/=100,t/=100;var r=e%360/60,i=n*t,s=n-i,o=Math.abs(r%2-1),u=n*(1-t*o),a=n,f;switch(~~r){case 0:f=[a,u,s];break;case 1:f=[u,a,s];break;case 2:f=[s,a,u];break;case 3:f=[s,u,a];break;case 4:f=[u,s,a];break;case 5:f=[a,s,u]}return f.forEach(function(e,t){f[t]=Math.min(255,Math.round(e*256))}),"rgb("+f.join(",")+")"};var Utf8={encode:function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t},decode:function(e){var t="",n=0,r=0,i=0,s=0;while(n<e.length)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(i=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|i&63),n+=2):(i=e.charCodeAt(n+1),s=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63),n+=3);return t}};sprintfWrapper={init:function(){if(typeof arguments=="undefined")return null;if(arguments.length<1)return null;if(typeof arguments[0]!="string")return null;if(typeof RegExp=="undefined")return null;var e=arguments[0],t=new RegExp(/(%([%]|(\-)?(\+|\x20)?(0)?(\d+)?(\.(\d)?)?([bcdfosxX])))/g),n=new Array,r=new Array,i=0,s=0,o=0,u=0,a="",f=null;while(f=t.exec(e)){f[9]&&(i+=1),s=u,o=t.lastIndex-f[0].length,r[r.length]=e.substring(s,o),u=t.lastIndex;var l=parseInt(arguments[i])<0;l||(l=parseFloat(arguments[i])<0),n[n.length]={match:f[0],left:f[3]?!0:!1,sign:f[4]||"",pad:f[5]||" ",min:f[6]||0,precision:f[8],code:f[9]||"%",negative:l,argument:String(arguments[i])}}r[r.length]=e.substring(u);if(n.length==0)return e;if(arguments.length-1<i)return null;f=null;var c=null;for(c=0;c<n.length;c++){var h=n[c],p;h.code=="%"?p="%":h.code=="b"?(h.argument=String(Math.abs(parseInt(h.argument)).toString(2)),p=sprintfWrapper.convert(h,!0)):h.code=="c"?(h.argument=String(String.fromCharCode(parseInt(Math.abs(parseInt(h.argument))))),p=sprintfWrapper.convert(h,!0)):h.code=="d"?(h.argument=toFormatedString(String(Math.abs(parseInt(h.argument)))),p=sprintfWrapper.convert(h)):h.code=="f"?(h.argument=toFormatedString(String(Math.abs(parseFloat(h.argument)).toFixed(h.precision?h.precision:6))),p=sprintfWrapper.convert(h)):h.code=="o"?(h.argument=String(Math.abs(parseInt(h.argument)).toString(8)),p=sprintfWrapper.convert(h)):h.code=="s"?(h.argument=h.argument.substring(0,h.precision?h.precision:h.argument.length),p=sprintfWrapper.convert(h,!0)):h.code=="x"?(h.argument=String(Math.abs(parseInt(h.argument)).toString(16)),p=sprintfWrapper.convert(h)):h.code=="X"?(h.argument=String(Math.abs(parseInt(h.argument)).toString(16)),p=sprintfWrapper.convert(h).toUpperCase()):p=h.match,a+=r[c],a+=p}return a+=r[c],a},convert:function(e,t){t?e.sign="":e.sign=e.negative?"-":e.sign;var n=e.min-e.argument.length+1-e.sign.length,r=(new Array(n<0?0:n)).join(e.pad);return e.left?e.pad=="0"||t?e.sign+e.argument+r.replace(/0/g," "):e.sign+e.argument+r:e.pad=="0"||t?e.sign+r+e.argument:r+e.sign+e.argument}},sprintf=sprintfWrapper.init,function(){function e(e,t){var n={enumerable:!0,configurable:!0};return n[e]=t,n}this.defineGetter=function(n,r,i){if(Object.prototype.__defineGetter__)return n.__defineGetter__(r,i);if(Object.defineProperty)return Object.defineProperty(n,r,e("get",i));throw new Error("browser does not support getters")},this.defineSetter=function(n,r,i){if(Object.prototype.__defineSetter__)return n.__defineSetter__(r,i);if(Object.defineProperty)return Object.defineProperty(n,r,e("set",i));throw new Error("browser does not support setters")}}(),pen.define("cdf/Dashboards.Utils",function(){}),pen.define("cdf/Dashboards",function(){}),BaseComponent=Base.extend(Backbone.Events).extend({visible:!0,isManaged:!0,timerStart:0,timerSplit:0,elapsedSinceSplit:-1,elapsedSinceStart:-1,logColor:undefined,placeholder:function(e){var t=this.htmlObject;return t?$("#"+t+(e?" "+e:"")):$()},focus:function(){try{this.placeholder("*:first").focus()}catch(e){}},_doAutoFocus:function(){this.autoFocus&&(delete this.autoFocus,this.focus())},clear:function(){this.placeholder().empty()},copyEvents:function(e,t){_.each(t,function(t,n){var r=t,i=t.tail;while((r=r.next)!==i)e.on(n,r.callback,r.context)})},clone:function(e,t,n){var r,i,s;return i=this.dashboard,s=this._events,delete this.dashboard,delete this._events,r=$.extend(!0,{},this),r.dashboard=this.dashboard=i,this._events=s,this.copyEvents(r,s),r.parameters&&(r.parameters=r.parameters.map(function(t){return t[1]in e?[t[0],e[t[1]]]:t})),r.components&&(r.components=r.components.map(function(e){return e in t?t[e]:e})),r.htmlObject=r.htmlObject?n[r.htmlObject]:undefined,r.listeners&&(r.listeners=r.listeners.map(function(t){return t in e?e[t]:t})),r.parameter&&r.parameter in e&&(r.parameter=e[r.parameter]),r},getAddIn:function(e,t){var n=typeof this.type=="function"?this.type():this.type;return Dashboards.getAddIn(n,e,t)},hasAddIn:function(e,t){var n=typeof this.type=="function"?this.type():this.type;return Dashboards.hasAddIn(n,e,t)},getValuesArray:function(){var e;if(typeof this.valuesArray=="undefined"||this.valuesArray.length==0){if(typeof this.queryDefinition!="undefined"){var t=this.queryDefinition.queryType=="sql"?"sql":"none";this.queryDefinition.queryType=="mdx"&&!this.valueAsId?t="mdx":this.queryDefinition.dataAccessId!==undefined&&!this.valueAsId&&(t="cda"),QueryComponent.makeQuery(this);var n=new Array;for(r in this.result)if(this.result.hasOwnProperty(r))switch(t){case"sql":n.push([this.result[r][0],this.result[r][1]]);break;case"mdx":n.push([this.result[r][1],this.result[r][0]]);break;case"cda":n.push([this.result[r][0],this.result[r][1]]);break;default:n.push([this.result[r][0],this.result[r][0]])}return n}var r=new Array(this.parameters?this.parameters.length:0);for(var i=0,s=r.length;i<s;i++){var o=this.parameters[i][0],u=this.parameters[i][1]==""||this.parameters[i][1]=="NIL"?this.parameters[i][2]:Dashboards.getParameterValue(this.parameters[i][1]);r[i]=[o,u]}var a=this;if(this.url){var f={};$.each(r,function(e,t){f[t[0]]=t[1]}),e=Dashboards.parseXActionResult(a,Dashboards.urlAction(this.url,f))}else e=Dashboards.callPentahoAction(a,this.solution,this.path,this.action,r,null);var n=this.parseArray(e,!1);return n}return this.valuesArray},parseArray:function(e,t){if(e===null)return[];if($(e).find("CdaExport").size()>0)return this.parseArrayCda(e,t);var n=new Array,r=$(e).find("COLUMN-HDR-ITEM");if(t&&r.size()>0){var i=new Array;r.each(function(){i.push($(this).text())}),n.push(i)}var s=$(e).find("DATA-ROW");return s.each(function(){var e=new Array;$(this).children("DATA-ITEM").each(function(){e.push($(this).text())}),n.push(e)}),n},parseArrayCda:function(e,t){var n=new Array,r=$(e).find("ColumnMetaData");if(r.size()>0&&t){var i=new Array;r.each(function(){i.push($(this).attr("name"))}),n.push(i)}var s=$(e).find("Row");return s.each(function(){var e=new Array;$(this).children("Col").each(function(){e.push($(this).text())}),n.push(e)}),n},setAddInDefaults:function(e,t,n){var r=typeof this.type=="function"?this.type():this.type;Dashboards.setAddInDefaults(r,e,t,n)},setAddInOptions:function(e,t,n){this.addInOptions||(this.addInOptions={}),this.addInOptions[e]||(this.addInOptions[e]={}),this.addInOptions[e][t]=n},getAddInOptions:function(e,t){var n=null;try{n=this.addInOptions[e][t]}catch(r){}return n||{}},startTimer:function(){this.timerStart=new Date,this.timerSplit=new Date},splitTimer:function(){(this.elapsedSinceStart===-1||this.elapsedSinceSplit===-1)&&this.startTimer();var e=new Date;return this.elapsedSinceStart=e.getTime()-this.timerStart.getTime(),this.elapsedSinceSplit=e.getTime()-this.timerSplit.getTime(),this.timerSplit=e,this.getTimerInfo()},formatTimeDisplay:function(e){return Math.log(e)/Math.log(10)>=3?Math.round(e/100)/10+"s":e+"ms"},getTimerInfo:function(){return{timerStart:this.timerStart,timerSplit:this.timerSplit,elapsedSinceStart:this.elapsedSinceStart,elapsedSinceStartDesc:this.formatTimeDisplay(this.elapsedSinceStart),elapsedSinceSplit:this.elapsedSinceSplit,elapsedSinceSplitDesc:this.formatTimeDisplay(this.elapsedSinceSplit)}},getLogColor:function(){if(this.logColor)return this.logColor;var e=function(e){var t=0;if(e.length==0)return t;for(i=0;i<e.length;i++){var n=e.charCodeAt(i);t=(t<<5)-t+n,t&=t}return t},t=e(this.name).toString(),n=t.substr(t.length-6,2)||0,r=t.substr(t.length-2,2)||0,s=t.substr(t.length-4,2)||0;return this.logColor=Dashboards.hsvToRgb(3.6*n,.75*r,45+.35*s),this.logColor}});var TextComponent=BaseComponent.extend({update:function(){this.placeholder().html(this.expression())}}),CommentsComponent=BaseComponent.extend({processing:function(){var e={};return e.defaults={dataTemplates:{comments:'<div class="commentsDetails"> {{#user}} {{{user}}}, {{/user}} {{{createdOn}}}</div><div class="commentsBody"> <div class="comment">   {{{comment}}} </div> {{#user}} <div class="operation"> {{#permissions.deletePermission}}   <div class="delete">X</div> {{/permissions.deletePermission}} {{#permissions.archive}}  <div class="archive">X</div> {{/permissions.archive}} </div> {{/user}}</div>',addComments:'<div class="commentsAdd">{{#add}} <div class="addComment">Add Comment</div> <div class="addCommentWrapper">   <textarea class=addCommentText></textarea>   <div class="commentsButtons">   <div class="saveComment">Save</div>   <div class="cancelComment">Cancel</div>   </div> </div>{{/add}}</div>',paginateComments:'<div class="paginate commentPaginate"> {{#active}} <div class="navigateRefresh"> Refresh </div> <div class="navigatePrevious"> Newest Comments </div> <div class="navigateNext"> Oldest Comments </div>{{/active}}</div>'}},e.operations={processOperation:function(e,t,n,r,i){var s={};switch(e){case"LIST_ALL":s={data:{action:"list",page:i.page,firstResult:i.paginate.firstResult,maxResults:i.paginate.maxResults,where:!1}};break;case"LIST_ACTIVE":s={data:{action:"list",page:i.page,firstResult:i.paginate.firstResult,maxResults:i.paginate.maxResults}};break;case"GET_LAST":s={data:{action:"list",page:i.page,firstResult:0,maxResults:1}};break;case"DELETE_COMMENT":s={data:{action:"delete",page:i.page,commentId:t}};break;case"ARCHIVE_COMMENT":s={data:{action:"archive",page:i.page,commentId:t}};break;case"ADD_COMMENT":s={data:{action:"add",page:i.page,comment:t}}}this.requestProcessing(s,e,n,r)},requestProcessing:function(e,t,n,r){var i=this;e=e||{};var s={type:"GET",url:wd.cdf.endpoints.getComments(t),success:function(e){i.requestResponse(e,t,n,r)},dataType:"json"};s=_.extend({},s,e),$.ajax(s)},resetCollection:function(t){var n=e.options.paginate,r=n.activePageNumber*n.pageCommentsSize,i=r+n.pageCommentsSize<t.length?r+n.pageCommentsSize:t.length,s=[];for(var o=r;o<i;o++){var u=new e.CommentModel(t[o]);s.push(u)}return s},requestResponse:function(t,n,r,i){if(n=="LIST_ALL"||n=="LIST_ACTIVE"){var s=e.options.paginate;s.activePageNumber>0&&s.activePageNumber+1>Math.ceil(t.result.length/s.pageCommentsSize)&&s.activePageNumber--,e.options.queyResult=t.result,r.reset(this.resetCollection(t.result)),s.activePageNumber==0&&t&&typeof t.result!="undefined"&&t.result.length==0&&(t.result=[{id:0,comment:"No Comments to show!",createdOn:"",elapsedMinutes:"",isArchived:!1,isDeleted:!1,isMe:!0,page:"",user:"",permissions:{add:!1,archive:!1,remove:!1}}],r&&typeof r!="undefined"&&r.reset(this.resetCollection(t.result)))}i&&typeof i!="undefined"&&i.apply(this,[t,r])}},e.CommentModel=Backbone.Model.extend({defaults:{id:0,comment:"Guest User",createdOn:"",elapsedMinutes:"",isArchived:!1,isDeleted:!1,isMe:!0,page:"comments",user:"comments",permissions:{}},initialize:function(){this.set("permissions",e.options.permissions)}}),e.CommentView=Backbone.View.extend({tagName:"div",className:"commentView",events:{"click .delete":"deleteComment","click .archive":"archiveComment"},initialize:function(e){_.bindAll(this,"render","deleteComment","archiveComment"),this.model=e},render:function(){return this.$el.append(e.dataTemplates.comments(this.attributes)),this.$el},deleteComment:function(){var t=function(t,n){e.operations.processOperation("LIST_ACTIVE",null,n,null,e.options)};e.operations.processOperation("DELETE_COMMENT",this.model.get("id"),this.model.collection,t,e.options)},archiveComment:function(){var t=function(t,n){e.operations.processOperation("LIST_ACTIVE",null,n,null,e.options)};e.operations.processOperation("ARCHIVE_COMMENT",this.model.get("id"),this.model.collection,t,e.options)}}),e.CommentsCollection=Backbone.Collection.extend({model:e.CommentModel}),e.CommentsView=Backbone.View.extend({tagName:"div",className:"commentComponent",events:{"click .addComment":"addComment","click .saveComment":"saveComment","click .cancelComment":"cancelComment","click .navigatePrevious":"navigatePrevious","click .navigateNext":"navigateNext","click .navigateRefresh":"navigateRefresh"},initialize:function(e){_.bindAll(this,"render","addComment","saveComment","cancelComment","renderSingeComment","addComment","saveComment","cancelComment","navigateNext","navigatePrevious","commentsUpdateNotification"),this.collection=e,this.collection.on("reset",this.render),this.collection.on("commentsUpdateNotification",this.commentsUpdateNotification),this.render()},render:function(){var t=$("#"+e.options.htmlObject),n=$("<div/>").addClass("commentsGroup");_(this.collection.models).each(function(e){n.append(this.renderSingeComment(e))},this);var r=$(e.dataTemplates.addComments(e.options.permissions)),i=$(e.dataTemplates.paginateComments(e.options.paginate));this.$el.empty().append(n,r,i),t.append(this.$el),this.updateNavigateButtons()},renderSingeComment:function(t){var n=new e.CommentView(t);return n.render()},addComment:function(){this.showAddComment()},saveComment:function(){var t=this.$el.find(".addCommentText").val(),n=function(t,n){var r=e.options.paginate;r.activePageNumber=0,e.operations.processOperation("LIST_ACTIVE",null,n,null,e.options)};e.operations.processOperation("ADD_COMMENT",t,this.collection,n,e.options)},cancelComment:function(){this.hideAddComment()},navigateNext:function(){var t=e.options.paginate,n=t.activePageNumber*t.pageCommentsSize;n+t.pageCommentsSize<e.options.queyResult.length&&(t.activePageNumber++,this.collection.reset(e.operations.resetCollection(e.options.queyResult))),this.commentsUpdateNotification(),this.updateNavigateButtons()},navigatePrevious:function(){var t=e.options.paginate,n=t.activePageNumber;t.activePageNumber>0&&(t.activePageNumber--,this.collection.reset(e.operations.resetCollection(e.options.queyResult))),this.commentsUpdateNotification(),this.updateNavigateButtons()},navigateRefresh:function(){var t=e.options.paginate;e.options.paginate.activePageNumber=0,e.operations.processOperation("LIST_ACTIVE",null,this.collection,null,e.options),$(".tipsy").remove()},updateNavigateButtons:function(){var t=e.options.paginate;$(".navigatePrevious").addClass("disabled"),$(".navigateNext").addClass("disabled"),t.activePageNumber>0&&$(".navigatePrevious").removeClass("disabled"),t.activePageNumber+1<Math.ceil(e.options.queyResult.length/t.pageCommentsSize)&&$(".navigateNext").removeClass("disabled")},commentsUpdateNotification:function(){if(e.options.queyResult.length>0){var t=e.options.queyResult[0].createdOn,n=function(e){if(e.result.length>0&&e.result[0].createdOn!=t){var n={html:!0,fade:!0,trigger:"manual",className:"commentsComponentTipsy",title:function(){return"New comments, please refresh!"}};$(".commentComponent .navigateRefresh").attr("title","New comments, please refresh!").tipsy(n),$(".commentComponent .navigateRefresh").tipsy("show")}};e.operations.processOperation("GET_LAST",null,null,n,e.options)}},showAddComment:function(){this.$el.find(".addCommentWrapper").show(),this.$el.find(".paginate").hide(),this.$el.find(".addCommentText").val("")},hideAddComment:function(){this.$el.find(".addCommentWrapper").hide(),this.$el.find(".paginate").show(),this.$el.find(".addCommentText").val("")}}),e.compileTemplates=function(){e.dataTemplates=e.dataTemplates||{},_(e.defaults.dataTemplates).each(function(t,n){e.dataTemplates[n]=Mustache.compile(t)})},e.start=function(t){e.options=t,e.defaults=_.extend({},e.defaults,t.defaults),e.compileTemplates(),e.commentsCollection=new e.CommentsCollection,e.operations.processOperation("LIST_ACTIVE",null,e.commentsCollection,null,e.options),e.commentsView=new e.CommentsView(e.commentsCollection);if(e.options.intervalActive){var n=function(){e.operations.processOperation("LIST_ACTIVE",null,e.commentsCollection,null,e.options)};setInterval(function(){e.commentsCollection.trigger("commentsUpdateNotification")},e.options.interval)}},e},update:function(){this.paginateActive=typeof this.paginate=="undefined"?!0:this.paginate,this.pageCommentsSize=typeof this.pageCommentsSize=="undefined"?10:this.pageCommentsSize,this.firstResult=typeof this.firstResult=="undefined"?0:this.firstResult,this.maxResults=typeof this.maxResults=="undefined"?100:this.maxResults,this.interval=typeof this.interval=="undefined"?6e4:this.interval,this.intervalActive=typeof this.intervalActive=="undefined"?!0:this.intervalActive,this.addPermission=typeof this.addPermission=="undefined"?!0:this.addPermission,this.deletePermission=typeof this.deletePermission=="undefined"?!1:this.deletePermission,this.archivePermission=typeof this.archivePermission=="undefined"?!0:this.archivePermission,this.options=typeof this.options=="undefined"?{}:this.options;if(this.page==undefined){Dashboards.log("Fatal - no page definition passed","error");return}options={htmlObject:this.htmlObject,page:this.page,intervalActive:this.intervalActive,interval:this.interval,paginate:{active:this.paginateActive,activePageNumber:0,pageCommentsSize:this.pageCommentsSize,firstResult:this.firstResult,maxResults:this.maxResults},permissions:{add:this.addPermission,deletePermission:this.deletePermission,archive:this.archivePermission},defaults:this.options},this.processing().start(options)}}),QueryComponent=BaseComponent.extend({visible:!1,update:function(){QueryComponent.makeQuery(this)},warnOnce:function(){Dashboards.log("Warning: QueryComponent behaviour is due to change. See http://http://www.webdetails.org/redmine/projects/cdf/wiki/QueryComponent for more information"),delete this.warnOnce}},{makeQuery:function(e){this.warnOnce&&this.warnOnce();var t=e.queryDefinition;if(t==undefined){Dashboards.log("Fatal - No query definition passed","error");return}var n=Dashboards.getQuery(t);e.queryState=n,n.setAjaxOptions({async:!1}),n.fetchData(e.parameters,function(t){changedValues=undefined,e.metadata=t.metadata,e.result=t.resultset!=undefined?t.resultset:t,e.queryInfo=t.queryInfo,typeof e.postFetch=="function"&&(changedValues=e.postFetch(t)),changedValues!=undefined&&(t=changedValues),e.resultvar!=undefined&&Dashboards.setParameter(e.resultvar,e.result),e.result=t.resultset!=undefined?t.resultset:t,typeof t.resultset!="undefined"&&(e.metadata=t.metadata,e.queryInfo=t.queryInfo)})}}),MdxQueryGroupComponent=BaseComponent.extend({visible:!1,update:function(){OlapUtils.updateMdxQueryGroup(this)}}),ManagedFreeformComponent=BaseComponent.extend({update:function(){this.customfunction(this.parameters||[])}}),UnmanagedComponent=BaseComponent.extend({isManaged:!1,isRunning:!1,preExec:function(){typeof this.runCounter=="undefined"&&(this.runCounter=0);var e;if(typeof this.preExecution=="function")try{e=this.preExecution(),e=typeof e=="undefined"||e}catch(t){this.error(Dashboards.getErrorObj("COMPONENT_ERROR").msg,t),this.dashboard.log(t,"error"),e=!1}else e=!0;return this.trigger("cdf cdf:preExecution",this,e),e},postExec:function(){typeof this.postExecution=="function"&&this.postExecution(),this.trigger("cdf cdf:postExecution",this)},drawTooltip:function(){this.tooltip&&(this._tooltip=typeof this.tooltip=="function"?this.tooltip():this.tooltip)},showTooltip:function(){typeof this._tooltip!="undefined"&&this.placeholder().attr("title",this._tooltip).tooltip({delay:0,track:!0,fade:250})},synchronous:function(e,t){if(!this.preExec())return;var n=this.isSilent();n||this.block(),setTimeout(_.bind(function(){try{e.call(this,t||[]),this.drawTooltip(),this.postExec(),this.showTooltip()}catch(r){this.error(Dashboards.getErrorObj("COMPONENT_ERROR").msg,r),this.dashboard.log(r,"error")}finally{n||this.unblock()}},this),10)},triggerQuery:function(e,t,n){if(!this.preExec())return;var r=this.isSilent();r||this.block(),n=n||{};var i=_.bind(function(e){t(e),this.postExec()},this),s=_.bind(function(){r||this.unblock()},this),o=this.getSuccessHandler(i,s),u=this.getErrorHandler(),a=this.queryState=this.query=Dashboards.getQuery(e),f={async:!0};n.ajax&&_.extend(f,n.ajax),a.setAjaxOptions(f),n.pageSize&&a.setPageSize(n.pageSize),a.fetchData(this.parameters,o,u)},triggerAjax:function(e,t,n,r){if(!this.preExec())return;var i=this.isSilent();i||this.block();var s=$.extend({async:!0},r);typeof n!="function"?(n=t,_.extend(s,e)):_.extend(s,{url:e,data:t});var o=_.bind(function(e){n(e),this.trigger("cdf cdf:render",this,e),this.postExec()},this),u=_.bind(function(){i||this.unblock()},this);s.success=this.getSuccessHandler(o,u),s.error=this.getErrorHandler(),jQuery.ajax(s)},callCounter:function(){return++this.runCounter},error:function(e,t){e=e||Dashboards.getErrorObj("COMPONENT_ERROR").msg,this.isSilent()||this.unblock(),this.errorNotification({error:t,msg:e}),this.trigger("cdf cdf:error",this,e,t||null)},getSuccessHandler:function(e,t,n){return arguments.length===1?(t=e,e=this.callCounter()):typeof e=="function"&&(n=t,t=e,e=this.callCounter()),_.bind(function(r){var i;if(e>=this.runCounter)try{typeof this.postFetch=="function"&&(i=this.postFetch(r),this.trigger("cdf cdf:postFetch",this,r),r=typeof i=="undefined"?r:i),t(r)}catch(s){this.error(Dashboards.getErrorObj("COMPONENT_ERROR").msg,s),this.dashboard.log(s,"error")}typeof n=="function"&&n()},this)},getErrorHandler:function(){return _.bind(function(){var e=Dashboards.parseServerError.apply(this,arguments);this.error(e.msg,e.error)},this)},errorNotification:function(e,t){t=t||(this.htmlObject?this.placeholder():undefined);var n=this.name.replace("render_","");e.msg=e.msg+" ("+n+")",Dashboards.errorNotification(e,t)},block:function(){this.isRunning||(this.dashboard.incrementRunningCalls(),this.isRunning=!0)},unblock:function(){this.isRunning&&(this.dashboard.decrementRunningCalls(),this.isRunning=!1)},isSilent:function(){return this.lifecycle?!!this.lifecycle.silent:!1}}),FreeformComponent=UnmanagedComponent.extend({update:function(){var e=_.bind(this.render,this);typeof this.manageCallee=="undefined"||this.manageCallee?this.synchronous(e):e()},render:function(){var e=this.parameters||[];this.customfunction(e)}}),ActionComponent=UnmanagedComponent.extend({_docstring:function(){return"Abstract class for components calling a query/endpoint"},update:function(){var e=_.bind(this.render,this);_.isUndefined(this.manageCallee)||this.manageCallee?this.synchronous(e):e()},triggerAction:function(){var e=Dashboards.propertiesArrayToObject(this.actionParameters),t=this.failureCallback?_.bind(this.failureCallback,this):function(){},n=this.successCallback?_.bind(this.successCallback,this):function(){};return Dashboards.getQuery(this.actionDefinition).fetchData(e,n,t)},hasAction:function(){return this.actionDefinition?Dashboards.detectQueryType?!!Dashboards.detectQueryType(this.actionDefinition):!!this.actionDefinition.queryType&&Dashboards.hasQuery(this.actionDefinition.queryType):!1}});pen.define("cdf/components/core",function(){}),pen.define("cdf/lib/CCC/protovis",[],function(){Array.prototype.map||(Array.prototype.map=function(e,t){for(var n=this.length,r=new Array(n),i=0;n>i;i++)i in this&&(r[i]=e.call(t,this[i],i,this));return r}),Array.prototype.filter||(Array.prototype.filter=function(e,t){for(var n=this.length,r=new Array,i=0;n>i;i++)if(i in this){var s=this[i];e.call(t,s,i,this)&&r.push(s)}return r}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var n=this.length>>>0,r=0;n>r;r++)r in this&&e.call(t,this[r],r,this)}),Array.prototype.reduce||(Array.prototype.reduce=function(e,t){var n=this.length;if(!n&&1==arguments.length)throw new Error("reduce: empty array, no initial value");var r=0;if(arguments.length<2)for(;;){if(r in this){t=this[r++];break}if(++r>=n)throw new Error("reduce: no values, no initial value")}for(;n>r;r++)r in this&&(t=e(t,this[r],r,this));return t}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){for(var n=this.length>>>0,r=!isFinite(t)||0>t?0:t>this.length?this.length:t;n>r;r++)if(this[r]===e)return r;return-1}),Date.now||(Date.now=function(){return+(new Date)}),Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t});var e={};return e.version={major:3,minor:3},e.identity=function(e){return e},e.index=function(){return this.index},e.child=function(){return this.childIndex},e.parent=function(){return this.parent.index},!function(){e.extend=function(e){return Object.create(e.prototype||e)},e.extendType=function(t,n){var r=t.prototype=e.extend(n);return r.constructor=t,t},e.parse=function(t){for(var n,r,i=new RegExp("function\\s*(\\b\\w+)?\\s*\\([^)]*\\)\\s*","mg"),s=0,o="";n=i.exec(t);){var u=n.index+n[0].length;if("{"!=t.charAt(u)){o+=t.substring(s,u)+"{return ",s=u;for(var a=0;a>=0&&u<t.length;u++){var f=t.charAt(u);switch(f){case'"':case"'":for(;++u<t.length&&(r=t.charAt(u))!=f;)"\\"==r&&u++;break;case"[":case"(":a++;break;case"]":case")":a--;break;case";":case",":0==a&&a--}}o+=e.parse(t.substring(s,--u))+";}",s=u}i.lastIndex=u}return o+=t.substring(s),o},e.error=function(e){"undefined"!=typeof console&&console.error?console.error(e):alert(e)},e.listen=function(t,n,r){return r=e.listener(r),"load"===n||"onload"===n?e.listenForPageLoad(r):(t.addEventListener?t.addEventListener(n,r,!1):(t===window&&(t=document.documentElement),t.attachEvent("on"+n,r)),r)},e.unlisten=function(e,t,n){n.$listener&&(n=n.$listener),e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)},e.listenForPageLoad=function(e){"complete"!==document.readyState?document.addEventListener?window.addEventListener("load",e,!1):document.attachEvent&&window.attachEvent("onload",e):e(null)},e.listener=function(t){return t.$listener||(t.$listener=function(n){try{return e.event=n=n&&e.fixEvent(n),t.call(this,n)}catch(r){e.error(r)}finally{delete e.event}})},e.fixEvent=function(e){if(null==e.pageX&&null!=e.clientX){var t=e.target&&e.target.ownerDocument||document,n=t.documentElement,r=t.body;e.pageX=1*e.clientX+(n&&n.scrollLeft||r&&r.scrollLeft||0)-(n&&n.clientLeft||r&&r.clientLeft||0),e.pageY=1*e.clientY+(n&&n.scrollTop||r&&r.scrollTop||0)-(n&&n.clientTop||r&&r.clientTop||0)}return e},e.ancestor=function(e,t){for(;t;){if(t===e)return!0;t=t.parentNode}return!1},e.removeChildren=function(e){for(;e.lastChild;)e.removeChild(e.lastChild)},e.getWindow=function(e){return null!=e&&e==e.window?e:9===e.nodeType?e.defaultView||e.parentWindow:!1};var t=/\-([a-z])/g;e.hiphen2camel=function(e){return t.test(e)?e.replace(t,function(e,t){return t.toUpperCase()}):e};var n=window.getComputedStyle;e.css=function(t,r){return n?n.call(window,t,null).getPropertyValue(r):t.currentStyle["float"===r?"styleFloat":e.hiphen2camel(r)]},e.cssStyle=function(t){var r;return n?(r=n.call(window,t,null),function(e){return r.getPropertyValue(e)}):(r=t.currentStyle,function(t){return r["float"===t?"styleFloat":e.hiphen2camel(t)]})},e._getElementsByClass=function(e,t){null==t&&(t=document);for(var n=[],r=t.getElementsByTagName("*"),i=r.length,s=new RegExp("(^|\\s)"+e+"(\\s|$)"),o=0,u=0;i>o;o++)s.test(r[o].className)&&(n[u]=r[o],u++);return n},e.getElementsByClassName=function(t,n){return t.getElementsByClassName?t.getElementsByClassName(n):e._getElementsByClass(n,t)},e.elementOffset=function(t){var n=t&&t.ownerDocument;if(n){var r=n.body;if(r!==t){var i;i="undefined"!=typeof t.getBoundingClientRect?t.getBoundingClientRect():{top:0,left:0};var s=e.getWindow(n),o=n.documentElement,u=o.clientTop||r.clientTop||0,a=o.clientLeft||r.clientLeft||0,f=s.pageYOffset||o.scrollTop,l=s.pageXOffset||o.scrollLeft;return{top:i.top+f-u,left:i.left+l-a}}}},e.renderer=function(){var t=document.svgImplementation||"nativesvg";return e.renderer=function(){return t},t};var r=1;e.id=function(){return r++},e.functor=function(e){return"function"==typeof e?e:function(){return e}},e.get=function(e,t,n){var r;return e&&null!=(r=e[t])?r:n};var i=Object.prototype.hasOwnProperty;e.lazyArrayOwn=function(e,t){var n;return e&&i.call(e,t)&&(n=e[t])?n:e[t]=[]}}(),e.listen(window,"load",function(){e.$={i:0,x:document.getElementsByTagName("script")},e.$.xlen=e.$.x.length;for(;e.$.i<e.$.xlen;e.$.i++){e.$.s=e.$.x[e.$.i];if("text/javascript+protovis"==e.$.s.type)try{window.eval(e.parse(e.$.s.text))}catch(t){e.error(t)}}delete e.$}),e.Format={},e.Format.re=function(e){return e.replace(/[\\\^\$\*\+\?\[\]\(\)\.\{\}]/g,"\\$&")},e.Format.pad=function(e,t,n){var r=t-String(n).length;return 1>r?n:(new Array(r+1)).join(e)+n},e.Format.date=function(t){function n(e){return t.replace(/%[a-zA-Z0-9]/g,function(t){switch(t){case"%a":return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()];case"%A":return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.getDay()];case"%h":case"%b":return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()];case"%B":return["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()];case"%c":return e.toLocaleString();case"%C":return r("0",2,Math.floor(e.getFullYear()/100)%100);case"%d":return r("0",2,e.getDate());case"%x":case"%D":return r("0",2,e.getMonth()+1)+"/"+r("0",2,e.getDate())+"/"+r("0",2,e.getFullYear()%100);case"%e":return r(" ",2,e.getDate());case"%H":return r("0",2,e.getHours());case"%I":var n=e.getHours()%12;return n?r("0",2,n):12;case"%m":return r("0",2,e.getMonth()+1);case"%M":return r("0",2,e.getMinutes());case"%n":return"\n";case"%p":return e.getHours()<12?"AM":"PM";case"%T":case"%X":case"%r":var n=e.getHours()%12;return(n?r("0",2,n):12)+":"+r("0",2,e.getMinutes())+":"+r("0",2,e.getSeconds())+" "+(e.getHours()<12?"AM":"PM");case"%R":return r("0",2,e.getHours())+":"+r("0",2,e.getMinutes());case"%S":return r("0",2,e.getSeconds());case"%Q":return r("0",3,e.getMilliseconds());case"%t":return"	";case"%u":var i=e.getDay();return i?i:1;case"%w":return e.getDay();case"%y":return r("0",2,e.getFullYear()%100);case"%Y":return e.getFullYear();case"%%":return"%"}return t})}var r=e.Format.pad;return n.format=n,n.parse=function(n){var r=1970,i=0,s=1,o=0,u=0,a=0,f=[function(){}],l=e.Format.re(t).replace(/%[a-zA-Z0-9]/g,function(e){switch(e){case"%b":return f.push(function(e){i={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[e]}),"([A-Za-z]+)";case"%h":case"%B":return f.push(function(e){i={January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11}[e]}),"([A-Za-z]+)";case"%e":case"%d":return f.push(function(e){s=e}),"([0-9]+)";case"%I":case"%H":return f.push(function(e){o=e}),"([0-9]+)";case"%m":return f.push(function(e){i=e-1}),"([0-9]+)";case"%M":return f.push(function(e){u=e}),"([0-9]+)";case"%p":return f.push(function(e){12==o?"am"==e&&(o=0):"pm"==e&&(o=Number(o)+12)}),"(am|pm)";case"%S":return f.push(function(e){a=e}),"([0-9]+)";case"%y":return f.push(function(e){e=Number(e),r=e+(e>=0&&69>e?2e3:e>=69&&100>e?1900:0)}),"([0-9]+)";case"%Y":return f.push(function(e){r=e}),"([0-9]+)";case"%%":return f.push(function(){}),"%"}return e}),c=n.match(l);return c&&c.forEach(function(e,t){f[t](e)}),new Date(r,i,s,o,u,a)},n},e.Format.time=function(t){function n(e){e=Number(e);switch(t){case"short":return e>=31536e6?(e/31536e6).toFixed(1)+" years":e>=6048e5?(e/6048e5).toFixed(1)+" weeks":e>=864e5?(e/864e5).toFixed(1)+" days":e>=36e5?(e/36e5).toFixed(1)+" hours":e>=6e4?(e/6e4).toFixed(1)+" minutes":(e/1e3).toFixed(1)+" seconds";case"long":var n=[],i=e%6e4/1e3>>0,s=e%36e5/6e4>>0;n.push(r("0",2,i));if(e>=36e5){var o=e%864e5/36e5>>0;n.push(r("0",2,s)),e>=864e5?(n.push(r("0",2,o)),n.push(Math.floor(e/864e5).toFixed())):n.push(o.toFixed())}else n.push(s.toFixed());return n.reverse().join(":")}}var r=e.Format.pad;return n.format=n,n.parse=function(e){switch(t){case"short":for(var n,r=/([0-9,.]+)\s*([a-z]+)/g,i=0;n=r.exec(e);){var s=parseFloat(n[0].replace(",","")),o=0;switch(n[2].toLowerCase()){case"year":case"years":o=31536e6;break;case"week":case"weeks":o=6048e5;break;case"day":case"days":o=864e5;break;case"hour":case"hours":o=36e5;break;case"minute":case"minutes":o=6e4;break;case"second":case"seconds":o=1e3}i+=s*o}return i;case"long":var n=e.replace(",","").split(":").reverse(),i=0;return n.length&&(i+=1e3*parseFloat(n[0])),n.length>1&&(i+=6e4*parseFloat(n[1])),n.length>2&&(i+=36e5*parseFloat(n[2])),n.length>3&&(i+=864e5*parseFloat(n[3])),i}},n},e.Format.number=function(){function t(e){1/0>o&&(e=Math.round(e*u)/u);var t=String(Math.abs(e)).split("."),v=t[0];v.length>r&&(v=v.substring(v.length-r)),l&&v.length<n&&(v=(new Array(n-v.length+1)).join(a)+v),v.length>3&&(v=v.replace(/\B(?=(?:\d{3})+(?!\d))/g,h)),!l&&v.length<i&&(v=(new Array(i-v.length+1)).join(a)+v),t[0]=0>e?p+v+d:v;var m=t[1]||"";return m.length>o&&(m=t[1]=m.substr(0,o)),m.length<s&&(t[1]=m+(new Array(s-m.length+1)).join(f)),t.join(c)}var n=0,r=1/0,i=0,s=0,o=0,u=1,a="0",f="0",l=!0,c=".",h=",",p="−",d="";return t.format=t,t.parse=function(t){var n=e.Format.re,i=String(t).split(c);1==i.length&&(i[1]=""),i[0].replace(new RegExp("^("+n(a)+")*"),""),i[1].replace(new RegExp("("+n(f)+")*$"),"");var s=i[0].replace(new RegExp(n(h),"g"),"");s.length>r&&(s=s.substring(s.length-r));var l=i[1]?Number("0."+i[1]):0;return 1/0>o&&(l=Math.round(l*u)/u),Math.round(s)+l},t.integerDigits=function(e,t){return arguments.length?(n=Number(e),r=arguments.length>1?Number(t):n,i=n+Math.floor(n/3)*h.length,this):[n,r]},t.fractionDigits=function(e,t){return arguments.length?(s=Number(e),o=arguments.length>1?Number(t):s,u=Math.pow(10,o),this):[s,o]},t.integerPad=function(e){return arguments.length?(a=String(e),l=/\d/.test(a),this):a},t.fractionPad=function(e){return arguments.length?(f=String(e),this):f},t.decimal=function(e){return arguments.length?(c=String(e),this):c},t.group=function(e){return arguments.length?(h=e?String(e):"",i=n+Math.floor(n/3)*h.length,this):h},t.negativeAffix=function(e,t){return arguments.length?(p=String(e||""),d=String(t||""),this):[p,d]},t},!function(){var t;e.Text={},e.Text.createCache=function(){return new n},e.Text.usingCache=function(e,r,i){if(!(e instanceof n))throw new Error("Not a valid cache.");var s=t;t=e;try{return r.call(i)}finally{t=s}},e.Text.measure=function(e,n){e=null==e?"":String(e);var r=t&&t.get(n,e);return r||(r=e?this.measureCore(e,n):{width:0,height:0},t&&t.put(n,e,r)),r},e.Text.measureWidth=function(t,n){return e.Text.measure(t,n).width},e.Text.fontHeight=function(t){return e.Text.measure("M",t).height},e.Text.measureCore=function(){function t(){return r||(r=n())}function n(){var t=document.createElement("div");t.id="pvSVGText_"+(new Date).getTime();var n=t.style;n.position="absolute",n.visibility="hidden",n.width=0,n.height=0,n.left=0,n.top=0,n.lineHeight=1,n.textTransform="none",n.letterSpacing="normal",n.whiteSpace="nowrap";var r=e.SvgScene.create("svg");r.setAttribute("font-size","10px"),r.setAttribute("font-family","sans-serif"),t.appendChild(r);var i=e.SvgScene.create("text");return r.appendChild(i),i.appendChild(document.createTextNode("")),document.body.appendChild(t),i}var r,i="10px sans-serif";return function(n,r){r||(r=null);var s=t();i!==r&&(i=r,e.SvgScene.setStyle(s,{font:r})),s.firstChild.nodeValue=String(n);var o;try{o=s.getBBox()}catch(u){throw"function"==typeof console.error&&console.error("GetBBox failed: ",u),u}return{width:o.width,height:o.height}}}();var n=function(){this._fontsCache={}},r=Object.prototype.hasOwnProperty;n.prototype._getFont=function(e){return e=e||"",r.call(this._fontsCache,e)?this._fontsCache[e]:this._fontsCache[e]={}},n.prototype.get=function(e,t){t=t||"";var n=this._getFont(e);return r.call(n,t)?n[t]:null},n.prototype.put=function(e,t,n){return this._getFont(e)[t||""]=n}}(),e.map=function(e,t){var n={};return t?e.map(function(e,r){return n.index=r,t.call(n,e)}):e.slice()},e.repeat=function(t,n){return 1==arguments.length&&(n=2),e.blend(e.range(n).map(function(){return t}))},e.array=function(e,t){var n=e>=0?new Array(e):[];if(void 0!==t)for(var r=0;e>r;r++)n[r]=t;return n},e.cross=function(e,t){for(var n=[],r=0,i=e.length,s=t.length;i>r;r++)for(var o=0,u=e[r];s>o;o++)n.push([u,t[o]]);return n},e.blend=function(e){return Array.prototype.concat.apply([],e)},e.transpose=function(t){var n=t.length,r=e.max(t,function(e){return e.length});if(r>n){t.length=r;for(var i=n;r>i;i++)t[i]=new Array(n);for(var i=0;n>i;i++)for(var s=i+1;r>s;s++){var o=t[i][s];t[i][s]=t[s][i],t[s][i]=o}}else{for(var i=0;r>i;i++)t[i].length=n;for(var i=0;n>i;i++)for(var s=0;i>s;s++){var o=t[i][s];t[i][s]=t[s][i],t[s][i]=o}}t.length=r;for(var i=0;r>i;i++)t[i].length=n;return t},e.normalize=function(t,n){for(var r=e.map(t,n),i=e.sum(r),s=0;s<r.length;s++)r[s]/=i;return r},e.permute=function(t,n,r){r||(r=e.identity);var i=new Array(n.length),s={};return n.forEach(function(e,n){s.index=e,i[n]=r.call(s,t[e])}),i},e.numerate=function(t,n){n||(n=e.identity);var r={},i={};return t.forEach(function(e,t){i.index=t,r[n.call(i,e)]=t}),r},e.uniq=function(t,n){n||(n=e.identity);var r,i={},s=[],o={};return t.forEach(function(e,t){o.index=t,r=n.call(o,e),r in i||(i[r]=s.push(r))}),s},e.naturalOrder=function(e,t){return t>e?-1:e>t?1:0},e.reverseOrder=function(e,t){return e>t?-1:t>e?1:0},e.search=function(t,n,r){r||(r=e.identity);for(var i=0,s=t.length-1;s>=i;){var o=i+s>>1,u=r(t[o]);if(n>u)i=o+1;else{if(!(u>n))return o;s=o-1}}return-i-1},e.search.index=function(t,n,r){var i=e.search(t,n,r);return 0>i?-i-1:i},e.range=function(e,t,n){1==arguments.length&&(t=e,e=0),void 0==n&&(n=1);if(1/0==(t-e)/n)throw new Error("range must be finite");var r,i=[],s=0;t-=1e-10*(t-e);if(0>n)for(;(r=e+n*s++)>t;)i.push(r);else for(;(r=e+n*s++)<t;)i.push(r);return i},e.random=function(e,t,n){return 1==arguments.length&&(t=e,e=0),void 0==n&&(n=1),n?Math.floor(Math.random()*(t-e)/n)*n+e:Math.random()*(t-e)+e},e.sum=function(e,t){var n={};return e.reduce(t?function(e,r,i){return n.index=i,e+t.call(n,r)}:function(e,t){return e+t},0)},e.max=function(t,n){return n==e.index?t.length-1:Math.max.apply(null,n?e.map(t,n):t)},e.max.index=function(t,n){if(!t.length)return-1;if(n==e.index)return t.length-1;n||(n=e.identity);for(var r=0,i=-1/0,s={},o=0;o<t.length;o++){s.index=o;var u=n.call(s,t[o]);u>i&&(i=u,r=o)}return r},e.min=function(t,n){return n==e.index?0:Math.min.apply(null,n?e.map(t,n):t)},e.min.index=function(t,n){if(!t.length)return-1;if(n==e.index)return 0;n||(n=e.identity);for(var r=0,i=1/0,s={},o=0;o<t.length;o++){s.index=o;var u=n.call(s,t[o]);i>u&&(i=u,r=o)}return r},e.mean=function(t,n){return e.sum(t,n)/t.length},e.median=function(t,n){if(n==e.index)return(t.length-1)/2;t=e.map(t,n).sort(e.naturalOrder);if(t.length%2)return t[Math.floor(t.length/2)];var r=t.length/2;return(t[r-1]+t[r])/2},e.variance=function(t,n){if(t.length<1)return 0/0;if(1==t.length)return 0;var r=e.mean(t,n),i=0,s={};n||(n=e.identity);for(var o=0;o<t.length;o++){s.index=o;var u=n.call(s,t[o])-r;i+=u*u}return i},e.deviation=function(t,n){return Math.sqrt(e.variance(t,n)/(t.length-1))},e.log=function(e,t){return Math.log(e)/Math.log(t)},e.logSymmetric=function(t,n){return 0==t?0:0>t?-e.log(-t,n):e.log(t,n)},e.logAdjusted=function(t,n){if(!isFinite(t))return t;var r=0>t;return n>t&&(t+=(n-t)/n),r?-e.log(t,n):e.log(t,n)},e.logFloor=function(t,n){return t>0?Math.pow(n,Math.floor(e.log(t,n))):-Math.pow(n,-Math.floor(-e.log(-t,n)))},e.logCeil=function(t,n){return t>0?Math.pow(n,Math.ceil(e.log(t,n))):-Math.pow(n,-Math.ceil(-e.log(-t,n)))},!function(){var t=Math.PI/180,n=180/Math.PI;e.radians=function(e){return t*e},e.degrees=function(e){return n*e}}(),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t},e.entries=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},e.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},e.dict=function(e,t){for(var n={},r={},i=0;i<e.length;i++)if(i in e){var s=e[i];r.index=i,n[s]=t.call(r,s)}return n},e.hasOwnProp=Object.prototype.hasOwnProperty,e.copyOwn=function(t,n){if(n){var r=e.hasOwnProp;for(var i in n)r.call(n,i)&&(t[i]=n[i])}return t},e.dom=function(t){return new e.Dom(t)},e.Dom=function(e){this.$map=e},e.Dom.prototype.$leaf=function(e){return"object"!=typeof e},e.Dom.prototype.leaf=function(e){return arguments.length?(this.$leaf=e,this):this.$leaf},e.Dom.prototype.root=function(t){function n(t){var i=new e.Dom.Node;for(var s in t){var o=t[s];i.appendChild(r(o)?new e.Dom.Node(o):n(o)).nodeName=s}return i}var r=this.$leaf,i=n(this.$map);return i.nodeName=t,i},e.Dom.prototype.nodes=function(){return this.root().nodes()},e.Dom.Node=function(e){void 0!==e&&(this.nodeValue=e)},e.Dom.Node.prototype.nodeValue=void 0,e.Dom.Node.prototype.childNodes=[],e.Dom.Node.prototype.parentNode=null,e.Dom.Node.prototype.firstChild=null,e.Dom.Node.prototype.lastChild=null,e.Dom.Node.prototype.previousSibling=null,e.Dom.Node.prototype.nextSibling=null,e.Dom.Node.prototype._firstDirtyChildIndex=1/0,e.Dom.Node.prototype._childIndex=-1,e.Dom.Node.prototype.findChildIndex=function(e){if(!e)throw new Error("Argument 'n' required");if(e.parentNode===this){var t=e.childIndex(!0);if(t>-1)return t}throw new Error("child not found")},e.Dom.Node.prototype._childRemoved=function(){},e.Dom.Node.prototype._childAdded=function(){},e.Dom.Node.prototype.removeChild=function(e){var t=this.findChildIndex(e);return this.removeAt(t)},e.Dom.Node.prototype.appendChild=function(t){var n=t.parentNode;n&&n.removeChild(t);var r=this.lastChild;t.parentNode=this,t.previousSibling=r,r?(r.nextSibling=t,t._childIndex=r._childIndex+1):(this.firstChild=t,t._childIndex=0),this.lastChild=t;var i=e.lazyArrayOwn(this,"childNodes").push(t);return this._childAdded(t,i-1),t},e.Dom.Node.prototype.insertBefore=function(e,t){if(!t)return this.appendChild(e);var n=this.findChildIndex(t);return this.insertAt(e,n)},e.Dom.Node.prototype.insertAt=function(e,t){if(null==t)return this.appendChild(e);var n=this.childNodes,r=n.length;if(t===r)return this.appendChild(e);if(0>t||t>r)throw new Error("Index out of range.");var i=e.parentNode;i&&i.removeChild(e);var s=t+1;s<this._firstDirtyChildIndex&&(this._firstDirtyChildIndex=s);var o=n[t];e.parentNode=this,e.nextSibling=o,e._childIndex=t;var u=e.previousSibling=o.previousSibling;return o.previousSibling=e,u?u.nextSibling=e:(o===this.lastChild&&(this.lastChild=e),this.firstChild=e),n.splice(t,0,e),this._childAdded(e,t),e},e.Dom.Node.prototype.removeAt=function(e){var t=this.childNodes,n=t.length;if(!(0>e||e>=n)){var r=t[e];t.splice(e,1),n-1>e&&e<this._firstDirtyChildIndex&&(this._firstDirtyChildIndex=e);var i=r.previousSibling,s=r.nextSibling;return i?i.nextSibling=s:this.firstChild=s,s?s.previousSibling=i:this.lastChild=i,r.nextSibling=r.previousSibling=r.parentNode=null,this._childRemoved(r,e),r}},e.Dom.Node.prototype.replaceChild=function(e,t){var n=this.findChildIndex(t),r=e.parentNode;r&&r.removeChild(e),e.parentNode=this,e.nextSibling=t.nextSibling,e._childIndex=t._childIndex;var i=e.previousSibling=t.previousSibling;i?i.nextSibling=e:this.firstChild=e;var s=t.nextSibling;return s?s.previousSibling=e:this.lastChild=e,this.childNodes[n]=e,this._childRemoved(t,n),this._childAdded(e,n),t},e.Dom.Node.prototype.childIndex=function(e){var t=this.parentNode;if(t){var n=t._firstDirtyChildIndex;if(1/0>n){var r=t.childNodes;if(!e)return r.indexOf(this);for(var i=r.length;i>n;)r[n]._childIndex=n,n++;t._firstDirtyChildIndex=1/0}return this._childIndex}return-1},e.Dom.Node.prototype.visitBefore=function(e){function t(n,r){e(n,r);for(var i=n.firstChild;i;i=i.nextSibling)t(i,r+1)}t(this,0)},e.Dom.Node.prototype.visitAfter=function(e){function t(n,r){for(var i=n.firstChild;i;i=i.nextSibling)t(i,r+1);e(n,r)}t(this,0)},e.Dom.Node.prototype.sort=function(e){if(this.firstChild){this._firstDirtyChildIndex=1/0;var t=this.childNodes;t.sort(e);var n,r=this.firstChild=t[0];delete r.previousSibling,r._childIndex=0;for(var i=1,s=t.length;s>i;i++)r.sort(e),n=t[i],n._childIndex=i,n.previousSibling=r,r=r.nextSibling=n;this.lastChild=r,delete r.nextSibling,r.sort(e)}return this},e.Dom.Node.prototype.reverse=function(){var e=[];return this.visitAfter(function(t){this._firstDirtyChildIndex=1/0;for(var n;n=t.lastChild;)e.push(t.removeChild(n));if(e.length)for(;n=e.pop();)t.insertBefore(n,t.firstChild)}),this},e.Dom.Node.prototype.nodes=function(){var e=[];return this.visitBefore(function(t){e.push(t)}),e},e.Dom.Node.prototype.toggle=function(e){if(e)return this.toggled?this.visitBefore(function(e){e.toggled&&e.toggle()}):this.visitAfter(function(e){e.toggled||e.toggle()});var t,n=this;if(n.toggled){for(;t=n.toggled.pop();)n.appendChild(t);delete n.toggled}else if(t=n.lastChild){n.toggled=[];do n.toggled.push(n.removeChild(t));while(t=n.lastChild)}},e.nodes=function(t){for(var n=new e.Dom.Node,r=0,i=t.length;i>r;r++)n.appendChild(new e.Dom.Node(t[r]));return n.nodes()},e.tree=function(t){return new e.Tree(t)},e.Tree=function(e){this.array=e},e.Tree.prototype.keys=function(e){return this.k=e,this},e.Tree.prototype.value=function(e){return this.v=e,this},e.Tree.prototype.map=function(){for(var e={},t={},n=0;n<this.array.length;n++){t.index=n;for(var r=this.array[n],i=this.k.call(t,r),s=e,o=0;o<i.length-1;o++)s=s[i[o]]||(s[i[o]]={});s[i[o]]=this.v?this.v.call(t,r):r}return e},e.nest=function(t){return new e.Nest(t)},e.Nest=function(e){this.array=e,this.keys=[]},e.Nest.prototype.key=function(e){return this.keys.push(e),this},e.Nest.prototype.sortKeys=function(t){return this.keys[this.keys.length-1].order=t||e.naturalOrder,this},e.Nest.prototype.sortValues=function(t){return this.order=t||e.naturalOrder,this},e.Nest.prototype.map=function(){for(var e,t={},n=[],r=0;r<this.array.length;r++){var i=this.array[r],s=t;for(e=0;e<this.keys.length-1;e++){var o=this.keys[e](i);s[o]||(s[o]={}),s=s[o]}o=this.keys[e](i);if(!s[o]){var u=[];n.push(u),s[o]=u}s[o].push(i)}if(this.order)for(var e=0;e<n.length;e++)n[e].sort(this.order);return t},e.Nest.prototype.entries=function(){function e(t){var n=[];for(var r in t){var i=t[r];n.push({key:r,values:i instanceof Array?i:e(i)})}return n}function t(e,n){var r=this.keys[n].order;r&&e.sort(function(e,t){return r(e.key,t.key)});if(++n<this.keys.length)for(var i=0;i<e.length;i++)t.call(this,e[i].values,n);return e}return t.call(this,e(this.map()),0)},e.Nest.prototype.rollup=function(e){function t(n){for(var r in n){var i=n[r];i instanceof Array?n[r]=e(i):t(i)}return n}return t(this.map())},e.flatten=function(t){return new e.Flatten(t)},e.Flatten=function(e){this.map=e,this.keys=[]},e.Flatten.prototype.key=function(e,t){return this.keys.push({name:e,value:t}),delete this.$leaf,this},e.Flatten.prototype.leaf=function(e){return this.keys.length=0,this.$leaf=e,this},e.Flatten.prototype.array=function(){function e(t,i){if(s(t))n.push({keys:r.slice(),value:t});else for(var o in t)r.push(o),e(t[o],i+1),r.pop()}function t(e,s){if(s<i.length-1)for(var o in e)r.push(o),t(e[o],s+1),r.pop();else n.push(r.concat(e))}var n=[],r=[],i=this.keys,s=this.$leaf;return s?(e(this.map,0),n):(t(this.map,0),n.map(function(e){for(var t={},n=0;n<i.length;n++){var r=i[n],s=e[n];t[r.name]=r.value?r.value.call(null,s):s}return t}))},e.Transform=function(){},e.Transform.prototype={k:1,x:0,y:0},e.Transform.identity=new e.Transform,e.Transform.prototype.translate=function(t,n){var r=new e.Transform;return r.k=this.k,r.x=this.k*t+this.x,r.y=this.k*n+this.y,r},e.Transform.prototype.scale=function(t){var n=new e.Transform;return n.k=this.k*t,n.x=this.x,n.y=this.y,n},e.Transform.prototype.invert=function(){var t=new e.Transform,n=1/this.k;return t.k=n,t.x=-this.x*n,t.y=-this.y*n,t},e.Transform.prototype.times=function(t){var n=new e.Transform;return n.k=this.k*t.k,n.x=this.k*t.x+this.x,n.y=this.k*t.y+this.y,n},e.Scale=function(){},e.Scale.interpolator=function(t,n){if("number"==typeof t)return function(e){return e*(n-t)+t};var r=t.type&&"solid"!==t.type,i=n.type&&"solid"!==n.type;return r||i?(t=r?t:e.color(t).rgb(),n=i?n:e.color(n).rgb(),function(e){return.5>e?t:n}):(t=e.color(t).rgb(),n=e.color(n).rgb(),function(r){var i=t.a*(1-r)+n.a*r;return 1e-5>i&&(i=0),0==t.a?e.rgb(n.r,n.g,n.b,i):0==n.a?e.rgb(t.r,t.g,t.b,i):e.rgb(Math.round(t.r*(1-r)+n.r*r),Math.round(t.g*(1-r)+n.g*r),Math.round(t.b*(1-r)+n.b*r),i)})},e.Scale.common={by:function(e){function t(){return n(e.apply(this,arguments))}var n=this;for(var r in n)t[r]=n[r];return t},by1:function(e){function t(t){return n(e.call(this,t))}var n=this;for(var r in n)t[r]=n[r];return t},transform:function(e){function t(){return e.call(this,n.apply(n,arguments))}var n=this;for(var r in n)t[r]=n[r];return t}},e.Scale.quantitative=function(){function t(e){return new Date(e)}function n(t){var n=e.search(u,t);return 0>n&&(n=-n-2),n=Math.max(0,Math.min(l.length-1,n)),l[n]((p(t)-a[n])/(a[n+1]-a[n]))}var r,i,s,o,u=[0,1],a=[0,1],f=[0,1],l=[e.identity],c=Number,h=!1,p=e.identity,d=e.identity,v=String,m=null;return n.transform=function(e,t){return p=function(t){return h?-e(-t):e(t)},d=function(e){return h?-t(-e):t(e)},a=u.map(p),this},n.domain=function(n,r,i){if(arguments.length){var s;return n instanceof Array?(arguments.length<2&&(r=e.identity),arguments.length<3&&(i=r),s=n.length&&r(n[0]),u=n.length?[e.min(n,r),e.max(n,i)]:[]):(s=n,u=Array.prototype.slice.call(arguments).map(Number)),u.length?1==u.length&&(u=[u[0],u[0]]):u=[-1/0,1/0],h=(u[0]||u[u.length-1])<0,a=u.map(p),c=s instanceof Date?t:Number,this}return u.map(c)},n.range=function(){if(arguments.length){f=Array.prototype.slice.call(arguments),f.length?1==f.length&&(f=[f[0],f[0]]):f=[-1/0,1/0],l=[];for(var t=0;t<f.length-1;t++)l.push(e.Scale.interpolator(f[t],f[t+1]));return this}return f},n.invert=function(t){var n=e.search(f,t);return 0>n&&(n=-n-2),n=Math.max(0,Math.min(l.length-1,n)),c(d(a[n]+(t-f[n])/(f[n+1]-f[n])*(a[n+1]-a[n])))},n.ticks=function(n,a){function f(e,t){switch(t){case 31536e6:e.setMonth(0);case 2592e6:e.setDate(1);case 6048e5:6048e5==t&&e.setDate(e.getDate()-e.getDay());case 864e5:e.setHours(0);case 36e5:e.setMinutes(0);case 6e4:e.setSeconds(0);case 1e3:e.setMilliseconds(0)}}var l=u[0],h=u[u.length-1],p=l>h,d=p?h:l,m=p?l:h,g=m-d;if(!g||!isFinite(g))return c==t&&(v=e.Format.date("%x")),[c(d)];var y=e.get(a,"roundInside",!0);if(c==t){var b,w,E,S=null==n?5:n,x=1;g>=31536e6*S?(b=31536e6,w="%Y",E=function(e){e.setFullYear(e.getFullYear()+x)}):g>=2592e6*S?(b=2592e6,w="%m/%Y",E=function(e){e.setMonth(e.getMonth()+x)}):g>=6048e5*S?(b=6048e5,w="%m/%d",E=function(e){e.setDate(e.getDate()+7*x)}):g>=864e5*S?(b=864e5,w="%m/%d",E=function(e){e.setDate(e.getDate()+x)}):g>=36e5*S?(b=36e5,w="%I:%M %p",E=function(e){e.setHours(e.getHours()+x)}):g>=6e4*S?(b=6e4,w="%I:%M %p",E=function(e){e.setMinutes(e.getMinutes()+x)}):g>=1e3*S?(b=1e3,w="%I:%M:%S",E=function(e){e.setSeconds(e.getSeconds()+x)}):(b=1,w="%S.%Qs",E=function(e){e.setTime(e.getTime()+x)}),b=i?i:b,w=r?r:w,s=b,v=e.Format.date(w);var T=new Date(d),N=[];f(T,b);var C=g/b;if(C>10)switch(b){case 36e5:x=C>20?6:3,T.setHours(Math.floor(T.getHours()/x)*x);break;case 2592e6:x=C>24?3:C>12?2:1,T.setMonth(Math.floor(T.getMonth()/x)*x);break;case 6048e5:x=C>15?3:C>10?2:1,T.setDate(1+Math.floor(T.getDate()/(7*x))*7*x);break;case 864e5:x=C>=30?5:C>=15?3:2,T.setDate(1+Math.floor(T.getDate()/x)*x);break;case 6e4:x=C>30?15:C>15?10:5,T.setMinutes(Math.floor(T.getMinutes()/x)*x);break;case 1e3:x=C>90?15:C>60?10:5,T.setSeconds(Math.floor(T.getSeconds()/x)*x);break;case 1:x=C>1e3?250:C>200?100:C>100?50:C>50?25:5,T.setMilliseconds(Math.floor(T.getMilliseconds()/x)*x);break;default:x=e.logCeil(C/15,10),2>C/x?x/=5:5>C/x&&(x/=2),T.setFullYear(Math.floor(T.getFullYear()/x)*x)}i&&(x=1,E=function(e){e.setSeconds(e.getSeconds()+x*i/1e3)});if(y)for(;;){E(T);if(T>m)break;N.push(new Date(T))}else{m=new Date(m),E(m);do N.push(new Date(T)),E(T);while(m>=T)}return p?N.reverse():N}null==n&&(n=10);var k=e.get(a,"numberExponentMin",-1/0),L=e.get(a,"numberExponentMax",1/0),A=Math.floor(e.log(g/n,10)),O=!1;A>L?(A=L,O=!0):k>A&&(A=k,O=!0),x=Math.pow(10,A);var M=g/x,_=n/M;.15>=_&&L-1>A?(x*=10,M/=10):.35>=_?(x*=5,M/=5):.75>=_&&(x*=2,M/=2),A=Math.floor(e.log(x,10)+1e-10),l=x*Math[y?"ceil":"floor"](d/x),h=x*Math[y?"floor":"ceil"](m/x),o=Math.max(0,-A),v=e.Format.number().fractionDigits(o),2===n&&M>=2&&(x=h-l);var D=e.range(l,h+x,x);return p&&D.reverse(),D.roundInside=y,D.step=x,D.exponent=A,D.exponentOverflow=O,D.exponentMin=k,D.exponentMax=L,D},n.dateTickFormat=function(){return arguments.length?(r=arguments[0],this):r},n.dateTickPrecision=function(){return arguments.length?(i=arguments[0],this):i},n.tickFormatter=function(e){return arguments.length?(m=e,this):m},n.tickFormat=function(e){var t;return t=m?m(e,c!==Number?s:o):v(e),null==t?"":""+t},n.nice=function(){if(2!=u.length)return this;var e=u[0],t=u[u.length-1],n=e>t,r=n?t:e,i=n?e:t,s=i-r;if(!s||!isFinite(s))return this;var o=Math.pow(10,Math.round(Math.log(s)/Math.log(10))-1);return u=[Math.floor(r/o)*o,Math.ceil(i/o)*o],n&&u.reverse(),a=u.map(p),this},e.copyOwn(n,e.Scale.common),n.domain.apply(n,arguments),n},e.Scale.linear=function(){var t=e.Scale.quantitative();return t.domain.apply(t,arguments),t},e.Scale.log=function(){var t,n,r=e.Scale.quantitative(1,10),i=function(e){return Math.log(e)/n},s=function(e){return Math.pow(t,e)};return r.ticks=function(){var e=r.domain(),n=e[0]<0,o=Math.floor(n?-i(-e[0]):i(e[0])),u=Math.ceil(n?-i(-e[1]):i(e[1])),a=[];if(n){a.push(-s(-o));for(;o++<u;)for(var f=t-1;f>0;f--)a.push(-s(-o)*f)}else{for(;u>o;o++)for(var f=1;t>f;f++)a.push(s(o)*f);a.push(s(o))}for(o=0;a[o]<e[0];o++);for(u=a.length;a[u-1]>e[1];u--);return a.slice(o,u)},r.tickFormat=function(e){return e.toPrecision(1)},r.nice=function(){var n=r.domain();return r.domain(e.logFloor(n[0],t),e.logCeil(n[1],t))},r.base=function(e){return arguments.length?(t=Number(e),n=Math.log(t),r.transform(i,s),this):t},r.domain.apply(r,arguments),r.base(10)},e.Scale.root=function(){var t=e.Scale.quantitative();return t.power=function(e){if(arguments.length){var n=Number(e),r=1/n;return t.transform(function(e){return Math.pow(e,r)},function(e){return Math.pow(e,n)}),this}return n},t.domain.apply(t,arguments),t.power(2)},e.Scale.ordinal=function(){function t(e){return e in r||(r[e]=n.push(e)-1),i[r[e]%i.length]}var n=[],r={},i=[];return t.domain=function(t,i){if(arguments.length){t=t instanceof Array?arguments.length>1?e.map(t,i):t:Array.prototype.slice.call(arguments),n=[];for(var s={},o=0;o<t.length;o++){var u=t[o];u in s||(s[u]=!0,n.push(u))}return r=e.numerate(n),this}return n},t.range=function(t,n){return arguments.length?(i=t instanceof Array?arguments.length>1?e.map(t,n):t:Array.prototype.slice.call(arguments),"string"==typeof i[0]&&(i=i.map(e.fillStyle)),i.min=i[0],i.max=i[i.length-1],this):i},t.split=function(t,n){var r=n-t,s=this.domain().length,o=0;return 0===r?i=e.array(s,t):s&&(o=(n-t)/s,i=e.range(t+o/2,n,o)),i.min=t,i.max=n,i.step=o,this},t.splitBandedCenter=function(e,n,r){return t.split(e,n),null==r&&(r=1),i.band=i.step*r,i.margin=i.step-i.band,i.min=e,i.max=n,this},t.splitBandedFlushCenter=function(t,n,r){null==r&&(r=1);var s=n-t,o=this.domain().length,u=0,a=0,f=0;return 0===s?i=e.array(o,t):o&&(a=s*r/o,f=o>1?(s-o*a)/(o-1):0,u=f+a,i=e.range(t+a/2,n,u)),i.step=u,i.band=a,i.margin=f,i.min=t,i.max=n,this},t.splitFlush=function(t,n){var r=this.domain().length,s=(n-t)/(r-1);return i=1==r?[(t+n)/2]:e.range(t,n+s/2,s),i.min=t,i.max=n,this},t.splitBanded=function(t,n,r){arguments.length<3&&(r=1);if(0>r){var s=this.domain().length,o=-r*s,u=n-t-o,a=u/(s+1);i=e.range(t+a,n,a-r),i.band=-r}else{var f=(n-t)/(this.domain().length+(1-r));i=e.range(t+f*(1-r),n,f),i.band=f*r,i.step=f,i.margin=f-i.band}return i.min=t,i.max=n,this},t.invertIndex=function(e,t){var n=this.domain().length;if(0===n)return-1;var r=this.range(),i=r.max-r.min;if(0===i)return 0;var s=i/n;if(e>=r.max)return n;if(e<r.min)return 0;var o=(e-r.min)/s;return t?o:Math.round(o)},e.copyOwn(t,e.Scale.common),t.domain.apply(t,arguments),t},e.Scale.quantile=function(){function t(t){return o(Math.max(0,Math.min(r,e.search.index(i,t)-1))/r)}var n=-1,r=-1,i=[],s=[],o=e.Scale.linear();return t.quantiles=function(e){if(arguments.length){n=Number(e);if(0>n)i=[s[0]].concat(s),r=s.length-1;else{i=[],i[0]=s[0];for(var t=1;n>=t;t++)i[t]=s[~~(t*(s.length-1)/n)];r=n-1}return this}return i},t.domain=function(r,i){return arguments.length?(s=r instanceof Array?e.map(r,i):Array.prototype.slice.call(arguments),s.sort(e.naturalOrder),t.quantiles(n),this):s},t.range=function(){return arguments.length?(o.range.apply(o,arguments),this):o.range()},e.copyOwn(t,e.Scale.common),t.domain.apply(t,arguments),t},e.histogram=function(t,n){var r=!0;return{bins:function(i){var s=e.map(t,n),o=[];arguments.length||(i=e.Scale.linear(s).ticks());for(var u=0;u<i.length-1;u++){var a=o[u]=[];a.x=i[u],a.dx=i[u+1]-i[u],a.y=0}for(var u=0;u<s.length;u++){var l=e.search.index(i,s[u])-1,a=o[Math.max(0,Math.min(o.length-1,l))];a.y++,a.push(t[u])}if(!r)for(var u=0;u<o.length;u++)o[u].y/=s.length;return o},frequency:function(e){return arguments.length?(r=Boolean(e),this):r}}},!function(){e.Shape=function(){};var t={x:1,y:1};e.Shape.dist2=function(e,n,r){r=r||t;var i=e.x-n.x,s=e.y-n.y,o=i*i,u=s*s;return{cost:o+u,dist2:r.x*o+r.y*u}};var n=Math.PI,r=2*n,i=Math.atan2;e.Shape.normalizeAngle=function(e){return e%=r,0>e&&(e+=r),e},e.Shape.atan2Norm=function(e,t){var n=i(e,t);return 0>n&&(n+=r),n},e.Shape.prototype.hasArea=function(){return!0}}(),!function(){var t=e.Shape.dist2,n=Math.cos,r=Math.sin,i=Math.sqrt;e.vector=function(e,t){return new s(e,t)},e.Vector=function(e,t){this.x=e,this.y=t};var s=e.Shape.Point=e.Vector;e.Vector.prototype=e.extend(e.Shape),e.Vector.prototype.perp=function(){return new s(-this.y,this.x)},e.Vector.prototype.rotate=function(e){var t=n(e),i=r(e);return new s(t*this.x-i*this.y,i*this.x+t*this.y)},e.Vector.prototype.norm=function(){var e=this.length();return this.times(e?1/e:1)},e.Vector.prototype.length=function(){return i(this.x*this.x+this.y*this.y)},e.Vector.prototype.times=function(e){return new s(this.x*e,this.y*e)},e.Vector.prototype.plus=function(e,t){return 1==arguments.length?new s(this.x+e.x,this.y+e.y):new s(this.x+e,this.y+t)},e.Vector.prototype.minus=function(e,t){return 1==arguments.length?new s(this.x-e.x,this.y-e.y):new s(this.x-e,this.y-t)},e.Vector.prototype.dot=function(e,t){return 1==arguments.length?this.x*e.x+this.y*e.y:this.x*e+this.y*t},e.Vector.prototype.hasArea=function(){return!1},e.Vector.prototype.clone=function(){return new s(this.x,this.y)},e.Vector.prototype.apply=function(e){return new s(e.x+e.k*this.x,e.y+e.k*this.y)},e.Vector.prototype.intersectsRect=function(e){return this.x>=e.x&&this.x<=e.x2&&this.y>=e.y&&this.y<=e.y2},e.Vector.prototype.containsPoint=function(e){return this.x===e.x&&this.y===e.y},e.Vector.prototype.points=function(){return[this]},e.Vector.prototype.edges=function(){return[]},e.Vector.prototype.center=function(){return this},e.Vector.prototype.distance2=function(e,n){return t(this,e,n)}}(),!function(){var t=e.Shape.Point,n=e.Shape.dist2;e.Shape.Line=function(e,t,n,r){this.x=e||0,this.y=t||0,this.x2=n||0,this.y2=r||0};var r=e.Shape.Line;r.prototype=e.extend(e.Shape),r.prototype.hasArea=function(){return!1},r.prototype.clone=function(){return new r(this.x,this.y,this.x2,this.x2)},r.prototype.apply=function(e){var t=e.x+e.k*this.x,n=e.y+e.k*this.y,i=e.x+e.k*this.x2,s=e.y+e.k*this.y2;return new r(t,n,i,s)},r.prototype.points=function(){return[new t(this.x,this.y),new t(this.x2,this.y2)]},r.prototype.edges=function(){return[this]},r.prototype.center=function(){return new t((this.x+this.x2)/2,(this.y+this.y2)/2)},r.prototype.normal=function(e,t){var n=this.points(),r=n[1].minus(n[0]).perp().norm();if(t){var i=n[0].minus(t);i.dot(r)<0&&(r=r.times(-1))}return r},r.prototype.intersectsRect=function(e){var t,n,r=this.points();n=r.length;for(t=0;n>t;t++)if(r[t].intersectsRect(e))return!0;var i=e.edges();n=i.length;for(t=0;n>t;t++)if(this.intersectsLine(i[t]))return!0;return!1},r.prototype.containsPoint=function(e){var t=this.x,n=this.x2,r=this.y,i=this.y2;return t<=e.x&&e.x<=n&&(t===n?Math.min(r,i)<=e.y&&e.y<=Math.max(r,i):Math.abs((i-r)/(n-t)*(e.x-t)+r-e.y)<=1e-10)},r.prototype.intersectsLine=function(e){var t=this,n=t.x2-t.x,r=t.y2-t.y,i=e.x2-e.x,s=e.y2-e.y,o=s*n-i*r;if(0===o)return!1;var u=t.y-e.y,a=t.x-e.x,f=i*u-s*a,l=n*u-r*a;if(0===o)return 0===f&&0===l;var c=f/o;if(0>c||c>1)return!1;var h=l/o;return 0>h||h>1?!1:!0},r.prototype.distance2=function(e,t){var r=this,i={x:this.x2,y:this.y2},s=n(r,i).dist2;if(1e-10>=s)return n(e,r,t);var o=i.x-r.x,u=i.y-r.y,a=((e.x-r.x)*o+(e.y-r.y)*u)/s;if(0>a)return n(e,r,t);if(a>1)return n(e,i,t);var f={x:r.x+a*o,y:r.y+a*u};return n(e,f,t)}}(),!function(){var t=e.Shape.Point,n=e.Shape.Line;e.Shape.Polygon=function(e){this._points=e||[]};var r=e.Shape.Polygon;r.prototype=e.extend(e.Shape),r.prototype.points=function(){return this._points},r.prototype.clone=function(){return new r(this.points().slice())},r.prototype.apply=function(e){for(var t=this.points(),n=t.length,i=new Array(n),s=0;n>s;s++)i[s]=t[s].apply(e);return new r(i)},r.prototype.intersectsRect=function(e){var t,n,r=this.points();n=r.length;for(t=0;n>t;t++)if(r[t].intersectsRect(e))return!0;var i=this.edges();n=i.length;for(t=0;n>t;t++)if(i[t].intersectsRect(e))return!0;return!1},r.prototype.edges=function(){var e=this._edges;if(!e){e=this._edges=[];var t=this.points(),r=t.length;if(r){for(var i,s=t[0],o=s,u=1;r>u;u++)i=t[u],e.push(new n(s.x,s.y,i.x,i.y)),s=i;r>2&&e.push(new n(i.x,i.y,o.x,o.y))}}return e},r.prototype.distance2=function(e,t){var n={cost:1/0,dist2:1/0};return this.edges().forEach(function(r){var i=r.distance2(e,t);i.cost<n.cost&&(n=i)},this),n},r.prototype.center=function(){for(var e=this.points(),n=0,r=0,i=0,s=e.length;s>i;i++){var o=e[i];n+=o.x,r+=o.y}return new t(n/s,r/s)},r.prototype.containsPoint=function(e){var t=this.bbox();if(!t.containsPoint(e))return!1;var r=.01*t.dx,i=new n(t.x-r,e.y,e.x,e.y),s=0,o=this.edges();return o.forEach(function(e){e.intersectsLine(i)&&s++}),1===(1&s)},r.prototype.bbox=function(){var t=this._bbox;if(!t){var n,r;this.points().forEach(function(e){null==n?n={x:e.x,y:e.y}:(e.x<n.x&&(n.x=e.x),e.y<n.y&&(n.y=e.y)),null==r?r={x:e.x,y:e.y}:(e.x>r.x&&(r.x=e.x),e.y>r.y&&(r.y=e.y))}),n&&(t=this._bbox=new e.Shape.Rect(n.x,n.y,r.x-n.x,r.y-n.y))}return t}}(),!function(){var t=e.Shape.Point,n=e.Shape.Line;e.Shape.Rect=function(e,t,n,r){this.x=e||0,this.y=t||0,this.dx=n||0,this.dy=r||0,this.dx<0&&(this.dx=-this.dx,this.x=this.x-this.dx),this.dy<0&&(this.dy=-this.dy,this.y=this.y-this.dy),this.x2=this.x+this.dx,this.y2=this.y+this.dy};var r=e.Shape.Rect;r.prototype=e.extend(e.Shape.Polygon),r.prototype.clone=function(){var e=Object.create(r.prototype);return e.x=this.x,e.y=this.y,e.dx=this.dx,e.dy=this.dy,e.x2=this.x2,e.y2=this.y2,e},r.prototype.apply=function(e){var t=e.x+e.k*this.x,n=e.y+e.k*this.y,i=e.k*this.dx,s=e.k*this.dy;return new r(t,n,i,s)},r.prototype.containsPoint=function(e){return this.x<=e.x&&e.x<=this.x2&&this.y<=e.y&&e.y<=this.y2},r.prototype.intersectsRect=function(e){return this.x2>e.x&&this.x<e.x2&&this.y2>e.y&&this.y<e.y2},r.prototype.edges=function(){if(!this._edges){var e=this.x,t=this.y,r=this.x2,i=this.y2;this._edges=[new n(e,t,r,t),new n(r,t,r,i),new n(r,i,e,i),new n(e,i,e,t)]}return this._edges},r.prototype.center=function(){return new t(this.x+this.dx/2,this.y+this.dy/2)},r.prototype.points=function(){var e=this._points;if(!e){var n=this.x,r=this.y,i=this.x2,s=this.y2;e=this._points=[new t(n,r),new t(i,r),new t(i,s),new t(n,s)]}return e},r.prototype.bbox=function(){return this.clone()}}(),!function(){var t=e.Shape.Point,n=e.Shape.dist2,r=Math.sqrt,i=Math.abs,s=Math.pow;e.Shape.Circle=function(e,t,n){this.x=e||0,this.y=t||0,this.radius=n||0};var o=e.Shape.Circle;o.prototype=e.extend(e.Shape),o.prototype.clone=function(){return new o(this.x,this.y,this.radius)},o.prototype.apply=function(e){var t=e.x+e.k*this.x,n=e.y+e.k*this.y,r=e.k*this.radius;return new o(t,n,r)},o.prototype.intersectsRect=function(e){var t=e.dx/2,n=e.dy/2,r=this.radius,o=i(this.x-e.x-t),u=i(this.y-e.y-n);if(o>t+r||u>n+r)return!1;if(t>=o||n>=u)return!0;var a=s(o-t,2)+s(u-n,2);return r*r>=a},o.prototype.intersectLine=function(e,n){var i=e.x2-e.x,s=e.y2-e.y,o=this.x-e.x,u=this.y-e.y,a=i*i+s*s,f=i*o+s*u,l=this.radius,c=o*o+u*u-l*l,h=f/a,p=h*h-c/a;if(!(0>p)){var d=r(p),v=h-d,m=h+d,g=[];return(n||v>=0&&1>=v)&&g.push(new t(e.x+i*v,e.y+s*v)),0!==p&&(n||m>=0&&1>=m)&&g.push(new t(e.x+i*m,e.y+s*m)),g}},o.prototype.points=function(){return[this.center()]},o.prototype.center=function(){return new t(this.x,this.y)},o.prototype.normal=function(e){return e.minus(this.x,this.y).norm()},o.prototype.containsPoint=function(e){var t=e.x-this.x,n=e.y-this.y,r=this.radius;return r*r>=t*t+n*n},o.prototype.distance2=function(e,t){var r=(e.x-this.x,e.y-this.y,this.radius),i=e.minus(this).norm().times(r).plus(this),s=n(e,i,t);return s}}(),!function(){var t=e.Shape.Point,n=e.Shape.dist2,r=e.Shape.normalizeAngle,i=e.Shape.atan2Norm,s=Math.cos,o=Math.sin,u=Math.sqrt;e.Shape.Arc=function(e,t,n,i,s){this.x=e,this.y=t,this.radius=n,this.startAngle=r(i),this.angleSpan=r(s),this.endAngle=this.startAngle+this.angleSpan};var a=e.Shape.Arc;a.prototype=e.extend(e.Shape),a.prototype.hasArea=function(){return!1},a.prototype.clone=function(){var e=Object.create(a.prototype),t=this;return e.x=t.x,e.y=t.y,e.radius=t.radius,e.startAngle=t.startAngle,e.angleSpan=t.angleSpan,e.endAngle=t.endAngle,e},a.prototype.apply=function(e){var t=e.x+e.k*this.x,n=e.y+e.k*this.y,r=e.k*this.radius;return new a(t,n,r,this.startAngle,this.angleSpan)},a.prototype.containsPoint=function(e){var t=e.x-this.x,n=e.y-this.y,r=u(t*t+n*n);if(Math.abs(r-this.radius)<=1e-10){var s=i(n,t);return this.startAngle<=s&&s<=this.endAngle}return!1},a.prototype.intersectsRect=function(e){var t,n,r=this.points(),n=r.length;for(t=0;n>t;t++)if(r[t].intersectsRect(e))return!0;var i=e.edges();n=i.length;for(t=0;n>t;t++)if(this.intersectLine(i[t]))return!0;return!1};var f=e.Shape.Circle.prototype.intersectLine;a.prototype.intersectLine=function(e,t){var n=f.call(this,e,t);if(n){n=n.filter(function(e){return this.containsPoint(e)},this);if(n.length)return n}},a.prototype.points=function(){var e=this.x,n=this.y,r=this.radius,i=this.startAngle,u=this.endAngle;return[new t(e+r*s(i),n+r*o(i)),new t(e+r*s(u),n+r*o(u))]},a.prototype.center=function(){var e=this.x,n=this.y,r=this.radius,i=(this.startAngle+this.endAngle)/2;return new t(e+r*s(i),n+r*o(i))},a.prototype.normal=function(e,t){var n=e.minus(this.x,this.y).norm();if(t){var r=this.center().minus(t);r.dot(n)<0&&(n=n.times(-1))}return n},a.prototype.distance2=function(e,r){var u=e.x-this.x,a=e.y-this.y,f=i(a,u);if(this.startAngle<=f&&f<=this.endAngle){var l=new t(this.x+this.radius*s(f),this.y+this.radius*o(f));return n(e,l,r)}var c=this.points(),h=n(e,c[0],r),p=n(e,c[1],r);return h.cost<p.cost?h:p}}(),!function(){var t=e.Shape.Arc,n=e.Shape.Line,r=e.Shape.Point,i=Math.cos,s=Math.sin,o=Math.sqrt,u=e.Shape.atan2Norm,a=e.Shape.normalizeAngle;e.Shape.Wedge=function(e,t,n,r,i,s){this.x=e,this.y=t,this.innerRadius=n,this.outerRadius=r,this.startAngle=a(i),this.angleSpan=a(s),this.endAngle=this.startAngle+this.angleSpan};var f=e.Shape.Wedge;f.prototype=e.extend(e.Shape),f.prototype.clone=function(){return new f(this.x,this.y,this.innerRadius,this.outerRadius,this.startAngle,this.angleSpan)},f.prototype.apply=function(e){var t=e.x+e.k*this.x,n=e.y+e.k*this.y,r=e.k*this.innerRadius,i=e.k*this.outerRadius;return new f(t,n,r,i,this.startAngle,this.angleSpan)},f.prototype.containsPoint=function(e){var t=e.x-this.x,n=e.y-this.y,r=o(t*t+n*n);if(r>=this.innerRadius&&r<=this.outerRadius){var i=u(n,t);return this.startAngle<=i&&i<=this.endAngle}return!1},f.prototype.intersectsRect=function(e){var t,n,r=this.points();n=r.length;for(t=0;n>t;t++)if(r[t].intersectsRect(e))return!0;r=e.points(),n=r.length;for(t=0;n>t;t++)if(this.containsPoint(r[t]))return!0;var i=this.edges();n=i.length;for(t=0;n>t;t++)if(i[t].intersectsRect(e))return!0;return!1},f.prototype.points=function(){return this._points||this.edges(),this._points},f.prototype.edges=function(){var e=this._edges;if(!e){var o,u,a=this.x,f=this.y,l=this.innerRadius,c=this.outerRadius,h=this.startAngle,p=this.endAngle,d=this.angleSpan,v=i(h),m=s(h),g=i(p),y=s(p);l>0?(o=new r(a+l*v,f+l*m),u=new r(a+l*g,f+l*y)):o=u=new r(a,f);var b=new r(a+c*v,f+c*m),w=new r(a+c*g,f+c*y);e=this._edges=[],l>0&&e.push(new t(a,f,l,h,d)),e.push(new n(o.x,o.y,b.x,b.y),new t(a,f,c,h,d),new n(u.x,u.y,w.x,w.y));var E=this._points=[o,b,w];l>0&&E.push(u)}return e},f.prototype.distance2=function(e,t){var n={cost:1/0,dist2:1/0};return this.edges().forEach(function(r){var i=r.distance2(e,t);i.cost<n.cost&&(n=i)}),n},f.prototype.center=function(){var e=(this.startAngle+this.endAngle)/2,t=(this.innerRadius+this.outerRadius)/2;return new r(this.x+t*i(e),this.y+t*s(e))}}(),!function(){var t=Math.round,n=function(e){var n=parseFloat(e);return"%"==e[e.length-1]?t(2.55*n):n},r=/([a-z]+)\((.*)\)/i,i=function(t){if("#"===t.charAt(0)){var i,s,o;return 4===t.length?(i=t.charAt(1),i+=i,s=t.charAt(2),s+=s,o=t.charAt(3),o+=o):7===t.length&&(i=t.substring(1,3),s=t.substring(3,5),o=t.substring(5,7)),e.rgb(parseInt(i,16),parseInt(s,16),parseInt(o,16),1)}var u=r.exec(t);if(u){var a=u[2].split(","),f=1;switch(u[1]){case"hsla":case"rgba":f=parseFloat(a[3]);if(!f)return e.Color.transparent}switch(u[1]){case"hsla":case"hsl":var l=parseFloat(a[0]),c=parseFloat(a[1])/100,h=parseFloat(a[2])/100;return(new e.Color.Hsl(l,c,h,f)).rgb();case"rgba":case"rgb":var i=n(a[0]),s=n(a[1]),o=n(a[2]);return e.rgb(i,s,o,f)}}return new e.Color(t,1)},s={};e.color=function(t){if(t.rgb)return t.rgb();var n=e.Color.names[t];return n||(n=s[t]||(s[t]=i(t))),n}}(),e.Color=function(e,t){this.color=e,this.opacity=t,this.key="solid "+e+" alpha("+t+")"},e.Color.prototype.hsl=function(){return this.rgb().hsl()},e.Color.prototype.brighter=function(e){return this.rgb().brighter(e)},e.Color.prototype.darker=function(e){return this.rgb().darker(e)},e.Color.prototype.alphaBlend=function(t){var n=this.rgb(),r=n.a;if(1===r)return this;t=t?e.color(t):e.Color.names.white,t=t.rgb();var i=1-r;return e.rgb(i*n.r+r*t.r,i*n.g+r*t.g,i*n.b+r*t.b,1)},e.Color.prototype.rgbDecimal=function(e){var t=this.alphaBlend(e);return t.r<<16|t.g<<8|t.b},e.Color.prototype.isDark=function(){return this.rgbDecimal()<8388607.5},e.rgb=function(t,n,r,i){return new e.Color.Rgb(t,n,r,4==arguments.length?i:1)},e.Color.Rgb=function(t,n,r,i){e.Color.call(this,i?"rgb("+t+","+n+","+r+")":"none",i),this.r=t,this.g=n,this.b=r,this.a=i},e.Color.Rgb.prototype=e.extend(e.Color),e.Color.Rgb.prototype.red=function(t){return e.rgb(t,this.g,this.b,this.a)},e.Color.Rgb.prototype.green=function(t){return e.rgb(this.r,t,this.b,this.a)},e.Color.Rgb.prototype.blue=function(t){return e.rgb(this.r,this.g,t,this.a)},e.Color.Rgb.prototype.alpha=function(t){return e.rgb(this.r,this.g,this.b,t)},e.Color.Rgb.prototype.rgb=function(){return this},e.Color.Rgb.prototype.brighter=function(t){t=Math.pow(.7,null!=t?t:1);var n=this.r,r=this.g,i=this.b,s=30;return!n&&!r&&!i?e.rgb(s,s,s,this.a):(n&&s>n&&(n=s),r&&s>r&&(r=s),i&&s>i&&(i=s),e.rgb(Math.min(255,Math.floor(n/t)),Math.min(255,Math.floor(r/t)),Math.min(255,Math.floor(i/t)),this.a))},e.Color.Rgb.prototype.darker=function(t){return t=Math.pow(.7,null!=t?t:1),e.rgb(Math.max(0,Math.floor(t*this.r)),Math.max(0,Math.floor(t*this.g)),Math.max(0,Math.floor(t*this.b)),this.a)},e.Color.Rgb.prototype.hsl=function(){var t,n,r=this.r/255,i=this.g/255,s=this.b/255,o=Math.max(r,i,s),u=Math.min(r,i,s),a=(o+u)/2;if(o===u)t=n=0;else{var f=o-u;n=a>.5?f/(2-o-u):f/(o+u);switch(o){case r:t=(i-s)/f+(s>i?6:0);break;case i:t=(s-r)/f+2;break;case s:t=(r-i)/f+4}t/=6}return e.hsl(360*t,n,a,this.a)},e.Color.Rgb.prototype.complementary=function(){return this.hsl().complementary().rgb()},e.hsl=function(t,n,r,i){return new e.Color.Hsl(t,n,r,4==arguments.length?i:1)},e.Color.Hsl=function(t,n,r,i){e.Color.call(this,"hsl("+t+","+100*n+"%,"+100*r+"%)",i),this.h=t,this.s=n,this.l=r,this.a=i},e.Color.Hsl.prototype=e.extend(e.Color),e.Color.Hsl.prototype.hsl=function(){return this},e.Color.Hsl.prototype.hue=function(t){return e.hsl(t,this.s,this.l,this.a)},e.Color.Hsl.prototype.saturation=function(t){return e.hsl(this.h,t,this.l,this.a)},e.Color.Hsl.prototype.lightness=function(t){return e.hsl(this.h,this.s,t,this.a)},e.Color.Hsl.prototype.alpha=function(t){return e.hsl(this.h,this.s,this.l,t)},e.Color.Hsl.prototype.complementary=function(){return e.hsl((this.h+180)%360,1-this.s,1-this.l,this.a)},e.Color.Hsl.prototype.rgb=function(){function t(e){return e>360?e-=360:0>e&&(e+=360),60>e?u+(o-u)*e/60:180>e?o:240>e?u+(o-u)*(240-e)/60:u}function n(e){return Math.round(255*t(e))}var r=this.h,i=this.s,s=this.l;r%=360,0>r&&(r+=360),i=Math.max(0,Math.min(i,1)),s=Math.max(0,Math.min(s,1));var o=.5>=s?s*(1+i):s+i-s*i,u=2*s-o;return e.rgb(n(r+120),n(r),n(r-120),this.a)},e.Color.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:e.Color.transparent=e.rgb(0,0,0,0)},!function(){var t=e.Color.names;t.none=t.transparent;for(var n in t)t[n]=e.color(t[n])}(),e.colors=function(){var t=e.Scale.ordinal();return t.range.apply(t,arguments),t},e.Colors={},e.Colors.category10=function(){var t=e.colors("#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf");return t.domain.apply(t,arguments),t},e.Colors.category20=function(){var t=e.colors("#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5");return t.domain.apply(t,arguments),t},e.Colors.category19=function(){var t=e.colors("#9c9ede","#7375b5","#4a5584","#cedb9c","#b5cf6b","#8ca252","#637939","#e7cb94","#e7ba52","#bd9e39","#8c6d31","#e7969c","#d6616b","#ad494a","#843c39","#de9ed6","#ce6dbd","#a55194","#7b4173");return t.domain.apply(t,arguments),t},!function(){function t(t){var n=r(t);if(!n.length)return null;var s,o,a,f=Math.PI,l=n[0];0===l.indexOf("to ")?(o=/^to\s+(?:((top|bottom)(?:\s+(left|right))?)|((left|right)(?:\\s+(top|bottom))?))$/.exec(l),o&&(o[1]?(s=o[2],o[3]&&(s+=" "+o[3])):(s=o[5],o[6]&&(s=o[6]+" "+s)),f=e.radians(u[s]),n.shift())):(a=parseFloat(l),isNaN(a)||(f=a,/^.*?deg$/.test(l)&&(f=e.radians(f)),n.shift()));var c=i(n);switch(c.length){case 0:return null;case 1:return new e.FillStyle.Solid(c[0].color,1)}return new e.FillStyle.LinearGradient(f,c,t)}function n(t){var n=r(t);if(!n.length)return null;var s=i(n);switch(s.length){case 0:return null;case 1:return new e.FillStyle.Solid(s[0].color,1)}return new e.FillStyle.RadialGradient(50,50,s,t)}function r(e){var t={},n=0;e=e.replace(/\b\w+?\(.*?\)/g,function(e){var r="__color"+n++;return t[r]=e,r});var r=e.split(/\s*,\s*/);return r.length?(n&&r.forEach(function(e,n){t.hasOwnProperty(e)&&(r[n]=t[e])}),r):null}function i(t){function n(e){var t=o.length;if(t){for(var n=s,r=(e-n)/(t+1),i=0;t>i;i++)n+=r,o[i].offset=n;o.length=0}}for(var r=[],i=1/0,s=-1/0,o=[],u=0,a=t.length;a>u;){var f=t[u++],l=/^(.+?)\s*([+\-]?[e\.\d]+%)?$/i.exec(f);if(l){var c={color:e.color(l[1])},h=parseFloat(l[2]);isNaN(h)&&(r.length?u===a&&(h=Math.max(s,100)):h=0),r.push(c),isNaN(h)?o.push(c):(c.offset=h,n(h),h>s?s=h:s>h&&(h=s),i>h&&(i=h))}}if(r.length>=2&&(0>i||s>100)){var p=[],d=[];r.forEach(function(e){p.push(e.offset),d.push(e.color)});var v=e.scale.linear().domain(p).range(d);if(0>i){for(;r.length&&r[0].offset<=0;)r.shift();r.unshift({offset:0,color:v(0)})}if(s>100){for(;r.length&&r[r.length-1].offset>=100;)r.pop();r.push({offset:100,color:v(100)})}}return r}e.fillStyle=function(e){if(e.type)return e;var t=e.key||e,n=s[t];return n=n?n.clone():s[t]=o(e),n};var s={},o=function(r){if(r.rgb)return new e.FillStyle.Solid(r.color,r.opacity);var i=/^\s*([a-z\-]+)\(\s*(.*?)\s*\)\s*$/.exec(r);if(i)switch(i[1]){case"linear-gradient":return t(i[2]);case"radial-gradient":return n(i[2])}return new e.FillStyle.Solid(e.color(r))},u={top:0,"top right":45,right:90,"bottom right":135,bottom:180,"bottom left":225,left:270,"top left":315},a=e.FillStyle=function(e){this.type=e,this.key=e};e.extendType(a,new e.Color("none",1)),a.prototype.rgb=function(){var t=e.color(this.color);return this.opacity!==t.opacity&&(t=t.alpha(this.opacity)),t},a.prototype.alphaBlend=function(e){return this.rgb().alphaBlend(e)},a.prototype.rgbDecimal=function(e){return this.rgb().rgbDecimal(e)},a.prototype.isDark=function(){return this.rgb().isDark()};var f=e.FillStyle.Solid=function(e,t){a.call(this,"solid"),e.rgb?(this.color=e.color,this.opacity=e.opacity):(this.color=e,this.opacity=t),this.key+=" "+this.color+" alpha("+this.opacity+")"};e.extendType(f,a),f.prototype.alpha=function(e){return new f(this.color,e)},f.prototype.brighter=function(e){return new f(this.rgb().brighter(e))},f.prototype.darker=function(e){return new f(this.rgb().darker(e))},f.prototype.complementary=function(){return new f(this.rgb().complementary())},f.prototype.clone=function(){var t=e.extend(f);return t.type=this.type,t.key=this.key,t.color=this.color,t.opacity=this.opacity,t},e.FillStyle.transparent=new f(e.Color.transparent);var l=0,c=e.FillStyle.Gradient=function(e,t){a.call(this,e),this.id=++l,this.stops=t,t.length&&(this.color=t[0].color.color),this.key+=" stops("+t.map(function(e){var t=e.color;return t.color+" alpha("+t.opacity+") at("+e.offset+")"}).join(", ")+")"};e.extendType(c,a),c.prototype.rgb=function(){return this.stops.length?this.stops[0].color:void 0},c.prototype.alpha=function(e){return this._cloneWithStops(this.stops.map(function(t){return{offset:t.offset,color:t.color.alpha(e)}}))},c.prototype.darker=function(e){return this._cloneWithStops(this.stops.map(function(t){return{offset:t.offset,color:t.color.darker(e)}}))},c.prototype.brighter=function(e){return this._cloneWithStops(this.stops.map(function(t){return{offset:t.offset,color:t.color.brighter(e)}}))},c.prototype.complementary=function(){return this._cloneWithStops(this.stops.map(function(e){return{offset:e.offset,color:e.color.complementary()}}))},c.prototype.alphaBlend=function(e){return this._cloneWithStops(this.stops.map(function(t){return{offset:t.offset,color:t.color.alphaBlend(e)}}))},c.prototype.clone=function(){var t=this.constructor,n=e.extend(t);n.constructor=t,n.id=++l,n.type=this.type,n.key=this.key;var r=this.stops;return n.stops=r,r.length&&(n.color=r[0].color.color),this._initClone(n),n};var h=e.FillStyle.LinearGradient=function(e,t){c.call(this,"lineargradient",t),this.angle=e,this.key+=" angle("+e+")"};e.extendType(h,c),h.prototype._cloneWithStops=function(e){return new h(this.angle,e)},h.prototype._initClone=function(e){e.angle=this.angle};var p=e.FillStyle.RadialGradient=function(e,t,n){c.call(this,"radialgradient",n),this.cx=e,this.cy=t,this.key+=" center("+e+","+t+")"};e.extendType(p,c),p.prototype._cloneWithStops=function(e){return new p(this.cx,this.cy,e)},p.prototype._initClone=function(e){e.cx=this.cx,e.cy=this.cy}}(),e.ramp=function(){var t=e.Scale.linear();return t.range.apply(t,arguments),t},e.Scene=e.SvgScene={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml",scale:1,events:["DOMMouseScroll","mousewheel","mousedown","mouseup","mouseover","mouseout","mousemove","click","dblclick","contextmenu"],mousePositionEventSet:{mousedown:1,mouseup:1,mouseover:1,mouseout:1,mousemove:1,click:1,dblclick:1,contextmenu:1},implicit:{svg:{"shape-rendering":"auto","pointer-events":"painted",x:0,y:0,dy:0,"text-anchor":"start",transform:"translate(0,0)",fill:"none","fill-opacity":1,stroke:"none","stroke-opacity":1,"stroke-width":1.5,"stroke-linejoin":"miter","stroke-linecap":"butt","stroke-miterlimit":8,"stroke-dasharray":"none"},css:{font:"10px sans-serif"}}},e.SvgScene.updateAll=function(e){if(e.length&&e[0].reverse&&"line"!==e.type&&"area"!==e.type){for(var t=Object.create(e),n=0,r=e.length-1;r>=0;n++,r--)t[n]=e[r];e=t}this.removeSiblings(this[e.type](e))},e.SvgScene.create=function(e){return document.createElementNS(this.svg,e)},e.SvgScene.expect=function(e,t,n,r,i,s){var o;e&&(o=e.tagName,"defs"===o?(e=e.nextSibling,e&&(o=e.tagName)):"a"===o&&(e=e.firstChild));if(e){if(o!==t){var u=this.create(t);e.parentNode.replaceChild(u,e),e=u}}else e=this.create(t);return i&&this.setAttributes(e,i),s&&this.setStyle(e,s),e},e.SvgScene.setAttributes=function(e,t){var n=this.implicit.svg,r=e.__attributes__;r===t&&(r=null);for(var i in t){var s=t[i];r&&s===r[i]||(null==s||s==n[i]?e.removeAttribute(i):e.setAttribute(i,s))}e.__attributes__=t},e.SvgScene.setStyle=function(e,t){var n=this.implicit.css,r=e.__style__;r===t&&(r=null);for(var i in t){var s=t[i];r&&s===r[i]||(null==s||s==n[i]?e.style.removeProperty(i):e.style[i]=s)}e.__style__=t},e.SvgScene.append=function(e,t,n){return e.$scene={scenes:t,index:n},e=this.title(e,t[n]),e.parentNode||t.$g.appendChild(e),e.nextSibling},e.SvgScene.title=function(e,t){var n=e.parentNode;n&&"a"!=n.tagName&&(n=null);if(t.title){n||(n=this.create("a"),n.setAttributeNS(this.xlink,"xlink:href",""),e.parentNode&&e.parentNode.replaceChild(n,e),n.appendChild(e)),n.setAttributeNS(this.xlink,"xlink:title",t.title);for(var r=null,i=e.firstChild;null!=i;i=i.nextSibling)if("title"==i.nodeName){r=i;break}return r?r.removeChild(r.firstChild):(r=this.create("title"),e.appendChild(r)),r.appendChild(document.createTextNode(t.title)),n}return n&&n.parentNode.replaceChild(e,n),e},e.SvgScene.dispatch=e.listener(function(t){var n=t.target.$scene;if(n){var r=t.type;switch(r){case"DOMMouseScroll":r="mousewheel",t.wheel=-480*t.detail;break;case"mousewheel":t.wheel=(window.opera?12:1)*t.wheelDelta}e.Mark.dispatch(r,n.scenes,n.index,t)&&(t.preventDefault(),t.stopPropagation())}}),e.SvgScene.removeSiblings=function(e){for(;e;){var t=e.nextSibling;"defs"!==e.nodeName&&e.parentNode.removeChild(e),e=t}},e.SvgScene.undefined=function(){},!function(){var t={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"},n={shortdash:[3,1],shortdot:[1,1],shortdashdot:[3,1,1,1],shortdashdotdot:[3,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};e.SvgScene.isStandardDashStyle=function(e){return n.hasOwnProperty(e)},e.SvgScene.translateDashStyleAlias=function(e){return t.hasOwnProperty(e)?t[e]:e},e.SvgScene.parseDasharray=function(e){var t=e.strokeDasharray;if(t&&"none"!==t){t=this.translateDashStyleAlias(t);var r=n[t];t=r?r:t.split(/[\s,]+/);var i=e.lineWidth,s=e.lineCap||"butt",o="butt"===s;t=t.map(function(e,t){return e=+e,o||(t%2?e++:e-=1),0>=e&&(e=.001),e*i/this.scale},this).join(" ")}else t=null;return t}}(),!function(){var t=/^url\(#/,n=1,r=Math.PI/2,i=r/2,s=Math.SQRT2/2,o=Math.abs,u=Math.sin,a=Math.cos,f=function(e){return o(e)<=1e-12?0:e};e.SvgScene.addFillStyleDefinition=function(e,r){if(r.type&&"solid"!==r.type&&!t.test(r.color)){var i=e.mark.root,s=i.__fillStyleMap__||(i.__fillStyleMap__={}),o=r.key,u=s[o];if(!u){u=s[o]="__pvGradient"+n++;var a=l.call(this,e,r,u);i.scene.$defs.appendChild(a)}r.color="url(#"+u+")"}};var l=function(e,t,n){var l="lineargradient"===t.type,c=this.create(l?"linearGradient":"radialGradient");c.setAttribute("id",n);if(l){var h=t.angle-r,p=o(h%r)-i,d=o(s*a(p)),v=d*a(h),m=d*u(h);c.setAttribute("x1",f(.5-v)),c.setAttribute("y1",f(.5-m)),c.setAttribute("x2",f(.5+v)),c.setAttribute("y2",f(.5+m))}for(var g=t.stops,y=g.length,b=0;y>b;b++){var w=g[b],E=c.appendChild(this.create("stop")),S=w.color;E.setAttribute("offset",w.offset+"%"),E.setAttribute("stop-color",S.color),E.setAttribute("stop-opacity",S.opacity+"")}return c}}(),e.SvgScene.pathBasis=function(){function e(e,t,n,r,i){return{x:e[0]*t.left+e[1]*n.left+e[2]*r.left+e[3]*i.left,y:e[0]*t.top+e[1]*n.top+e[2]*r.top+e[3]*i.top}}var t=[[1/6,2/3,1/6,0],[0,2/3,1/3,0],[0,1/3,2/3,0],[0,1/6,2/3,1/6]],n=function(n,r,i,s){var o=e(t[1],n,r,i,s),u=e(t[2],n,r,i,s),a=e(t[3],n,r,i,s);return"C"+o.x+","+o.y+","+u.x+","+u.y+","+a.x+","+a.y};return n.segment=function(n,r,i,s){var o=e(t[0],n,r,i,s),u=e(t[1],n,r,i,s),a=e(t[2],n,r,i,s),f=e(t[3],n,r,i,s);return["M"+o.x+","+o.y,"C"+u.x+","+u.y+","+a.x+","+a.y+","+f.x+","+f.y]},n}(),e.SvgScene.curveBasis=function(e,t,n){var r;null==t?(r=e.length,t=0,n=r-1):r=n-t+1;if(2>=r)return"";var i="",s=e[t],o=s,u=s,a=e[t+1];i+=this.pathBasis(s,o,u,a);for(var f=t+2;n>=f;f++)s=o,o=u,u=a,a=e[f],i+=this.pathBasis(s,o,u,a);return i+=this.pathBasis(o,u,a,a),i+=this.pathBasis(u,a,a,a),i},e.SvgScene.curveBasisSegments=function(e,t,n){var r;null==t?(r=e.length,t=0,n=r-1):r=n-t+1;if(2>=r)return"";var i=[],s=e[t],o=s,u=s,a=e[t+1],f=this.pathBasis.segment(s,o,u,a);s=o,o=u,u=a,a=e[t+2],f[1]+=this.pathBasis(s,o,u,a),i.push(f);for(var l=t+3;n>=l;l++)s=o,o=u,u=a,a=e[l],i.push(this.pathBasis.segment(s,o,u,a));var c=this.pathBasis.segment(o,u,a,a);return c[1]+=this.pathBasis(u,a,a,a),i.push(c),i},e.SvgScene.curveHermite=function(e,t,n,r){var i;null==n?(i=e.length,n=0,r=i-1):i=r-n+1;var s=t.length;if(1>s||i!==s&&i!==s+2)return"";var o=i!==s,u="",a=e[n],f=e[n+1],l=t[0],c=l,h=n+1;o&&(u+="Q"+(f.left-2*l.x/3)+","+(f.top-2*l.y/3)+","+f.left+","+f.top,a=e[n+1],h=n+2);if(s>1){c=t[1],f=e[h],h++,u+="C"+(a.left+l.x)+","+(a.top+l.y)+","+(f.left-c.x)+","+(f.top-c.y)+","+f.left+","+f.top;for(var p=2;s>p;p++,h++)f=e[h],c=t[p],u+="S"+(f.left-c.x)+","+(f.top-c.y)+","+f.left+","+f.top}if(o){var d=e[h];u+="Q"+(f.left+2*c.x/3)+","+(f.top+2*c.y/3)+","+d.left+","+d.top}return u},e.SvgScene.curveHermiteSegments=function(e,t,n,r){var i;null==n?(i=e.length,n=0,r=i-1):i=r-n+1;var s=t.length;if(1>s||i!==s&&i!==s+2)return[];var o=i!==s,u=[],a=e[n],f=a,l=t[0],c=l,h=n+1;o&&(f=e[n+1],u.push(["M"+a.left+","+a.top,"Q"+(f.left-2*c.x/3)+","+(f.top-2*c.y/3)+","+f.left+","+f.top]),h=n+2);for(var p=1;s>p;p++,h++)a=f,l=c,f=e[h],c=t[p],u.push(["M"+a.left+","+a.top,"C"+(a.left+l.x)+","+(a.top+l.y)+","+(f.left-c.x)+","+(f.top-c.y)+","+f.left+","+f.top]);if(o){var d=e[h];u.push(["M"+f.left+","+f.top,"Q"+(f.left+2*c.x/3)+","+(f.top+2*c.y/3)+","+d.left+","+d.top])}return u},e.SvgScene.cardinalTangents=function(e,t,n,r){var i;null==n?(i=e.length,n=0,r=i-1):i=r-n+1;for(var s=[],o=(1-t)/2,u=e[n],a=e[n+1],f=e[n+2],l=n+3;r>=l;l++)s.push({x:o*(f.left-u.left),y:o*(f.top-u.top)}),u=a,a=f,f=e[l];return s.push({x:o*(f.left-u.left),y:o*(f.top-u.top)}),s},e.SvgScene.curveCardinal=function(e,t,n,r){var i;return null==n?(i=e.length,n=0,r=i-1):i=r-n+1,2>=i?"":this.curveHermite(e,this.cardinalTangents(e,t,n,r),n,r)},e.SvgScene.curveCardinalSegments=function(e,t,n,r){var i;return null==n?(i=e.length,n=0,r=i-1):i=r-n+1,2>=i?"":this.curveHermiteSegments(e,this.cardinalTangents(e,t,n,r),n,r)},e.SvgScene.monotoneTangents=function(e,t,n){var r;null==t?(r=e.length,t=0,n=r-1):r=n-t+1;var i,s=[],o=[],u=[],a=[],f=0;for(f=0;r-1>f;f++){i=t+f;var l=e[i+1].left-e[i].left;o[f]=Math.abs(l)<=1e-12?0:(e[i+1].top-e[i].top)/l}u[0]=o[0],a[0]=e[t+1].left-e[t].left;for(f=1,i=t+f;r-1>f;f++,i++)u[f]=(o[f-1]+o[f])/2,a[f]=(e[i+1].left-e[i-1].left)/2;u[f]=o[f-1],a[f]=e[i].left-e[i-1].left;for(f=0;r-1>f;f++)0==o[f]&&(u[f]=0,u[f+1]=0);for(f=0;r-1>f;f++)if(!(Math.abs(u[f])<1e-5||Math.abs(u[f+1])<1e-5)){var c=u[f]/o[f],h=u[f+1]/o[f],p=c*c+h*h;if(p>9){var d=3/Math.sqrt(p);u[f]=d*c*o[f],u[f+1]=d*h*o[f]}}for(var v,m=0;r>m;m++)v=1+u[m]*u[m],s.push({x:a[m]/3/v,y:u[m]*a[m]/3/v});return s},e.SvgScene.curveMonotone=function(e,t,n){var r;return null==t?(r=e.length,t=0,n=r-1):r=n-t+1,2>=r?"":this.curveHermite(e,this.monotoneTangents(e,t,n),t,n)},e.SvgScene.curveMonotoneSegments=function(e,t,n){var r;return null==t?(r=e.length,t=0,n=r-1):r=n-t+1,2>=r?"":this.curveHermiteSegments(e,this.monotoneTangents(e,t,n),t,n)},e.SvgScene.area=function(e){var t=e.$g.firstChild,n=e.length;if(!n)return t;var r=e[0];return"smart"===r.segmented?this.areaSegmentedSmart(t,e):r.segmented?this.areaSegmentedFull(t,e):this.areaFixed(t,e,0,n-1,!0)},e.SvgScene.areaFixed=function(e,t,n,r,i){var s=r-n+1;if(1===s)return this.lineAreaDotAlone(e,t,n);var o=t[n];if(!o.visible)return e;var u=o.fillStyle,a=o.strokeStyle;if(!u.opacity&&!a.opacity)return e;this.addFillStyleDefinition(t,u),this.addFillStyleDefinition(t,a);var f=!1,l=!1,c=!1,h=!1,p=!1;switch(o.interpolate){case"basis":f=!0;break;case"cardinal":l=!0;break;case"monotone":c=!0;break;case"step-after":h=!0;break;case"step-before":p=!0}for(var d,v,m=f||l||c,g=[],y=n;r>=y;y++){d=t[y];if(d.width||d.height){for(var b=y+1;r>=b;b++){v=t[b];if(!v.width&&!v.height)break}y>n&&!h&&y--,r>=b&&!p&&b++;var w=m&&b-y>2?this.areaPathCurve:this.areaPathStraight;g.push(w.call(this,t,y,b-1,o)),y=b-1}}if(!g.length)return e;var E=a.opacity;return e=this.expect(e,"path",t,n,{"shape-rendering":o.antialias?null:"crispEdges","pointer-events":i?o.events:"none",cursor:o.cursor,d:"M"+g.join("ZM")+"Z",fill:u.color,"fill-opacity":u.opacity||null,stroke:a.color,"stroke-opacity":E||null,"stroke-width":E?o.lineWidth/this.scale:null,"stroke-linecap":o.lineCap,"stroke-linejoin":o.lineJoin,"stroke-miterlimit":o.strokeMiterLimit,"stroke-dasharray":E?this.parseDasharray(o):null}),o.svg&&this.setAttributes(e,o.svg),o.css&&this.setStyle(e,o.css),this.append(e,t,n)},e.SvgScene.areaSegmentedSmart=function(e,t){return this.eachLineAreaSegment(e,t,function(e,t,n,r){var i=this.areaSegmentPaths(t,n,r),s=i.top,o=i.bottom,u=n,a={breakOnKeyChange:!0,from:n,to:r};return this.eachLineAreaSegment(e,t,a,function(e,t,n,r,i,a){var f=t[n],l=f.fillStyle,c=f.strokeStyle;this.addFillStyleDefinition(t,l),this.addFillStyleDefinition(t,c);if(n===r)return this.lineAreaDotAlone(e,t,n);var h=this.areaJoinPaths(s,o,n-u,r-u-1),p=c.opacity,d={"shape-rendering":f.antialias?null:"crispEdges","pointer-events":a,cursor:f.cursor,d:h,fill:l.color,"fill-opacity":l.opacity||null,stroke:c.color,"stroke-opacity":p||null,"stroke-width":p?f.lineWidth/this.scale:null,"stroke-linecap":f.lineCap,"stroke-linejoin":f.lineJoin,"stroke-miterlimit":f.strokeMiterLimit,"stroke-dasharray":p?this.parseDasharray(f):null};return e=this.expect(e,"path",t,n,d,f.css),this.append(e,t,n)})})},e.SvgScene.areaSegmentPaths=function(e,t,n){return this.areaSegmentCurvePaths(e,t,n)||this.areaSegmentStraightPaths(e,t,n)},e.SvgScene.areaSegmentCurvePaths=function(e,t,n){var r=n-t+1,i=e[t],s="basis"===i.interpolate,o=!s&&"cardinal"===i.interpolate;if(s||o||"monotone"==i.interpolate){for(var u=[],a=[],f=0;r>f;f++){var l=e[t+f],c=e[n-f];u.push(l),a.push({left:c.left+c.width,top:c.top+c.height})}var h,p;s?(h=this.curveBasisSegments(u),p=this.curveBasisSegments(a)):o?(h=this.curveCardinalSegments(u,i.tension),p=this.curveCardinalSegments(a,i.tension)):(h=this.curveMonotoneSegments(u),p=this.curveMonotoneSegments(a));if(h||h.length)return{from:t,top:h,bottom:p}}},e.SvgScene.areaSegmentStraightPaths=function(e,t,n){for(var r=[],i=[],s=n,o=t;s>t;t++,n--){var u=e[t],a=e[n],f=["M"+u.left+","+u.top],l=["M"+(a.left+a.width)+","+(a.top+a.height)],c=e[t+1],h=e[n-1];switch(u.interpolate){case"step-before":f.push("V"+c.top+"H"+c.left);break;case"step-after":f.push("H"+c.left+"V"+c.top);break;default:f.push("L"+c.left+","+c.top)}l.push("L"+(h.left+h.width)+","+(h.top+h.height)),r.push(f),i.push(l)}return{from:o,top:r,bottom:i}},e.SvgScene.areaJoinPaths=function(e,t,n,r){for(var i="",s="",o=e.length,u=n,a=o-1-r;r>=u;u++,a++){var f,l,c=e[u],h=t[a];u===n?(f=c.join(""),l="L"+h[0].substr(1)+h[1]):(f=c[1],l=h[1]),i+=f,s+=l}return i+s+"Z"},e.SvgScene.areaSegmentedFull=function(e,t){var n,r,i=t.length,s=this.areaSegmentCurvePaths(t,0,i-1);s&&(n=s.top,r=s.bottom),t[0];for(var o=0;i-1>o;o++){var u=t[o],a=t[o+1];if(u.visible&&a.visible){var f=u.fillStyle,l=u.strokeStyle;if(f.opacity||l.opacity){var c;if(n){var h=n[o].join(""),p="L"+r[i-o-2].join("").substr(1);c=h+p+"Z"}else{var d=u,v=a;switch(u.interpolate){case"step-before":d=a;break;case"step-after":v=u}c="M"+u.left+","+d.top+"L"+a.left+","+v.top+"L"+(a.left+a.width)+","+(v.top+v.height)+"L"+(u.left+u.width)+","+(d.top+d.height)+"Z"}var m={"shape-rendering":u.antialias?null:"crispEdges","pointer-events":u.events,cursor:u.cursor,d:c,fill:f.color,"fill-opacity":f.opacity||null,stroke:l.color,"stroke-opacity":l.opacity||null,"stroke-width":l.opacity?u.lineWidth/this.scale:null};e=this.expect(e,"path",t,o,m),u.svg&&this.setAttributes(e,u.svg),u.css&&this.setStyle(e,u.css),e=this.append(e,t,o)}}}return e},e.SvgScene.areaPathStraight=function(e,t,n,r){for(var i=[],s=[],o=n;o>=t;t++,n--){var u=e[t],a=e[n],f=u.left+","+u.top,l=a.left+a.width+","+(a.top+a.height);if(o>t){var c=e[t+1],h=e[n-1];switch(r.interpolate){case"step-before":f+="V"+c.top,l+="H"+(h.left+h.width);break;case"step-after":f+="H"+c.left,l+="V"+(h.top+h.height)}}i.push(f),s.push(l)}return i.concat(s).join("L")},e.SvgScene.areaPathCurve=function(e,t,n,r){for(var i,s,o=[],u=[],a=n;a>=t;t++,n--){var f=e[n];o.push(e[t]),u.push({left:f.left+f.width,top:f.top+f.height})}switch(r.interpolate){case"basis":i=this.curveBasis(o),s=this.curveBasis(u);break;case"cardinal":i=this.curveCardinal(o,r.tension),s=this.curveCardinal(u,r.tension);break;default:i=this.curveMonotone(o),s=this.curveMonotone(u)}return o[0].left+","+o[0].top+i+"L"+u[0].left+","+u[0].top+s},e.SvgScene.minBarWidth=1,e.SvgScene.minBarHeight=1,e.SvgScene.minBarLineWidth=.2,e.SvgScene.bar=function(e){for(var t=e.$g.firstChild,n=0;n<e.length;n++){var r=e[n];if(!(!r.visible||Math.abs(r.width)<=1e-10||Math.abs(r.height)<=1e-10)){r.width<this.minBarWidth&&(r.width=this.minBarWidth),r.height<this.minBarHeight&&(r.height=this.minBarHeight);var i=r.fillStyle,s=r.strokeStyle;if(i.opacity||s.opacity){this.addFillStyleDefinition(e,i),this.addFillStyleDefinition(e,s);var o;s.opacity?(o=r.lineWidth,o=1e-10>o?0:Math.max(this.minBarLineWidth,o/this.scale)):o=null,t=this.expect(t,"rect",e,n,{"shape-rendering":r.antialias?null:"crispEdges","pointer-events":r.events,cursor:r.cursor,x:r.left,y:r.top,width:Math.max(1e-10,r.width),height:Math.max(1e-10,r.height),fill:i.color,"fill-opacity":i.opacity||null,stroke:s.color,"stroke-opacity":s.opacity||null,"stroke-width":o,"stroke-linecap":r.lineCap,"stroke-dasharray":s.opacity?this.parseDasharray(r):null}),r.svg&&this.setAttributes(t,r.svg),r.css&&this.setStyle(t,r.css),t=this.append(t,e,n)}}}return t},e.SvgScene.dot=function(t){for(var n=t.$g.firstChild,r=0,i=t.length;i>r;r++){var s=t[r];if(s.visible){var o=s.fillStyle,u=o.opacity,a=s.strokeStyle,f=a.opacity;if(u||f){this.addFillStyleDefinition(t,o),this.addFillStyleDefinition(t,a);var l={"shape-rendering":s.antialias?null:"crispEdges","pointer-events":s.events,cursor:s.cursor,fill:o.color,"fill-opacity":u||null,stroke:a.color,"stroke-opacity":f||null,"stroke-width":f?s.lineWidth/this.scale:null,"stroke-linecap":s.lineCap,"stroke-dasharray":f?this.parseDasharray(s):null},c=s.shape||"circle",h=s.aspectRatio,p=s.shapeAngle,d=null;if("circle"===c)1===h?(l.cx=s.left,l.cy=s.top,l.r=s.shapeRadius):(c="ellipse",l.cx=l.cy=0,d="translate("+s.left+","+s.top+") ",p&&(d+="rotate("+e.degrees(p)+") "),l.rx=s._width/2,l.ry=s._height/2);else{var v=s.shapeRadius,m=v,g=v;if(h>0&&1!==h){var y=1/Math.sqrt(h),b=h*y;m*=b,g*=y}l.d=this.renderSymbol(c,s,m,g),c="path",d="translate("+s.left+","+s.top+") ",p&&(d+="rotate("+e.degrees(p)+") ")}d&&(l.transform=d),n=this.expect(n,c,t,r,l),s.svg&&this.setAttributes(n,s.svg),s.css&&this.setStyle(n,s.css),n=this.append(n,t,r)}}}return n},!function(t){var n={};t.registerSymbol=function(e,r){return n[e]=r,t},t.renderSymbol=function(e,r,i,s){return n[e].call(t,r,e,i,s)},t.hasSymbol=function(e){return n.hasOwnProperty(e)},t.symbols=function(){return e.keys(n)};var r=2/Math.sqrt(3);t.registerSymbol("circle",function(){throw new Error("Not implemented as a symbol")}).registerSymbol("cross",function(e,t,n,r){var i=(e.shapeRadius,-n),s=-r;return"M"+i+","+s+"L"+n+","+r+"M"+n+","+s+"L"+i+","+r}).registerSymbol("triangle",function(e,t,n,i){var s=i,o=n*r,u=-i,a=-o;return"M0,"+s+"L"+o+","+u+" "+a+","+u+"Z"}).registerSymbol("diamond",function(e,t,n,r){var i=n*Math.SQRT2,s=r*Math.SQRT2,o=-i,u=-s;return"M0,"+u+"L"+i+",0"+" "+"0,"+s+" "+o+",0"+"Z"}).registerSymbol("square",function(e,t,n,r){var i=-n,s=-r;return"M"+i+","+s+"L"+n+","+s+" "+n+","+r+" "+i+","+r+"Z"}).registerSymbol("tick",function(e,t,n,r){var i=-r*r;return"M0,0L0,"+i}).registerSymbol("bar",function(e,t,n,r){var i=r*r/2;return"M0,"+i+"L0,"+ -i})}(e.SvgScene),e.SvgScene.image=function(e){for(var t=e.$g.firstChild,n=0;n<e.length;n++){var r=e[n];if(r.visible){t=this.fill(t,e,n);if(r.image){t=this.expect(t,"foreignObject",e,n,{cursor:r.cursor,x:r.left,y:r.top,width:r.width,height:r.height}),r.svg&&this.setAttributes(t,r.svg),r.css&&this.setStyle(t,r.css);var i=t.firstChild||t.appendChild(document.createElementNS(this.xhtml,"canvas"));i.$scene={scenes:e,index:n},i.style.width=r.width,i.style.height=r.height,i.width=r.imageWidth,i.height=r.imageHeight,i.getContext("2d").putImageData(r.image,0,0)}else t=this.expect(t,"image",e,n,{preserveAspectRatio:"none",cursor:r.cursor,x:r.left,y:r.top,width:r.width,height:r.height}),r.svg&&this.setAttributes(t,r.svg),r.css&&this.setStyle(t,r.css),t.setAttributeNS(this.xlink,"xlink:href",r.url);t=this.append(t,e,n),t=this.stroke(t,e,n)}}return t},e.SvgScene.label=function(e){for(var t=e.$g.firstChild,n=0;n<e.length;n++){var r=e[n];if(r.visible){var i=r.textStyle;if(i.opacity&&r.text){var s=0,o=0,u=0,a="start";switch(r.textBaseline){case"middle":u=".35em";break;case"top":u=".71em",o=r.textMargin;break;case"bottom":o="-"+r.textMargin}switch(r.textAlign){case"right":a="end",s="-"+r.textMargin;break;case"center":a="middle";break;case"left":s=r.textMargin}t=this.expect(t,"text",e,n,{"pointer-events":r.events,cursor:r.cursor,x:s,y:o,dy:u,transform:"translate("+r.left+","+r.top+")"+(r.textAngle?" rotate("+180*r.textAngle/Math.PI+")":"")+(1!=this.scale?" scale("+1/this.scale+")":""),fill:i.color,"fill-opacity":i.opacity||null,"text-anchor":a},{font:r.font,"text-shadow":r.textShadow,"text-decoration":r.textDecoration}),r.svg&&this.setAttributes(t,r.svg),r.css&&this.setStyle(t,r.css),t.firstChild?t.firstChild.nodeValue=r.text:t.appendChild(document.createTextNode(r.text)),t=this.append(t,e,n)}}}return t},e.SvgScene.line=function(e){var t=e.$g.firstChild,n=e.length;if(!n)return t;var r=e[0];return"smart"===r.segmented?this.lineSegmentedSmart(t,e):2>n?t:r.segmented?this.lineSegmentedFull(t,e):this.lineFixed(t,e)},e.SvgScene.lineFixed=function(e,t){var n=t.length;if(1===n)return this.lineAreaDotAlone(e,t,0);var r=t[0];if(!r.visible)return e;var i=r.fillStyle,s=r.strokeStyle;if(!i.opacity&&!s.opacity)return e;this.addFillStyleDefinition(t,i),this.addFillStyleDefinition(t,s);var o="M"+r.left+","+r.top,u=n>2;if(u)switch(r.interpolate){case"basis":o+=this.curveBasis(t);break;case"cardinal":o+=this.curveCardinal(t,r.tension);break;case"monotone":o+=this.curveMonotone(t);break;default:u=!1}if(!u)for(var a=1;n>a;a++)o+=this.lineSegmentPath(t[a-1],t[a]);var f=s.opacity,l={"shape-rendering":r.antialias?null:"crispEdges","pointer-events":r.events,cursor:r.cursor,d:o,fill:i.color,"fill-opacity":i.opacity||null,stroke:s.color,"stroke-opacity":f||null,"stroke-width":f?r.lineWidth/this.scale:null,"stroke-linecap":r.lineCap,"stroke-linejoin":r.lineJoin,"stroke-miterlimit":r.strokeMiterLimit,"stroke-dasharray":f?this.parseDasharray(r):null};return e=this.expect(e,"path",t,0,l,r.css),r.svg&&this.setAttributes(e,r.svg),this.append(e,t,0)},e.SvgScene.lineSegmentedSmart=function(e,t){return this.eachLineAreaSegment(e,t,function(e,t,n,r){var i=this.lineSegmentPaths(t,n,r),s=n,o={breakOnKeyChange:!0,from:n,to:r};return this.eachLineAreaSegment(e,t,o,function(e,t,n,r,o,u){var a=t[n],f=a.fillStyle;this.addFillStyleDefinition(t,f);var l=a.strokeStyle;this.addFillStyleDefinition(t,l);if(n===r)return this.lineAreaDotAlone(e,t,n);var c=this.lineJoinPaths(i,n-s,r-s-1),h=l.opacity,p={"shape-rendering":a.antialias?null:"crispEdges","pointer-events":u,cursor:a.cursor,d:c,fill:f.color,"fill-opacity":f.opacity||null,stroke:l.color,"stroke-opacity":h||null,"stroke-width":h?a.lineWidth/this.scale:null,"stroke-linecap":a.lineCap,"stroke-linejoin":a.lineJoin,"stroke-miterlimit":a.strokeMiterLimit,"stroke-dasharray":h?this.parseDasharray(a):null};return e=this.expect(e,"path",t,n,p,a.css),this.append(e,t,n)})})},e.SvgScene.lineSegmentedFull=function(t,n){var r,i=n[0];switch(i.interpolate){case"basis":r=this.curveBasisSegments(n);break;case"cardinal":r=this.curveCardinalSegments(n,i.tension);break;case"monotone":r=this.curveMonotoneSegments(n)}for(var s=0,o=n.length-1;o>s;s++){var u=n[s],a=n[s+1];if(u.visible&&a.visible){var f=u.strokeStyle,l=e.FillStyle.transparent;if(f.opacity){var c;"linear"==u.interpolate&&"miter"==u.lineJoin?(l=f,f=e.FillStyle.transparent,c=this.pathJoin(n[s-1],u,a,n[s+2])):c=r?r[s].join(""):"M"+u.left+","+u.top+this.lineSegmentPath(u,a),t=this.expect(t,"path",n,s,{"shape-rendering":u.antialias?null:"crispEdges","pointer-events":u.events,cursor:u.cursor,d:c,fill:l.color,"fill-opacity":l.opacity||null,stroke:f.color,"stroke-opacity":f.opacity||null,"stroke-width":f.opacity?u.lineWidth/this.scale:null,"stroke-linejoin":u.lineJoin}),u.svg&&this.setAttributes(t,u.svg),u.css&&this.setStyle(t,u.css),t=this.append(t,n,s)}}}return t},e.SvgScene.lineSegmentPath=function(e,t){var n=1;switch(e.interpolate){case"polar-reverse":n=0;case"polar":var r=t.left-e.left,i=t.top-e.top,s=1-e.eccentricity,o=Math.sqrt(r*r+i*i)/(2*s);if(0>=s||s>1)break;return"A"+o+","+o+" 0 0,"+n+" "+t.left+","+t.top;case"step-before":return"V"+t.top+"H"+t.left;case"step-after":return"H"+t.left+"V"+t.top}return"L"+t.left+","+t.top},e.SvgScene.lineSegmentPaths=function(e,t,n){var r,i=e[t];switch(i.interpolate){case"basis":r=this.curveBasisSegments(e,t,n);break;case"cardinal":r=this.curveCardinalSegments(e,i.tension,t,n);break;case"monotone":r=this.curveMonotoneSegments(e,t,n)}if(!r||!r.length){r=[];for(var s=t+1;n>=s;s++){var o=e[s-1],u=e[s];r.push(["M"+o.left+","+o.top,this.lineSegmentPath(o,u)])}}return r},e.strokeMiterLimit=4,e.SvgScene.pathJoin=function(t,n,r,i){var s,o,u,a=[],f=n.lineWidth/this.scale,l=e.vector(n.left,n.top),c=e.vector(r.left,r.top),h=c.minus(l),p=h.perp().norm(),d=p.times(f/2),v=l.plus(d),m=l.minus(d),g=c.plus(d),y=c.minus(d);if(t&&t.visible){var b=e.vector(t.left,t.top),w=l.minus(b),E=w.perp().norm(),S=E.plus(p).norm(),x=this.lineIntersect(l,S,v,h),T=this.lineIntersect(l,S,m,h);u=x.minus(T).length();var N=t.lineWidth/this.scale,C=(f+N)/2;o=u/C,s=n.strokeMiterLimit||e.strokeMiterLimit;if(s>=o)a.push(T,x);else{var k=h.times(-1),L=w.norm().plus(k.norm()).norm(),A=l.plus(L.times(C/2));L.dot(p)>=0?a.push(T,A,v):a.push(m,A,x)}}else a.push(m,v);if(i&&i.visible){var O=e.vector(i.left,i.top),M=O.minus(c),_=M.perp().norm(),D=_.plus(p).norm(),P=this.lineIntersect(c,D,g,h),H=this.lineIntersect(c,D,y,h);u=P.minus(H).length();var B=i.lineWidth/this.scale,j=(B+f)/2;o=u/j,s=r.strokeMiterLimit||e.strokeMiterLimit;if(s>=o)a.push(P,H);else{var F=M.times(-1),I=h.norm().plus(F.norm()).norm(),q=c.plus(I.times(j/2));I.dot(p)>=0?a.push(g,q,H):a.push(P,q,y)}}else a.push(g,y);var R=a.shift();return"M"+R.x+","+R.y+"L"+a.map(function(e){return e.x+","+e.y}).join(" ")},e.SvgScene.lineIntersect=function(e,t,n,r){return e.plus(t.times(n.minus(e).dot(r.perp())/t.dot(r.perp())))},e.SvgScene.lineJoinPaths=function(e,t,n){for(var r=e[t].join(""),i=t+1;n>=i;i++)r+=e[i][1];return r},e.SvgScene.lineAreaDotAlone=function(e){return e},e.Scene.eventsToNumber={"":0,none:0,painted:1,all:2},e.Scene.numberToEvents=["none","painted","all"],e.SvgScene.eachLineAreaSegment=function(t,n,r,i){"function"==typeof r&&(i=r,r=null);var s,o,u,a=e.get(r,"breakOnKeyChange",!1),f=e.get(r,"from")||0,l=e.get(r,"to",n.length-1);a&&(o=[],u=[]);for(var c=f;l>=c;){var h=n[c];if(this.isSceneVisible(h)){s=this.eventsToNumber[h.events]||0,a&&this.lineAreaSceneKey(h,o);for(var p,d=c;;){var v=d+1;if(v>l){p=v;break}var m=n[v];if(!this.isSceneVisible(m)){p=v+1;break}s=Math.max(s,this.eventsToNumber[m.events]||0),d=v;if(a){this.lineAreaSceneKey(m,u);if(!this.equalSceneKeys(o,u)){p=d;break}}}t=i.call(this,t,n,c,d,r,this.numberToEvents[s]),c=p}else c++}return t},e.SvgScene.lineAreaSceneKey=function(e,t){return t[0]=e.fillStyle.key,t[1]=e.strokeStyle.key,t[2]=e.lineWidth,t[3]=e.strokeDasharray||"none",t[4]=e.interpolate,t},e.SvgScene.isSceneVisible=function(e){return e.visible&&(e.fillStyle.opacity>0||e.strokeStyle.opacity>0)},e.SvgScene.equalSceneKeys=function(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n]!==t[n])return!1;return!0},e.SvgScene.panel=function(e){for(var t=e.$g,n=t&&t.firstChild,r=0,i=e.length;i>r;r++){var s=e[r];if(s.visible){if(!e.parent){var o=s.canvas;this.applyCanvasStyle(o),t&&t.parentNode!==o&&(t=o.firstChild,n=t&&t.firstChild),t?n&&"defs"===n.tagName&&(n=n.nextSibling):(t=this.createRootPanelElement(),n=null,this.initRootPanelElement(t,e.mark),o.appendChild(t),e.$defs=t.appendChild(this.create("defs")),e.$g=t),t.setAttribute("width",s.width+s.left+s.right),t.setAttribute("height",s.height+s.top+s.bottom)}var u=null;if("hidden"===s.overflow){var a=this.addPanelClipPath(t,n,e,r,s);u=a.g,e.$g=t=u,n=a.next}n=this.fill(n,e,r);var f=this.scale,l=s.transform,c=s.left+l.x,h=s.top+l.y;this.scale*=l.k;if(s.children.length)for(var p={transform:"translate("+c+","+h+")"+(1!=l.k?" scale("+l.k+")":"")},d=this.getSortedChildScenes(e,r),v=0,m=d.length;m>v;v++){var g=d[v];g.$g=n=this.expect(n,"g",e,r,p),this.updateAll(g),n.parentNode||t.appendChild(n),n=n.nextSibling}this.scale=f,n=this.stroke(n,e,r),u&&(e.$g=t=u.parentNode,n=u.nextSibling)}}return n},e.SvgScene.applyCanvasStyle=function(e){e.style.display="inline-block"},e.SvgScene.createRootPanelElement=function(){return this.create("svg")},e.SvgScene.initRootPanelElement=function(e,t){e.setAttribute("font-size","10px"),e.setAttribute("font-family","sans-serif"),e.setAttribute("fill","none"),e.setAttribute("stroke","none"),e.setAttribute("stroke-width",1.5),this.disableElementSelection(e),this.listenRootPanelElement(e,t)},e.SvgScene.listenRootPanelElement=function(e,t){for(var n=0,r=this.events,i=r.length;i>n;n++)e.addEventListener(r[n],this.dispatch,!1),t._registerBoundEvent(e,r[n],this.dispatch,!1)},e.SvgScene.disableElementSelection=function(e){e.setAttribute("style","-webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;"),"undefined"!=typeof e.onselectstart&&(e.setAttribute("unselectable","on"),e.onselectstart=function(){return!1})},e.SvgScene.addPanelClipPath=function(t,n,r,i,s){var o=e.id().toString(36),u=this.expect(n,"g",r,i,{"clip-path":"url(#"+o+")"}),a=this.expect(u.firstChild,"clipPath",r,i,{id:o}),f=a.firstChild||a.appendChild(this.create("rect"));return f.setAttribute("x",s.left),f.setAttribute("y",s.top),f.setAttribute("width",s.width),f.setAttribute("height",s.height),a.parentNode||u.appendChild(a),u.parentNode||t.appendChild(u),{g:u,next:a.nextSibling}},e.SvgScene.getSortedChildScenes=function(e,t){var n=e[t].children;return e.mark._zOrderChildCount&&(n=n.slice(0),n.sort(function(e,t){var n=e.mark._zOrder-t.mark._zOrder;return 0===n&&(n=e.childIndex-t.childIndex),n})),n},e.SvgScene.fill=function(e,t,n){var r=t[n],i=r.fillStyle;if(i.opacity||"all"==r.events)this.addFillStyleDefinition(t,i),e=this.expect(e,"rect",t,n,{"shape-rendering":r.antialias?null:"crispEdges","pointer-events":r.events,cursor:r.cursor,x:r.left,y:r.top,width:r.width,height:r.height,fill:i.color,"fill-opacity":i.opacity,stroke:null}),e=this.append(e,t,n);return e},e.SvgScene.stroke=function(e,t,n){var r=t[n],i=r.strokeStyle;if(i.opacity||"all"==r.events)e=this.expect(e,"rect",t,n,{"shape-rendering":r.antialias?null:"crispEdges","pointer-events":"all"==r.events?"stroke":r.events,cursor:r.cursor,x:r.left,y:r.top,width:Math.max(1e-10,r.width),height:Math.max(1e-10,r.height),fill:null,stroke:i.color,"stroke-opacity":i.opacity,"stroke-width":r.lineWidth/this.scale,"stroke-linecap":r.lineCap,"stroke-dasharray":i.opacity?this.parseDasharray(r):null}),e=this.append(e,t,n);return e},e.SvgScene.minRuleLineWidth=1,e.SvgScene.rule=function(e){for(var t=e.$g.firstChild,n=0;n<e.length;n++){var r=e[n];if(r.visible){var i=r.strokeStyle;if(i.opacity){var s=r.lineWidth;s=1e-10>s?0:Math.max(this.minRuleLineWidth,s/this.scale),t=this.expect(t,"line",e,n,{"shape-rendering":r.antialias?null:"crispEdges","pointer-events":r.events,cursor:r.cursor,x1:r.left,y1:r.top,x2:r.left+r.width,y2:r.top+r.height,stroke:i.color,"stroke-opacity":i.opacity,"stroke-width":s,"stroke-linecap":r.lineCap,"stroke-dasharray":i.opacity?this.parseDasharray(r):null}),r.svg&&this.setAttributes(t,r.svg),r.css&&this.setStyle(t,r.css),t=this.append(t,e,n)}}}return t},e.SvgScene.wedge=function(e){for(var t=e.$g.firstChild,n=0;n<e.length;n++){var r=e[n];if(r.visible){var i=r.fillStyle,s=r.strokeStyle;if(i.opacity||s.opacity){var o,u=r.innerRadius,a=r.outerRadius,f=Math.abs(r.angle);if(f>=2*Math.PI)o=u?"M0,"+a+"A"+a+","+a+" 0 1,1 0,"+ -a+"A"+a+","+a+" 0 1,1 0,"+a+"M0,"+u+"A"+u+","+u+" 0 1,1 0,"+ -u+"A"+u+","+u+" 0 1,1 0,"+u+"Z":"M0,"+a+"A"+a+","+a+" 0 1,1 0,"+ -a+"A"+a+","+a+" 0 1,1 0,"+a+"Z";else{var l=Math.min(r.startAngle,r.endAngle),c=Math.max(r.startAngle,r.endAngle),h=Math.cos(l),p=Math.cos(c),d=Math.sin(l),v=Math.sin(c);o=u?"M"+a*h+","+a*d+"A"+a+","+a+" 0 "+(f<Math.PI?"0":"1")+",1 "+a*p+","+a*v+"L"+u*p+","+u*v+"A"+u+","+u+" 0 "+(f<Math.PI?"0":"1")+",0 "+u*h+","+u*d+"Z":"M"+a*h+","+a*d+"A"+a+","+a+" 0 "+(f<Math.PI?"0":"1")+",1 "+a*p+","+a*v+"L0,0Z"}this.addFillStyleDefinition(e,i),this.addFillStyleDefinition(e,s),t=this.expect(t,"path",e,n,{"shape-rendering":r.antialias?null:"crispEdges","pointer-events":r.events,cursor:r.cursor,transform:"translate("+r.left+","+r.top+")",d:o,fill:i.color,"fill-rule":"evenodd","fill-opacity":i.opacity||null,stroke:s.color,"stroke-opacity":s.opacity||null,"stroke-width":s.opacity?r.lineWidth/this.scale:null,"stroke-linejoin":r.lineJoin,"stroke-miterlimit":r.strokeMiterLimit,"stroke-linecap":r.lineCap,"stroke-dasharray":s.opacity?this.parseDasharray(r):null}),r.svg&&this.setAttributes(t,r.svg),r.css&&this.setStyle(t,r.css),t=this.append(t,e,n)}}}return t},e.Mark=function(){this.$properties=[],this.$propertiesMap={},this.$handlers={}},e.Mark.prototype.properties={},e.Mark.cast={},e.Mark.prototype.property=function(t,n){return this.hasOwnProperty("properties")||(this.properties=e.extend(this.properties)),this.properties[t]=!0,e.Mark.prototype.propertyMethod(t,!1,e.Mark.cast[t]=n),this},e.Mark.prototype.localProperty=function(t,n){this.hasOwnProperty("properties")||(this.properties=e.extend(this.properties)),this.properties[t]=!0;var r=e.Mark.cast[t];return n&&(e.Mark.cast[t]=r=n),this.propertyMethod(t,!1,r),this},e.Mark.prototype.def=function(e,t){return this.propertyMethod(e,!0),this[e](arguments.length>1?t:null)},e.Mark.prototype.propertyMethod=function(t,n,r){r||(r=e.Mark.cast[t]),this[t]=function(i,s){if(n&&this.scene){var o=this.scene.defs;if(arguments.length)return o[t]={id:null==i?0:e.id(),value:null!=i&&r?r(i):i},this;var u=o[t];return u?u.value:null}if(arguments.length)return this.setPropertyValue(t,i,n,r,!1,s),this;var a=this.instance();return e.propBuildMark===this&&1!==e.propBuilt[t]?(e.propBuilt[t]=1,a[t]=this.evalProperty(this.binds.properties[t])):a[t]}},e.Mark.funPropertyCaller=function(t,n){function r(){var e=t.apply(this,i);return null!=e?n(e):e}var i=e.Mark.stack;return r},e.Mark.prototype.setPropertyValue=function(t,n,r,i,s,o){var u=!r<<1|"function"==typeof n;1&u&&i?n=e.Mark.funPropertyCaller(n,i):null!=n&&i&&(n=i(n));var a=this.$propertiesMap,f=this.$properties,l={name:t,id:e.id(),value:n,type:u,tag:o},c=a[t];a[t]=l;if(c)for(var h=0,p=f.length;p>h;h++)if(f[h]===c){f.splice(h,1);break}return f.push(l),s&&c&&3===u&&(l.proto=c,l.root=c.root||c),l},e.Mark.prototype.intercept=function(t,n,r){return this.setPropertyValue(t,n,!1,e.get(r,"noCast")?null:e.Mark.cast[t],!0,e.get(r,"tag")),this},e.Mark.prototype.propertyValue=function(e,t){var n=this.$propertiesMap[e];if(n)return n.value;if(t){if(this.proto){var r=this.proto._propertyValueRecursive(e);if(void 0!==r)return r}return this.defaults._propertyValueRecursive(e)}},e.Mark.prototype._propertyValueRecursive=function(e){var t=this.$propertiesMap[e];return t?t.value:this.proto?this.proto._propertyValueRecursive(e):void 0},e.Mark.stack=[],e.Mark.prototype.property("data").property("visible",Boolean).property("css",Object).property("svg",Object).property("left",Number).property("right",Number).property("top",Number).property("bottom",Number).property("cursor",String).property("title",String).property("reverse",Boolean).property("antialias",Boolean).property("events",String).property("id",String),e.Mark.prototype.childIndex=-1,e.Mark.prototype.index=-1,e.Mark.prototype.scale=1,e.Mark.prototype._zOrder=0,e.Mark.prototype.defaults=(new e.Mark).data(function(e){return[e]}).visible(!0).antialias(!0).events("painted"),e.Mark.prototype.extend=function(e){return this.proto=e,this.target=e.target,this},e.Mark.prototype.add=function(e){return this.parent.add(e).extend(this)},e.Mark.prototype.zOrder=function(e){if(!arguments.length)return this._zOrder;e=+e||0;if(this._zOrder!==e){var t=this.parent;t&&0!==this._zOrder&&t._zOrderChildCount--,this._zOrder=e,t&&0!==this._zOrder&&t._zOrderChildCount++}return this},e.Mark.prototype.anchor=function(t){return(new e.Anchor(this)).name(t||"center").data(function(){return this.scene.target.map(function(e){return e.data})}).visible(function(){return this.scene.target[this.index].visible}).id(function(){return this.scene.target[this.index].id}).left(function(){var e=this.scene.target[this.index],t=e.width||0;switch(this.name()){case"bottom":case"top":case"center":return e.left+t/2;case"left":return null}return e.left+t}).top(function(){var e=this.scene.target[this.index],t=e.height||0;switch(this.name()){case"left":case"right":case"center":return e.top+t/2;case"top":return null}return e.top+t}).right(function(){var e=this.scene.target[this.index];return"left"==this.name()?e.right+(e.width||0):null}).bottom(function(){var e=this.scene.target[this.index];return"top"==this.name()?e.bottom+(e.height||0):null}).textAlign(function(){switch(this.name()){case"bottom":case"top":case"center":return"center";case"right":return"right"}return"left"}).textBaseline(function(){switch(this.name()){case"right":case"left":case"center":return"middle";case"top":return"top"}return"bottom"})},e.Mark.prototype.anchorTarget=function(){return this.target},e.Mark.prototype.margin=function(e){return this.left(e).right(e).top(e).bottom(e)},e.Mark.prototype.instance=function(e){var t=this.scene||this.parent.instance(-1).children[this.childIndex],n=null==e||this.hasOwnProperty("index")?this.index:e;return t[0>n?t.length-1:n]},e.Mark.prototype.instances=function(t){for(var n,r=this,i=[];!(n=r.scene);)i.push({index:t.parentIndex,childIndex:r.childIndex}),t=t.parent,r=r.parent;for(var s=i.length;s--;){var o=i[s];n=n[o.index].children[o.childIndex]}if(this.hasOwnProperty("index")){var u=e.extend(n[this.index]);return u.right=u.top=u.left=u.bottom=0,[u]}return n},e.Mark.prototype.first=function(){return this.scene[0]},e.Mark.prototype.last=function(){return this.scene[this.scene.length-1]},e.Mark.prototype.sibling=function(){return 0==this.index?null:this.scene[this.index-1]},e.Mark.prototype.cousin=function(){var e=this.parent,t=e&&e.sibling();return t&&t.children?t.children[this.childIndex][this.index]:null},e.Mark.prototype._renderId=0,e.Mark.prototype.renderId=function(){return this.root._renderId},e.Mark.prototype.render=function(){var e=this.root;!this.parent||e.scene?(e._renderId++,this.renderCore()):e.render()},e.Mark.prototype.renderCore=function(){function t(t,r,s){t.scale=s;if(a>r){var o=r>=i.length;o&&i.unshift(null);if(t.hasOwnProperty("index"))n(t,r,s,o);else{for(var u=0,f=t.scene.length;f>u;u++)t.index=u,n(t,r,s,o);delete t.index}o&&i.shift()}else t.build(),e.Scene.scale=s,e.Scene.updateAll(t.scene);delete t.scale}function n(e,n,r,s){var u,a=e.scene[e.index];if(a.visible){var f=e.children,l=a.children,c=o[n],h=f[c];h.scene||c++;for(u=0;c>u;u++)f[u].scene=l[u];s&&(i[0]=a.data),t(h,n+1,r*a.transform.k);for(u=0;c>u;u++)f[u].scene=void 0}}for(var r=this.parent,i=e.Mark.stack,s=i.length,o=[],u=this;u.parent;u=u.parent)o.unshift(u.childIndex);var a=o.length;this.bind();for(;r&&!r.hasOwnProperty("index");)r=r.parent;try{this.context(r?r.scene:void 0,r?r.index:-1,function(){t(this.root,0,1)})}catch(f){throw i.length>s&&(i.length=s),f}},e.Mark.prototype.bind=function(){function t(e){do for(var t=e.$properties,o=t.length;o--;){var u=t[o],a=u.name,f=r[a];if(f){if(3===f.type){var l=f.root;f.root=u,l?l.proto||(l.proto=u):f.proto=u}}else{r[a]=u;switch(a){case"data":n=u;break;case"visible":case"id":i.push(u);break;default:s[u.type].push(u)}}}while(e=e.proto)}var n,r={},i=[],s=[[],[],[],[]];t(this),t(this.defaults);var o=s[0],u=s[1].reverse(),a=s[2];s[3].reverse();var f=this;do for(var l in f.properties)l in r||a.push(r[l]={name:l,type:2,value:null});while(f=f.proto);var c;if(o.length||u.length){c=o.concat(u);for(var h=0,p=c.length;p>h;h++)this.propertyMethod(c[h].name,!0)}else c=[];this.binds={properties:r,data:n,defs:c,required:i,optional:e.blend(s)}},e.Mark.prototype.build=function(){var t=e.Mark.stack,n=this.scene;if(!n){n=this.scene=[],n.mark=this,n.type=this.type,n.childIndex=this.childIndex;var r=this.parent;r&&(n.parent=r.scene,n.parentIndex=r.index)}this.target&&(n.target=this.target.instances(n));var i=this.binds.defs;if(i.length)for(var s=n.defs||(n.defs={}),o=0,u=i.length;u>o;o++){var a=i[o],f=s[a.name];(!f||a.id>f.id)&&(s[a.name]={id:0,value:1&a.type?a.value.apply(this,t):a.value})}var l=this.evalProperty(this.binds.data),c=l.length;n.length=c;if(c){var h=e.Mark.prototype;t.unshift(null);var p=e.propBuildMark,d=e.propBuilt;e.propBuildMark=this;try{for(var o=0;c>o;o++){h.index=this.index=o,e.propBuilt={};var v=n[o];v?v._state&&delete v._state:v=n[o]={},v.data=t[0]=l[o],this.preBuildInstance(v),this.buildInstance(v)}}finally{h.index=-1,delete this.index,t.shift(),e.propBuildMark=p,e.propBuilt=d}}return this},e.Mark.prototype.instanceState=function(e){return e||(e=this.instance()),e?e._state||(e._state={}):null},e.Mark.prototype.preBuildInstance=function(){},e.Mark.prototype.buildInstance=function(e){this.buildProperties(e,this.binds.required),e.visible&&(this.buildProperties(e,this.binds.optional),this.buildImplied(e))},!function(){var t,n=e.Mark.stack,r=[function(e){return this.scene.defs[e.name].value},null,function(e){return e.value},function(e){return t=e.proto,e.value.apply(this,n)}];r[1]=r[0],e.Mark.prototype.buildProperties=function(n,i){var s=e.propBuilt,o=!s;o&&(e.propBuildMark=this,e.propBuilt=s={});for(var u=t,a=0,f=i.length;f>a;a++){var l=i[a],c=l.name;c in s||(s[c]=1,n[c]=r[l.type].call(this,l))}t=u,o&&(e.propBuildMark=e.propBuilt=null)},e.Mark.prototype.evalProperty=function(e){var n=t,i=r[e.type].call(this,e);return t=n,i},e.Mark.prototype.evalInPropertyContext=function(e,r){var i=t;t=r;var s=e.apply(this,n);return t=i,s},e.Mark.prototype.delegate=function(e,n){if(t&&(!n||t.tag===n)){var r=this.evalProperty(t);if(void 0!==r)return r}return e},e.Mark.prototype.delegateExcept=function(e,n){if(t&&(!n||t.tag!==n)){var r=this.evalProperty(t);if(void 0!==r)return r}return e},e.Mark.prototype.hasDelegate=function(e){return!(!t||e&&t.tag!==e)}}(),e.Mark.prototype.buildImplied=function(t){var n,r,i=t.left,s=t.right,o=t.top,u=t.bottom,a=this.properties,f=a.width?t.width:0,l=a.height?t.height:0;if(null==f||null==s||null==i){n=this.parent&&this.parent.instance(),r=!0;var c=n?n.width:f+i+s;null==f?f=c-(s=s||0)-(i=i||0):null==s?null==i?i=s=(c-f)/2:s=c-f-i:i=c-f-s}if(null==l||null==u||null==o){r||(n=this.parent&&this.parent.instance());var h=n?n.height:l+o+u;null==l?l=h-(o=o||0)-(u=u||0):null==u?u=null==o?o=(h-l)/2:h-l-o:o=h-l-u}t.left=i,t.right=s,t.top=o,t.bottom=u,a.width&&(t.width=f),a.height&&(t.height=l),a.textStyle&&!t.textStyle&&(t.textStyle=e.FillStyle.transparent),a.fillStyle&&!t.fillStyle&&(t.fillStyle=e.FillStyle.transparent),a.strokeStyle&&!t.strokeStyle&&(t.strokeStyle=e.FillStyle.transparent)},e.Mark.prototype.mouse=function(){var t=this.root.canvas(),n=e.event,r=n&&n.pageX||0,i=n&&n.pageY||0,s=e.elementOffset(t);if(s){var o=e.cssStyle(t);r-=s.left+parseFloat(o("paddingLeft")||0),i-=s.top+parseFloat(o("paddingTop")||0)}var u=e.Transform.identity,a=this.properties.transform?this:this.parent,f=[];do f.push(a);while(a=a.parent);for(;a=f.pop();){var l=a.instance();u=u.translate(l.left,l.top).times(l.transform)}return u=u.invert(),e.vector(r*u.k+u.x,i*u.k+u.y)},e.Mark.prototype.event=function(t,n){n=e.functor(n);var r=this.$handlers[t];return r?r instanceof Array?r.push(n):r=[r,n]:r=n,this.$hasHandlers=!0,this.$handlers[t]=r,this},e.Mark.prototype.context=function(t,n,r){function i(t,n){e.Mark.scene=t,o.index=n;if(t){var r,i=t.mark,s=i,a=[];do{a.push(s),u.push(t[n].data),s.index=n,s.scene=t;if(s=s.parent)n=t.parentIndex,t=t.parent}while(s);var f=1;r=a.length-1;if(r>0)do s=a[r--],s.scale=f,f*=s.scene[s.index].transform.k;while(r);i.scale=f;var l,c=i.children;if(c&&(l=c.length)>0){var h=i.scene[i.index];f*=h.transform.k;var p=h.children;r=l;for(;r--;)s=c[r],s.scene=p[r],s.scale=f}}}function s(e){if(e){var t,n=e.mark,r=n.children;if(r)for(var i=r.length;i--;)t=r[i],t.scene=void 0,t.scale=1;t=n;var s,o=0;do{o++,delete t.index;if(s=t.parent)t.scene=void 0,t.scale=1}while(t=s);o&&(u.length-=o)}}var o=e.Mark.prototype,u=e.Mark.stack,a=e.Mark.scene,f=o.index;if(t&&t===a&&n===f)try{r.apply(this,u)}catch(l){throw e.error(l),l}finally{e.Mark.scene=a,o.index=f}else{s(a,f),i(t,n);try{r.apply(this,u)}catch(l){throw e.error(l),l}finally{s(t,n),i(a,f)}}},e.Mark.prototype.getEventHandler=function(e,t,n,r){var i=this.$handlers[e];return i?[i,t,n,r]:this.getParentEventHandler(e,t,n,r)},e.Mark.prototype.getParentEventHandler=function(e,t,n,r){var i=t.parent;return i?i.mark.getEventHandler(e,i,t.parentIndex,r):void 0},e.Mark.dispatch=function(e,t,n,r){var i=t.mark.root;if(i.$transition)return!0;var s,o=i.$interceptors&&i.$interceptors[e];if(o)for(var u=0,a=o.length;a>u;u++){s=o[u](e,r);if(s)break;if(s===!1)return!0}if(!s){s=t.mark.getEventHandler(e,t,n,r);if(!s)return!1}return this.handle.apply(this,s)},e.Mark.handle=function(t,n,r,i){var s=n.mark;return s.context(n,r,function(){var n,r,o,u=e.Mark.stack.concat(i);if(t instanceof Array){var a;for(n=0,r=t.length;r>n;n++)o=t[n].apply(s,u),o&&o.render&&(a||(a=[])).push(o);if(a)for(n=0,r=a.length;r>n;n++)a[n].render()}else o=t.apply(s,u),o&&o.render&&o.render()}),!0},e.Mark.prototype.addEventInterceptor=function(e,t,n){var r=this.root;if(r){var i=r.$interceptors||(r.$interceptors={}),s=i[e]||(i[e]=[]);n?s.unshift(t):s.push(t)}},e.Mark.prototype.eachInstance=function(t,n){function r(e,i,o){var a=e.length;if(a>0){var f,l=i===u;l||(f=s[i]);for(var c=0;a>c;c++){var h=e[c];if(h.visible)if(i===u)t.call(n,e,c,o);else{var p=h.children[f];if(p){var d=o.times(h.transform).translate(h.left,h.top);r(p,i+1,d)}}}}}for(var i=this,s=[];i.parent;)s.unshift(i.childIndex),i=i.parent;var o=i.scene;if(o){var u=s.length;r(o,0,e.Transform.identity)}},e.Mark.prototype.toScreenTransform=function(){var t=e.Transform.identity;this instanceof e.Panel&&(t=t.translate(this.left(),this.top()).times(this.transform()));var n=this.parent;if(n)do t=t.translate(n.left(),n.top()).times(n.transform());while(n=n.parent);return t},e.Mark.prototype.transition=function(){return new e.Transition(this)},e.Mark.prototype.on=function(t){return this["$"+t]=new e.Transient(this)},e.Mark.prototype.getShape=function(e,t,n){var r=e[t];if(!r.visible)return null;null==n&&(n=0);var i="_shape_inset_"+n;return r[i]||(r[i]=this.getShapeCore(e,t,n))},e.Mark.prototype.getShapeCore=function(t,n,r){var i=t[n],s=i.left,o=i.top,u=i.width,a=i.height;if(r>0&&1>=r){var f=r*u,l=r*a;s+=f,o+=l,u-=2*f,a-=2*l}return new e.Shape.Rect(s,o,u,a)},e.Anchor=function(t){e.Mark.call(this),this.target=t,this.parent=t.parent},e.Anchor.prototype=e.extend(e.Mark).property("name",String),e.Anchor.prototype.extend=function(e){return this.proto=e,this},e.Area=function(){e.Mark.call(this)},e.Area.castSegmented=function(e){if(!e)return"";switch(e){case"smart":case"full":break;default:e="full"}return e},e.Area.prototype=e.extend(e.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeDasharray",String).property("strokeStyle",e.fillStyle).property("fillStyle",e.fillStyle).property("segmented",e.Area.castSegmented).property("interpolate",String).property("tension",Number),e.Area.prototype.type="area",e.Area.prototype.defaults=(new e.Area).extend(e.Mark.prototype.defaults).lineWidth(1.5).fillStyle(e.Colors.category20().by(e.parent)).interpolate("linear").tension(.7).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none"),e.Area.prototype.buildImplied=function(t){null==t.height&&(t.height=0),null==t.width&&(t.width=0),e.Mark.prototype.buildImplied.call(this,t)},e.Area.fixed={lineWidth:1,lineJoin:1,strokeMiterLimit:1,lineCap:1,strokeStyle:1,strokeDasharray:1,fillStyle:1,segmented:1,interpolate:1,tension:1},e.Area.prototype.bind=function(){e.Mark.prototype.bind.call(this);for(var t=this.binds,n=t.required,r=t.optional,i=0,s=r.length;s>i;i++){var o=r[i];o.fixed=o.name in e.Area.fixed,"segmented"==o.name&&(n.push(o),r.splice(i,1),i--,s--)}this.binds.$required=n,this.binds.$optional=r},e.Area.prototype.buildInstance=function(t){function n(e){return!e.fixed||(i.push(e),!1)}var r=this.binds;if(this.index){var i=r.fixed;i||(i=r.fixed=[],r.required=r.required.filter(n),this.scene[0].segmented||(r.optional=r.optional.filter(n)));var s=i.length;if(s)for(var o=this.scene[0],u=0;s>u;u++){var a=i[u].name;t[a]=o[a]}}else r.required=r.$required,r.optional=r.$optional,r.fixed=null;e.Mark.prototype.buildInstance.call(this,t)},e.Area.prototype.anchor=function(t){return e.Mark.prototype.anchor.call(this,t).interpolate(function(){return this.scene.target[this.index].interpolate}).eccentricity(function(){return this.scene.target[this.index].eccentricity}).tension(function(){return this.scene.target[this.index].tension})},e.Area.prototype.getEventHandler=function(t,n,r,i){var s=n[r],o=1===e.Scene.mousePositionEventSet[t]&&(!s.segmented||"smart"===s.segmented);if(!o)return e.Mark.prototype.getEventHandler.call(this,t,n,r,i);var u,a="mousemove"===t?this.$handlers.mouseover:null,f=this.$handlers[t],l=f||a;return l&&(u=this.getNearestInstanceToMouse(n,r),a&&!this.filterMouseMove(n,u)&&(a=null,l=f)),l?(f&&a&&(l=[].concat(f,a)),[l,n,u,i]):this.getParentEventHandler(t,n,r,i)},e.Area.prototype.filterMouseMove=function(e,t){var n=this._mouseOverScene;if(!n||n!==e||this._mouseOverIndex!==t)return this._mouseOverScene=e,this._mouseOverIndex=t,!0},e.Area.prototype.getNearestInstanceToMouse=function(e,t){for(var n=this.mouse(),r=1/0,i=null,s=t,o=e.length;o>s;s++){var u=this.getShape(e,s);if(u){if(u.containsPoint(n))return s;var a=u.distance2(n).dist2;r>a&&(r=a,i=s)}}return null!=i?i:t},e.Area.prototype.getShapeCore=function(t,n){var r=t[n],i=r.width||0,s=r.height||0,o=r.left,u=r.top,a=n+1<t.length?t[n+1]:null;if(!a||!a.visible)return new e.Shape.Line(o,u,o+i,u+s);var f=a.left,l=a.top,c=a.height||0,h=a.width||0;return new e.Shape.Polygon([new e.Vector(o,u),new e.Vector(f,l),new e.Vector(f+h,l+c),new e.Vector(o+i,u+s)])},e.Bar=function(){e.Mark.call(this)},e.Bar.prototype=e.extend(e.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",e.fillStyle).property("fillStyle",e.fillStyle).property("lineCap",String).property("strokeDasharray",String),e.Bar.prototype.type="bar",e.Bar.prototype.defaults=(new e.Bar).extend(e.Mark.prototype.defaults).lineWidth(1.5).fillStyle(e.Colors.category20().by(e.parent)).lineCap("butt").strokeDasharray("none"),e.Dot=function(){e.Mark.call(this)},e.Dot.prototype=e.extend(e.Mark).property("shape",String).property("shapeAngle",Number).property("shapeRadius",Number).property("shapeSize",Number).property("aspectRatio",Number).property("lineWidth",Number).property("strokeStyle",e.fillStyle).property("lineCap",String).property("strokeDasharray",String).property("fillStyle",e.fillStyle),e.Dot.prototype.type="dot",e.Dot.prototype.defaults=(new e.Dot).extend(e.Mark.prototype.defaults).shape("circle").aspectRatio(1).lineWidth(1.5).strokeStyle(e.Colors.category10().by(e.parent)).lineCap("butt").strokeDasharray("none"),e.Dot.prototype.anchor=function(t){return e.Mark.prototype.anchor.call(this,t).left(function(){var e=this.scene.target[this.index];switch(this.name()){case"bottom":case"top":case"center":return e.left;case"left":return null}return e.left+e._width/2}).right(function(){var e=this.scene.target[this.index];return"left"==this.name()?e.right+e._width/2:null}).top(function(){var e=this.scene.target[this.index];switch(this.name()){case"left":case"right":case"center":return e.top;case"top":return null}return e.top+e._height/2}).bottom(function(){var e=this.scene.target[this.index];return"top"==this.name()?e.bottom+e._height/2:null}).textAlign(function(){switch(this.name()){case"left":return"right";case"bottom":case"top":case"center":return"center"}return"left"}).textBaseline(function(){switch(this.name()){case"right":case"left":case"center":return"middle";case"bottom":return"top"}return"bottom"})},e.Dot.prototype.buildImplied=function(t){var n=t.shapeRadius,r=t.shapeSize,i=t.aspectRatio||1;null==n?null==r?(r=t.shapeSize=20.25,n=t.shapeRadius=4.5):n=t.shapeRadius=Math.sqrt(r):null==r&&(r=t.shapeSize=n*n);var s,o;1===i||0>i?s=o=2*n:(s=2*n/Math.sqrt(i),o=i*s),t._height=s,t._width=o,e.Mark.prototype.buildImplied.call(this,t)},e.Dot.prototype.width=function(){return this.instance()._width},e.Dot.prototype.height=function(){return this.instance()._height},e.Dot.prototype.getShapeCore=function(t,n){var r=t[n],i=r._width,s=r._height,o=r.left,u=r.top;switch(r.shape){case"diamond":i*=Math.SQRT2,s*=Math.SQRT2;case"square":case"cross":return new e.Shape.Rect(o-s/2,u-i/2,s,i)}return new e.Shape.Circle(o,u,r.shapeRadius)},e.Label=function(){e.Mark.call(this)},e.Label.prototype=e.extend(e.Mark).property("text",String).property("font",String).property("textAngle",Number).property("textStyle",e.color).property("textAlign",String).property("textBaseline",String).property("textMargin",Number).property("textDecoration",String).property("textShadow",String),e.Label.prototype.type="label",e.Label.prototype.defaults=(new e.Label).extend(e.Mark.prototype.defaults).events("none").text(e.identity).font("10px sans-serif").textAngle(0).textStyle("black").textAlign("left").textBaseline("bottom").textMargin(3),e.Label.prototype.getShapeCore=function(t,n,r){var i=t[n],s=e.Text.measure(i.text,i.font),o=i.left,u=i.top,a=s.width,f=s.height;if(r>0&&1>=r){var l=r*a,c=r*f;o+=l,u+=c,a-=2*l,f-=2*c}return e.Label.getPolygon(a,f,i.textAlign,i.textBaseline,i.textAngle,i.textMargin).apply(e.Transform.identity.translate(o,u))},e.Label.getPolygon=function(t,n,r,i,s,o){var u,a;switch(i){case"middle":a=n/2;break;case"top":a=o+n;break;case"bottom":a=-o}switch(r){case"right":u=-o-t;break;case"center":u=-t/2;break;case"left":u=o}var f=new e.Vector(u,a),l=f.plus(t,0),c=l.plus(0,-n),h=f.plus(0,-n);return 0!==s&&(f=f.rotate(s),l=l.rotate(s),h=h.rotate(s),c=c.rotate(s)),new e.Shape.Polygon([f,l,c,h])},e.Line=function(){e.Mark.call(this)},e.Line.prototype=e.extend(e.Mark).property("lineWidth",Number).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeStyle",e.fillStyle).property("strokeDasharray",String).property("fillStyle",e.fillStyle).property("segmented",e.Area.castSegmented).property("interpolate",String).property("eccentricity",Number).property("tension",Number),e.Line.prototype.type="line",e.Line.prototype.defaults=(new e.Line).extend(e.Mark.prototype.defaults).lineWidth(1.5).strokeStyle(e.Colors.category10().by(e.parent)).interpolate("linear").eccentricity(0).tension(.7).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none"),e.Line.prototype.bind=e.Area.prototype.bind,e.Line.prototype.buildInstance=e.Area.prototype.buildInstance,e.Line.prototype.getEventHandler=e.Area.prototype.getEventHandler,e.Line.prototype.getNearestInstanceToMouse=e.Area.prototype.getNearestInstanceToMouse,e.Line.prototype.filterMouseMove=e.Area.prototype.filterMouseMove,e.Line.prototype.anchor=function(t){return e.Area.prototype.anchor.call(this,t).textAlign(function(){switch(this.name()){case"left":return"right";case"bottom":case"top":case"center":return"center";case"right":return"left"}}).textBaseline(function(){switch(this.name()){case"right":case"left":case"center":return"middle";case"top":return"bottom";case"bottom":return"top"}})},e.Line.prototype.getShapeCore=function(t,n){var r=t[n],i=n+1<t.length?t[n+1]:null;return null!=i&&i.visible?new e.Shape.Line(r.left,r.top,i.left,i.top):new e.Shape.Point(r.left,r.top)},e.Rule=function(){e.Mark.call(this)},e.Rule.prototype=e.extend(e.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",e.fillStyle).property("lineCap",String).property("strokeDasharray",String),e.Rule.prototype.type="rule",e.Rule.prototype.defaults=(new e.Rule).extend(e.Mark.prototype.defaults).lineWidth(1).strokeStyle("black").antialias(!1).lineCap("butt").strokeDasharray("none"),e.Rule.prototype.anchor=e.Line.prototype.anchor,e.Rule.prototype.buildImplied=function(t){var n=t.left,r=t.right;t.top,t.bottom,null!=t.width||null==n&&null==r||null!=r&&null!=n?t.height=0:t.width=0,e.Mark.prototype.buildImplied.call(this,t)},e.Rule.prototype.getShapeCore=function(t,n){var r=t[n];return new e.Shape.Line(r.left,r.top,r.left+r.width,r.top+r.height)},e.Panel=function(){e.Bar.call(this),this.children=[],this.root=this,this.$dom=e.$&&e.$.s},e.Panel.prototype=e.extend(e.Bar).property("transform").property("overflow",String).property("canvas",function(e){return"string"==typeof e?document.getElementById(e):e}),e.Panel.prototype.type="panel",e.Panel.prototype._zOrderChildCount=0,e.Panel.prototype.defaults=(new e.Panel).extend(e.Bar.prototype.defaults).fillStyle(null).overflow("visible"),e.Panel.prototype.anchor=function(t){var n=e.Bar.prototype.anchor.call(this,t);return n.parent=this,n},e.Panel.prototype.add=function(e){var t=new e;t.parent=this,t.root=this.root,t.childIndex=this.children.length,this.children.push(t);var n=+t._zOrder||0;return 0!==n&&this._zOrderChildCount++,t},e.Panel.prototype.bind=function(){e.Mark.prototype.bind.call(this);for(var t=this.children,n=0,r=t.length;r>n;n++)t[n].bind()},e.Panel.prototype.buildInstance=function(t){e.Bar.prototype.buildInstance.call(this,t);if(t.visible){var n=this.scale*t.transform.k;e.Mark.prototype.index=-1;for(var r,i=this.children,s=t.children||(t.children=[]),o=0,u=i.length;u>o;o++)r=i[o],r.scene=s[o],r.scale=n,r.build();o=u;for(;o--;)r=i[o],s[o]=r.scene,delete r.scene,delete r.scale;s.length=u}},e.Panel.prototype.buildImplied=function(t){this.parent||this._buildRootInstanceImplied(t)?(t.transform||(t.transform=e.Transform.identity),e.Mark.prototype.buildImplied.call(this,t)):t.visible=!1},e.Panel.prototype._buildRootInstanceImplied=function(e){var t=e.canvas;if(t){if(!this._rootInstanceStealCanvas(e,t))return!1;this._rootInstanceInitCanvas(e,t)}else e.canvas=this._rootInstanceGetInlineCanvas(e);return!0},e.Panel.prototype._rootInstanceStealCanvas=function(t,n){var r=n.$panel;if(r!==this){if(r){if(this.$lastCreateId)return!1;r._disposeRootPanel(),this._updateCreateId(n)}n.$panel=this,e.removeChildren(n)}else this._updateCreateId(n);return!0},e.Panel.prototype._registerBoundEvent=function(e,t,n,r){if(e.removeEventListener){var i=this._boundEvents||(this._boundEvents=[]);i.push([e,t,n,r])}},e.Panel.prototype._disposeRootPanel=function(){var e=this.$transition;e&&e.stop();var t=this._boundEvents;if(t){this._boundEvents=null;for(var n=0,r=t.length;r>n;n++){var i=t[n];i[0].removeEventListener(i[1],i[2],i[3])}}},e.Panel.prototype._rootInstanceInitCanvas=function(t,n){var r,i,s;null==t.width&&(s=e.cssStyle(n),r=parseFloat(s("width")||0),t.width=r-t.left-t.right),null==t.height&&(s||(s=e.cssStyle(n)),i=parseFloat(s("height")||0),t.height=i-t.top-t.bottom),s=null},e.Panel.prototype._rootInstanceGetInlineCanvas=function(){var e,t=this.$canvas||(this.$canvas=[]);if(!(e=t[this.index])){e=t[this.index]=document.createElement("span");if(this.$dom)this.$dom.parentNode.insertBefore(e,this.$dom);else{for(var n=document.body;n.lastChild&&n.lastChild.tagName;)n=n.lastChild;n!=document.body&&(n=n.parentNode),n.appendChild(e)}}return e},e.Panel.prototype._updateCreateId=function(e){this.$lastCreateId=e.$pvCreateId=(e.$pvCreateId||0)+1},e.Image=function(){e.Bar.call(this)},e.Image.prototype=e.extend(e.Bar).property("url",String).property("imageWidth",Number).property("imageHeight",Number),e.Image.prototype.type="image",e.Image.prototype.defaults=(new e.Image).extend(e.Bar.prototype.defaults).fillStyle(null),e.Image.prototype.image=function(t){return this.$image=function(){var n=t.apply(this,arguments);return null==n?e.Color.transparent:"string"==typeof n?e.color(n):n},this},e.Image.prototype.bind=function(){e.Bar.prototype.bind.call(this);var t=this.binds,n=this;do t.image=n.$image;while(!t.image&&(n=n.proto))},e.Image.prototype.buildImplied=function(t){e.Bar.prototype.buildImplied.call(this,t);if(t.visible){null==t.imageWidth&&(t.imageWidth=t.width),null==t.imageHeight&&(t.imageHeight=t.height);if(null==t.url&&this.binds.image){var n,r=this.$canvas||(this.$canvas=document.createElement("canvas")),i=r.getContext("2d"),s=t.imageWidth,o=t.imageHeight,u=e.Mark.stack;r.width=s,r.height=o,n=(t.image=i.createImageData(s,o)).data,u.unshift(null,null);for(var a=0,f=0;o>a;a++){u[1]=a;for(var l=0;s>l;l++){u[0]=l;var c=this.binds.image.apply(this,u);n[f++]=c.r,n[f++]=c.g,n[f++]=c.b,n[f++]=255*c.a}}u.splice(0,2)}}},e.Wedge=function(){e.Mark.call(this)},e.Wedge.prototype=e.extend(e.Mark).property("startAngle",Number).property("endAngle",Number).property("angle",Number).property("innerRadius",Number).property("outerRadius",Number).property("lineWidth",Number).property("strokeStyle",e.fillStyle).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeDasharray",String).property("fillStyle",e.fillStyle),e.Wedge.prototype.type="wedge",e.Wedge.prototype.defaults=(new e.Wedge).extend(e.Mark.prototype.defaults).startAngle(function(){var e=this.sibling();return e?e.endAngle:-Math.PI/2}).innerRadius(0).lineWidth(1.5).strokeStyle(null).fillStyle(e.Colors.category20().by(e.index)).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none"),e.Wedge.prototype.midRadius=function(){return(this.innerRadius()+this.outerRadius())/2},e.Wedge.prototype.midAngle=function(){return(this.startAngle()+this.endAngle())/2},e.Wedge.prototype.anchor=function(t){function n(e){return e.innerRadius||e.angle<2*Math.PI}function r(e){return(e.innerRadius+e.outerRadius)/2}function i(e){return(e.startAngle+e.endAngle)/2}return e.Mark.prototype.anchor.call(this,t).left(function(){var e=this.scene.target[this.index];if(n(e))switch(this.name()){case"outer":return e.left+e.outerRadius*Math.cos(i(e));case"inner":return e.left+e.innerRadius*Math.cos(i(e));case"start":return e.left+r(e)*Math.cos(e.startAngle);case"center":return e.left+r(e)*Math.cos(i(e));case"end":return e.left+r(e)*Math.cos(e.endAngle)}return e.left}).top(function(){var e=this.scene.target[this.index];if(n(e))switch(this.name()){case"outer":return e.top+e.outerRadius*Math.sin(i(e));case"inner":return e.top+e.innerRadius*Math.sin(i(e));case"start":return e.top+r(e)*Math.sin(e.startAngle);case"center":return e.top+r(e)*Math.sin(i(e));case"end":return e.top+r(e)*Math.sin(e.endAngle)}return e.top}).textAlign(function(){var t=this.scene.target[this.index];if(n(t))switch(this.name()){case"outer":return e.Wedge.upright(i(t))?"right":"left";case"inner":return e.Wedge.upright(i(t))?"left":"right"}return"center"}).textBaseline(function(){var t=this.scene.target[this.index];if(n(t))switch(this.name()){case"start":return e.Wedge.upright(t.startAngle)?"top":"bottom";case"end":return e.Wedge.upright(t.endAngle)?"bottom":"top"}return"middle"}).textAngle(function(){var t=this.scene.target[this.index],r=0;if(n(t))switch(this.name()){case"center":case"inner":case"outer":r=i(t);break;case"start":r=t.startAngle;break;case"end":r=t.endAngle}return e.Wedge.upright(r)?r:r+Math.PI})},e.Wedge.upright=function(e){return e%=2*Math.PI,e=0>e?2*Math.PI+e:e,e<Math.PI/2||e>=3*Math.PI/2},e.Wedge.prototype.buildImplied=function(t){null==t.angle?t.angle=t.endAngle-t.startAngle:null==t.endAngle&&(t.endAngle=t.startAngle+t.angle),e.Mark.prototype.buildImplied.call(this,t)},e.Wedge.prototype.getShapeCore=function(t,n){var r=t[n];return new e.Shape.Wedge(r.left,r.top,r.innerRadius,r.outerRadius,r.startAngle,r.angle)},e.Ease=function(){function t(e){return function(t){return 1-e(1-t)}}function n(e){return function(t){return.5*(.5>t?e(2*t):2-e(2-2*t))}}function r(e){return function(t){return 0>t?0:t>1?1:Math.pow(t,e)}}function i(e){return 1-Math.cos(e*Math.PI/2)}function s(e){return e?Math.pow(2,10*(e-1))-.001:0}function o(e){return-(Math.sqrt(1-e*e)-1)}function u(e,t){var n;return t||(t=.45),!e||1>e?(e=1,n=t/4):n=t/(2*Math.PI)*Math.asin(1/e),function(r){return 0>=r||r>=1?r:-(e*Math.pow(2,10*--r)*Math.sin((r-n)*2*Math.PI/t))}}function a(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function f(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}var l=r(2),c=r(3),h=u(),p=a(),d={linear:e.identity,"quad-in":l,"quad-out":t(l),"quad-in-out":n(l),"quad-out-in":n(t(l)),"cubic-in":c,"cubic-out":t(c),"cubic-in-out":n(c),"cubic-out-in":n(t(c)),"sin-in":i,"sin-out":t(i),"sin-in-out":n(i),"sin-out-in":n(t(i)),"exp-in":s,"exp-out":t(s),"exp-in-out":n(s),"exp-out-in":n(t(s)),"circle-in":o,"circle-out":t(o),"circle-in-out":n(o),"circle-out-in":n(t(o)),"elastic-in":h,"elastic-out":t(h),"elastic-in-out":n(h),"elastic-out-in":n(t(h)),"back-in":p,"back-out":t(p),"back-in-out":n(p),"back-out-in":n(t(p)),"bounce-in":f,"bounce-out":t(f),"bounce-in-out":n(f),"bounce-out-in":n(t(f))};return e.ease=function(e){return d[e]},{reverse:t,reflect:n,linear:function(){return e.identity},sin:function(){return i},exp:function(){return s},circle:function(){return o},elastic:u,back:a,bounce:f,poly:r}}(),e.Transient=function(t){e.Mark.call(this),this.fillStyle(null).strokeStyle(null).textStyle(null),this.on=function(e){return t.on(e)}},e.Transient.prototype=e.extend(e.Mark),!function(){function t(e){for(var t={},n=e.length;n--;){var r=e[n],i=r.id;i&&(t[i]=r)}return t}function n(t,n,r,i){var s;if(n in u){var o=e.Scale.interpolator(r[n],i[n]);s=function(e){r[n]=o(e)}}else s=function(e){e>.5&&(r[n]=i[n])};s.next=t.head,t.head=s}function r(e,t,r){for(var i in t)"children"!==i&&t[i]!=r[i]&&n(e,i,t,r);var o=t.children;if(o)for(var u=r.children,a=0,f=o.length;f>a;a++)s(e,o[a],u[a])}function i(e,t,n,r){var i,s=Object.create(e[t]),o=e.mark,u=o.root.scene;r.target&&(i=r.target[r.length])&&(e=Object.create(e),e.target=Object.create(r.target),e.target[t]=i),n||(n=a);var f=n.$properties,l=n.$propertiesMap;return f=o.binds.optional.filter(function(e){return!(e.name in l)}).concat(f),o.context(e,t,function(){this.buildProperties(s,f),this.buildImplied(s)}),o.root.scene=u,s}function s(e,n,s){for(var o,u,a=n.mark,f=t(n),l=t(s),c=0,h=n.length;h>c;c++){o=n[c],u=o.id?l[o.id]:s[c],o.index=c;if(o.visible){if(!u||!u.visible){var p=i(n,c,a.$exit,s);o.transition=u?2:(s.push(p),1),u=p}r(e,o,u)}}c=0,h=s.length;for(;h>c;c++){u=s[c],o=u.id?f[u.id]:n[c];if((!o||!o.visible)&&u.visible){var d=i(s,c,a.$enter,n);o?n[o.index]=d:n.push(d),r(e,d,u)}}}function o(e){for(var t=0,n=0;t<e.length;t++){var r=e[t];1!=r.transition&&(e[n++]=r,2==r.transition&&(r.visible=!1),r.children&&r.children.forEach(o))}e.length=n}var u={top:1,left:1,right:1,bottom:1,width:1,height:1,innerRadius:1,outerRadius:1,radius:1,shapeRadius:1,shapeSize:1,startAngle:1,endAngle:1,angle:1,fillStyle:1,strokeStyle:1,lineWidth:1,eccentricity:1,tension:1,textAngle:1,textStyle:1,textMargin:1},a=new e.Transient;e.Transition=function(t){function n(e){var n=t.root.$transition===a;n&&(t.root.$transition=null),null!=r&&(clearInterval(r),r=null),n&&c(t.scene);if(i){var s=i;i=null,s(e)}return e}var r,i,u,a=this,f=e.ease("cubic-in-out"),l=250,c=function(e){u||(u=!0,o(e))};a.ease=function(t){return arguments.length?(f="function"==typeof t?t:e.ease(t),a):f},a.duration=function(e){return arguments.length?(l=Number(e),a):l},a.start=function(o){if(t.parent)throw new Error("Animated partial rendering is not supported.");i=o;var u=t.root;if(u.$transition)try{u.$transition.stop()}catch(h){return n(!1)}var p,d;u.$transition=a,u._renderId++;var v=t.scene;t.scene=null;var m=e.Mark.prototype.index;try{t.bind(),t.build();var g=t.scene;t.scene=v,e.Mark.prototype.index=m,d=Date.now(),p={},s(p,v,g)}catch(h){return e.Mark.prototype.index=m,n(!1)}if(!p.head)return n(!0);var y=function(){var r=Math.max(0,Math.min(1,(Date.now()-d)/l)),i=f(r),s=p.head;do s(i);while(s=s.next);1===r?(c(t.scene),e.Scene.updateAll(v),n(!0)):e.Scene.updateAll(v)};r=setInterval(function(){try{y()}catch(e){n(!1)}},24)},a.stop=function(){n(!0)}}}(),e.simulation=function(t){return new e.Simulation(t)},e.Simulation=function(e){for(var t=0;t<e.length;t++)this.particle(e[t])},e.Simulation.prototype.particle=function(e){return e.next=this.particles,isNaN(e.px)&&(e.px=e.x),isNaN(e.py)&&(e.py=e.y),isNaN(e.fx)&&(e.fx=0),isNaN(e.fy)&&(e.fy=0),this.particles=e,this},e.Simulation.prototype.force=function(e){return e.next=this.forces,this.forces=e,this},e.Simulation.prototype.constraint=function(e){return e.next=this.constraints,this.constraints=e,this},e.Simulation.prototype.stabilize=function(t){var n;arguments.length||(t=3);for(var r=0;t>r;r++){var i=new e.Quadtree(this.particles);for(n=this.constraints;n;n=n.next)n.apply(this.particles,i)}for(var s=this.particles;s;s=s.next)s.px=s.x,s.py=s.y;return this},e.Simulation.prototype.step=function(){var t,n,r;for(t=this.particles;t;t=t.next){var i=t.px,s=t.py;t.px=t.x,t.py=t.y,t.x+=t.vx=t.x-i+t.fx,t.y+=t.vy=t.y-s+t.fy}var o=new e.Quadtree(this.particles);for(r=this.constraints;r;r=r.next)r.apply(this.particles,o);for(t=this.particles;t;t=t.next)t.fx=t.fy=0;for(n=this.forces;n;n=n.next)n.apply(this.particles,o)},e.Quadtree=function(t){function n(e,t,n,i,s,o){if(!isNaN(t.x)&&!isNaN(t.y))if(e.leaf)if(e.p)if(Math.abs(e.p.x-t.x)+Math.abs(e.p.y-t.y)<.01)r(e,t,n,i,s,o);else{var u=e.p;e.p=null,r(e,u,n,i,s,o),r(e,t,n,i,s,o)}else e.p=t;else r(e,t,n,i,s,o)}function r(t,r,i,s,o,u){var a=.5*(i+o),f=.5*(s+u),l=r.x>=a,c=r.y>=f;t.leaf=!1;switch((c<<1)+l){case 0:t=t.c1||(t.c1=new e.Quadtree.Node);break;case 1:t=t.c2||(t.c2=new e.Quadtree.Node);break;case 2:t=t.c3||(t.c3=new e.Quadtree.Node);break;case 3:t=t.c4||(t.c4=new e.Quadtree.Node)}l?i=a:o=a,c?s=f:u=f,n(t,r,i,s,o,u)}var i,s=Number.POSITIVE_INFINITY,o=s,u=Number.NEGATIVE_INFINITY,a=u;for(i=t;i;i=i.next)i.x<s&&(s=i.x),i.y<o&&(o=i.y),i.x>u&&(u=i.x),i.y>a&&(a=i.y);var f=u-s,l=a-o;f>l?a=o+f:u=s+l,this.xMin=s,this.yMin=o,this.xMax=u,this.yMax=a,this.root=new e.Quadtree.Node;for(i=t;i;i=i.next)n(this.root,i,s,o,u,a)},e.Quadtree.Node=function(){this.leaf=!0,this.c1=null,this.c2=null,this.c3=null,this.c4=null,this.p=null},e.Force={},e.Force.charge=function(e){function t(n){function r(e){t(e),n.cn+=e.cn,i+=e.cn*e.cx,s+=e.cn*e.cy}var i=0,s=0;n.cn=0,n.leaf||(n.c1&&r(n.c1),n.c2&&r(n.c2),n.c3&&r(n.c3),n.c4&&r(n.c4)),n.p&&(n.cn+=e,i+=e*n.p.x,s+=e*n.p.y),n.cx=i/n.cn,n.cy=s/n.cn}function n(t,r,s,a,f,l){var c=t.cx-r.x,h=t.cy-r.y,p=1/Math.sqrt(c*c+h*h);if(t.leaf&&t.p!=r||u>(f-s)*p){if(o>p)return;p>i&&(p=i);var d=t.cn*p*p*p,v=c*d,m=h*d;r.fx+=v,r.fy+=m}else if(!t.leaf){var g=.5*(s+f),y=.5*(a+l);t.c1&&n(t.c1,r,s,a,g,y),t.c2&&n(t.c2,r,g,a,f,y),t.c3&&n(t.c3,r,s,y,g,l),t.c4&&n(t.c4,r,g,y,f,l);if(o>p)return;p>i&&(p=i);if(t.p&&t.p!=r){var d=e*p*p*p,v=c*d,m=h*d;r.fx+=v,r.fy+=m}}}var r=2,i=1/r,s=500,o=1/s,u=.9,a={};return arguments.length||(e=-40),a.constant=function(t){return arguments.length?(e=Number(t),a):e},a.domain=function(e,t){return arguments.length?(r=Number(e),i=1/r,s=Number(t),o=1/s,a):[r,s]},a.theta=function(e){return arguments.length?(u=Number(e),a):u},a.apply=function(e,r){t(r.root);for(var i=e;i;i=i.next)n(r.root,i,r.xMin,r.yMin,r.xMax,r.yMax)},a},e.Force.drag=function(e){var t={};return arguments.length||(e=.1),t.constant=function(n){return arguments.length?(e=n,t):e},t.apply=function(t){if(e)for(var n=t;n;n=n.next)n.fx-=e*n.vx,n.fy-=e*n.vy},t},e.Force.spring=function(e){var t,n,r=.1,i=20,s={};return arguments.length||(e=.1),s.links=function(e){return arguments.length?(t=e,n=e.map(function(e){return 1/Math.sqrt(Math.max(e.sourceNode.linkDegree,e.targetNode.linkDegree))}),s):t},s.constant=function(t){return arguments.length?(e=Number(t),s):e},s.damping=function(e){return arguments.length?(r=Number(e),s):r},s.length=function(e){return arguments.length?(i=Number(e),s):i},s.apply=function(){for(var s=0;s<t.length;s++){var o=t[s].sourceNode,u=t[s].targetNode,a=o.x-u.x,f=o.y-u.y,c=Math.sqrt(a*a+f*f),h=c?1/c:1,p=e*n[s],v=r*n[s],m=(p*(c-i)+v*(a*(o.vx-u.vx)+f*(o.vy-u.vy))*h)*h,g=-m*(c?a:.01*(.5-Math.random())),y=-m*(c?f:.01*(.5-Math.random()));o.fx+=g,o.fy+=y,u.fx-=g,u.fy-=y}},s},e.Constraint={},e.Constraint.collision=function(e){function t(u,a,f,l,c,h){if(!u.leaf){var p=.5*(f+c),d=.5*(l+h),v=d>i,m=o>d,g=p>r,y=s>p;v&&(u.c1&&g&&t(u.c1,a,f,l,p,d),u.c2&&y&&t(u.c2,a,p,l,c,d)),m&&(u.c3&&g&&t(u.c3,a,f,d,p,h),u.c4&&y&&t(u.c4,a,p,d,c,h))}if(u.p&&u.p!=a){var b=a.x-u.p.x,w=a.y-u.p.y,E=Math.sqrt(b*b+w*w),S=n+e(u.p);if(S>E){var x=.5*((E-S)/E);b*=x,w*=x,a.x-=b,a.y-=w,u.p.x+=b,u.p.y+=w}}}var n,r,i,s,o,u=1,a={};return arguments.length||(n=10),a.repeat=function(e){return arguments.length?(u=Number(e),a):u},a.apply=function(a,f){var l,c,h=-1/0;for(l=a;l;l=l.next)c=e(l),c>h&&(h=c);for(var p=0;u>p;p++)for(l=a;l;l=l.next)c=(n=e(l))+h,r=l.x-c,s=l.x+c,i=l.y-c,o=l.y+c,t(f.root,l,f.xMin,f.yMin,f.xMax,f.yMax)},a},e.Constraint.position=function(e){var t=1,n={};return arguments.length||(e=function(e){return e.fix}),n.alpha=function(e){return arguments.length?(t=Number(e),n):t},n.apply=function(n){for(var r=n;r;r=r.next){var i=e(r);i&&(r.x+=(i.x-r.x)*t,r.y+=(i.y-r.y)*t,r.fx=r.fy=r.vx=r.vy=0)}},n},e.Constraint.bound=function(){var e,t,n={};return n.x=function(t,n){return arguments.length?(e={min:Math.min(t,n),max:Math.max(t,n)},this):e},n.y=function(e,n){return arguments.length?(t={min:Math.min(e,n),max:Math.max(e,n)},this):t},n.apply=function(n){if(e)for(var r=n;r;r=r.next)r.x=r.x<e.min?e.min:r.x>e.max?e.max:r.x;if(t)for(var r=n;r;r=r.next)r.y=r.y<t.min?t.min:r.y>t.max?t.max:r.y},n},e.Layout=function(){e.Panel.call(this)},e.Layout.prototype=e.extend(e.Panel),e.Layout.prototype.property=e.Mark.prototype.localProperty,e.Layout.Network=function(){e.Layout.call(this);var t=this;this.$id=e.id(),(this.node=(new e.Mark).data(function(){return t.nodes()}).strokeStyle("#1f77b4").fillStyle("#fff").left(function(e){return e.x}).top(function(e){return e.y})).parent=this,this.link=(new e.Mark).extend(this.node).data(function(e){return[e.sourceNode,e.targetNode]}).fillStyle(null).lineWidth(function(e,t){return 1.5*t.linkValue}).strokeStyle("rgba(0,0,0,.2)"),this.link.add=function(n){return t.add(e.Panel).data(function(){return t.links()}).add(n).extend(this)},(this.label=(new e.Mark).extend(this.node).textMargin(7).textBaseline("middle").text(function(e){return e.nodeName||e.nodeValue}).textAngle(function(t){var n=t.midAngle;return e.Wedge.upright(n)?n:n+Math.PI}).textAlign(function(t){return e.Wedge.upright(t.midAngle)?"left":"right"})).parent=this},e.Layout.Network.prototype=e.extend(e.Layout).property("nodes",function(e){return e.map(function(e,t){return"object"!=typeof e&&(e={nodeValue:e}),e.index=t,e})}).property("links",function(e){return e.map(function(e){return isNaN(e.linkValue)&&(e.linkValue=isNaN(e.value)?1:e.value),e})}),e.Layout.Network.prototype.reset=function(){return this.$id=e.id(),this},e.Layout.Network.prototype.buildProperties=function(t,n){(t.$id||0)<this.$id&&e.Layout.prototype.buildProperties.call(this,t,n)},e.Layout.Network.prototype.buildImplied=function(t){e.Layout.prototype.buildImplied.call(this,t);if(t.$id>=this.$id)return!0;t.$id=this.$id,t.nodes.forEach(function(e){e.linkDegree=0}),t.links.forEach(function(e){var n=e.linkValue;(e.sourceNode||(e.sourceNode=t.nodes[e.source])).linkDegree+=n,(e.targetNode||(e.targetNode=t.nodes[e.target])).linkDegree+=n})},e.Layout.Hierarchy=function(){e.Layout.Network.call(this),this.link.strokeStyle("#ccc")},e.Layout.Hierarchy.prototype=e.extend(e.Layout.Network),e.Layout.Hierarchy.prototype.buildImplied=function(t){t.links||(t.links=e.Layout.Hierarchy.links.call(this)),e.Layout.Network.prototype.buildImplied.call(this,t)},e.Layout.Hierarchy.links=function(){return this.nodes().filter(function(e){return e.parentNode}).map(function(e){return{sourceNode:e,targetNode:e.parentNode,linkValue:1}})},e.Layout.Hierarchy.NodeLink={buildImplied:function(e){function t(e){return e.parentNode?e.depth*(c-l)+l:0}function n(e){return e.parentNode?2*(e.breadth-.25)*Math.PI:0}function r(e){switch(o){case"left":return e.depth*a;case"right":return a-e.depth*a;case"top":return e.breadth*a;case"bottom":return a-e.breadth*a;case"radial":return a/2+t(e)*Math.cos(e.midAngle)}}function i(e){switch(o){case"left":return e.breadth*f;case"right":return f-e.breadth*f;case"top":return e.depth*f;case"bottom":return f-e.depth*f;case"radial":return f/2+t(e)*Math.sin(e.midAngle)}}var s=e.nodes,o=e.orient,u=/^(top|bottom)$/.test(o),a=e.width,f=e.height;if("radial"==o){var l=e.innerRadius,c=e.outerRadius;null==l&&(l=0),null==c&&(c=Math.min(a,f)/2)}for(var h=0;h<s.length;h++){var p=s[h];p.midAngle="radial"==o?n(p):u?Math.PI/2:0,p.x=r(p),p.y=i(p),p.firstChild&&(p.midAngle+=Math.PI)}}},e.Layout.Hierarchy.Fill={constructor:function(){this.node.strokeStyle("#fff").fillStyle("#ccc").width(function(e){return e.dx}).height(function(e){return e.dy}).innerRadius(function(e){return e.innerRadius}).outerRadius(function(e){return e.outerRadius}).startAngle(function(e){return e.startAngle}).angle(function(e){return e.angle}),this.label.textAlign("center").left(function(e){return e.x+e.dx/2}).top(function(e){return e.y+e.dy/2}),delete this.link},buildImplied:function(e){function t(e,t){return(e+t)/(1+t)}function n(e){switch(c){case"left":return t(e.minDepth,v)*p;case"right":return(1-t(e.maxDepth,v))*p;case"top":return e.minBreadth*p;case"bottom":return(1-e.maxBreadth)*p;case"radial":return p/2}}function r(e){switch(c){case"left":return e.minBreadth*d;case"right":return(1-e.maxBreadth)*d;case"top":return t(e.minDepth,v)*d;case"bottom":return(1-t(e.maxDepth,v))*d;case"radial":return d/2}}function i(e){switch(c){case"left":case"right":return(e.maxDepth-e.minDepth)/(1+v)*p;case"top":case"bottom":return(e.maxBreadth-e.minBreadth)*p;case"radial":return e.parentNode?(e.innerRadius+e.outerRadius)*Math.cos(e.midAngle):0}}function s(e){switch(c){case"left":case"right":return(e.maxBreadth-e.minBreadth)*d;case"top":case"bottom":return(e.maxDepth-e.minDepth)/(1+v)*d;case"radial":return e.parentNode?(e.innerRadius+e.outerRadius)*Math.sin(e.midAngle):0}}function o(e){return Math.max(0,t(e.minDepth,v/2))*(g-m)+m}function u(e){return t(e.maxDepth,v/2)*(g-m)+m}function a(e){return 2*(e.parentNode?e.minBreadth-.25:0)*Math.PI}function f(e){return 2*(e.parentNode?e.maxBreadth-e.minBreadth:1)*Math.PI}var l=e.nodes,c=e.orient,h=/^(top|bottom)$/.test(c),p=e.width,d=e.height,v=-l[0].minDepth;if("radial"==c){var m=e.innerRadius,g=e.outerRadius;null==m&&(m=0),m&&(v*=2),null==g&&(g=Math.min(p,d)/2)}for(var y=0;y<l.length;y++){var b=l[y];b.x=n(b),b.y=r(b),"radial"==c?(b.innerRadius=o(b),b.outerRadius=u(b),b.startAngle=a(b),b.angle=f(b),b.midAngle=b.startAngle+b.angle/2):b.midAngle=h?-Math.PI/2:0,b.dx=i(b),b.dy=s(b)}}},e.Layout.Grid=function(){e.Layout.call(this);var t=this;(this.cell=(new e.Mark).data(function(){return t.scene[t.index].$grid}).width(function(){return t.width()/t.cols()}).height(function(){return t.height()/t.rows()}).left(function(){return this.width()*(this.index%t.cols())}).top(function(){return this.height()*Math.floor(this.index/t.cols())})).parent=this},e.Layout.Grid.prototype=e.extend(e.Layout).property("rows").property("cols"),e.Layout.Grid.prototype.defaults=(new e.Layout.Grid).extend(e.Layout.prototype.defaults).rows(1).cols(1),e.Layout.Grid.prototype.buildImplied=function(t){e.Layout.prototype.buildImplied.call(this,t);var n=t.rows,r=t.cols;"object"==typeof r&&(n=e.transpose(r)),"object"==typeof n?(t.$grid=e.blend(n),t.rows=n.length,t.cols=n[0]?n[0].length:0):t.$grid=e.repeat([t.data],n*r)},e.Layout.Stack=function(){function t(e){return function(){return s[e](this.parent.index,this.index)}}e.Layout.call(this);var n,r=this,i=function(){return null},s={t:i,l:i,r:i,b:i,w:i,h:i},o=r.buildImplied;this.buildImplied=function(t){o.call(this,t);var r,u=t.layers,a=u.length,f=t.orient,l=/^(top|bottom)\b/.test(f),c=this.parent[l?"height":"width"](),h=[],p=[],d=[],v=e.Mark.stack,m={parent:{parent:this}};v.unshift(null),n=[];for(var g=0;a>g;g++){d[g]=[],p[g]=[],m.parent.index=g,v[0]=u[g],n[g]=this.$values.apply(m.parent,v),g||(r=n[g].length),v.unshift(null);for(var y=0;r>y;y++)v[0]=n[g][y],m.index=y,g||(h[y]=this.$x.apply(m,v)),d[g][y]=this.$y.apply(m,v);v.shift()}v.shift();var b;switch(t.order){case"inside-out":for(var w=d.map(function(t){return e.max.index(t)}),E=e.range(a).sort(function(e,t){return w[e]-w[t]}),S=d.map(function(t){return e.sum(t)}),x=0,T=0,N=[],C=[],g=0;a>g;g++){var y=E[g];T>x?(x+=S[y],N.push(y)):(T+=S[y],C.push(y))}b=C.reverse().concat(N);break;case"reverse":b=e.range(a-1,-1,-1);break;default:b=e.range(a)}switch(t.offset){case"silohouette":for(var y=0;r>y;y++){for(var m=0,g=0;a>g;g++)m+=d[g][y];p[b[0]][y]=(c-m)/2}break;case"wiggle":for(var m=0,g=0;a>g;g++)m+=d[g][0];p[b[0]][0]=m=(c-m)/2;for(var y=1;r>y;y++){for(var k=0,L=0,A=h[y]-h[y-1],g=0;a>g;g++)k+=d[g][y];for(var g=0;a>g;g++){for(var O=(d[b[g]][y]-d[b[g]][y-1])/(2*A),M=0;g>M;M++)O+=(d[b[M]][y]-d[b[M]][y-1])/A;L+=O*d[b[g]][y]}p[b[0]][y]=m-=k?L/k*A:0}break;case"expand":for(var y=0;r>y;y++){p[b[0]][y]=0;for(var M=0,g=0;a>g;g++)M+=d[g][y];if(M){M=c/M;for(var g=0;a>g;g++)d[g][y]*=M}else{M=c/a;for(var g=0;a>g;g++)d[g][y]=M}}break;default:for(var y=0;r>y;y++)p[b[0]][y]=0}for(var y=0;r>y;y++)for(var m=p[b[0]][y],g=1;a>g;g++)m+=d[b[g-1]][y],p[b[g]][y]=m;var g=f.indexOf("-"),_=l?"h":"w",D=0>g?l?"l":"b":f.charAt(g+1),P=f.charAt(0);for(var H in s)s[H]=i;s[D]=function(e,t){return h[t]},s[P]=function(e,t){return p[e][t]},s[_]=function(e,t){return d[e][t]}},this.layer=(new e.Mark).data(function(){return n[this.parent.index]}).top(t("t")).left(t("l")).right(t("r")).bottom(t("b")).width(t("w")).height(t("h")),this.layer.add=function(t){return r.add(e.Panel).data(function(){return r.layers()}).add(t).extend(this)}},e.Layout.Stack.prototype=e.extend(e.Layout).property("orient",String).property("offset",String).property("order",String).property("layers"),e.Layout.Stack.prototype.defaults=(new e.Layout.Stack).extend(e.Layout.prototype.defaults).orient("bottom-left").offset("zero").layers([[]]),e.Layout.Stack.prototype.$x=e.Layout.Stack.prototype.$y=function(){return 0},e.Layout.Stack.prototype.x=function(t){return this.$x=e.functor(t),this},e.Layout.Stack.prototype.y=function(t){return this.$y=e.functor(t),this},e.Layout.Stack.prototype.$values=e.identity,e.Layout.Stack.prototype.values=function(t){return this.$values=e.functor(t),this},e.Layout.Band=function(){function t(e){return function(){return n[e](this.index,this.parent.index)}}e.Layout.call(this);var n,r,i=this,s=i.buildImplied,o=(new e.Mark).data(function(){return r[this.parent.index]}).top(t("t")).left(t("l")).right(t("r")).bottom(t("b")).width(t("w")).height(t("h")).antialias(t("antialias"));this.buildImplied=function(t){s.call(this,t),n=Object.create(e.Layout.Band.$baseItemProps),r=[];var i=t.layers,o=i.length;if(o>0){var u=t.orient,a=/^(top|bottom)\b/.test(u),f=this.parent[a?"height":"width"](),l=this._readData(i,r,t),c=l.length;"reverse"===t.bandOrder&&l.reverse();if("reverse"===t.order){r.reverse();for(var h=0;c>h;h++)l[h].items.reverse()}switch(t.layout){case"grouped":this._calcGrouped(l,o,t);break;case"stacked":this._calcStacked(l,o,f,t)}for(var p=t.hZero||0,d="stacked"===t.layout,v=0;c>v;v++)for(var m=l[v],g=d?Math.max(0,m.vertiMargin)/2:0,y=0;o>y;y++){var b=m.items[y];b.zero&&(b.h=p,b.y-=g+p/2)}this._bindItemProps(l,n,u,a)}};var u=this.item={end:this,add:function(t){return i.add(e.Panel).data(function(){return i.layers()}).add(t).extend(o)},order:function(e){return i.order(e),this},w:function(t){return i.$iw=e.functor(t),this},h:function(t){return i.$ih=e.functor(t),this},horizontalRatio:function(t){return i.$ihorizRatio=e.functor(t),this},verticalMargin:function(t){return i.$ivertiMargin=e.functor(t),this}},a=this.band={end:this,w:function(t){return i.$bw=e.functor(t),this},x:function(t){return i.$bx=e.functor(t),this},order:function(e){return i.bandOrder(e),this},differentialControl:function(t){return i.$bDiffControl=e.functor(t),this}};this.band.item=u,this.item.band=a},e.Layout.Band.$baseItemProps=function(){var e=function(){return null};return{t:e,l:e,r:e,b:e,w:e,h:e}}(),e.Layout.Band.prototype=e.extend(e.Layout).property("orient",String).property("layout",String).property("layers").property("yZero",Number).property("hZero",Number).property("verticalMode",String).property("horizontalMode",String).property("order",String).property("bandOrder",String),e.Layout.Band.prototype.defaults=(new e.Layout.Band).extend(e.Layout.prototype.defaults).orient("bottom-left").layout("grouped").yZero(0).hZero(1.5).layers([[]]),e.Layout.Band.prototype.$bx=e.Layout.Band.prototype.$bw=e.Layout.Band.prototype.$bDiffControl=e.Layout.Band.prototype.$iw=e.Layout.Band.prototype.$ih=e.Layout.Band.prototype.$ivertiMargin=e.functor(0),e.Layout.Band.prototype.$ihorizRatio=e.functor(.9),e.Layout.Band.prototype.$values=e.identity,e.Layout.Band.prototype.values=function(t){return this.$values=e.functor(t),this},e.Layout.prototype._readData=function(t,n,r){var i,s=t.length,o=[],u=e.Mark.stack,a=r.hZero,f={parent:{parent:this}};u.unshift(null);for(var l=0;s>l;l++){f.parent.index=l,u[0]=t[l];var c=n[l]=this.$values.apply(f.parent,u);l||(i=c.length),u.unshift(null);for(var h=0;i>h;h++){u[0]=c[h],f.index=h;var p=o[h];p||(p=o[h]={horizRatio:this.$ihorizRatio.apply(f,u),vertiMargin:this.$ivertiMargin.apply(f,u),w:this.$bw.apply(f,u),x:this.$bx.apply(f,u),diffControl:this.$bDiffControl?this.$bDiffControl.apply(f,u):0,items:[]});var d=this.$ih.apply(f,u),v=null!=d?Math.abs(d):d;p.items[l]={y:r.yZero||0,x:0,w:this.$iw.apply(f,u),h:v,zero:null!=v&&a>=v,dir:0>d?-1:1}}u.shift()}return u.shift(),o},e.Layout.Band.prototype._calcGrouped=function(e,t,n){for(var r=0,i=e.length;i>r;r++){for(var s=e[r],o=s.items,u=s.w,a=s.horizRatio,f=0,l=0;t>l;l++)f+=o[l].w;1===t?a=1:a>0&&1>=a||(a=1);if(null==u)u=s.w=f/a;else if("expand"===n.horizontalMode){var c=a*u;if(f)for(var h=c/f,l=0;t>l;l++)o[l].w*=h;else for(var p=c/t,l=0;t>l;l++)o[l].w=p;f=c}for(var d=f/a,v=s.x-d/2,m=t>1?(d-f)/(t-1):0,l=0;t>l;l++){var g=o[l];g.x=v,v+=g.w+m,g.dir<0&&(g.y-=g.h)}}},e.Layout.Band.prototype._calcStacked=function(e,t,n,r){var i,s=e.length;if("expand"===r.verticalMode)for(var o=0;s>o;o++){i=e[o].items;for(var u=null,a=0,f=0;t>f;f++){var l=i[f];l.dir=1;var c=l.h;null!=c&&(a++,u+=c)}if(a)if(u)for(var h=n/u,f=0;t>f;f++){var c=i[f].h;null!=c&&(i[f].h=c*h)}else if(0==u)for(var f=0;t>f;f++)i[f].h=0;else for(var p=n/a,f=0;t>f;f++){var c=i[f].h;null!=c&&(i[f].h=p)}}for(var d=r.yZero,v=d,o=0;s>o;o++){var m=e[o],g=m.x,y=m.diffControl,b=0>y,w=Math.max(0,m.vertiMargin);i=m.items;var E=this._layoutItemsOfDir(1,b,i,w,g,v),S=null;E.existsOtherDir&&(S=this._layoutItemsOfDir(-1,b,i,w,g,v));if(y){if(1===Math.abs(y)){var x=v;v=E.yOffset,S&&(v-=x-S.yOffset)}}else v=d}},e.Layout.Band.prototype._layoutItemsOfDir=function(e,t,n,r,i,s){for(var o=!1,u=r/2,a=t?-e:e,f=t,l=0,c=n.length;c>l;l+=1){var h=n[f?c-l-1:l];if(h.dir===e){var p=h.h||0;a>0?(h.y=s+u,s+=p):(h.y=s-(p-u),s-=p);var d=p-r;h.h=d>0?d:0,h.x=i-h.w/2}else o=!0}return{existsOtherDir:o,yOffset:s}},e.Layout.Band.prototype._bindItemProps=function(e,t,n,r){var i=n.indexOf("-"),s=r?"h":"w",o=r?"w":"h",u=0>i?r?"l":"b":n.charAt(i+1),a=n.charAt(0);t[u]=function(t,n){return e[t].items[n].x},t[a]=function(t,n){return e[t].items[n].y},t[o]=function(t,n){return e[t].items[n].w},t[s]=function(t,n){return e[t].items[n].h||0},t.antialias=function(t,n){return e[t].items[n].zero}},e.Layout.Treemap=function(){e.Layout.Hierarchy.call(this),this.node.strokeStyle("#fff").fillStyle("rgba(31, 119, 180, .25)").width(function(e){return e.dx}).height(function(e){return e.dy}),this.label.visible(function(e){return!e.firstChild}).left(function(e){return e.x+e.dx/2}).top(function(e){return e.y+e.dy/2}).textAlign("center").textAngle(function(e){return e.dx>e.dy?0:-Math.PI/2}),(this.leaf=(new e.Mark).extend(this.node).fillStyle(null).strokeStyle(null).visible(function(e){return!e.firstChild})).parent=this,delete this.link},e.Layout.Treemap.prototype=e.extend(e.Layout.Hierarchy).property("round",Boolean).property("mode",String).property("order",String),e.Layout.Treemap.prototype.defaults=(new e.Layout.Treemap).extend(e.Layout.Hierarchy.prototype.defaults).mode("squarify").order("ascending"),e.Layout.Treemap.prototype.$size=function(e){return Number(e.nodeValue)},e.Layout.Treemap.prototype.$padLeft=e.Layout.Treemap.prototype.$padRight=e.Layout.Treemap.prototype.$padBottom=e.Layout.Treemap.prototype.$padTop=function(){return 0},e.Layout.Treemap.prototype.size=function(t){return this.$size=e.functor(t),this},e.Layout.Treemap.prototype.padding=function(t){return t=e.functor(t),this.paddingLeft(t).paddingRight(t).paddingTop(t).paddingBottom(t)},e.Layout.Treemap.prototype.paddingLeft=function(t){return arguments.length?(this.$padLeft=e.functor(t),this):this.$padLeft},e.Layout.Treemap.prototype.paddingRight=function(t){return arguments.length?(this.$padRight=e.functor(t),this):this.$padRight},e.Layout.Treemap.prototype.paddingBottom=function(t){return arguments.length?(this.$padBottom=e.functor(t),this):this.$padBottom},e.Layout.Treemap.prototype.paddingTop=function(t){return arguments.length?(this.$padTop=e.functor(t),this):this.$padTop},e.Layout.Treemap.prototype.buildImplied=function(t){function n(e,t,n,r,i,s,o){for(var u=0,a=0;u<e.length;u++){var f=e[u];n?(f.x=r+a,f.y=i,a+=f.dx=l(s*f.size/t),f.dy=o):(f.x=r,f.y=i+a,f.dx=s,a+=f.dy=l(o*f.size/t))}f&&(n?f.dx+=s-a:f.dy+=o-a)}function r(e,t){for(var n=-1/0,r=1/0,i=0,s=0;s<e.length;s++){var o=e[s].size;r>o&&(r=o),o>n&&(n=o),i+=o}return i*=i,t*=t,Math.max(t*n/i,i/(t*r))}function i(t,i){function s(t){var r=h==m,i=e.sum(t,f),s=m?l(i/m):0;return n(t,i,r,u,a,r?h:s,r?s:p),r?(a+=s,p-=s):(u+=s,h-=s),m=Math.min(h,p),r}var o=t.parentNode,u=t.x,a=t.y,h=t.dx,p=t.dy;o&&(u+=o.paddingLeft,a+=o.paddingTop,h+=-o.paddingLeft-o.paddingRight,p+=-o.paddingTop-o.paddingBottom);if("squarify"==c){var d=[],v=1/0,m=Math.min(h,p),g=h*p/t.size;if(!(t.size<=0)){t.visitBefore(function(e){e.size*=g});for(var y=t.childNodes.slice();y.length;){var b=y[y.length-1];if(b.size){d.push(b);var g=r(d,m);v>=g?(y.pop(),v=g):(d.pop(),s(d),d.length=0,v=1/0)}else y.pop()}if(s(d))for(var i=0;i<d.length;i++)d[i].dy+=p;else for(var i=0;i<d.length;i++)d[i].dx+=h}}else n(t.childNodes,t.size,"slice"==c?!0:"dice"==c?!1:1&i,u,a,h,p)}if(!e.Layout.Hierarchy.prototype.buildImplied.call(this,t)){var s=this,o=t.nodes,u=o[0],a=e.Mark.stack,f=function(e){return e.size},l=t.round?Math.round:Number,c=t.mode;a.unshift(null);try{u.visitAfter(function(t,n){t.depth=n,t.x=t.y=t.dx=t.dy=0,a[0]=t,t.firstChild?(t.size=e.sum(t.childNodes,f),t.paddingRight=+s.$padRight.apply(s,a)||0,t.paddingLeft=+s.$padLeft.apply(s,a)||0,t.paddingBottom=+s.$padBottom.apply(s,a)||0,t.paddingTop=+s.$padTop.apply(s,a)||0):t.size=s.$size.apply(s,a)})}finally{a.shift()}switch(t.order){case"ascending":u.sort(function(e,t){return e.size-t.size});break;case"descending":u.sort(function(e,t){return t.size-e.size});break;case"reverse":u.reverse()}u.x=0,u.y=0,u.dx=t.width,u.dy=t.height,u.visitBefore(i)}},e.Layout.Tree=function(){e.Layout.Hierarchy.call(this)},e.Layout.Tree.prototype=e.extend(e.Layout.Hierarchy).property("group",Number).property("breadth",Number).property("depth",Number).property("orient",String),e.Layout.Tree.prototype.defaults=(new e.Layout.Tree).extend(e.Layout.Hierarchy.prototype.defaults).group(1).breadth(15).depth(60).orient("top"),e.Layout.Tree.prototype.buildImplied=function(t){function n(e){var t,r,s;if(e.firstChild){t=e.firstChild,r=e.lastChild,s=t;for(var o=t;o;o=o.nextSibling)n(o),s=i(o,s);a(e);var u=.5*(t.prelim+r.prelim);(t=e.previousSibling)?(e.prelim=t.prelim+l(e.depth,!0),e.mod=e.prelim-u):e.prelim=u}else(t=e.previousSibling)&&(e.prelim=t.prelim+l(e.depth,!0))}function r(e,t,n){e.breadth=e.prelim+t,t+=e.mod;for(var i=e.firstChild;i;i=i.nextSibling)r(i,t,n)}function i(e,t){var n=e.previousSibling;if(n){for(var r=e,i=e,a=n,c=e.parentNode.firstChild,h=r.mod,p=i.mod,d=a.mod,v=c.mod,m=o(a),g=s(r);m&&g;){a=m,r=g,c=s(c),i=o(i),i.ancestor=e;var y=a.prelim+d-(r.prelim+h)+l(a.depth,!1);y>0&&(u(f(a,e,t),e,y),h+=y,p+=y),d+=a.mod,h+=r.mod,v+=c.mod,p+=i.mod,m=o(a),g=s(r)}m&&!o(i)&&(i.thread=m,i.mod+=d-p),g&&!s(c)&&(c.thread=g,c.mod+=h-v,t=e)}return t}function s(e){return e.firstChild||e.thread}function o(e){return e.lastChild||e.thread}function u(e,t,n){var r=t.number-e.number;t.change-=n/r,t.shift+=n,e.change+=n/r,t.prelim+=n,t.mod+=n}function a(e){for(var t=0,n=0,r=e.lastChild;r;r=r.previousSibling)r.prelim+=t,r.mod+=t,n+=r.change,t+=r.shift+n}function f(e,t,n){return e.ancestor.parentNode==t.parentNode?e.ancestor:n}function l(e,t){return(t?1:y+1)/("radial"==v?e:1)}function c(e){return"radial"==v?e.breadth/m:0}function h(e){switch(v){case"left":return e.depth;case"right":return b-e.depth;case"top":case"bottom":return e.breadth+b/2;case"radial":return b/2+e.depth*Math.cos(c(e))}}function p(e){switch(v){case"left":case"right":return e.breadth+w/2;case"top":return e.depth;case"bottom":return w-e.depth;case"radial":return w/2+e.depth*Math.sin(c(e))}}if(!e.Layout.Hierarchy.prototype.buildImplied.call(this,t)){var d=t.nodes,v=t.orient,m=t.depth,g=t.breadth,y=t.group,b=t.width,w=t.height,E=d[0];E.visitAfter(function(e,t){e.ancestor=e,e.prelim=0,e.mod=0,e.change=0,e.shift=0,e.number=e.previousSibling?e.previousSibling.number+1:0,e.depth=t}),n(E),r(E,-E.prelim,0),E.visitAfter(function(e){e.breadth*=g,e.depth*=m,e.midAngle=c(e),e.x=h(e),e.y=p(e),e.firstChild&&(e.midAngle+=Math.PI),delete e.breadth,delete e.depth,delete e.ancestor,delete e.prelim,delete e.mod,delete e.change,delete e.shift,delete e.number,delete e.thread})}},e.Layout.Indent=function(){e.Layout.Hierarchy.call(this),this.link.interpolate("step-after")},e.Layout.Indent.prototype=e.extend(e.Layout.Hierarchy).property("depth",Number).property("breadth",Number),e.Layout.Indent.prototype.defaults=(new e.Layout.Indent).extend(e.Layout.Hierarchy.prototype.defaults).depth(15).breadth(15),e.Layout.Indent.prototype.buildImplied=function(t){function n(e,t,r){e.x=o+r++*s,e.y=u+t++*i,e.midAngle=0;for(var a=e.firstChild;a;a=a.nextSibling)t=n(a,t,r);return t}if(!e.Layout.Hierarchy.prototype.buildImplied.call(this,t)){var r=t.nodes,i=t.breadth,s=t.depth,o=0,u=0;n(r[0],1,1)}},e.Layout.Pack=function(){e.Layout.Hierarchy.call(this),this.node.shapeRadius(function(e){return e.radius}).strokeStyle("rgb(31, 119, 180)").fillStyle("rgba(31, 119, 180, .25)"),this.label.textAlign("center"),delete this.link},e.Layout.Pack.prototype=e.extend(e.Layout.Hierarchy).property("spacing",Number).property("order",String),e.Layout.Pack.prototype.defaults=(new e.Layout.Pack).extend(e.Layout.Hierarchy.prototype.defaults).spacing(1).order("ascending"),e.Layout.Pack.prototype.$radius=function(){return 1},e.Layout.Pack.prototype.size=function(e){return this.$radius="function"==typeof e?function(){return Math.sqrt(e.apply(this,arguments))}:(e=Math.sqrt(e),function(){return e}),this},e.Layout.Pack.prototype.buildImplied=function(t){function n(t){var n=e.Mark.stack;n.unshift(null);for(var r=0,i=t.length;i>r;r++){var s=t[r];s.firstChild||(s.radius=u.$radius.apply(u,(n[0]=s,n)))}n.shift()}function r(e){for(var n=[],s=e.firstChild;s;s=s.nextSibling)s.firstChild&&(s.radius=r(s)),s.n=s.p=s,n.push(s);switch(t.order){case"ascending":n.sort(function(e,t){return e.radius-t.radius});break;case"descending":n.sort(function(e,t){return t.radius-e.radius});break;case"reverse":n.reverse()}return i(n)}function i(e){function n(e){h=Math.min(e.x-e.radius,h),p=Math.max(e.x+e.radius,p),d=Math.min(e.y-e.radius,d),v=Math.max(e.y+e.radius,v)}function r(e,t){var n=e.n;e.n=t,t.p=e,t.n=n,n.p=t}function i(e,t){e.n=t,t.p=e}function o(e,t){var n=t.x-e.x,r=t.y-e.y,i=e.radius+t.radius;return i*i-n*n-r*r>.001}var u,a,f,l,c,h=1/0,p=-1/0,d=1/0,v=-1/0;u=e[0],u.x=-u.radius,u.y=0,n(u);if(e.length>1){a=e[1],a.x=a.radius,a.y=0,n(a);if(e.length>2){f=e[2],s(u,a,f),n(f),r(u,f),u.p=f,r(f,a),a=u.n;for(var m=3;m<e.length;m++){s(u,a,f=e[m]);var g=0,y=1,b=1;for(l=a.n;l!=a;l=l.n,y++)if(o(l,f)){g=1;break}if(1==g)for(c=u.p;c!=l.p;c=c.p,b++)if(o(c,f)){y>b&&(g=-1,l=c);break}0==g?(r(u,f),a=f,n(f)):g>0?(i(u,l),a=l,m--):0>g&&(i(l,a),u=l,m--)}}}for(var w=(h+p)/2,E=(d+v)/2,S=0,m=0;m<e.length;m++){var x=e[m];x.x-=w,x.y-=E,S=Math.max(S,x.radius+Math.sqrt(x.x*x.x+x.y*x.y))}return S+t.spacing}function s(e,t,n){var r=t.radius+n.radius,i=e.radius+n.radius,s=t.x-e.x,o=t.y-e.y,u=Math.sqrt(s*s+o*o),a=(i*i+u*u-r*r)/(2*i*u),f=Math.acos(a),l=a*i,c=Math.sin(f)*i;s/=u,o/=u,n.x=e.x+l*s+c*o,n.y=e.y+l*o-c*s}function o(e,t,n,r){for(var i=e.firstChild;i;i=i.nextSibling)i.x+=e.x,i.y+=e.y,o(i,t,n,r);e.x=t+r*e.x,e.y=n+r*e.y,e.radius*=r}if(!e.Layout.Hierarchy.prototype.buildImplied.call(this,t)){var u=this,a=t.nodes,f=a[0];n(a),f.x=0,f.y=0,f.radius=r(f);var l=this.width(),c=this.height(),h=1/Math.max(2*f.radius/l,2*f.radius/c);o(f,l/2,c/2,h)}},e.Layout.Force=function(){e.Layout.Network.call(this),this.link.lineWidth(function(e,t){return 1.5*Math.sqrt(t.linkValue)}),this.label.textAlign("center")},e.Layout.Force.prototype=e.extend(e.Layout.Network).property("bound",Boolean).property("iterations",Number).property("dragConstant",Number).property("chargeConstant",Number).property("chargeMinDistance",Number).property("chargeMaxDistance",Number).property("chargeTheta",Number).property("springConstant",Number).property("springDamping",Number).property("springLength",Number),e.Layout.Force.prototype.defaults=(new e.Layout.Force).extend(e.Layout.Network.prototype.defaults).dragConstant(.1).chargeConstant(-40).chargeMinDistance(2).chargeMaxDistance(500).chargeTheta(.9).springConstant(.1).springDamping(.3).springLength(20),e.Layout.Force.prototype.buildImplied=function(t){function n(e){return e.fix?1:e.vx*e.vx+e.vy*e.vy}if(e.Layout.Network.prototype.buildImplied.call(this,t)){var r=t.$force;r&&(r.next=this.binds.$force,this.binds.$force=r)}else{for(var i,s=this,o=t.nodes,u=t.links,a=t.iterations,f=t.width,l=t.height,c=0;c<o.length;c++)i=o[c],isNaN(i.x)&&(i.x=f/2+40*Math.random()-20),isNaN(i.y)&&(i.y=l/2+40*Math.random()-20);var h=e.simulation(o);h.force(e.Force.drag(t.dragConstant)),h.force(e.Force.charge(t.chargeConstant).domain(t.chargeMinDistance,t.chargeMaxDistance).theta(t.chargeTheta)),h.force(e.Force.spring(t.springConstant).damping(t.springDamping).length(t.springLength).links(u)),h.constraint(e.Constraint.position()),t.bound&&h.constraint(e.Constraint.bound().x(6,f-6).y(6,l-6));if(null==a)h.step(),h.step(),t.$force=this.binds.$force={next:this.binds.$force,nodes:o,min:1e-4*(u.length+1),sim:h},this.$timer||(this.$timer=setInterval(function(){for(var t=!1,r=s.binds.$force;r;r=r.next)e.max(r.nodes,n)>r.min&&(r.sim.step(),t=!0);t&&s.render()},42));else for(var c=0;a>c;c++)h.step()}},e.Layout.Cluster=function(){e.Layout.Hierarchy.call(this);var t,n=this.buildImplied;this.buildImplied=function(e){n.call(this,e),t=/^(top|bottom)$/.test(e.orient)?"step-before":/^(left|right)$/.test(e.orient)?"step-after":"linear"},this.link.interpolate(function(){return t})},e.Layout.Cluster.prototype=e.extend(e.Layout.Hierarchy).property("group",Number).property("orient",String).property("innerRadius",Number).property("outerRadius",Number),e.Layout.Cluster.prototype.defaults=(new e.Layout.Cluster).extend(e.Layout.Hierarchy.prototype.defaults).group(0).orient("top"),e.Layout.Cluster.prototype.buildImplied=function(t){if(!e.Layout.Hierarchy.prototype.buildImplied.call(this,t)){var n,r,i=t.nodes[0],s=t.group,o=0,u=.5-s/2,a=void 0;i.visitAfter(function(t){t.firstChild?t.depth=1+e.max(t.childNodes,function(e){return e.depth}):(s&&a!=t.parentNode&&(a=t.parentNode,o+=s),o++,t.depth=0)}),n=1/o,r=1/i.depth;var a=void 0;i.visitAfter(function(t){t.firstChild?t.breadth=e.mean(t.childNodes,function(e){return e.breadth}):(s&&a!=t.parentNode&&(a=t.parentNode,u+=s),t.breadth=n*u++),t.depth=1-t.depth*r}),i.visitAfter(function(e){e.minBreadth=e.firstChild?e.firstChild.minBreadth:e.breadth-n/2,e.maxBreadth=e.firstChild?e.lastChild.maxBreadth:e.breadth+n/2}),i.visitBefore(function(e){e.minDepth=e.parentNode?e.parentNode.maxDepth:0,e.maxDepth=e.parentNode?e.depth+i.depth:e.minDepth+2*i.depth}),i.minDepth=-r,e.Layout.Hierarchy.NodeLink.buildImplied.call(this,t)}},e.Layout.Cluster.Fill=function(){e.Layout.Cluster.call(this),e.Layout.Hierarchy.Fill.constructor.call(this)},e.Layout.Cluster.Fill.prototype=e.extend(e.Layout.Cluster),e.Layout.Cluster.Fill.prototype.buildImplied=function(t){e.Layout.Cluster.prototype.buildImplied.call(this,t)||e.Layout.Hierarchy.Fill.buildImplied.call(this,t)},e.Layout.Partition=function(){e.Layout.Hierarchy.call(this)},e.Layout.Partition.prototype=e.extend(e.Layout.Hierarchy).property("order",String).property("orient",String).property("innerRadius",Number).property("outerRadius",Number),e.Layout.Partition.prototype.defaults=(new e.Layout.Partition).extend(e.Layout.Hierarchy.prototype.defaults).orient("top"),e.Layout.Partition.prototype.$size=function(){return 1},e.Layout.Partition.prototype.size=function(e){return this.$size=e,this},e.Layout.Partition.prototype.buildImplied=function(t){if(!e.Layout.Hierarchy.prototype.buildImplied.call(this,t)){var n=this,r=t.nodes[0],i=e.Mark.stack,s=0;i.unshift(null),r.visitAfter(function(t,r){r>s&&(s=r),t.size=t.firstChild?e.sum(t.childNodes,function(e){return e.size}):n.$size.apply(n,(i[0]=t,i))}),i.shift();switch(t.order){case"ascending":r.sort(function(e,t){return e.size-t.size});break;case"descending":r.sort(function(e,t){return t.size-e.size})}r.minBreadth=0,r.breadth=.5,r.maxBreadth=1,r.visitBefore(function(e){for(var t=e.minBreadth,n=e.maxBreadth-t,r=e.firstChild;r;r=r.nextSibling)r.minBreadth=t,t+=r.size/e.size*n,r.maxBreadth=t,r.breadth=(t+r.minBreadth)/2}),r.visitAfter(function(e,t){e.minDepth=(t-1)/s,e.maxDepth=e.depth=t/s}),e.Layout.Hierarchy.NodeLink.buildImplied.call(this,t)}},e.Layout.Partition.Fill=function(){e.Layout.Partition.call(this),e.Layout.Hierarchy.Fill.constructor.call(this)},e.Layout.Partition.Fill.prototype=e.extend(e.Layout.Partition),e.Layout.Partition.Fill.prototype.buildImplied=function(t){e.Layout.Partition.prototype.buildImplied.call(this,t)||e.Layout.Hierarchy.Fill.buildImplied.call(this,t)},e.Layout.Arc=function(){e.Layout.Network.call(this);var t,n,r,i=this.buildImplied;this.buildImplied=function(e){i.call(this,e),n=e.directed,t="radial"==e.orient?"linear":"polar",r="right"==e.orient||"top"==e.orient},this.link.data(function(e){var t=e.sourceNode,i=e.targetNode;return r!=(n||t.breadth<i.breadth)?[t,i]:[i,t]}).interpolate(function(){return t})},e.Layout.Arc.prototype=e.extend(e.Layout.Network).property("orient",String).property("directed",Boolean),e.Layout.Arc.prototype.defaults=(new e.Layout.Arc).extend(e.Layout.Network.prototype.defaults).orient("bottom"),e.Layout.Arc.prototype.sort=function(e){return this.$sort=e,this},e.Layout.Arc.prototype.buildImplied=function(t){function n(e){switch(o){case"top":return-Math.PI/2;case"bottom":return Math.PI/2;case"left":return Math.PI;case"right":return 0;case"radial":return 2*(e-.25)*Math.PI}}function r(e){switch(o){case"top":case"bottom":return e*f;case"left":return 0;case"right":return f;case"radial":return f/2+c*Math.cos(n(e))}}function i(e){switch(o){case"top":return 0;case"bottom":return l;case"left":case"right":return e*l;case"radial":return l/2+c*Math.sin(n(e))}}if(!e.Layout.Network.prototype.buildImplied.call(this,t)){var s=t.nodes,o=t.orient,u=this.$sort,a=e.range(s.length),f=t.width,l=t.height,c=Math.min(f,l)/2;u&&a.sort(function(e,t){return u(s[e],s[t])});for(var h=0;h<s.length;h++){var p=s[a[h]],d=p.breadth=(h+.5)/s.length;p.x=r(d),p.y=i(d),p.midAngle=n(d)}}},e.Layout.Horizon=function(){e.Layout.call(this);var t,n,r,i,s,o,u=this,a=this.buildImplied;this.buildImplied=function(u){a.call(this,u),t=u.bands,n=u.mode,r=Math.round(("color"==n?.5:1)*u.height),i=u.backgroundStyle,s=e.ramp(i,u.negativeStyle).domain(0,t),o=e.ramp(i,u.positiveStyle).domain(0,t)};var t=(new e.Panel).data(function(){return e.range(2*t)}).overflow("hidden").height(function(){return r}).top(function(e){return"color"==n?(1&e)*r:0}).fillStyle(function(e){return e?null:i});this.band=(new e.Mark).top(function(e,t){return"mirror"==n&&1&t?(t+1>>1)*r:null}).bottom(function(e,t){return"mirror"==n?1&t?null:(t+1>>1)*-r:(1&t||-1)*(t+1>>1)*r}).fillStyle(function(e,t){return(1&t?s:o)((t>>1)+1)}),this.band.add=function(n){return u.add(e.Panel).extend(t).add(n).extend(this)}},e.Layout.Horizon.prototype=e.extend(e.Layout).property("bands",Number).property("mode",String).property("backgroundStyle",e.fillStyle).property("positiveStyle",e.fillStyle).property("negativeStyle",e.fillStyle),e.Layout.Horizon.prototype.defaults=(new e.Layout.Horizon).extend(e.Layout.prototype.defaults).bands(2).mode("offset").backgroundStyle("white").positiveStyle("#1f77b4").negativeStyle("#d62728"),e.Layout.Rollup=function(){e.Layout.Network.call(this);var t,n,r=this,i=r.buildImplied;this.buildImplied=function(e){i.call(this,e),t=e.$rollup.nodes,n=e.$rollup.links},this.node.data(function(){return t}).shapeSize(function(e){return 20*e.nodes.length}),this.link.interpolate("polar").eccentricity(.8),this.link.add=function(t){return r.add(e.Panel).data(function(){return n}).add(t).extend(this)}},e.Layout.Rollup.prototype=e.extend(e.Layout.Network).property("directed",Boolean),e.Layout.Rollup.prototype.x=function(t){return this.$x=e.functor(t),this},e.Layout.Rollup.prototype.y=function(t){return this.$y=e.functor(t),this},e.Layout.Rollup.prototype.buildImplied=function(t){function n(e){return u[e]+","+a[e]}if(!e.Layout.Network.prototype.buildImplied.call(this,t)){var r=t.nodes,i=t.links,s=t.directed,o=r.length,u=[],a=[],f=0,l={},c={},h=e.Mark.stack,p={parent:this};h.unshift(null);for(var d=0;o>d;d++)p.index=d,h[0]=r[d],u[d]=this.$x.apply(p,h),a[d]=this.$y.apply(p,h);h.shift();for(var d=0;d<r.length;d++){var v=n(d),m=l[v];m||(m=l[v]=Object.create(r[d]),m.index=f++,m.x=u[d],m.y=a[d],m.nodes=[]),m.nodes.push(r[d])}for(var d=0;d<i.length;d++){var g=i[d].sourceNode,y=i[d].targetNode,b=l[n(g.index)],w=l[n(y.index)],E=!s&&b.index>w.index,S=E?w.index+","+b.index:b.index+","+w.index,x=c[S];x||(x=c[S]={sourceNode:b,targetNode:w,linkValue:0,links:[]}),x.links.push(i[d]),x.linkValue+=i[d].linkValue}t.$rollup={nodes:e.values(l),links:e.values(c)}}},e.Layout.Matrix=function(){e.Layout.Network.call(this);var t,n,r,i,s,o=this,u=o.buildImplied;this.buildImplied=function(e){u.call(this,e),t=e.nodes.length,n=e.width/t,r=e.height/t,i=e.$matrix.labels,s=e.$matrix.pairs},this.link.data(function(){return s}).left(function(){return n*(this.index%t)}).top(function(){return r*Math.floor(this.index/t)}).width(function(){return n}).height(function(){return r}).lineWidth(1.5).strokeStyle("#fff").fillStyle(function(e){return e.linkValue?"#555":"#eee"}).parent=this,delete this.link.add,this.label.data(function(){return i}).left(function(){return 1&this.index?n*((this.index>>1)+.5):0}).top(function(){return 1&this.index?0:r*((this.index>>1)+.5)}).textMargin(4).textAlign(function(){return 1&this.index?"left":"right"}).textAngle(function(){return 1&this.index?-Math.PI/2:0}),delete this.node},e.Layout.Matrix.prototype=e.extend(e.Layout.Network).property("directed",Boolean),e.Layout.Matrix.prototype.sort=function(e){return this.$sort=e,this},e.Layout.Matrix.prototype.buildImplied=function(t){if(!e.Layout.Network.prototype.buildImplied.call(this,t)){var n=t.nodes,r=t.links,i=this.$sort,s=n.length,o=e.range(s),u=[],a=[],f={};t.$matrix={labels:u,pairs:a},i&&o.sort(function(e,t){return i(n[e],n[t])});for(var l=0;s>l;l++)for(var c=0;s>c;c++){var h=o[l],p=o[c],d={row:l,col:c,sourceNode:n[h],targetNode:n[p],linkValue:0};a.push(f[h+"."+p]=d)}for(var l=0;s>l;l++){var h=o[l];u.push(n[h],n[h])}for(var l=0;l<r.length;l++){var v=r[l],m=v.sourceNode.index,g=v.targetNode.index,y=v.linkValue;f[m+"."+g].linkValue+=y,t.directed||(f[g+"."+m].linkValue+=y)}}},e.Layout.Bullet=function(){e.Layout.call(this);var t,n,r,i,s,o=this,u=o.buildImplied,a=o.x=e.Scale.linear();this.buildImplied=function(o){u.call(this,s=o),t=o.orient,n=/^left|right$/.test(t),r=e.ramp("#bbb","#eee").domain(0,Math.max(1,s.ranges.length-1)),i=e.ramp("steelblue","lightsteelblue").domain(0,Math.max(1,s.measures.length-1))},(this.range=new e.Mark).data(function(){return s.ranges}).reverse(!0).left(function(){return"left"==t?0:null}).top(function(){return"top"==t?0:null}).right(function(){return"right"==t?0:null}).bottom(function(){return"bottom"==t?0:null}).width(function(e){return n?a(e):null}).height(function(e){return n?null:a(e)}).fillStyle(function(){return r(this.index)}).antialias(!1).parent=o,(this.measure=new e.Mark).extend(this.range).data(function(){return s.measures}).left(function(){return"left"==t?0:n?null:this.parent.width()/3.25}).top(function(){return"top"==t?0:n?this.parent.height()/3.25:null}).right(function(){return"right"==t?0:n?null:this.parent.width()/3.25}).bottom(function(){return"bottom"==t?0:n?this.parent.height()/3.25:null}).fillStyle(function(){return i(this.index)}).parent=o,(this.marker=new e.Mark).data(function(){return s.markers}).left(function(e){return"left"==t?a(e):n?null:this.parent.width()/2}).top(function(e){return"top"==t?a(e):n?this.parent.height()/2:null}).right(function(e){return"right"==t?a(e):null}).bottom(function(e){return"bottom"==t?a(e):null}).strokeStyle("black").shape("bar").shapeAngle(function(){return n?0:Math.PI/2}).parent=o,(this.tick=new e.Mark).data(function(){return a.ticks(7)}).left(function(e){return"left"==t?a(e):null}).top(function(e){return"top"==t?a(e):null}).right(function(e){return"right"==t?a(e):n?null:-6}).bottom(function(e){return"bottom"==t?a(e):n?-8:null}).height(function(){return n?6:null}).width(function(){return n?null:6}).parent=o},e.Layout.Bullet.prototype=e.extend(e.Layout).property("orient",String).property("ranges").property("markers").property("measures").property("minimum").property("maximum"),e.Layout.Bullet.prototype.defaults=(new e.Layout.Bullet).extend(e.Layout.prototype.defaults).orient("left").ranges([]).markers([]).measures([]),e.Layout.Bullet.prototype._originIsZero=!0,e.Layout.Bullet.prototype.originIsZero=function(e){return arguments.length?this._originIsZero=!!e:this._originIsZero},e.Layout.Bullet.prototype.buildImplied=function(t){e.Layout.prototype.buildImplied.call(this,t);var n,r=this.parent[/^left|right$/.test(t.orient)?"width":"height"](),i=t.maximum,s=t.minimum,o=1e-10;null==i?(n=[].concat(t.ranges,t.markers,t.measures),i=e.max(n)):i=+i,null==s?(n||(n=[].concat(t.ranges,t.markers,t.measures)),s=e.min(n),s=.95*s):s=+s,(s>i||o>i-s)&&(s=Math.abs(i)<o?-0.1:.99*i),this._originIsZero&&s*i>0&&(s>0?s=0:i=0),t.minimum=s,t.maximum=i,this.x.domain(s,i).range(0,r)},e.Behavior={},e.Behavior.dragBase=function(t){function n(n){c||(c=!0,this.addEventInterceptor("click",u,!0));if(!a){var o=this.root.scene.$g;a=[[o,"mousemove",e.listen(o,"mousemove",r)],[o,"mouseup",e.listen(o,"mouseup",i)],[document,"mousemove",e.listen(document,"mousemove",r)],[document,"mouseup",e.listen(document,"mouseup",i)]]}var p=arguments[arguments.length-1];f=p.target,l=!1,p.stopPropagation();var d=this.mouse(),v=this.scene,m=this.index;h=v[m].drag={phase:"start",m:d,m1:d,m2:null,d:n,scene:v,index:m},p=s(p,h),t.dragstart.call(this,p);var g=h.m;g!==d&&(d.x=g.x,d.y=g.y)}function r(e){if(h){h.phase="move",e.stopPropagation(),e=s(e,h);var n=h.scene;n.mark.context(n,h.index,function(){var n=h.m2||h.m1,r=this.mouse();if(!(n&&r.distance2(n).dist2<=2)){h.m=h.m2=r,t.drag.call(this,e);var i=h.m;i!==r&&(r.x=i.x,r.y=i.y)}})}}function i(n){if(h){h.phase="end";var r=h.m2,i=r&&h.m1.distance2(r).dist2>.1;h.canceled=!i,l=i&&f===n.target,l||(f=null),n.stopPropagation(),n=s(n,h),a&&(a.forEach(function(t){e.unlisten.apply(e,t)}),a=null);var o=h.scene,u=h.index;try{o.mark.context(o,u,function(){t.dragend.call(this,n)})}finally{h=null,delete o[u].drag}}}function s(e,t){try{return e.drag=t,e}catch(n){}var r={};for(var i in e){var s=e[i];r[i]="function"!=typeof s?s:o(s,e)}return r._sourceEvent=e,r}function o(e,t){return function(){return e.apply(t,arguments)}}function u(e,t){if(l&&f===t.target)return l=!1,f=null,!1}var a,f,l,c,h;return t.autoRender=!0,t.positionConstraint=null,t.bound=function(e,t){return Math.max(h.min[t],Math.min(h.max[t],e))},n.autoRender=function(e){return arguments.length?(t.autoRender=!!e,n):t.autoRender},n.positionConstraint=function(e){return arguments.length?(t.positionConstraint=e,n):t.positionConstraint},n},e.Behavior.drag=function(){var t,n=null,r=1,i=1,s={dragstart:function(n){var r=n.drag;r.type="drag";var i=r.d,o=e.vector(i.x,i.y);i.fix=o,i.drag=r,t=o.minus(r.m1);var u=this.parent;r.max={x:u.width()-(i.dx||0),y:u.height()-(i.dy||0)},r.min={x:0,y:0},s.autoRender&&this.render(),e.Mark.dispatch("dragstart",r.scene,r.index,n)},drag:function(n){var o=n.drag,u=o.m2,a=o.d;o.m=t.plus(u);var f=s.positionConstraint;f&&f(o);var l=o.m;r&&(a.x=a.fix.x=s.bound(l.x,"x")),i&&(a.y=a.fix.y=s.bound(l.y,"y")),s.autoRender&&this.render(),e.Mark.dispatch("drag",o.scene,o.index,n)},dragend:function(n){var r=n.drag,i=r.d;i.fix=null,t=null,s.autoRender&&this.render();try{e.Mark.dispatch("dragend",r.scene,r.index,n)}finally{delete i.drag}}},o=e.Behavior.dragBase(s);return o.collapse=function(e){if(arguments.length){n=String(e);switch(n){case"y":r=1,i=0;break;case"x":r=0,i=1;break;default:r=1,i=1}return o}return n},o},e.Behavior.point=function(t){function n(e,t){for(var r=e[t],i={cost:1/0},s=(r.visible?r.children.length:0)-1;s>=0;s--){var o,f=r.children[s],l=f.mark;if("panel"==l.type){l.scene=f;for(var c=f.length-1;c>=0;c--)l.index=c,o=n(f,c),o.cost<i.cost&&(i=o);delete l.scene,delete l.index}else if(l.$handlers.point)for(var h=l.mouse(),c=f.length-1;c>=0;c--){var p=f[c],d=h.x-p.left-(p.width||0)/2,v=h.y-p.top-(p.height||0)/2,m=u*d*d+a*v*v;m<i.cost&&(i.distance=d*d+v*v,i.cost=m,i.scene=f,i.index=c)}}return i}function r(t){var r=n(this.scene,this.index);(1/0==r.cost||r.distance>l)&&(r=null);if(s){if(r&&s.scene==r.scene&&s.index==r.index)return;e.Mark.dispatch("unpoint",s.scene,s.index,t)}if(s=r)e.Mark.dispatch("point",r.scene,r.index,t),f||"panel"!==this.type?e.listen(this.root.canvas(),"mouseout",i):(f=this,f.event("mouseout",function(){var e=arguments[arguments.length-1];i.call(f.scene.$g,e)}))}function i(t){s&&!e.ancestor(this,t.relatedTarget)&&(e.Mark.dispatch("unpoint",s.scene,s.index,t),s=null)}var s,o=null,u=1,a=1,f=null,l=arguments.length?t*t:900;return r.collapse=function(e){if(arguments.length){o=String(e);switch(o){case"y":u=1,a=0;break;case"x":u=0,a=1;break;default:u=1,a=1}return r}return o},r},e.Behavior.select=function(){var t=null,n=1,r=1,i=!1,s={dragstart:function(t){var o=t.drag;o.type="select",o.dxmin=0,o.dymin=0;var u=o.d;u.drag=o,o.max={x:this.width(),y:this.height()},o.min={x:0,y:0};var a=s.positionConstraint;a&&(o.m=o.m.clone(),a(o));var f=o.m;n&&(u.x=s.bound(f.x,"x"),i||(u.dx=Math.max(0,o.dxmin))),r&&(u.y=s.bound(f.y,"y"),i||(u.dy=Math.max(0,o.dymin))),e.Mark.dispatch("selectstart",o.scene,o.index,t)},drag:function(t){var o=t.drag,u=o.m1,a=o.d;o.max.x=this.width(),o.max.y=this.height();var f=s.positionConstraint;f&&(o.m=o.m.clone(),f(o));var l=o.m;if(n){var c=Math.min(u.x,l.x);c=s.bound(c,"x"),a.x=c;if(!i){var h=Math.max(l.x,u.x);h=s.bound(h,"x"),a.dx=Math.max(0,o.dxmin,h-c)}}if(r){var p=Math.min(u.y,l.y);p=s.bound(p,"y"),a.y=p;if(!i){var d=Math.max(l.y,u.y);d=s.bound(d,"y"),a.dy=Math.max(0,o.dymin,d-p)}}s.autoRender&&this.render(),e.Mark.dispatch("select",o.scene,o.index,t)},dragend:function(t){var n=t.drag;try{e.Mark.dispatch("selectend",n.scene,n.index,t)}finally{var r=n.d;delete r.drag}}},o=e.Behavior.dragBase(s);return o.collapse=function(e){if(arguments.length){t=String(e);switch(t){case"y":n=1,r=0;break;case"x":n=0,r=1;break;default:n=1,r=1}return o}return t},o.preserveLength=function(e){return arguments.length?(i=!!e,o):i},o},e.Behavior.resize=function(t){var n=!1,r="left"===t||"right"===t,i={dragstart:function(n){var r=n.drag;r.type="resize";var i=r.m1,s=r.d;s.drag=r;switch(t){case"left":i.x=s.x+s.dx;break;case"right":i.x=s.x;break;case"top":i.y=s.y+s.dy;break;case"bottom":i.y=s.y}var o=this.parent;r.max={x:o.width(),y:o.height()},r.min={x:0,y:0},e.Mark.dispatch("resizestart",r.scene,r.index,n)},drag:function(t){var s=t.drag,o=s.m1,u=i.positionConstraint;u&&(s.m=s.m.clone(),u(s));var a=s.m,f=s.d;if(!n||r){var l=Math.min(o.x,a.x),c=Math.max(a.x,o.x);l=i.bound(l,"x"),c=i.bound(c,"x"),f.x=l,f.dx=c-l}if(!n||!r){var h=Math.min(o.y,a.y),p=Math.max(a.y,o.y);h=i.bound(h,"y"),p=i.bound(p,"y"),f.y=h,f.dy=p-h}i.autoRender&&this.render(),e.Mark.dispatch("resize",s.scene,s.index,t)},dragend:function(t){var n=t.drag;n.max=null;try{e.Mark.dispatch("resizeend",n.scene,n.index,t)}finally{var r=n.d;delete r.drag}}},s=e.Behavior.dragBase(i);return s.preserveOrtho=function(e){return arguments.length?(n=!!e,s):n},s},e.Behavior.pan=function(){function t(){s=this.index,i=this.scene,u=e.vector(e.event.pageX,e.event.pageY),o=this.transform(),a=1/(o.k*this.scale),f&&(f={x:(1-o.k)*this.width(),y:(1-o.k)*this.height()})}function n(t){i&&(i.mark.context(i,s,function(){var t=(e.event.pageX-u.x)*a,n=(e.event.pageY-u.y)*a,r=o.translate(t,n);f&&(r.x=Math.max(f.x,Math.min(0,r.x)),r.y=Math.max(f.y,Math.min(0,r.y))),this.transform(r).render()}),e.Mark.dispatch("pan",i,s,t))}function r(){i=null}var i,s,o,u,a,f;return t.bound=function(e){return arguments.length?(f=Boolean(e),this):Boolean(f)},e.listen(window,"mousemove",n),e.listen(window,"mouseup",r),t},e.Behavior.zoom=function(t){function n(n){var i=this.mouse(),s=e.event.wheel*t,o=this.transform().translate(i.x,i.y).scale(0>s?1e3/(1e3-s):(1e3+s)/1e3).translate(-i.x,-i.y);r&&(o.k=Math.max(1,o.k),o.x=Math.max((1-o.k)*this.width(),Math.min(0,o.x)),o.y=Math.max((1-o.k)*this.height(),Math.min(0,o.y))),this.transform(o).render(),e.Mark.dispatch("zoom",this.scene,this.index,n)}var r;return arguments.length||(t=1/48),n.bound=function(e){return arguments.length?(r=Boolean(e),this):Boolean(r)},n},e.Geo=function(){},e.Geo.projections={mercator:{project:function(t){return{x:t.lng/180,y:t.lat>85?1:t.lat<-85?-1:Math.log(Math.tan(Math.PI/4+e.radians(t.lat)/2))/Math.PI}},invert:function(t){return{lng:180*t.x,lat:e.degrees(2*Math.atan(Math.exp(t.y*Math.PI))-Math.PI/2)}}},"gall-peters":{project:function(t){return{x:t.lng/180,y:Math.sin(e.radians(t.lat))}},invert:function(t){return{lng:180*t.x,lat:e.degrees(Math.asin(t.y))}}},sinusoidal:{project:function(t){return{x:e.radians(t.lng)*Math.cos(e.radians(t.lat))/Math.PI,y:t.lat/90}},invert:function(t){return{lng:e.degrees(t.x*Math.PI/Math.cos(t.y*Math.PI/2)),lat:90*t.y}}},aitoff:{project:function(t){var n=e.radians(t.lng),r=e.radians(t.lat),i=Math.acos(Math.cos(r)*Math.cos(n/2));return{x:2*(i?Math.cos(r)*Math.sin(n/2)*i/Math.sin(i):0)/Math.PI,y:2*(i?Math.sin(r)*i/Math.sin(i):0)/Math.PI}},invert:function(t){var n=t.x*Math.PI/2,r=t.y*Math.PI/2;return{lng:e.degrees(n/Math.cos(r)),lat:e.degrees(r)}}},hammer:{project:function(t){var n=e.radians(t.lng),r=e.radians(t.lat),i=Math.sqrt(1+Math.cos(r)*Math.cos(n/2));return{x:2*Math.SQRT2*Math.cos(r)*Math.sin(n/2)/i/3,y:Math.SQRT2*Math.sin(r)/i/1.5}},invert:function(t){var n=3*t.x,r=1.5*t.y,i=Math.sqrt(1-n*n/16-r*r/4);return{lng:e.degrees(2*Math.atan2(i*n,2*(2*i*i-1))),lat:e.degrees(Math.asin(i*r))}}},identity:{project:function(e){return{x:e.lng/180,y:e.lat/90}},invert:function(e){return{lng:180*e.x,lat:90*e.y}}}},e.Geo.scale=function(t){function n(e){if(!s||e.lng!=s.lng||e.lat!=s.lat){s=e;var t=r(e);o={x:c(t.x),y:h(t.y)}}return o}function r(e){var t={lng:e.lng-p.lng,lat:e.lat};return l.project(t)}function i(e){var t=l.invert(e);return t.lng+=p.lng,t}var s,o,u={x:0,y:0},a={x:1,y:1},f=[],l=e.Geo.projections.identity,c=e.Scale.linear(-1,1).range(0,1),h=e.Scale.linear(-1,1).range(1,0),p={lng:0,lat:0};return n.x=function(e){return n(e).x},n.y=function(e){return n(e).y},n.ticks={lng:function(t){var n,r;if(f.length>1){var i=e.Scale.linear();void 0==t&&(t=10),n=i.domain(f,function(e){return e.lat}).ticks(t),r=i.domain(f,function(e){return e.lng}).ticks(t)}else n=e.range(-80,81,10),r=e.range(-180,181,10);return r.map(function(e){return n.map(function(t){return{lat:t,lng:e}})})},lat:function(t){return e.transpose(n.ticks.lng(t))}},n.invert=function(e){return i({x:c.invert(e.x),y:h.invert(e.y)})},n.domain=function(t,n){if(arguments.length){f=t instanceof Array?arguments.length>1?e.map(t,n):t:Array.prototype.slice.call(arguments);if(f.length>1){var i=f.map(function(e){return e.lng}),o=f.map(function(e){return e.lat});p={lng:(e.max(i)+e.min(i))/2,lat:(e.max(o)+e.min(o))/2};var u=f.map(r);c.domain(u,function(e){return e.x}),h.domain(u,function(e){return e.y})}else p={lng:0,lat:0},c.domain(-1,1),h.domain(-1,1);return s=null,this}return f},n.range=function(e,t){return arguments.length?("object"==typeof e?(u={x:Number(e.x),y:Number(e.y)},a={x:Number(t.x),y:Number(t.y)}):(u={x:0,y:0},a={x:Number(e),y:Number(t)}),c.range(u.x,a.x),h.range(a.y,u.y),s=null,this):[u,a]},n.projection=function(t){return arguments.length?(l="string"==typeof t?e.Geo.projections[t]||e.Geo.projections.identity:t,this.domain(f)):t},e.copyOwn(n,e.Scale.common),arguments.length&&n.projection(t),n},e}),pen.define("cdf/lib/CCC/protovis",function(){}),pen.define("cdf/lib/CCC/pvc-d1.0",["cdf/lib/CCC/def","cdf/lib/CCC/protovis","cdf/jquery","cdf/lib/CCC/tipsy"],function(e,t,n){function r(){if(sn.debug>0&&"undefined"!=typeof console)["log","info",["trace","debug"],"error","warn",["group","groupCollapsed"],"groupEnd"].forEach(function(e){e=e instanceof Array?e:[e,e],s(sn,e[0],e[1],"[pvChart]")});else{sn.debug>1&&(sn.debug=1),["log","info","trace","warn","group","groupEnd"].forEach(function(t){sn[t]=e.noop});var n="[pvChart ERROR]: ";sn.error=function(t){throw t&&"object"==typeof t&&t.message&&(t=t.message),t=""+e.nullyTo(t,""),t.indexOf(n)<0&&(t=n+t),new Error(t)}}sn.logError=sn.error,t.error=sn.error}function i(){var e=t.Behavior.tipsy;e&&e.setDebug&&(e.setDebug(sn.debug),e.log=sn.log)}function s(t,n,r,i){r||(r=n);var s,o=console,u=o[r]||o.log;if(u){var a=i+": %s";if(e.fun.is(u))s=u.bind(o,a);else{var f=Function.prototype.apply;s=function(){f.call(u,o,e.array.append([a],arguments))}}}t[n]=s}function o(t,n){return t?e.object.is(t)?t.abs:n?n+e.firstUpperCase(t):t:n}function u(e,t){return t?(e=e.toString().split("e"),+(e[0]+"e"+(e[1]?+e[1]+t:t))):e}function a(e){e=t.color(e);var n=e.r,r=e.g,i=e.b,s=(n+r+i)/3,o=2;return Math.abs(n-s)<=o&&Math.abs(r-s)<=o&&Math.abs(i-s)<=o}function f(t){t||e.fail.argumentRequired("keyArgs");var n=t.type||e.fail.argumentRequired("keyArgs.type");switch(n){case"linear":return(new sn.color.LinearScalesBuild(t)).buildMap();case"discrete":return(new sn.color.DiscreteScalesBuild(t)).buildMap();case"normal":return(new sn.color.NormalScalesBuild(t)).buildMap()}throw e.error.argumentInvalid("scaleType","Unexistent scale type '{0}'.",[n])}function l(t){t||e.fail.argumentRequired("keyArgs");var n=t.type||e.fail.argumentRequired("keyArgs.type");switch(n){case"linear":return(new sn.color.LinearScalesBuild(t)).build();case"discrete":return(new sn.color.DiscreteScalesBuild(t)).build();case"normal":return(new sn.color.NormalScalesBuild(t)).build()}throw e.error.argumentInvalid("scaleType","Unexistent scale type '{0}'.",[n])}function c(t,n){function r(e){return h[e].resolve()}function i(e,t){var n=r(e);return t&&!n.isSpecified?void 0:n.value}function s(e){return r(e).isSpecified}function o(e){return i(e,!0)}function u(t){return e.hasOwn(h,t)}function a(e){return c(e,!1)}function f(e){return c(e,!0)}function l(e){return r(e)._dv}function c(t,n){for(var r in t){var s=e.hasOwnProp.call(h,r)&&h[r];if(s){var o=t[r];void 0!==o&&s.set(o,n)}}return i}t||e.fail.argumentRequired("specs");var h={};return e.each(t,function(e,t){var r=new dn(t,i,n,e);h[r.name]=r}),i.option=i,i.specified=o,i.defaultValue=l,i.isSpecified=s,i.isDefined=u,i.specify=a,i.defaults=f,i}function h(e){return function(t){for(var n=0,r=e.length;r>n;n++){var i=e[n];"string"==typeof i&&(i=this[i]);if(i.call(this,t)===!0)return!0}}}function p(e){return function(t){return t.specify(e),!0}}function d(e){return function(t){var n=e.call(this,t);if(void 0!==n)return t.specify(n),!0}}function v(e){return function(t){var n=e.call(this,t);if(void 0!==n)return t.defaultValue(n),!0}}function m(){e.instance(this,vn,mn,arguments)}function g(t){return e.string.is(t)?!!this.mask(t):e.is(t,gn)?!!this.mask(t.mask()).style(t.style()):void 0}function y(e){e||(e="");var t="_"+e,n=yn[t];return n||(bn===gn.cacheLimit&&(yn={},bn=0),yn[t]=n=b(e),bn++),n}function b(e){function t(e,t){return null==e?o?o(t):"":(e=+e,isNaN(e)||!isFinite(e)?"":r?0===e?s?s(t):r(t,e,null,!1):e>0?r(t,e,s,!1):i?i(t,-e,s||r):r(t,-e,s,!0):String(e))}function n(){var t,n,u,a=w(e);a.forEach(E),t=a.length,r=o=i=s=null;if(t){r=C(u=a[0]);if(t>1){n=a[1],i=C(n.empty?u:n);if(t>2){n=a[2],s=T(n.empty?u:n);if(t>3){n=a[3],o=N(n.empty?u:n);if(t>4)throw new Error("Invalid mask. More than 4 sections.")}}}}}var r,i,s,o;return n(),t}function w(e){var t=[];if(e){var n,r,i,s,o=-1,u=e.length,a="",f=1,l=1,c=0,h=0,p=function(e){f=0,i.list.push(e)},d=function(e){f=0,a+=e},v=function(){a&&(p({type:0,text:a}),a="")},m=function(e){v(),p(e)},g=function(){v(),!c&&h&&p({type:2}),i.digits=s,s=0,l=0,i=r.fractional},y=function(){r&&(!f||!t.length)&&(l?g():v(),i.digits=s,t.push(r)),f=l=1,h=s=c=0,r={empty:0,scale:0,groupOn:0,scientific:0,integer:{list:[],digits:0},fractional:{list:[],digits:0}},i=r.integer},b=function(){var t,i=o+1,s=!1,a=0;if(u>i){t=e.charAt(i);if("-"===t||"+"===t){s="+"===t;if(!(++i<u))return 0;t=e.charAt(i)}for(;"0"===t&&++a&&++i<u&&(t=e.charAt(i)););if(a)return o=i-1,m({type:5,text:n,digits:a,positive:s}),r.scientific=1,1}return 0};y();for(;++o<u;){n=e.charAt(o);if("0"===n)m({type:1}),c=1,s++;else if("#"===n)m({type:2}),c=1,s++;else if(","===n)l&&m({type:3});else if("."===n)l&&(h=1,g());else if("¤"===n)m({type:4});else if(";"===n){y();if(o+1>=u||";"===e.charAt(o+1))o++,t.push({empty:1})}else if("\\"===n)o++,u>o&&d(e.charAt(o));else if('"'===n){o++;var w=e.indexOf(n,o);0>w&&(w=u),d(e.substring(o,w)),o=w}else if("e"!==n&&"E"!==n||!b())"%"===n?r.scale+=2:"‰"===n?r.scale+=3:"‱"===n&&(r.scale+=4),d(n)}y()}return t}function E(e){e.empty||(S(e,!0),S(e,!1))}function S(e,t){function n(e){a[s](e)}for(var r,i,s=t?"push":"unshift",o=e[t?"integer":"fractional"],u=o.list,a=o.list=[],f=o.digits-1,l=0,c=0,h=u.length,p=t?0:h,d=t?function(){return h>p?u[p++]:null}:function(){return p>0?u[--p]:null};r=d();)switch(i=r.type){case 0:n(A(r.text));break;case 1:case 2:c&&2===i&&(i=1),n(O(t,f,1===i,!l)),f--,l=1,c||1!==i||(c=1);break;case 3:x(u,p,h)?l&&(e.groupOn=1):e.scale-=3;break;case 4:n(H);break;case 5:n(_(e,r))}!t&&o.digits&&a.unshift(M(c))}function x(e,t,n){for(;n>t;){var r=e[t++].type;if(1===r||2===r)return 1}return 0}function T(e){function t(t){return k(e,t,0,!1)}return t}function N(e){function t(t){return k(e,t,"",!1)}return t}function C(e){function t(t,n,r,i){var s,o=n,u=0,a=e.scale;return e.scientific&&(s=Math.floor(Math.log(n)/Math.LN10),u=a+s-e.integer.digits+1,a-=u),a&&(n=sn.mult10(n,a)),n=sn.round10(n,e.fractional.digits),!n&&r?r(t,o):k(e,t,n,i,u)}return t}function k(e,t,n,r,i){var s=""+n,o=s.indexOf("."),u=0>o?s:s.substr(0,o),a=0>o?"":s.substr(o+1);"0"===u&&(u=""),i||(i=0);var f=[];return r&&f.push(t.negativeSign),u=u.split(""),a=a.split(""),t.group&&e.groupOn&&L(t,u),e.integer.list.forEach(function(e){f.push(e(t,u,i))}),e.fractional.list.forEach(function(e){f.push(e(t,a,i))}),f.join("")}function L(e,t){for(var n,r=e.group,i=function(){t[s-a-1]+=r},s=t.length,o=e.groupSizes,u=o.length,a=0,f=-1;++f<u;){a+=n=o[f];if(!(s>a))return;i()}for(;(a+=n)<s;)i()}function A(e){function t(){return e}return t}function O(e,t,n,r){function i(t){return t[e?"integerPad":"fractionPad"]}function s(e,n){var i=n.length;if(i>t){var s=i-1-t;return r?n.slice(0,s+1).join(""):n[s]}return u?u(e):""}function o(e,n){return t<n.length?n[t]:u?u(e):""}var u=n?i:null;return e?s:o}function M(e){return e?D:P}function _(e,t){function n(e,n,r){var i=0>r?e.negativeSign:t.positive?"+":"",s=""+Math.abs(r),o=t.digits-s.length;return o>0&&(s=(new Array(o+1)).join("0")+s),t.text+i+s}return n}function D(e){return e.decimal}function P(e,t){return t.length?e.decimal:""}function H(e){return e.currency}function B(t){return e.string.is(t)?!!this.mask(t):e.is(t,wn)?!!this.mask(t.mask()):void 0}function j(n){return n?t.Format.createFormatter(t.Format.date(n)):e.string.to}function F(t){return e.is(t,En)?!!this.formatter(t.formatter()):e.fun.is(t)?!!this.formatter(t):void 0}function I(e){return null!=e?String(e):""}function q(t){function n(n){return e.is(n,t)||e.is(n,En)?n:null}function r(n,r){var i=e.fun.is(n)?En:t;return i(n,r)}return{cast:n,factory:r}}function R(t){switch(e.classOf(t)){case Sn:return!!this.number(t.number()).percent(t.percent()).date(t.date()).any(t.any());case gn:return!!this.number(t);case wn:return!!this.date(t);case En:return!!this.any(t)}}function U(e,t){var n=e&&e.length;if(n){for(var r=0;n>r;r++){var i=e[r];t&&(i[t]=null),i.dispose()}e.length=0}}function z(e,t,n,r,i){n[r]=e;var s=e[t]||(e[t]=[]);null==i||i>=s.length?s.push(n):s.splice(i,0,n)}function W(t,n,r,i){var s=t[n];if(s){var o=s.indexOf(r);o>=0&&e.array.removeAt(s,o)}r[i]=null}function X(e){this.playedVisualRoles.set(e.name,e),$.call(this.complexType,this)}function V(e){this.playedVisualRoles.rem(e.name),$.call(this.complexType,this)}function $(){this._isPctRoleDimTypeMap=null}function J(t,n){function r(){var r={},s=e.query(i.source).select(function(e){n(e,r);var t=r.series;return null!=t&&null!=t.v&&(t=t.v),t||null}).distinct().array();return i._createPlot2SeriesKeySet(t,s)}var i=this;return this._dataPartGet(r,n)}function K(e,t){return e.id-t.id}function Q(e,t){return t.id-e.id}function G(){delete this.isSelected}function Y(e){return e.isNull||e.isSelected}function Z(e){return e.isSelected===!0}function et(e){return e.isSelected===!1}function tt(e){return e.isVisible===!0}function nt(e){return e.isVisible===!1}function rt(e){return e.isNull===!0}function it(e){return e.isNull===!1}function st(t,n,r,i,s,o){var u;if(this.owner===this){if(null==s){var a=t._formatter;s=a?a(i,n):i}s=e.string.to(s),!s&&sn.debug>=2&&sn.log("Only the null value should have an empty label."),u=new sn.data.Atom(this,i,s,n,r),o&&(u.isVirtual=!0)}else{var f=this.parent||this.linkParent;u=f._atomsByKey[r]||st.call(f,t,n,r,i,s,o)}return e.array.insert(this._atoms,u,this._atomComparer),ht.call(this),this._atomsByKey[r]=u,u}function ot(t){var n=t.key,r=this;if(t.dimension===r)return r.owner===r||e.assert("Should be an owner dimension"),n||t!==r._virtualNullAtom||(t=r.intern(null)),t;var i=!r._lazyInit;if(i){var s=r._atomsByKey[n];if(s){if(s!==t)throw e.error.operationInvalid("Atom is from a different root data.");return t}if(r.owner===r)throw e.error.operationInvalid("Atom is from a different root data.")}return ot.call(r.parent||r.linkParent,t),i&&(r._atomsByKey[n]=t,n?e.array.insert(r._atoms,t,r._atomComparer):(r._nullAtom=t,r._atoms.unshift(t)),ht.call(r)),t}function ut(t){var n=e.get(t,"visible"),r=e.get(t,"selected");return(null==n?null:!!n)+":"+(null==r?null:!!r)}function at(t){var n=this._nullAtom;if(!n){if(this.owner===this){var r=this.type._formatter,i=r?e.string.to(r.call(null,null,t)):"";n=new sn.data.Atom(this,null,i,null,""),this.data._atomsBase[this.name]=n}else n=at.call(this.parent||this.linkParent,t);this._atomsByKey[""]=this._nullAtom=n,this._atoms.unshift(n)}return n}function ft(){return this.owner===this||e.assert("Can only create atoms on an owner dimension."),this._virtualNullAtom||(this._virtualNullAtom=new sn.data.Atom(this,null,"",null,""),this.data._atomsBase[this.name]=this._virtualNullAtom),this._virtualNullAtom}function lt(){this.owner===this||e.assert("Can only unintern atoms of an owner dimension.");var t=this._atoms;if(t){for(var n=this._atomsByKey,r=0,i=t.length;i>r;){var s=t[r];if(s.visited)delete s.visited,r++;else if(s!==this._virtualNullAtom){t.splice(r,1),i--;var o=s.key;delete n[o],o||(delete this._nullAtom,this.data._atomsBase[this.name]=this._virtualNullAtom)}}ht.call(this)}}function ct(){var t=this._atoms;if(t){for(var n,r=this._atomsByKey,i=0,s=t.length;s>i;){var o=t[i];if(o.isVirtual){t.splice(i,1),s--,n=!0;var u=o.key||e.assert("Cannot be the null or virtual null atom.");delete r[u]}else i++}n&&ht.call(this)}}function ht(){this._atomVisibleDatumsCount=this._sumCache=this._visibleAtoms=this._visibleIndexes=null}function pt(e){z(this,"childNodes",e,"parent"),e.owner=this.owner}function dt(e){z(this,"_linkChildren",e,"linkParent"),e.owner=this.owner}function vt(t,n){var r;if(!this._disposed&&(r=this._atomVisibleDatumsCount)){var i=t.atoms[this.name],s=i.key;e.hasOwn(this._atomsByKey,s)||e.assert("Atom must exist in this dimension.");var o=r[s];n||o>0||e.assert("Must have had accounted for at least one visible datum."),r[s]=(o||0)+(n?1:-1),this._visibleAtoms=this._sumCache=this._visibleIndexes=null}}function mt(){var e=this._atomVisibleDatumsCount;return e||(e={},this.data.datums(null,{visible:!0}).each(function(t){var n=t.atoms[this.name],r=n.key;e[r]=(e[r]||0)+1},this),this._atomVisibleDatumsCount=e),e}function gt(e){var t=[];return this._atoms.forEach(function(n,r){this.isVisible(n)===e&&t.push(r)},this),t}function yt(t){return e.query(this._atoms).where(function(e){return this.isVisible(e)===t},this).array()}function bt(t,n){this.insertAt(t,n),e.lazy(this,"_childrenByKey")[t.key]=t}function wt(e,t){z(this,"_linkChildren",e,"linkParent",t)}function Et(e){W(this,"_linkChildren",e,"linkParent")}function St(){U(this.childNodes,"parent"),this._childrenByKey=null,U(this._linkChildren,"linkParent"),this._groupByCache=null,this._sumAbsCache=null}function xt(){this.isOwner()||e.fail("Can only be called on the owner data.")}function Tt(t,n){!t.isNull||e.assert("Null datums do not notify selected changes"),n?this._selectedNotNullDatums.set(t.id,t):this._selectedNotNullDatums.rem(t.id),this._sumAbsCache=null}function Nt(t,n){var r=t.id,i=this,s=e.hasOwnProp;if(s.call(i._datumsById,r)){!t.isNull||e.assert("Null datums do not notify visible changes"),n?i._visibleNotNullDatums.set(r,t):i._visibleNotNullDatums.rem(r),i._sumAbsCache=null;for(var o=i._dimensionsList,u=0,a=o.length;a>u;)vt.call(o[u++],t,n);o=i.childNodes,u=0,a=o.length;for(;a>u;)Nt.call(o[u++],t,n);o=i._linkChildren;if(o&&(a=o.length)){u=0;for(;a>u;)Nt.call(o[u++],t,n)}}}function Ct(t,n){return e.string.is(t)||e.fail.argumentInvalid("groupLevelText","Invalid grouping specification."),e.query(t.split(/\s*\|\s*/)).where(e.truthy).select(function(t){var r=Cn.exec(t)||e.fail.argumentInvalid("groupLevelText","Invalid grouping level syntax '{0}'.",[t]),i=r[1],s=(r[2]||"").toLowerCase(),o="desc"===s;return new sn.data.GroupingDimensionSpec(i,o,n)})}function kt(t,n){function r(t){if(t){var n=t.key;if(!e.hasOwnProp.call(m,n)){!f&&o&&e.hasOwnProp.call(o,n)&&(t=o[n]);var r=t.id;v.push(t),m[n]=t,g[r]=t,d&&d.push(t),Lt.call(this,t,l,a),t.isNull||(h&&t.isSelected&&h.set(r,t),t.isVisible&&c.set(r,t))}}}t||e.fail.argumentRequired("addDatums");var i,s,o,u,a=e.get(n,"doAtomGC",!1),f=e.get(n,"isAdditive",!1),l=!!this._dimensions,c=this._visibleNotNullDatums,h=this._selectedNotNullDatums,p=this._datums;p?(o=this._datumsByKey,u=this._datumsById,f&&a&&p.forEach(function(e){Lt.call(this,e,!1,!0)},this)):f=!1;var d,v,m,g;f?(d=[],v=p,g=u,m=o,this._sumAbsCache=null):(this._datums=v=[],this._datumsById=g={},this._datumsByKey=m={},p&&(St.call(this),c.clear(),h&&h.clear()));if(e.array.is(t)){i=0,s=t.length;for(;s>i;)r.call(this,t[i++])}else{if(!(t instanceof e.Query))throw e.error.argumentInvalid("addDatums","Argument is of invalid type.");t.each(r,this)}if(a){var y=this._dimensionsList;i=0,s=y.length;for(;s>i;)lt.call(y[i++])}if(f){var b=this._linkChildren;if(b){i=0,s=b.length;for(;s>i;)At.call(b[i++],d)}}}function Lt(e,t,n){var r=this._dimensionsList;r||(t=!1);if(t||n){var i,s,o,u=e.atoms,a=0;if(r){i=r.length;for(;i>a;)o=r[a++],s=u[o.name],s&&(t&&ot.call(o,s),n&&(s.visited=!0))}else{var f=this.type.dimensionsNames();i=f.length;for(;i>a;)s=u[f[a++]],s&&(s.visited=!0)}}}function At(t){t||e.fail.argumentRequired("newDatums");var n=this._groupOper;if(n)t=n.executeAdd(this,t);else{var r=this._wherePred;r&&(t=t.filter(r)),Ot.call(this,t)}var i=this._linkChildren,s=i&&i.length;if(s)for(var o=0;s>o;o++)At.call(i[o],t)}function Ot(e){var t=this;t._sumAbsCache=null;for(var n=t._datums,r=t._visibleNotNullDatums,i=t._selectedNotNullDatums,s=t._datumsById,o=0,u=e.length;u>o;o++){var a=e[o],f=a.id;s[f]=a,Lt.call(t,a,!0,!1),a.isNull||(i&&a.isSelected&&i.set(f,a),a.isVisible&&r.set(f,a)),n.push(a)}}function Mt(t){function n(t){if(null!=t){"object"==typeof t||e.fail.invalidArgument("datumFilter");var n={},i=!1;for(var s in t){var o=this.dimensions(s).getDistinctAtoms(e.array.as(t[s]));o.length&&(i=!0,n[s]=o)}i&&r.push(n)}}var r=[];return t=e.array.as(t),t&&t.forEach(n,this),r}function _t(t,n){var r=e.get(n,"visible"),i=e.get(n,"isNull"),s=e.get(n,"selected"),o=e.get(n,"where");return null!=r&&(t=t.where(r?tt:nt)),null!=i&&(t=t.where(i?rt:it)),null!=s&&(t=t.where(s?Z:et)),o&&(t=t.where(o)),t}function Dt(t,n){var r=e.get(n,"visible"),i=e.get(n,"isNull"),s=e.get(n,"selected"),o=e.get(n,"where"),u=[];null!=r&&u.unshift(r?tt:nt),null!=i&&u.unshift(i?rt:it),null!=s&&u.unshift(s?Z:et),o&&u.unshift(o),t&&u.unshift(Pt(t));var a=u.length;if(a){if(1===a)return u[0];var f=function(e){for(var t=a;t;)if(!u[--t](e))return!1;return!0};return f}}function Pt(e){function t(t){for(var i=t.atoms,s=0;r>s;s++)if(n(i,e[s]))return!0;return!1}function n(e,t){for(var n in t)if(t[n].indexOf(e[n])<0)return!1;return!0}var r=e.length;return t}function Ht(t,n){var r=e.array.as(e.get(n,"orderBy")),i=e.create(n||{},{orderBy:null}),s=e.query(t).selectMany(function(e,t){return r&&(i.orderBy=r[t]),Bt.call(this,e,i)},this);return s.distinct(e.propGet("id"))}function Bt(t,n){var r=n.orderBy;if(r){if(r.indexOf("|")>=0)throw e.error.argumentInvalid("keyArgs.orderBy","Multi-dimension order by is not supported.")}else r=Object.keys(t).sort().join(",");var i=this.groupBy(r,n),s=i.treeHeight,o=[];return e.query(function(){var n;if(this._data){if(this._datumsQuery){this._data||e.assert("Must have a current data"),o.length||e.assert("Must have a parent data"),!this._dimAtomsOrQuery||e.assert();if(this._datumsQuery.next())return this.item=this._datumsQuery.item,1;this._datumsQuery=null,n=o.pop(),this._data=n.data,this._dimAtomsOrQuery=n.dimAtomsOrQuery}}else this._data=i,this._dimAtomsOrQuery=e.query(t[i._groupLevelSpec.dimensions[0].name]);this._dimAtomsOrQuery||e.assert("Invalid programmer"),this._data||e.assert("Must have a current data");for(var r=o.length;;){for(;this._dimAtomsOrQuery.next();){var u=this._dimAtomsOrQuery.item,a=this._data.child(u.key);if(a&&(s-1>r||a._datums.length)){o.push({data:this._data,dimAtomsOrQuery:this._dimAtomsOrQuery}),this._data=a;if(!(s-1>r))return this._dimAtomsOrQuery=null,this._datumsQuery=e.query(a._datums),this._datumsQuery.next(),this.item=this._datumsQuery.item,1;this._dimAtomsOrQuery=e.query(t[a._groupLevelSpec.dimensions[0].name]),r++}}if(!r)return 0;n=o.pop(),this._data=n.data,this._dimAtomsOrQuery=n.dimAtomsOrQuery,r--}return 0})}function jt(e){this._renderId!==e&&(this._renderId=e,this.renderState={})}function Ft(e){var t;e&&(t=e.ownerScene)&&(e=t);var n=this._active;return n!==e?(n&&It.call(n,!1),this._active=n=e||null,n&&It.call(n,!0),!0):!1}function It(e){this.isActive!==e&&(e?this.isActive=!0:delete this.isActive)}function qt(e,t){return function(){var n=this.vars[e];return void 0===n&&(n=this[t](),void 0===n&&(n=null),this.vars[e]=n),n}}function Rt(e,n){this.event=t.event,this.pvMark=e;if(e){var r=this.sign=e.sign||null;!n&&r&&(n=r.scene()),n?this.index=n.childIndex():(this.index=null,n=new sn.visual.Scene(null,{panel:this.panel}))}else this.sign=null,this.index=null,n=new sn.visual.Scene(null,{panel:this.panel,source:this.chart.root.data});this.scene=n}function Ut(t){var n=zt(t)||e.assert("There must exist an ancestor sign");return new sn.visual.BasicSign(n.panel,t)}function zt(e){var t;do e=e.parent;while(!(!e||(t=e.sign)||e.proto&&(t=e.proto.sign)));return t}function Wt(e){return e.isDiscrete()?"discrete":e.firstDimensionValueType()===Date?"timeSeries":"numeric"}function Xt(e,t){return sn.parseDomainScope(e,t.orientation)}function Vt(t){if(t){if(e.hasOwn(fn.namesSet,t)){var n=sn.BasePanel["y"===this.orientation?"horizontalAlign":"verticalAlign2"];return n[t]}sn.debug>=2&&sn.log(e.format("Invalid axis position value '{0}'.",[t]))}return"x"===this.orientation?"bottom":"left"}function $t(e){var t=this.option("Position");return hn.toOrtho(e,t)}function Jt(e){var t=this.option("Position");return hn.to(e,{singleProp:sn.BasePanel.orthogonalLength[t]})}function Kt(n){var r;if(n){var i;e.eachOwn(n,function(e,r){i=!0,n[r]=t.color(e)}),i&&(r=n)}return r}function Qt(){var e,n=this.scaleType;if(n)if("discrete"===n)if(0===this.index)e=sn.createColorScheme();else{var r=this;e=function(){return r.chart._getRoleColorScale(r.role.name)}}else In||(In=["red","yellow","green"].map(t.color)),e=In.slice();else e=sn.createColorScheme();return e}function Gt(t){if(!e.object.is(t)){var n=this.option("Position");t=(new hn).setSize(t,{singleProp:sn.BasePanel.orthogonalLength[n]})}return t}function Yt(e){var t=this.option("Position");return sn.parseAlign(t,e)}function Zt(e){return(new hn).setSize(e,{singleProp:"width"})}function en(e){return e.dataPartValue}function tn(e){if("trend"===this.name)return null;var t=this.option("TrendType");!t&&e&&(t=e.type);if(!t||"none"===t)return null;e=e?Object.create(e):{};var n=sn.trends.get(t);e.info=n,e.type=t;var r=this.option("TrendLabel");return e.label=null!=r?String(r):n.dataPartAtom.f,e}function nn(e,t){return{resolveV1:function(n){if(0===this.globalIndex)return this._specifyChartOption(n,"show"+e)||n.defaultValue(t),!0}}}function rn(e){return{resolveV1:function(t){return this._specifyChartOption(t,"show"+e),!0}}}Array.prototype.every||(Array.prototype.every=function(e){if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var r=arguments.length>=2?arguments[1]:void 0,i=0;n>i;i++)if(i in t&&!e.call(r,t[i],i,t))return!1;return!0});var sn=e.globalSpace("pvc",{debug:0});!function(){if("undefined"!=typeof window&&window.location){var e=function(e){return e&&/\bdebug=true\b/.test(e)?e:null},t=e(window.location.href);if(!t)try{t=e(window.top.location.href)}catch(n){}if(t){var r=/\bdebugLevel=(\d+)/.exec(t);sn.debug=r?+r[1]:3}}}();var on=t.Mark;sn.invisibleFill="rgba(127,127,127,0.00001)",sn.logSeparator="------------------------------------------";var un=Array.prototype.slice;sn.setDebug=function(e){return e=+e,sn.debug=isNaN(e)?0:e,r(),i(),sn.debug},sn.setDebug(sn.debug),sn.defaultCompatVersion=function(e){var t=sn.BaseChart.prototype.defaults;return null!=e?t.compatVersion=e:t.compatVersion},sn.cloneMatrix=function(e){return e.map(function(e){return e.slice()})},sn.normAngle=t.Shape.normalizeAngle,sn.stringify=function(t,n){var r=e.get(n,"maxLevel")||5,i=[];return sn.stringifyRecursive(i,t,r,n),i.join("")},sn.stringifyRecursive=function(t,n,r,i){if(r>0){r--;switch(typeof n){case"undefined":return t.push("undefined");case"object":if(!n)return t.push("null"),!0;if(e.fun.is(n.stringify))return n.stringify(t,r,i);if(n instanceof Array)t.push("["),n.forEach(function(e,n){n&&t.push(", "),sn.stringifyRecursive(t,e,r,i)||t.pop()}),t.push("]");else{var s=e.get(i,"ownOnly",!0);if(n===e.global)return t.push("<window>"),!0;if(e.fun.is(n.cloneNode))return t.push("<dom #"+(n.id||n.name||"?")+">"),!0;r>1&&n.constructor!==Object&&(r=1,s=!0),t.push("{");var o=!0;for(var u in n)if(!s||e.hasOwnProp.call(n,u))o||t.push(", "),t.push(u+": "),sn.stringifyRecursive(t,n[u],r,i)?o&&(o=!1):(t.pop(),o||t.pop());if(o){var a=""+n;"[object Object]"!==a&&t.push("{"+a+"}")}t.push("}")}return!0;case"number":return t.push(""+Math.round(1e5*n)/1e5),!0;case"boolean":return t.push(""+n),!0;case"string":return t.push(JSON.stringify(n)),!0;case"function":if(e.get(i,"funs",!1))return t.push(JSON.stringify(n.toString().substr(0,13)+"...")),!0;return!1}return t.push("'new ???'"),!0}},sn.orientation={vertical:"vertical",horizontal:"horizontal"},sn.extensionTag="extension",sn.extendType=function(t,n,r){if(n){var i,s=t.prototype._vars,o=function(t,n){void 0!==t&&(i||(i={}),s&&s[n]&&(n="_"+n+"EvalCore"),i[n]=e.fun.to(t))};r?r.forEach(function(e){o(n[e],e)}):e.each(o),i&&t.add(i)}},t.Color.prototype.stringify=function(e,t,n){return sn.stringifyRecursive(e,this.key,t,n)},on.prototype.hasDelegateValue=function(e,t){var n=this.$propertiesMap[e];return n?!t||n.tag===t:this.proto?this.proto.hasDelegateValue(e,t):!1},sn.defaultColorScheme=null,sn.brighterColorTransform=function(e){return(e.rgb?e:t.color(e)).brighter(.6)},sn.setDefaultColorScheme=function(e){return sn.defaultColorScheme=sn.colorScheme(e)},sn.defaultColor=t.Colors.category10()("?"),sn.colorScheme=function(n){if(null==n)return null;if("function"==typeof n){if(!n.hasOwnProperty("range"))return n;n=n.range()}else n=e.array.as(n);return n.length?function(){var e=t.colors(n);return e.domain.apply(e,arguments),e}:null},sn.createColorScheme=function(e){return sn.colorScheme(e)||sn.defaultColorScheme||t.Colors.category10},sn.toGrayScale=function(e,n,r,i){e=t.color(e);var s=.299*e.r+.587*e.g+.114*e.b;void 0===r?r=200:null==r&&(r=255),void 0===i?i=30:null==i&&(i=0);var o=r-i;return s=0>=o?r:i+s/255*o,null==n?n=e.opacity:0>n&&(n=-n*e.opacity),s=Math.round(s),t.rgb(s,s,s,n)},sn.removeTipsyLegends=function(){try{n(".tipsy").remove()}catch(e){}},sn.createDateComparer=function(e,n){return n||(n=t.identity),function(t,r){return e.parse(n(t))-e.parse(n(r))}},sn.time={intervals:{y:31536e6,m:2592e6,d30:2592e6,w:6048e5,d7:6048e5,d:864e5,h:36e5,M:6e4,s:1e3,ms:1},withoutTime:function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())},weekday:{previousOrSelf:function(e,t){var n=e.getDay(),r=n-t;if(r){var i=0>r?7+r:r;e=new Date(e-i*sn.time.intervals.d)}return e},nextOrSelf:function(e,t){var n=e.getDay(),r=n-t;if(r){var i=r>0?7-r:-r;e=new Date(e+i*sn.time.intervals.d)}return e},closestOrSelf:function(e,t){var n=e.getDay(),r=n-t;if(r){var i=sn.time.intervals.d,s=r>0?1:-1;r=Math.abs(r),e=r>=4?new Date(e.getTime()+s*(7-r)*i):new Date(e.getTime()-s*r*i)}return e}}},t.Format.createParser=function(t){function n(n){return n instanceof Date?n:e.number.is(n)?new Date(n):t.parse(n)}return n},t.Format.createFormatter=function(e){function t(t){return null!=t?e(t):""}return t},sn.buildTitleFromName=function(t){return e.firstUpperCase(t).replace(/([a-z\d])([A-Z])/,"$1 $2")},sn.buildIndexedId=function(e,t){return t>0?e+""+(t+1):e},sn.splitIndexedId=function(e){var t=/^(.*?)(\d*)$/.exec(e),n=null;return t[2]&&(n=Number(t[2]),1>=n?n=1:n--),[t[1],n]};var an=[null];sn.makeExtensionAbsId=function(t,n){if(!t)return n;var r=[];n=e.array.to(n)||an,t=e.array.to(t);for(var i=0,s=n.length;s>i;i++)for(var u=0,a=t.length;a>u;u++){var f=o(t[u],n[i]);f&&r.push(f)}return r},sn.makeEnumParser=function(t,n,r){if(e.array.is(n)){var i={};n.forEach(function(e){e&&(i[e.toLowerCase()]=e)}),n=function(t){return e.hasOwn(i,t)}}return r&&(r=r.toLowerCase()),function(e){return e&&(e=(""+e).toLowerCase()),n(e)||(e&&sn.debug>=2&&sn.warn("Invalid '"+t+"' value: '"+e+"'. Assuming '"+r+"'."),e=r),e}},sn.parseDistinctIndexArray=function(t,n,r){t=e.array.as(t);if(null==t)return null;null==n&&(n=0),null==r&&(r=1/0);var i=e.query(t).select(function(e){return+e}).where(function(e){return!isNaN(e)&&e>=n&&r>=e}).distinct().array();return i.length?i:null},sn.parseValuesOverflow=sn.makeEnumParser("valuesOverflow",["show","trim","hide"],"hide"),sn.parseMultiChartOverflow=sn.makeEnumParser("multiChartOverflow",["grow","fit","clip"],"grow"),sn.parseLegendClickMode=sn.makeEnumParser("legendClickMode",["toggleSelected","toggleVisible","none"],"toggleVisible"),sn.parseTooltipAutoContent=sn.makeEnumParser("tooltipAutoContent",["summary","value"],"value"),sn.parseSelectionMode=sn.makeEnumParser("selectionMode",["rubberBand","focusWindow"],"rubberBand"),sn.parseClearSelectionMode=sn.makeEnumParser("clearSelectionMode",["emptySpaceClick","manual"],"emptySpaceClick"),sn.parseSunburstSliceOrder=sn.makeEnumParser("sliceOrder",["bySizeAscending","bySizeDescending","none"],"bySizeDescending"),sn.parseShape=sn.makeEnumParser("shape",t.Scene.hasSymbol,null),sn.parseTreemapColorMode=sn.makeEnumParser("colorMode",["byParent","bySelf"],"byParent"),sn.parseTreemapLayoutMode=sn.makeEnumParser("layoutMode",["squarify","slice-and-dice","slice","dice"],"squarify"),sn.parseContinuousColorScaleType=function(e){if(e){e=(""+e).toLowerCase();switch(e){case"linear":case"normal":case"discrete":break;default:sn.debug>=2&&sn.log("[Warning] Invalid 'ScaleType' option value: '"+e+"'."),e=null}}return e},sn.parseDomainScope=function(t,n){if(t){t=(""+t).toLowerCase();switch(t){case"cell":case"global":break;case"section":if(!n)throw e.error.argumentRequired("orientation");t="y"===n?"row":"column";break;case"column":case"row":n&&n!==("row"===t?"y":"x")&&(t="section",sn.debug>=2&&sn.log("[Warning] Invalid 'DomainScope' option value: '"+t+"' for the orientation: '"+n+"'."));break;default:sn.debug>=2&&sn.log("[Warning] Invalid 'DomainScope' option value: '"+t+"'."),t=null}}return t},sn.parseDomainRoundingMode=function(e){if(e){e=(""+e).toLowerCase();switch(e){case"none":case"nice":case"tick":break;default:sn.debug>=2&&sn.log("[Warning] Invalid 'DomainRoundMode' value: '"+e+"'."),e=null}}return e},sn.parseOverlappedLabelsMode=function(e){if(e){e=(""+e).toLowerCase();switch(e){case"leave":case"hide":case"rotatethenhide":break;default:sn.debug>=2&&sn.log("[Warning] Invalid 'OverlappedLabelsMode' option value: '"+e+"'."),e=null}}return e},sn.castNumber=function(e){return null!=e&&(e=+e,isNaN(e)&&(e=null)),e},sn.castPositiveNumber=function(e){return e=sn.castNumber(e),null==e||e>0||(e=null),e},sn.castNonNegativeNumber=function(e){return e=sn.castNumber(e),null!=e&&0>e&&(e=null),e},sn.parseWaterDirection=function(e){if(e){e=(""+e).toLowerCase();switch(e){case"up":case"down":return e}sn.debug>=2&&sn.log("[Warning] Invalid 'WaterDirection' value: '"+e+"'.")}},sn.parseTrendType=function(e){if(e){e=(""+e).toLowerCase();if("none"===e)return e;if(sn.trends.has(e))return e;sn.debug>=2&&sn.log("[Warning] Invalid 'TrendType' value: '"+e+"'.")}},sn.parseNullInterpolationMode=function(e){if(e){e=(""+e).toLowerCase();switch(e){case"none":case"linear":case"zero":return e}sn.debug>=2&&sn.log("[Warning] Invalid 'NullInterpolationMode' value: '"+e+"'.")}},sn.parseAlign=function(t,n){n&&(n=(""+n).toLowerCase());var r,i;return"left"===t||"right"===t?(r=n&&sn.BasePanel.verticalAlign[n],r||(r="middle",i=!!n)):(r=n&&sn.BasePanel.horizontalAlign[n],r||(r="center",i=!!n)),i&&sn.debug>=2&&sn.log(e.format("Invalid alignment value '{0}'. Assuming '{1}'.",[n,r])),r},sn.parseAnchor=function(t){if(t){t=(""+t).toLowerCase();switch(t){case"top":case"left":case"center":case"bottom":case"right":return t}sn.debug>=2&&sn.log(e.format("Invalid anchor value '{0}'.",[t]))}},sn.parseAnchorWedge=function(t){if(t){t=(""+t).toLowerCase();switch(t){case"outer":case"inner":case"center":case"start":case"end":return t}sn.debug>=2&&sn.log(e.format("Invalid wedge anchor value '{0}'.",[t]))}},sn.unionExtents=function(e,t){if(e)t&&(t.min<e.min&&(e.min=t.min),t.max>e.max&&(e.max=t.max));else{if(!t)return null;e={min:t.min,max:t.max}}return e};var fn=sn.Sides=function(e){null!=e&&this.setSides(e)};fn.hnames="left right".split(" "),fn.vnames="top bottom".split(" "),fn.names="left right top bottom".split(" "),fn.namesSet=t.dict(fn.names,e.retTrue),sn.parsePosition=function(t,n){if(t){t=(""+t).toLowerCase();if(!e.hasOwn(fn.namesSet,t)){var r=n||"left";sn.debug>=2&&sn.log(e.format("Invalid position value '{0}. Assuming '{1}'.",[t,r])),t=r}}return t||n||"left"},fn.as=function(e){return null==e||e instanceof fn||(e=(new fn).setSides(e)),e},fn.to=function(e){return null!=e&&e instanceof fn||(e=(new fn).setSides(e)),e},fn.prototype.stringify=function(t,n,r){return sn.stringifyRecursive(t,e.copyOwn(this),n,r)},fn.prototype.setSides=function(e){if("string"==typeof e){var t=e.split(/\s+/).map(function(e){return ln.parse(e)});switch(t.length){case 1:return this.set("all",t[0]),this;case 2:return this.set("top",t[0]),this.set("left",t[1]),this.set("right",t[1]),this.set("bottom",t[0]),this;case 3:return this.set("top",t[0]),this.set("left",t[1]),this.set("right",t[1]),this.set("bottom",t[2]),this;case 4:return this.set("top",t[0]),this.set("right",t[1]),this.set("bottom",t[2]),this.set("left",t[3]),this;case 0:return this}}else{if("number"==typeof e)return this.set("all",e),this;if("object"==typeof e){if(e instanceof ln)this.set("all",e);else{this.set("all",e.all),this.set("width",e.width),this.set("height",e.height);for(var n in e)fn.namesSet.hasOwnProperty(n)&&this.set(n,e[n])}return this}}return sn.debug&&sn.log("Invalid 'sides' value: "+sn.stringify(e)),this},fn.prototype.set=function(t,n){n=ln.parse(n);if(null!=n)switch(t){case"all":fn.names.forEach(function(e){this[e]=n},this);break;case"width":this.left=this.right=ln.divide(n,2);break;case"height":this.top=this.bottom=ln.divide(n,2);break;default:e.hasOwn(fn.namesSet,t)&&(this[t]=n)}},fn.prototype.resolve=function(e,t){"object"==typeof e&&(t=e.height,e=e.width);var n={};return fn.names.forEach(function(r){var i=0,s=this[r];null!=s&&(i="number"==typeof s?s:s.resolve("left"===r||"right"===r?e:t)),n[r]=i},this),fn.updateSize(n)},fn.updateSize=function(e){return e.width=(e.left||0)+(e.right||0),e.height=(e.bottom||0)+(e.top||0),e},fn.resolvedMax=function(e,t){var n={};return fn.names.forEach(function(r){n[r]=Math.max(e[r]||0,t[r]||0)}),n},fn.inflate=function(e,t){var n={};return fn.names.forEach(function(r){n[r]=(e[r]||0)+t}),fn.updateSize(n)};var ln=sn.PercentValue=function(e){this.percent=e};ln.prototype.resolve=function(e){return this.percent*e},ln.prototype.divide=function(e){return new ln(this.percent/e)},ln.divide=function(e,t){return e instanceof ln?e.divide(t):e/t},ln.parse=function(t){if(null!=t&&""!==t){switch(typeof t){case"number":return t;case"string":var n=t.match(/^(.+?)\s*(%)?$/);if(n){var r=+n[1];if(!isNaN(r)){if(!n[2])return r;if(r>=0)return new ln(r/100)}}break;case"object":if(t instanceof ln)return t}sn.debug&&sn.log(e.format("Invalid margins component '{0}'",[""+t]))}},ln.resolve=function(e,t){return e instanceof ln?e.resolve(t):e};var cn=on.prototype.zOrder;on.prototype.zOrder=function(e){var t=this.borderPanel;return t&&t!==this?cn.call(t,e):cn.call(this,e)},on.prototype.wrapper=function(e){return this._wrapper=e,this},on.prototype.wrap=function(t,n){return t&&e.fun.is(t)&&this._wrapper&&!t._cccWrapped&&(t=this._wrapper(t,n),t._cccWrapped=!0),t},t.Mark.prototype.call=function(e){e.call(this,this)},on.prototype.lock=function(e,t){return void 0!==t&&this[e](t),(this._locked||(this._locked={}))[e]=!0,this},on.prototype.isIntercepted=function(e){return this._intercepted&&this._intercepted[e]},on.prototype.isLocked=function(e){return this._locked&&this._locked[e]},on.prototype.ensureEvents=function(e){var t=this.propertyValue("events",!0);return t&&"none"!==t||this.events(e||"all"),this},on.prototype.addMargin=function(n,r){if(0!==r){var i=e.nullyTo(this.propertyValue(n),0),s=t.functor(i);this[n](function(){return r+s.apply(this,un.call(arguments))})}return this},on.prototype.addMargins=function(t){var n=e.get(t,"all",0);return this.addMargin("left",e.get(t,"left",n)),this.addMargin("right",e.get(t,"right",n)),this.addMargin("top",e.get(t,"top",n)),this.addMargin("bottom",e.get(t,"bottom",n)),this},on.prototype.eachInstanceWithData=function(e,t){this.eachInstance(function(n,r,i){n.mark.sign&&n[r].data&&e.call(t,n,r,i)})},on.prototype.eachSceneWithDataOnRect=function(e,t,n,r){function i(r,i){if(r.intersectsRect(e)){var s=i.data;s&&s.datum&&t.call(n,s)}}var s=this,o=s.sign;if(!o||o.selectable()){null==r&&(r=s.rubberBandSelectionMode||"partial");var u="center"===r;s.eachInstanceWithData(function(e,t,n){var r=s.getShape(e,t,.15);r=(u?r.center():r).apply(n),i(r,e[t])})}},on.prototype.eachDatumOnRect=function(e,t,n,r){function i(r,i){if(r.intersectsRect(e)){var s=i.data;s&&s.datum&&s.datums().each(function(e){e.isNull||t.call(n,e)})}}var s=this,o=s.sign;if(!o||o.selectable()){null==r&&(r=s.rubberBandSelectionMode||"partial");var u="center"===r;s.eachInstanceWithData(function(e,t,n){var r=s.getShape(e,t,.15);r=(u?r.center():r).apply(n),i(r,e[t])})}},t.Transform.prototype.transformHPosition=function(e){return this.x+this.k*e},t.Transform.prototype.transformVPosition=function(e){return this.y+this.k*e},t.Transform.prototype.transformLength=function(e){return this.k*e};var hn=e.type("pvc.Size").init(function(e,t){1===arguments.length?null!=e&&this.setSize(e):(null!=e&&(this.width=e),null!=t&&(this.height=t))}).add({stringify:function(t,n,r){return sn.stringifyRecursive(t,e.copyOwn(this),n,r)},setSize:function(t,n){if("string"==typeof t){var r=t.split(/\s+/).map(function(e){return ln.parse(e)});switch(r.length){case 1:return this.set(e.get(n,"singleProp","all"),r[0]),this;case 2:return this.set("width",r[0]),this.set("height",r[1]),this;case 0:return this}}else{if("number"==typeof t)return this.set(e.get(n,"singleProp","all"),t),this;if("object"==typeof t){if(t instanceof ln)this.set(e.get(n,"singleProp","all"),t);else{this.set("all",t.all);for(var i in t)"all"!==i&&this.set(i,t[i])}return this}}return sn.debug&&sn.log("Invalid 'size' value: "+sn.stringify(t)),this},set:function(t,n){return null!=n&&("all"===t||e.hasOwn(hn.namesSet,t))&&(n=ln.parse(n),null!=n&&("all"===t?hn.names.forEach(function(e){this[e]=n},this):this[t]=n)),this},clone:function(){return new hn(this.width,this.height)},intersect:function(e){return new hn(Math.min(this.width,e.width),Math.min(this.height,e.height))},resolve:function(e){var t={};return hn.names.forEach(function(n){var r=this[n];if(null!=r)if("number"==typeof r)t[n]=r;else if(e){var i=e[n];null!=i&&(t[n]=r.resolve(i))}},this),t}});hn.names=["width","height"],hn.namesSet=t.dict(hn.names,e.retTrue),hn.toOrtho=function(e,t){if(null!=e){var n;t&&(n=sn.BasePanel.orthogonalLength[t]),e=hn.to(e,{singleProp:n}),t&&delete e[sn.BasePanel.oppositeLength[n]]}return e},hn.to=function(e,t){return null==e||e instanceof hn||(e=(new hn).setSize(e,t)),e};var pn=e.type("pvc.Offset").init(function(e,t){1===arguments.length?null!=e&&this.setOffset(e):(null!=e&&(this.x=e),null!=t&&(this.y=t))}).add({stringify:function(t,n,r){return sn.stringifyRecursive(t,e.copyOwn(this),n,r)},setOffset:function(t,n){if("string"==typeof t){var r=t.split(/\s+/).map(function(e){return ln.parse(e)});switch(r.length){case 1:return this.set(e.get(n,"singleProp","all"),r[0]),this;case 2:return this.set("x",r[0]),this.set("y",r[1]),this;case 0:return this}}else{if("number"==typeof t)return this.set(e.get(n,"singleProp","all"),t),this;if("object"==typeof t){this.set("all",t.all);for(var i in t)"all"!==i&&this.set(i,t[i]);return this}}return sn.debug&&sn.log("Invalid 'offset' value: "+sn.stringify(t)),this},set:function(t,n){null!=n&&e.hasOwn(pn.namesSet,t)&&(n=ln.parse(n),null!=n&&("all"===t?pn.names.forEach(function(e){this[e]=n},this):this[t]=n))},resolve:function(e){var t={};return hn.names.forEach(function(n){var r=pn.namesSizeToOffset[n],i=this[r];if(null!=i)if("number"==typeof i)t[r]=i;else if(e){var s=e[n];null!=s&&(t[r]=i.resolve(s))}},this),t}});pn.addStatic({names:["x","y"]}).addStatic({namesSet:t.dict(pn.names,e.retTrue),namesSizeToOffset:{width:"x",height:"y"},namesSidesToOffset:{left:"x",right:"x",top:"y",bottom:"y"},as:function(e){return null==e||e instanceof pn||(e=(new pn).setOffset(e)),e}}),sn.round10=function(e,t){return t?(e=+e,isNaN(e)||"number"!=typeof t||0!==t%1?0/0:(e=Math.round(u(e,t)),u(e,-t))):Math.round(e)},sn.mult10=function(e,t){return t?u(+e,t):e},null==n.support.svg&&(n.support.svg=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")),sn.text={getFitInfo:function(e,n,r,i,s){if(""===r)return{h:!0,v:!0,d:!0};var o=t.Text.measureWidth(r,i);return{h:e>=o,v:n>=o,d:o<=Math.sqrt(e*e+n*n)-s}},trimToWidthB:function(e,n,r,i,s){var o=t.Text.measureWidth(i,r),u=1.5*o;return sn.text.trimToWidth(e,n,r,i,s,u)},trimToWidth:function(e,n,r,i,s,o){if(""===n)return n;var u=t.Text.measureWidth(n,r);if(e>=u)return n;if(u>1.5*e)return sn.text.trimToWidthBin(e,n,r,i,s,o);e-=t.Text.measureWidth(i,r);for(;u>e;)n=s?n.slice(1):n.slice(0,n.length-1),u=t.Text.measureWidth(n,r);return o&&o>=u?"":s?i+n:n+i},trimToWidthBin:function(e,n,r,i,s,o){e-=t.Text.measureWidth(i,r);for(var u,a,f=n.length,l=f-2,c=0;l>=c&&l>0;){u=Math.ceil((c+l)/2);var h=s?n.slice(f-u):n.slice(0,u);a=t.Text.measureWidth(h,r);if(a>e)l=u-1;else{if(!(t.Text.measureWidth(s?n.slice(f-u-1):n.slice(0,u+1),r)<e))return o&&o>=a?"":s?i+h:h+i;c=u+1}}return n=s?n.slice(f-l):n.slice(0,l),a=n.length,o&&o>=a?"":s?i+n:n+i},justify:function(e,n,r){var i=[];if(n<t.Text.measureWidth("a",r))return i;for(var s=(e||"").split(/\s+/),o="";s.length;){var u=s.shift();if(u){var a=o?o+" "+u:u;t.Text.measureWidth(a,r)>n?(o&&i.push(o),o=u):o=a}}return o&&i.push(o),i},getLabelBBox:function(e,n,r,i,s,o){var u=t.Label.getPolygon(e,n,r,i,s,o),a=u.bbox();return a.source=u,a.sourceAngle=s,a.sourceAlign=r,a.sourceTextWidth=e,a}},sn.color={scale:l,scales:f,toGray:sn.toGrayScale,isGray:a},e.type("pvc.color.ScalesBuild").init(function(n){this.keyArgs=n,this.data=n.data||e.fail.argumentRequired("keyArgs.data"),this.domainDimName=n.colorDimension||e.fail.argumentRequired("keyArgs.colorDimension"),this.domainDim=this.data.dimensions(this.domainDimName);var r=this.domainDim.type;r.isComparable?this.domainComparer=function(e,t){return r.compare(e,t)}:(this.domainComparer=null,sn.log("Color value dimension should be comparable. Generated color scale may be invalid.")),this.nullRangeValue=n.colorMissing?t.color(n.colorMissing):t.Color.transparent,this.domainRangeCountDif=0}).add({build:function(){this.range=this._getRange(),this.desiredDomainCount=this.range.length+this.domainRangeCountDif;var e=this._getDomain();return this._createScale(e)},buildMap:function(){this.range=this._getRange(),this.desiredDomainCount=this.range.length+this.domainRangeCountDif;var t;if(this.keyArgs.normPerBaseCategory)t=function(e){var t=this._ensureDomain(null,!1,e);return this._createScale(t)};else{var n=this._getDomain(),r=this._createScale(n);t=e.fun.constant(r)}return this._createCategoryScalesMap(t)},_createScale:e.method({isAbstract:!0}),_createCategoryScalesMap:function(e){return this.data.children().object({name:function(e){return e.absKey},value:e,context:this})},_getRange:function(){var e=this.keyArgs,n=e.colors||["red","yellow","green"];return null!=e.colorMin&&null!=e.colorMax?n=[e.colorMin,e.colorMax]:null!=e.colorMin?n.unshift(e.colorMin):null!=e.colorMax&&n.push(e.colorMax),n.map(function(e){return t.color(e)})},_getDataExtent:function(e){var t=e.dimensions(this.domainDimName).extent({visible:!0});if(!t)return null;var n=t.min.value,r=t.max.value;return r==n&&(r>=1?n=r-1:r=n+1),{min:n,max:r}},_getDomain:function(){var e=this.keyArgs.colorDomain;return null!=e?(e=e.slice(),this.domainComparer&&e.sort(this.domainComparer),e.length>this.desiredDomainCount&&(e=e.slice(0,this.desiredDomainCount))):e=[],this._ensureDomain(e,!0,this.data)},_ensureDomain:function(n,r,i){var s;if(n&&r){var o=this.desiredDomainCount-n.length;if(o>0){s=this._getDataExtent(i);if(s)switch(o){case 1:this.domainComparer?e.array.insert(n,s.max,this.domainComparer):n.push(s.max);break;case 2:this.domainComparer?(e.array.insert(n,s.min,this.domainComparer),e.array.insert(n,s.max,this.domainComparer)):(n.unshift(s.min),n.push(s.max));break;default:sn.debug>=2&&sn.log("Ignoring option 'colorDomain' due to unsupported length."+e.format(" Should have '{0}', but instead has '{1}'.",[this.desiredDomainCount,n.length])),n=null}}}if(!n){s||(s=this._getDataExtent(i));if(s){var u=s.min,a=s.max,f=(a-u)/(this.desiredDomainCount-1);n=t.range(u,a+f,f)}}return n}}),e.type("pvc.color.LinearScalesBuild",sn.color.ScalesBuild).add({_createScale:function(e){var n=t.Scale.linear();return e&&n.domain.apply(n,e),n.range.apply(n,this.range),n}}),e.type("pvc.color.DiscreteScalesBuild",sn.color.ScalesBuild).init(function(e){this.base(e),this.domainRangeCountDif=1}).add({_createScale:function(n){function r(e){if(null==e)return o;for(var t=0;i>t;t++)if(e<=n[t+1])return s[t];return s[u]}var i=n.length-1,s=this.range,o=this.nullRangeValue,u=s.length-1;return e.copy(r,t.Scale.common),r.domain=function(){return n},r.range=function(){return s},r}}),e.space("pvc.trends",function(t){var n={};e.set(t,"define",function(t,r){t||e.fail.argumentRequired("type"),r||e.fail.argumentRequired("trendSpec"),e.object.is(r)||e.fail.argumentInvalid("trendSpec","Must be a trend specification object."),t=(""+t).toLowerCase(),sn.debug>=2&&e.hasOwn(n,t)&&sn.log(e.format("[WARNING] A trend type with the name '{0}' is already defined.",[t]));var i=r.label||e.fail.argumentRequired("trendSpec.label"),s=r.model||e.fail.argumentRequired("trendSpec.model");e.fun.is(s)||e.fail.argumentInvalid("trendSpec.mode","Must be a function.");var o={dataPartAtom:{v:"trend",f:i},type:t,label:i,model:s};n[t]=o},"get",function(t){return t||e.fail.argumentRequired("type"),e.getOwn(n,t)||e.fail.operationInvalid("Undefined trend type '{0}'.",[t])},"has",function(t){return e.hasOwn(n,t)},"types",function(){return e.ownKeys(n)}),t.define("linear",{label:"Linear trend",model:function(t){for(var n=e.get(t,"rows"),r=e.get(t,"x"),i=e.get(t,"y"),s=0,o=0,u=0,a=0,f=0,l=0,c=function(e){return null!=e?+e:0/0};n.next();){var h=n.item,p=r?c(r(h)):s;if(!isNaN(p)){var d=c(i(h));isNaN(d)||(o++,u+=p,a+=d,f+=p*d,l+=p*p)}s++}var v,m;if(o>=2){var g=u/o,y=a/o,b=f/o,w=l/o,E=w-g*g;return m=0===E?0:(b-g*y)/E,v=y-m*g,{alpha:v,beta:m,reset:e.noop,sample:function(e){return v+m*+e}}}}}),t.define("moving-average",{label:"Moving average",model:function(t){var n=Math.max(+(e.get(t,"periods")||3),2),r=0,i=[];return{reset:function(){r=0,i.length=0},sample:function(e,t){var s=n;return null!=t&&(i.unshift(t),r+=t,s=i.length,s>n&&(r-=i.pop(),s=n)),r/s}}}}),t.define("weighted-moving-average",{label:"Weighted Moving average",model:function(t){var n=Math.max(+(e.get(t,"periods")||3),2),r=0,i=0,s=[],o=0,u=0;return{reset:function(){r=i=u=o=0,s.length=0},sample:function(e,t){if(null!=t)if(n>o)s.push(t),o++,u+=o,i+=o*t,r+=t;else{i+=o*t-r,r+=t-s[0];for(var a=1;n>a;a++)s[a-1]=s[a];s[n-1]=t}return i/u}}}})}),c.resolvers=h,c.constant=p,c.specify=d,c.defaultValue=v,sn.options=c;var dn=e.type().init(function(t,n,r,i){this.name=t,this.option=n,this._dv=this.value=e.get(i,"value"),this._resolve=e.get(i,"resolve");var s=!this._resolve;this.isResolved=s,this.isSpecified=!1,this._setCalled=!1,this._context=r,this._cast=e.get(i,"cast"),this._getDefault=s?null:e.get(i,"getDefault"),this.data=e.get(i,"data")}).add({resolve:function(){if(!this.isResolved){this.isResolved=!0,this._setCalled=!1,this._getFunProp("_resolve").call(this._context,this);if(!this._setCalled){this.isSpecified=!1;var e=this._dynDefault();null!=e&&(this.value=this._dv=e)}}return this},specify:function(e){return this.set(e,!1)},defaultValue:function(e){return arguments.length&&this.set(e,!0),this._dv},cast:function(e){if(null!=e){var t=this._getFunProp("_cast");t&&(e=t.call(this._context,e,this))}return e},set:function(e,t){this._setCalled=!0,null!=e&&(e=this.cast(e));if(null==e){e=this._dynDefault();if(null==e){if(!this.isSpecified)return this;e=this._dv}t=!0}return t?(this._dv=e,this.isSpecified||(this.value=e)):(this.isResolved=this.isSpecified=!0,this.value=e),this},_dynDefault:function(){var e=this._getFunProp("_getDefault");return e&&this.cast(e.call(this._context,this))},_getFunProp:function(e){var t=this[e];if(t){var n=this._context;n&&"string"==typeof t&&(t=n[t])}return t}}),vn=sn.numberFormatStyle=function(e,t){return new m(e,t)},mn=e.shared().property("safe");sn.NumberFormatStyle=m,e.classAccessors(m,mn,{decimal:{cast:String,fail:e.falsy},group:{cast:String},groupSizes:{fail:e.array.empty},negativeSign:{cast:String,fail:e.falsy},currency:{cast:String,fail:e.falsy},integerPad:{cast:String,fail:e.falsy},fractionPad:{cast:String,fail:e.falsy}}),e.copyOwn(m.prototype,{tryConfigure:function(t){if(e.is(t,vn))return e.configureGeneric(this,mn(t)),!0}}),vn.defaults=vn({integerPad:"0",fractionPad:"0",decimal:".",group:",",groupSizes:[3],negativeSign:"-",currency:"$"});var gn=sn.numberFormat=function(){function t(e){return r||(r=y(n.mask)),r(e,mn(n.style))}var n,r;return t.format=t,t.tryConfigure=g,n=e.instance(t,gn,mn,arguments,{mask:{cast:String,change:function(){r=null}},style:{cast:e.createAs(m),factory:vn}}),t};gn.defaults=gn().style(vn()),gn.cacheLimit=20;var yn={},bn=0,wn=sn.dateFormat=function(){function t(e){return r||(r=j(n.mask)),r(e)}var n,r;return t.format=t,t.tryConfigure=B,n=e.instance(t,wn,mn,arguments,{mask:{cast:String,change:function(){r=null}}}),arguments.length&&e.configure(t,arguments[0]),t};wn.defaults=wn();var En=sn.customFormat=function(){function t(){var e=n.formatter;return String(e&&e.apply(null,arguments))}var n;return t.format=t,t.tryConfigure=F,n=e.instance(t,En,mn,arguments,{formatter:{cast:e.fun.as}}),t};En.defaults=En().formatter(I);var Sn=sn.format=function(){function t(){}return t.tryConfigure=R,e.instance(t,Sn,mn,arguments,{number:q(gn),percent:q(gn),date:q(wn),any:{cast:e.createAs(En),factory:En}}),t};Sn.defaults=Sn({number:"#,0.##",percent:"#,0.#%",date:"%Y/%m/%d",any:En()}),e.global.NoDataException=function(){},e.global.InvalidDataException=function(e){this.message=e?e:"Invalid Data."},sn.data={visibleKeyArgs:{visible:!0}},e.type("pvc.data.DimensionType").init(function(n,r,i){this.complexType=n,this.name=r,this.label=e.get(i,"label")||sn.buildTitleFromName(r);var s=sn.splitIndexedId(r);this.group=s[0],this.groupLevel=e.nullyTo(s[1],0),this.label.indexOf("{")>=0&&(this.label=e.format(this.label,[this.groupLevel+1])),this.playedVisualRoles=new e.Map,this.isHidden=!!e.get(i,"isHidden");var o=e.get(i,"valueType")||null,u=sn.data.DimensionType.valueTypeName(o),a=e.getOwn(sn.data.DimensionType.cast,u,null);this.valueType=o,this.valueTypeName=u,this.cast=a;var f=this.valueType===Number,l=!f&&this.valueType===Date;this.isDiscreteValueType=!f&&!l,this.isDiscrete=e.get(i,"isDiscrete");if(null==this.isDiscrete)this.isDiscrete=this.isDiscreteValueType;else{this.isDiscrete=!!this.isDiscrete;if(!this.isDiscrete&&this.isDiscreteValueType)throw e.error.argumentInvalid("isDiscrete","The only supported continuous value types are Number and Date.")}this._converter=e.get(i,"converter")||null;if(!this._converter){var c=e.get(i,"rawFormat");if(c)switch(this.valueType){case Date:this._converter=t.Format.createParser(t.Format.date(c))}}this._key=e.get(i,"key")||null,this._comparer=e.get(i,"comparer");if(void 0===this._comparer)switch(this.valueType){case Number:case Date:this._comparer=e.compare;break;default:this._comparer=null}this.isComparable=null!=this._comparer;var h,p=e.get(i,"formatter"),d=e.get(i,"formatProto"),v=f?"number":l?"date":"any";p?h=sn.format(e.set({},v,p),d):this.isDiscreteValueType?h=Sn(null,d):(h=e.get(i,"format"),!h&&!f&&(h=e.get(i,"rawFormat"),h&&(h=h.replace(/-/g,"/"))),h?e.is(h,Sn)||((e.string.is(h)||e.fun.is(h)&&!e.classOf(h))&&(h=e.set({},v,h)),h=Sn(h,d)):h=Sn(null,d),p=h[v]()),this._formatter=p||null,this._format=h||null}).add({isCalculated:!1,compare:function(e,t){return null==e?null==t?0:-1:null==t?1:this._comparer.call(null,e,t)},comparer:function(e){if(!this.isComparable)return null;var t=this;return e?this._rc||(this._rc=function(e,n){return t.compare(n,e)}):this._dc||(this._dc=function(e,n){return t.compare(e,n)})},atomComparer:function(e){return e?this._rac||(this._rac=this._createReverseAtomComparer()):this._dac||(this._dac=this._createDirectAtomComparer())},_toDiscrete:function(){this.isDiscrete=!0},_toCalculated:function(){this.isCalculated=!0},_createReverseAtomComparer:function(){function e(e,n){return e===n?0:t.compare(n.value,e.value)}if(!this.isComparable)return Q;var t=this;return e},_createDirectAtomComparer:function(){function e(e,n){return e===n?0:t.compare(e.value,n.value)}if(!this.isComparable)return K;var t=this;return e},format:function(){return this._format},formatter:function(){return this._formatter},converter:function(){return this._converter},playingPercentVisualRole:function(){return e.query(this.playedVisualRoles.values()).any(function(e){return e.isPercent})}}),sn.data.DimensionType.cast={Date:function(e){return e instanceof Date?e:new Date(e)},Number:function(e){return e=Number(e),isNaN(e)?null:e},String:String,Boolean:Boolean,Object:Object,Any:null},sn.data.DimensionType.dimensionGroupName=function(e){return e.replace(/^(.*?)(\d*)$/,"$1")},sn.data.DimensionType.valueTypeName=function(t){if(null==t)return"Any";switch(t){case Boolean:return"Boolean";case Number:return"Number";case String:return"String";case Object:return"Object";case Date:return"Date";default:throw e.error.argumentInvalid("valueType","Invalid valueType function: '{0}'.",[t])}},sn.data.DimensionType.extendSpec=function(t,n,r){var i=sn.data.DimensionType.dimensionGroupName(t),s=e.get(r,"dimensionGroups");if(s){var o=s[i];o&&(n=e.create(o,n))}n||(n={});switch(i){case"category":var u=e.get(r,"isCategoryTimeSeries",!1);u&&void 0===n.valueType&&(n.valueType=Date);break;case"value":void 0===n.valueType&&(n.valueType=Number)}return void 0!==n.converter||n.valueType!==Date||n.rawFormat||(n.rawFormat=e.get(r,"timeSeriesFormat")),n.formatProto=e.get(r,"formatProto"),n},e.type("pvc.data.ComplexType").init(function(e){this._dims={},this._dimsList=[],this._dimsNames=[],this._calculations=[],this._calculatedDimNames={},this._dimsIndexByName=null,this._dimsByGroup={},this._dimsNamesByGroup={};if(e)for(var t in e)this.addDimension(t,e[t])}).add({describe:function(){var e=["COMPLEX TYPE INFORMATION",sn.logSeparator];return this._dimsList.forEach(function(t){var n=[];n.push(t.valueTypeName),t.isComparable&&n.push("comparable"),t.isDiscrete||n.push("continuous"),t.isHidden&&n.push("hidden"),e.push("  "+t.name+" ("+n.join(", ")+")")}),e.join("\n")},dimensions:function(t,n){if(null==t)return this._dims;var r=e.getOwn(this._dims,t,null);if(!r&&e.get(n,"assertExists",!0))throw e.error.argumentInvalid("name","Undefined dimension '{0}'",[t]);return r},dimensionsList:function(){return this._dimsList},calculatedDimensionsList:function(){return this._calcDimsList},dimensionsNames:function(){return this._dimsNames},groupDimensions:function(t,n){var r=e.getOwn(this._dimsByGroup,t);if(!r&&e.get(n,"assertExists",!0))throw e.error.operationInvalid("There is no dimension type group with name '{0}'.",[t]);return r},groupDimensionsNames:function(t,n){var r=e.getOwn(this._dimsNamesByGroup,t);if(!r&&e.get(n,"assertExists",!0))throw e.error.operationInvalid("There is no dimension type group with name '{0}'.",[t]);return r},addDimension:function(t,n){t||e.fail.argumentRequired("name"),!e.hasOwn(this._dims,t)||e.fail.operationInvalid("A dimension type with name '{0}' is already defined.",[t]);var r=new sn.data.DimensionType(this,t,n);this._dims[t]=r,this._dimsIndexByName=null;var i,s=r.group;if(s){var o,u=e.getOwn(this._dimsByGroup,s);u?o=this._dimsNamesByGroup[s]:(u=this._dimsByGroup[s]=[],o=this._dimsNamesByGroup[s]=[]),i=e.array.insert(o,t,e.compare),i=~i,e.array.insertAt(u,i,r)}var a,f=this._dimsList.length;if(s){i=r.groupLevel;for(var l=0;f>l;l++){var c=this._dimsList[l];if(c.group===s){if(c.groupLevel>i){a=l;break}a=l+1}}null==a&&(a=f)}else a=f;return e.array.insertAt(this._dimsList,a,r),e.array.insertAt(this._dimsNames,a,t),r._calculate&&(a=e.array.binarySearch(this._calcDimsList,r._calculationOrder,e.compare,function(e){return e._calculationOrder}),a>=0?a++:a=~a,e.array.insertAt(this._calcDimsList,a,r)),this._isPctRoleDimTypeMap=null,r},addCalculation:function(t,n){t||e.fail.argumentRequired("calcSpec");var r=t.calculation||e.fail.argumentRequired("calculations[i].calculation"),i=t.names;i="string"==typeof i?i.split(/\s*\,\s*/):e.array.as(i);if(i&&i.length){var s=this._calculatedDimNames;i.forEach(function(t){if(t){t=t.replace(/^\s*(.+?)\s*$/,"$1"),!e.hasOwn(s,t)||e.fail.argumentInvalid("calculations[i].names","Dimension name '{0}' is already being calculated.",[t]);var r=this._dims[t];if(!r){var i=sn.data.DimensionType.extendSpec(t,null,n);this.addDimension(t,i)}s[t]=!0,r._toCalculated()}},this)}this._calculations.push(r)},isCalculated:function(t){return e.hasOwn(this._calculatedDimNames,t)},_calculate:function(e){var t=this._calculations,n=t.length;if(n){for(var r={},i=0;n>i;i++){var s=t[i];s(e,r)}return r}},getPlayingPercentVisualRoleDimensionMap:function(){var t=this._isPctRoleDimTypeMap;return t||(t=this._isPctRoleDimTypeMap=new e.Map(e.query(e.own(this._dims)).where(function(e){return e.playingPercentVisualRole()}).object({name:function(e){return e.name}}))),t},sortDimensionNames:function(t,n){var r=this._dimsIndexByName;return r||(r=e.query(this._dimsList).object({name:function(e){return e.name},value:function(e,t){return t}}),this._dimsIndexByName=r),t.sort(function(t,i){return e.compare(r[n?n(t):t],r[n?n(i):i])}),t}}),e.type("pvc.data.ComplexTypeProject").init(function(e){this._dims={},this._dimList=[],this._dimGroupsDims={},this._dimGroupSpecs=e||{},this._calcList=[]}).add({_ensureDim:function(t,n){t||e.fail.argumentInvalid("name","Invalid dimension name '{0}'.",[t]);var r=e.getOwn(this._dims,t);if(r)n&&e.setUDefaults(r.spec,n);else{r=this._dims[t]=this._createDim(t,n),this._dimList.push(r);var i=e.array.lazy(this._dimGroupsDims,r.groupName);e.array.insert(i,t,e.compare)}return r},hasDim:function(t){return e.hasOwn(this._dims,t)},setDim:function(t,n){var r=this._ensureDim(t).spec;return n&&e.copy(r,n),this},setDimDefaults:function(t,n){return e.setUDefaults(this._ensureDim(t).spec,n),this},_createDim:function(t,n){var r=sn.data.DimensionType.dimensionGroupName(t),i=this._dimGroupSpecs[r];return i&&(n=e.create(i,n)),{name:t,groupName:r,spec:n||{}}},readDim:function(t,n){var r=this._ensureDim(t,n);if(r.isRead)throw e.error.operationInvalid("Dimension '{0}' already is the target of a reader.",[t]);if(r.isCalc)throw e.error.operationInvalid("Dimension '{0}' is being calculated, so it cannot be the target of a reader.",[t]);r.isRead=!0},calcDim:function(t,n){var r=this._ensureDim(t,n);if(r.isCalc)throw e.error.operationInvalid("Dimension '{0}' already is being calculated.",[t]);if(r.isRead)throw e.error.operationInvalid("Dimension '{0}' is the target of a reader, so it cannot be calculated.",[t]);r.isCalc=!0},isReadOrCalc:function(t){if(t){var n=e.getOwn(this._dims,t);if(n)return n.isRead||n.isCalc}return!1},groupDimensionsNames:function(e){return this._dimGroupsDims[e]},setCalc:function(t){t||e.fail.argumentRequired("calculations[i]"),t.calculation||e.fail.argumentRequired("calculations[i].calculation");var n=t.names;n="string"==typeof n?n.split(/\s*\,\s*/):e.array.as(n),n&&n.length&&n.forEach(this.calcDim,this),this._calcList.push(t)},configureComplexType:function(e,t){this._dimList.forEach(function(n){var r=n.name,i=n.spec;i=sn.data.DimensionType.extendSpec(r,i,t),e.addDimension(r,i)}),this._calcList.forEach(function(n){e.addCalculation(n,t)})}}),e.type("pvc.data.TranslationOper").init(function(t,n,r,i,s){this.chart=t,this.complexTypeProj=n,this.source=r||e.fail.argumentRequired("source"),this.metadata=i||e.fail.argumentRequired("metadata"),this.options=s||{},this._initType(),sn.debug>=4&&(this._logItems=!0,this._logItemCount=0)}).add({_logItems:!1,logSource:e.method({isAbstract:!0}),logVItem:e.method({isAbstract:!0}),_translType:"Unknown",logTranslatorType:function(){return this._translType+" data source translator"},virtualItemSize:function(){return this.metadata.length},freeVirtualItemSize:function(){return this.virtualItemSize()-this._userUsedIndexesCount},setSource:function(t){if(!t)throw e.error.argumentRequired("source");this.source=t},defReader:function(t){t||e.fail.argumentRequired("readerSpec");var n;n=e.string.is(t)?t:t.names,n=e.string.is(n)?n.split(/\s*\,\s*/):e.array.as(n);var r=e.array.as(t.indexes);r&&r.forEach(this._userUseIndex,this);var i=!!n&&!!n.length,s=t.reader;if(s)i||e.fail.argumentRequired("reader.names","Required argument when a reader function is specified."),this._userRead(s,n);else{if(i)return this._userCreateReaders(n,r);r&&r.forEach(function(e){this._userIndexesToSingleDim[e]=null},this)}return r},configureType:function(){this._configureTypeCore()},_configureTypeCore:e.method({isAbstract:!0}),_initType:function(){this._userDimsReaders=[],this._userDimsReadersByDim={},this._userItem=[],this._userUsedIndexes={},this._userUsedIndexesCount=0,this._userIndexesToSingleDim=[];var e=this.options.readers;e&&e.forEach(this.defReader,this);var t=sn.parseDistinctIndexArray(this.options.multiChartIndexes);t&&(this._multiChartIndexes=this.defReader({names:"multiChart",indexes:t}))},_userUseIndex:function(t){t=+t;if(0>t)throw e.error.argumentInvalid("index","Invalid reader index: '{0}'.",[t]);if(e.hasOwn(this._userUsedIndexes,t))throw e.error.argumentInvalid("index","Virtual item index '{0}' is already assigned.",[t]);return this._userUsedIndexes[t]=!0,this._userUsedIndexesCount++,this._userItem[t]=!0,t},_userCreateReaders:function(t,n){n?n.forEach(function(e,t){n[t]=+e}):n=[];var r,i=n.length,s=t.length;if(s>i){var o=i>0?n[i-1]+1:0;do o=this._nextAvailableItemIndex(o),n[i]=o,this._userUseIndex(o),i++;while(s>i)}for(var u,a=i===s?s:s-1,f=0;a>f;f++)r=t[f],u=n[f],this._userIndexesToSingleDim[u]=r,this._userRead(this._propGet(r,u),r);if(s>a)for(var l=sn.splitIndexedId(t[s-1]),c=l[0],h=e.nullyTo(l[1],0),p=a;i>p;p++,h++)r=sn.buildIndexedId(c,h),u=n[p],this._userIndexesToSingleDim[u]=r,this._userRead(this._propGet(r,u),r);return n},_userRead:function(t,n){e.fun.is(t)||e.fail.argumentInvalid("reader","Reader must be a function."),e.array.is(n)?n.forEach(function(e){this._readDim(e,t)},this):this._readDim(n,t),this._userDimsReaders.push(t)},_readDim:function(e,t){var n,r,i=this._userIndexesToSingleDim.indexOf(e);if(i>=0){n=this._itemInfos[i];if(n&&!this.options.ignoreMetadataLabels){var s=n.label||n.name;s&&(r={label:s})}}this.complexTypeProj.readDim(e,r),this._userDimsReadersByDim[e]=t},execute:function(e){return this.data=e,this._executeCore()},_executeCore:function(){var t=this._getDimensionsReaders();return e.query(this._getItems()).select(function(e){return this._readItem(e,t)},this)},_getItems:function(){return this.source},_getDimensionsReaders:function(){return this._userDimsReaders},_readItem:function(e,t){for(var n=this._logItems&&this._logItemBefore(e),r=0,i=t.length,s=this.data,o={};i>r;)t[r++].call(s,e,o);return n&&this._logItemAfter(o),o},_logItemBefore:function(e){return this._logItemCount<10?(sn.log("virtual item ["+this._logItemCount++ +"]: "+sn.stringify(e)),!0):(sn.log("..."),this._logItems=!1)},_logItemAfter:function(t){var n={};for(var r in t){var i=t[r];e.object.is(i)&&(i="v"in i?i.v:"value"in i?i.value:"..."),n[r]=i}sn.log("-> read: "+sn.stringify(n))},_propGet:function(e,t){function n(n,r){r[e]=n[t]}return n},_nextAvailableItemIndex:function(t,n){null==t&&(t=0),null==n&&(n=1/0);for(;n>t&&e.hasOwn(this._userItem,t);)t++;return n>t?t:-1},_getUnboundRoleDefaultDimNames:function(e,t,n,r){var i=this.chart.visualRoles[e];if(i&&!i.isPreBound()){var s=i.defaultDimensionName;if(s){s=s.match(/^(.*?)(\*)?$/)[1],n||(n=[]),null==r&&(r=0),null==t&&(t=1);for(;t--;){var o=sn.buildIndexedId(s,r++);this.complexTypeProj.isReadOrCalc(o)||n.push(o)}return n.length?n:null}}},collectFreeDiscreteAndConstinuousIndexes:function(e,t){this._itemInfos.forEach(function(n,r){if(!this._userUsedIndexes[r]){var i=1===n.type?t:e;i&&i.push(r)}},this)}}),e.type("pvc.data.MatrixTranslationOper",sn.data.TranslationOper).add({_initType:function(){this.J=this.metadata.length,this.I=this.source.length,this._processMetadata(),this.base()},setSource:function(e){this.base(e),this.I=this.source.length},_knownContinuousColTypes:{numeric:1,number:1,integer:1},_processMetadata:function(){for(var t=this._knownContinuousColTypes,n=e.query(this.metadata).select(function(e,t){return e.colIndex=t,e}).where(function(e){var n=e.colType;return!n||1!==t[n.toLowerCase()]}).select(function(e){return e.colIndex}).array(),r=e.array.create(this.J,1),i=this.I,s=this.source,o=n.length,u=0;i>u&&o>0;u++)for(var a=s[u],f=0;o>f;){var l=n[f],c=a[l];null!=c?(r[l]=this._getSourceValueType(c),n.splice(f,1),o--):f++}this._columnTypes=r},_buildItemInfoFromMetadata:function(e){var t=this.metadata[e];return{type:this._columnTypes[e],name:t.colName,label:t.colLabel}},_getSourceValueType:function(e){switch(typeof e){case"number":return 1;case"object":if(e instanceof Date)return 1}return 0},logSource:function(){var t=["DATA SOURCE SUMMARY",sn.logSeparator,"ROWS ("+Math.min(10,this.I)+"/"+this.I+")"];e.query(this.source).take(10).each(function(e,n){t.push("  ["+n+"] "+sn.stringify(e))}),this.I>10&&t.push("  ..."),t.push("COLS ("+this.J+")");var n=this._columnTypes;return this.metadata.forEach(function(e,r){t.push("  ["+r+"] "+"'"+e.colName+"' ("+"type: "+e.colType+", "+"inspected: "+(n[r]?"number":"string")+(e.colLabel?", label: '"+e.colLabel+"'":"")+")")}),t.push(""),t.join("\n")},_logVItem:function(t,n){var r=["VIRTUAL ITEM ARRAY",sn.logSeparator],i=4,s=5,o=9;this._itemInfos.forEach(function(e,t){i=Math.max(i,(e.name||"").length),s=Math.max(s,(e.label||"").length);var n=this._userIndexesToSingleDim[t];n&&(o=Math.max(o,n.length))},this),r.push("Index | Kind | Type   | "+e.string.padRight("Name",i)+" | "+e.string.padRight("Label",s)+" > "+"Dimension","------+------+--------+-"+e.string.padRight("",i,"-")+"-+-"+e.string.padRight("",s,"-")+"-+-"+e.string.padRight("",o,"-")+"-");var u=0;return t.forEach(function(t){for(var o=0,a=n[t];a>o;o++){var f=this._itemInfos[u],l=this._userIndexesToSingleDim[u];void 0===l&&(l=""),r.push(" "+u+"    | "+t+"    | "+(f.type?"number":"string")+" | "+e.string.padRight(f.name||"",i)+" | "+e.string.padRight(f.label||"",s)+" | "+l),u++}},this),r.push(""),r.join("\n")},_createPlot2SeriesKeySet:function(t,n){var r=null,i=n.length;return e.query(t).each(function(t){var s=+t;if(isNaN(s))throw e.error.argumentInvalid("plot2DataSeriesIndexes","Element is not a number '{0}'.",[t]);if(0>s){if(-i>=s)throw e.error.argumentInvalid("plot2DataSeriesIndexes","Index is out of range '{0}'.",[s]);s=i+s}else if(s>=i)throw e.error.argumentInvalid("plot2DataSeriesIndexes","Index is out of range '{0}'.",[s]);r||(r={}),r[n[s]]=!0}),r},_dataPartGet:function(t,n){function r(r,c){i||(s=t(),i=a.data.dimensions(f),sn.debug>=3&&s&&sn.log("Second axis series values: "+sn.stringify(e.keys(s))));var h;n(r,l);var p=l.series;null!=p&&null!=p.v&&(p=p.v),h=e.hasOwn(s,p)?u||(u=i.intern("1")):o||(o=i.intern("0")),c[f]=h}var i,s,o,u,a=this,f=this.options.dataPartDimName,l={};return r}}),e.type("pvc.data.CrosstabTranslationOper",sn.data.MatrixTranslationOper).add({_translType:"Crosstab",virtualItemSize:function(){return this.R+this.C+this.M},_executeCore:function(){function t(e,t){for(var n=s[e],r=0,u=o[e];u-->0;)i[n++]=t[r++]}function n(e,t){for(var n=s.M,r=o._colGroupsIndexes[t],u=o.M,a=0;u>a;a++){var f=r[a];i[n++]=null!=f?e[f]:null}}if(!this.metadata.length)return e.query();var r=this._getDimensionsReaders(),i=new Array(this.virtualItemSize()),s=this._itemCrossGroupIndex,o=this,u=e.query(this.source);if(this._colGroups&&this._colGroups.length){var a=function(s){return t("R",s),e.query(this._colGroups).select(function(e,o){return t("C",e),n(s,o),this._readItem(i,r)},this)};return u.selectMany(a,this)}return u.select(function(e){return t("R",e),this._readItem(i,r)},this)},_processMetadata:function(){this.base(),this._separator=this.options.separator||"~";var t=this.R=1;this.C=1,this.M=1,this.measuresDirection=null;var n,r=this.options.seriesInRows,i=this.metadata;n=r?i.map(function(e){return e.colName}):this.options.compatVersion<=1?i.map(function(e){return{v:e.colName}}):i.map(function(e){return{v:e.colName,f:e.colLabel}});var s=this._itemCrossGroupInfos={};if(this.options.isMultiValued){var o=e.get(this.options,"measuresInColumns",!0);if(o||null==this.options.measuresIndex){t=this.R=this._getCategoriesCount();var u=n.slice(t),a=u.length;a>0?(o?(this.measuresDirection="columns",this._processEncodedColGroups(u)):(this._colGroups=u,this._colGroupsIndexes=[],this._colGroups.forEach(function(e,t){this._colGroups[t]=this._splitEncodedColGroupCell(e),this._colGroupsIndexes[t]=[this.R+t]},this),s.M=[this._buildItemInfoFromMetadata(t)]),this.C=this._colGroups[0].length,s.C=e.range(0,this.C).select(function(){return{type:0}}).array()):(this.C=this.M=0,s.M=[],s.C=[])}else{this.measuresDirection="rows",this.R=+this.options.measuresIndex;var f=this.options.measuresCount;null==f&&(f=1),this.M=f,this._colGroups=n.slice(this.R+1),this._colGroups.forEach(function(e,t){this._colGroups[t]=[e]},this)}}else t=this.R=this._getCategoriesCount(),this._colGroups=n.slice(t),this._colGroupsIndexes=new Array(this._colGroups.length),this._colGroups.forEach(function(e,n){this._colGroups[n]=[e],this._colGroupsIndexes[n]=[t+n]},this),s.C=[{type:0}],s.M=[{type:this._columnTypes[t]}];s.R=e.range(0,this.R).select(this._buildItemInfoFromMetadata,this).array();var l=this._itemCrossGroupIndex={C:r?this.R:0,R:r?0:this.C,M:this.C+this.R},c=this._itemInfos=new Array(this.virtualItemSize());e.eachOwn(l,function(e,t){s[t].forEach(function(t,n){c[e+n]=t})}),this._itemLogicalGroup={series:r?this.R:this.C,category:r?this.C:this.R,value:this.M},this._itemLogicalGroupIndex={series:0,category:this._itemLogicalGroup.series,value:this.C+this.R}},logVItem:function(){return this._logVItem(["C","R","M"],{C:this.C,R:this.R,M:this.M})},_getCategoriesCount:function(){var t=this.options.categoriesCount;return null!=t&&(!isFinite(t)||0>t)&&(t=null),null==t&&(t=e.query(this._columnTypes).whayl(function(e){return 0===e}).count(),t||(t=1)),t},_splitEncodedColGroupCell:function(e){var t,n=e.v;return null==n?n=[]:(n=n.split(this._separator),t=e.f,t&&(t=t.split(this._separator))),n.map(function(e,n){return{v:e,f:t&&t[n]}})},_processEncodedColGroups:function(t){for(var n,r=t.length||e.assert("Must have columns"),i=this.R,s=[],o={},u=[],a=0;r>a;a++){var f,l,c,h,p=t[a],d=p.v,v=p.f,m=d.lastIndexOf(this._separator);0>m?(f=d,l=v,d="",c=[]):(f=d.substring(m+1),d=d.substring(0,m),c=d.split(this._separator),null!=v&&(h=v.split(this._separator),l=h.pop()),c.forEach(function(e,t){var n=h&&h[t];c[t]={v:e,f:n}})),n&&n.encValues===d?n.measureNames.push(f):(n={startIndex:a,encValues:d,values:c,measureNames:[f]},s.push(n));var g=a-n.startIndex,y=e.getOwn(o,f);y?g>y.groupIndex&&(y.groupIndex=g):(o[f]=y={name:f,label:l,type:this._columnTypes[i+a],groupIndex:g,index:a},u.push(y))}u.sort(function(t,n){return e.compare(t.groupIndex,n.groupIndex)||e.compare(t.index,n.index)}),u.forEach(function(e,t){e.groupIndex=t});var b=s.length,w=new Array(b),E=new Array(b),S=u.length;s.map(function(e,t){w[t]=e.values;var n=e.startIndex,r=E[t]=new Array(S);e.measureNames.forEach(function(e,t){var s=o[e].groupIndex;r[s]=i+n+t})}),this._colGroups=w,this._colGroupsIndexes=E,this._itemCrossGroupInfos.M=u,this.M=S},configureType:function(){if("rows"===this.measuresDirection)throw e.error.notImplemented();this.base()},_configureTypeCore:function(){function t(e,t,r){for(var u=i[e]+r;r>0;){var a=sn.buildIndexedId(e,t);if(!n.complexTypeProj.isReadOrCalc(a)){s=n._nextAvailableItemIndex(s);if(s>=u)return;o.push({names:a,indexes:s}),s++,r--}t++}}var n=this,r=n._itemLogicalGroup,i=n._itemLogicalGroupIndex,s=0,o=[],u=this.options.dataPartDimName;if(u&&1===this.C&&!this.complexTypeProj.isReadOrCalc(u)){var a=this.options.plot2DataSeriesIndexes;if(null!=a){var f=this._colGroups.map(function(e){return""+e[0].v});this._plot2SeriesKeySet=this._createPlot2SeriesKeySet(a,f)}}["series","category","value"].forEach(function(e){var n=r[e];n>0&&t(e,0,n)}),o&&o.forEach(this.defReader,this);if(this._plot2SeriesKeySet){var l=this._userDimsReadersByDim.series;if(l){var c=e.fun.constant(this._plot2SeriesKeySet);this._userRead(this._dataPartGet(c,l),u)}}}}),e.type("pvc.data.RelationalTranslationOper",sn.data.MatrixTranslationOper).add({M:0,C:0,S:0,_translType:"Relational",_processMetadata:function(){this.base();var t=this.metadata,n=this.J,r=this.options.categoriesCount;null!=r&&(!isFinite(r)||0>r)&&(r=0);var i,s,o;this.options.isMultiValued&&(s=sn.parseDistinctIndexArray(this.options.measuresIndexes,0,n-1),o=s?s.length:0);var u;if(null==o)if(n>0&&3>=n&&(null==r||1===r)&&null==i)o=1,s=[n-1],r=n>=2?1:0,i=n>=3?1:0,u=r+i;else if(null!=r&&r>=n)u=n,r=n,i=0,o=0;else{var a=null!=r?n-r:1/0;s=e.query(t).where(function(e,t){return 0!==this._columnTypes[t]},this).select(function(e){return e.colIndex}).take(a).array(),o=s.length}null==u&&(u=n-o,0===u?i=r=0:null!=r?r>u?(r=u,i=0):i=u-r:(i=u>1?1:0,r=u-i));var f=this.options.seriesInRows,l=[];u&&(i&&!f&&l.push({name:"S",count:i}),r&&l.push({name:"C",count:r}),i&&f&&l.push({name:"S",count:i})),o&&l.push({name:"M",count:o});var c=e.range(0,n).array();s&&s.forEach(function(e){c.splice(e,1)});var h={};l.forEach(function(e){var t=e.count,n=e.name;h[n]=e,e.indexes=s&&"M"===n?s:c.splice(0,t)}),this.M=o,this.S=i,this.C=r;var p=[];["S","C","M"].forEach(function(t){var n=h[t];n&&e.array.append(p,n.indexes)}),this._itemInfos=p.map(this._buildItemInfoFromMetadata,this),this._itemCrossGroupIndex={S:0,C:this.S,M:this.S+this.C},this._itemPerm=p},logVItem:function(){return this._logVItem(["S","C","M"],{S:this.S,C:this.C,M:this.M})},_configureTypeCore:function(){function e(e,i,s,o){for(var u=t._itemCrossGroupIndex[i]+o;o>0;){var a=sn.buildIndexedId(e,s);if(!t.complexTypeProj.isReadOrCalc(a)){n=t._nextAvailableItemIndex(n);if(n>=u)return;r.push({names:a,indexes:n}),n++,o--}s++}}var t=this,n=0,r=[];this.S>0&&e("series","S",0,this.S),this.C>0&&e("category","C",0,this.C),this.M>0&&e("value","M",0,this.M),r&&r.forEach(this.defReader,this);var i=this.options.dataPartDimName;if(i&&!this.complexTypeProj.isReadOrCalc(i)){var s=this.options.plot2DataSeriesIndexes;if(null!=s){var o=this._userDimsReadersByDim.series;o&&this._userRead(J.call(this,s,o),i)}}},_executeCore:function(){var n=this._getDimensionsReaders(),r=this._itemPerm;return e.query(this._getItems()).select(function(e){return e=t.permute(e,r),this._readItem(e,n)},this)}}),e.type("pvc.data.Atom").init(function(t,n,r,i,s){this.dimension=t,this.id=null==n?-e.nextId():e.nextId(),this.value=n,this.label=r,void 0!==i&&(this.rawValue=i),this.key=s}).add({isVirtual:!1,rawValue:void 0,toString:function(){var e=this.label;return null!=e?e:(e=this.value,null!=e?""+e:"")}});var xn=1;e.type("pvc.data.Complex").init(function(t,n,r,i,s,o){var u=this;u.id=xn++;var a;t&&(a=t.owner,i||(i=t.atoms)),u.owner=a=a||u;var f=a.type||e.fail.argumentRequired("owner.type");u.atoms=i?Object.create(i):{};var l=!!r;r||(r=f._dimsNames);var c,h,p=u.atoms,d=r.length;if(n){var v=a._dimensions,m=function(e){var t=n[e],r=v[e].intern(t);null==t||i&&r===i[e]||(p[e]=r)};if(l){c=d;for(;c--;)m(r[c])}else for(h in n)m(h);if(o){n=f._calculate(u);for(h in n)e.hasOwnProp.call(p,h)||m(h)}}var g;if(d)if(1===d)g=p[r[0]],u.value=g.value,u.rawValue=g.rawValue,u.key=g.key,s&&(u.label=g.label);else{var y,b,w,E=a.keySep,S=a.labelSep;for(c=0;d>c;c++)g=p[r[c]],c?y+=E+g.key:y=g.key,s&&(w=g.label)&&(b?b+=S+w:b=w);u.value=u.rawValue=u.key=y,s&&(u.label=b)}else u.value=null,u.key="",s&&(u.label="")}).add({labelSep:" ~ ",keySep:"~",value:null,label:null,rawValue:void 0,ensureLabel:function(){var t=this.label;if(null==t){t="";var n=this.owner.labelSep;e.eachOwn(this.atoms,function(e){var r=e.label;r&&(t?t+=n+r:t=r)}),this.label=t}return t},view:function(e){return new sn.data.ComplexView(this,e)},toString:function(){var e=[""+this.constructor.typeName];return null!=this.index&&e.push("#"+this.index),this.owner.type.dimensionsNames().forEach(function(t){e.push(t+": "+sn.stringify(this.atoms[t].value))},this),e.join(" ")},rightTrimKeySep:function(e){return e&&sn.data.Complex.rightTrimKeySep(e,this.owner.keySep)},absKeyTrimmed:function(){return this.rightTrimKeySep(this.absKey)},keyTrimmed:function(){return this.rightTrimKeySep(this.key)}}),sn.data.Complex.rightTrimKeySep=function(e,t){if(e&&t)for(var n,r=t.length;e.lastIndexOf(t)===(n=e.length-r)&&n>=0;)e=e.substr(0,n);return e},sn.data.Complex.values=function(e,t){var n=e.atoms;return t.map(function(e){return n[e].value})},sn.data.Complex.compositeKey=function(e,t){var n=e.atoms;return t.map(function(e){return n[e].key}).join(e.owner.keySep)},sn.data.Complex.labels=function(e,t){var n=e.atoms;return t.map(function(e){return n[e].label})};var Tn=e.propGet("id");e.type("pvc.data.ComplexView",sn.data.Complex).init(function(e,t){this.source=e,this.viewDimNames=t,this.base(e,e.atoms,t,e.owner.atoms,!0)}).add({values:function(){return sn.data.Complex.values(this,this.viewDimNames)},labels:function(){return sn.data.Complex.labels(this,this.viewDimNames)}}),e.type("pvc.data.Datum",sn.data.Complex).init(function(e,t){this.base(e,t,null,null,!1,!0)}).add({isSelected:!1,isVisible:!0,isNull:!1,isVirtual:!1,isTrend:!1,trend:null,isInterpolated:!1,interpolation:null,setSelected:function(e){if(this.isNull)return!1;e=null==e||!!e;var t=this.isSelected!==e;return t&&(e?this.isSelected=!0:delete this.isSelected,Tt.call(this.owner,this,e)),t},toggleSelected:function(){return this.setSelected(!this.isSelected)},setVisible:function(e){if(this.isNull)return!1;e=null==e||!!e;var t=this.isVisible!==e;return t&&(this.isVisible=e,Nt.call(this.owner,this,e)),t},toggleVisible:function(){return this.setVisible(!this.isVisible)}});var Nn=e.propGet("isSelected");e.type("pvc.data.TrendDatum",sn.data.Datum).init(function(e,t,n){this.base(e,t),this.trend=n}).add({isVirtual:!0,isTrend:!0}),e.type("pvc.data.InterpolationDatum",sn.data.Datum).init(function(e,t,n){this.base(e,t),this.interpolation=n}).add({isVirtual:!0,isInterpolated:!0}),e.type("pvc.data.Dimension").init(function(t,n){this.data=t,this.type=n,this.root=this,this.owner=this;var r=n.name;this.name=r,this._atomComparer=n.atomComparer(),this._atomsByKey={};if(t.isOwner())this._atoms=[],ft.call(this);else{var i,s=t.parent;s?(i=s._dimensions[r],pt.call(i,this),this.root=t.parent.root):(s=t.linkParent,s||e.assert("Data must have a linkParent"),i=s._dimensions[r],dt.call(i,this)),this._nullAtom=this.owner._nullAtom,this._lazyInit=function(){this._lazyInit=null;for(var t=this.data._datums,n=t.length,s=this._atomsByKey,o=0;n>o;o++){var u=t[o].atoms[r];s[u.key]=u}this._atoms=i.atoms().filter(function(t){return e.hasOwnProp.call(s,t.key)})}}}).add({parent:null,linkParent:null,_linkChildren:null,_atomsByKey:null,_atomVisibleDatumsCount:null,_disposed:!1,_nullAtom:null,_virtualNullAtom:null,_visibleAtoms:null,_visibleIndexes:null,_atomComparer:null,_atoms:null,_sumCache:null,count:function(){return this._lazyInit&&this._lazyInit(),this._atoms.length},isVisible:function(t){return this._lazyInit&&this._lazyInit(),e.hasOwn(this._atomsByKey,t.key)||e.assert("Atom must exist in this dimension."),mt.call(this)[t.key]>0},atoms:function(t){this._lazyInit&&this._lazyInit();var n=e.get(t,"visible");return null==n?this._atoms:(n=!!n,this._visibleAtoms||(this._visibleAtoms={}),this._visibleAtoms[n]||(this._visibleAtoms[n]=yt.call(this,n)))},indexes:function(n){this._lazyInit&&this._lazyInit();var r=e.get(n,"visible");return null==r?t.range(0,this._atoms.length):(r=!!r,this._visibleIndexes||(this._visibleIndexes={}),this._visibleIndexes[r]||(this._visibleIndexes[r]=gt.call(this,r)))},atom:function(e){if(null==e||""===e)return this._nullAtom;if(e instanceof sn.data.Atom)return e;this._lazyInit&&this._lazyInit();var t=this.type._key,n=t?t.call(null,e):e;return this._atomsByKey[n]||null},getDistinctAtoms:function(e){var t=[],n=e?e.length:0;if(n)for(var r={},i=0;n>i;i++){var s,o=this.atom(e[i]);o&&!r[s="\0"+o.key]&&(r[s]=o,t.push(o))}return t},extent:function(t){var n=this.atoms(t),r=n.length;if(!r)return void 0;var i=this._nullAtom&&null==n[0].value?1:0,s=r-i;if(s>0){var o,u=n[i],a=n[r-1];if(u!==a&&e.get(t,"abs",!1)){var f=u.value<0?-1:1,l=a.value<0?-1:1;if(f===l)0>l&&(o=a,a=u,u=o);else if(s>2){a.value<-u.value&&(a=u);var c=e.array.binarySearch(n,0,this.type.comparer(),function(e){return e.value});if(0>c){c=~c;var h=n[c-1],p=n[c];u=-h.value<p.value?h:p}else u=n[c]}else a.value<-u.value&&(o=a,a=u,u=o)}return{min:u,max:a}}return void 0},min:function(e){var t=this.atoms(e),n=t.length;if(!n)return void 0;var r=this._nullAtom&&null==t[0].value?1:0;return n>r?t[r]:void 0},max:function(e){var t=this.atoms(e),n=t.length;return n&&null!=t[n-1].value?t[n-1]:void 0},sumAbs:function(t){return this.sum(e.create(t,{abs:!0}))},value:function(t){return this.sum(t&&t.abs?e.create(t,{abs:!1}):t)},valueAbs:function(e){var t=this.value(e);return t?Math.abs(t):t},sum:function(t){var n=!!e.get(t,"abs",!1),r=e.get(t,"zeroIfNone",!0),i=ut(t)+":"+n,s=e.getOwn(this._sumCache,i);if(void 0===s){var o=this.name;s=this.data.datums(null,t).reduce(function(e,t){var r=t.atoms[o].value;return n&&0>r&&(r=-r),null!=e?e+r:r},null),(this._sumCache||(this._sumCache={}))[i]=s}return r?s||0:s},percent:function(e,t){var n=e instanceof sn.data.Atom?e.value:e;if(!n)return 0;var r=this.sumAbs(t);return r?Math.abs(n)/r:0},valuePercent:function(e){var t=this.valueAbs(e);if(!t)return 0;var n=this.data.parent;if(!n)return 1;var r=n.dimensionsSumAbs(this.name,e);return t/r},percentOverParent:function(e){return this.valuePercent(e)},format:function(t,n){return e.string.to(this.type._formatter?this.type._formatter.call(null,t,n):t)},intern:function(t,n){if(null==t||""===t)return this._nullAtom||at.call(this,t);if(t instanceof sn.data.Atom){if(t.dimension!==this)throw e.error.operationInvalid("Atom is of a different dimension.");return t}var r,i,s=this.type;if("object"==typeof t&&"v"in t){i=t.f,t=t.v;if(null==t||""===t)return this._nullAtom||at.call(this)}if(n)r=t;else{var o=s._converter;if(o){r=o(t);if(null==r||""===r)return this._nullAtom||at.call(this,t);i=void 0}else r=t}var u=s.cast;if(u){r=u(r);if(null==r||""===r)return this._nullAtom||at.call(this)}var a=s._key,f=""+(a?a(r):r);f||e.fail.operationInvalid("Only a null value can have an empty key.");var l=this._atomsByKey[f];return l?(!n&&l.isVirtual&&delete l.isVirtual,l):st.call(this,s,t,f,r,i,n)},read:function(t,n){if(null==t||""===t)return null;var r,i=this.type,s=null!=n;if("object"==typeof t&&"v"in t){n=t.f,t=t.v;if(null==t||""===t)return null}var o=i._converter;r=o?o(t):t;if(null==r||""===r)return null;!s&&o&&(n=null);var u=i.cast;if(u){r=u(r);if(null==r||""===r)return null}var a=i._key,f=""+(a?a(r):r),l=this._atomsByKey[f];if(l)return{rawValue:t,key:f,value:l.value,label:""+(null==n?l.label:n)};if(null==n){var c=i._formatter;n=c?c(r,t):r}return n=e.string.to(n),{rawValue:t,key:f,value:r,label:n}},dispose:function(){var e=this;if(!e._disposed){U(e.childNodes,"parent"),U(e._linkChildren,"linkParent");var t;(t=e.parent)&&W(t,"childNodes",e,"parent"),(t=e.linkParent)&&W(t,"_linkChildren",e,"linkParent"),ht.call(e),e._lazyInit=e._atoms=e._nullAtom=e._virtualNullAtom=null,e._disposed=!0}}}),e.type("pvc.data.Data",sn.data.Complex).init(function(n){n||e.fail.argumentRequired("keyArgs"),this._visibleNotNullDatums=new e.Map;var r,i,s,o,u,a,f=this.parent=n.parent||null;if(f)this.root=f.root,this.depth=f.depth+1,this.type=f.type,u=n.datums||e.fail.argumentRequired("datums"),r=f.owner,i=n.atoms||e.fail.argumentRequired("atoms"),o=n.atomsDimNames||e.fail.argumentRequired("atomsDimNames"),s=f.atoms;else{this.root=this,o=[];var l=n.linkParent||null;l?(r=l.owner,this.type=r.type,u=n.datums||e.fail.argumentRequired("datums"),this._leafs=[],this._wherePred=n.where||null,s=l.atoms,a=e.get(n,"index",null),wt.call(l,this,a)):(r=this,s={},n.labelSep&&(this.labelSep=n.labelSep),n.keySep&&(this.keySep=n.keySep),this.type=n.type||e.fail.argumentRequired("type"),this._selectedNotNullDatums=new e.Map)}u&&kt.call(this,u),this.owner=r,this._atomsBase=s,this._dimensions={},this._dimensionsList=[],this.type.dimensionsList().forEach(this._initDimension,this),this.base(r,i,o,s,!0),t.Dom.Node.call(this),f?(a=e.get(n,"index",null),bt.call(f,this,a),this.absLabel=f.absLabel?e.string.join(r.labelSep,f.absLabel,this.label):this.label,this.absKey=f.absKey?e.string.join(r.keySep,f.absKey,this.key):this.key):(this.absLabel=this.label,this.absKey=this.key)}).add(t.Dom.Node).add({parent:null,linkParent:null,_dimensions:null,_dimensionsList:null,_freeDimensionNames:null,_linkChildren:null,_leafs:null,_childrenByKey:null,_visibleNotNullDatums:null,_selectedNotNullDatums:null,_groupByCache:null,_sumAbsCache:null,treeHeight:null,_groupOper:null,_wherePred:null,_groupSpec:null,_groupLevel:null,_datums:null,_datumsById:null,_datumsByKey:null,depth:0,label:"",absLabel:"",_disposed:!1,_isFlattenGroup:!1,_isDegenerateFlattenGroup:!1,_initDimension:function(e){var t=new sn.data.Dimension(this,e);this._dimensions[e.name]=t,this._dimensionsList.push(t)},dimensions:function(t,n){if(null==t)return this._dimensions;var r=e.getOwn(this._dimensions,t);if(!r&&e.get(n,"assertExists",!0))throw e.error.argumentInvalid("name","Undefined dimension '{0}'.",[t]);return r},dimensionsList:function(){return this._dimensionsList},freeDimensionsNames:function(){var e=this._freeDimensionNames;return e||(this._freeDimensionNames=e=this.type.dimensionsNames().filter(function(e){var t=this.atoms[e];return!(t instanceof sn.data.Atom)||null==t.value},this)),e},isOwner:function(){return this.owner===this},children:function(){var t=this.childNodes;return t.length?e.query(t):e.query()},child:function(t){return e.getOwn(this._childrenByKey,t,null)},childCount:function(){return this.childNodes.length},leafs:function(){return e.query(this._leafs)},count:function(){return this._datums.length},firstDatum:function(){return this._datums.length?this._datums[0]:null},firstAtoms:function(){return(this.firstDatum()||this).atoms},singleDatum:function(){var e=this._datums;return 1===e.length?e[0]:null},dispose:function(){var e=this;if(!e._disposed){St.call(e);var t;(t=e._selectedNotNullDatums)&&t.clear(),e._visibleNotNullDatums.clear(),t=e._dimensionsList;for(var n=0,r=t.length;r>n;n++)t[n].dispose();e._dimensions=null,e._dimensionsLIst=null;if(t=e.parent)t.removeChild(e),e.parent=null;(t=e.linkParent)&&Et.call(t,e),e._disposed=!0}},disposeChildren:function(){St.call(this)}}),sn.data.Data.add({selectedCount:function(){return this.isOwner()?this._selectedNotNullDatums.count:this.datums(null,{selected:!0}).count()},selectedDatums:function(){return this.isOwner()?this._selectedNotNullDatums.values():this.datums(null,{selected:!0}).array()},selectedDatumMap:function(){if(!this.isOwner()){var t=this.datums(null,{selected:!0}).object({name:e.propGet("id")});return new e.Set(t)}return this._selectedNotNullDatums.clone()},visibleCount:function(){return this._visibleNotNullDatums.count},replaceSelected:function(t){e.array.is(t)||(t=t.array());var n=e.query(t).where(Nn).object({name:Tn}),r=this.owner.clearSelected(function(t){return!e.hasOwn(n,t.id)});return r|=sn.data.Data.setSelected(t,!0),r},clearSelected:function(e){if(this.owner!==this)return this.owner.clearSelected(e);if(!this._selectedNotNullDatums.count)return!1;var t;return e?(t=!1,this._selectedNotNullDatums.values().filter(e).forEach(function(e){t=!0,G.call(e),this._selectedNotNullDatums.rem(e.id)},this)):(t=!0,this._selectedNotNullDatums.values().forEach(function(e){G.call(e)}),this._selectedNotNullDatums.clear()),t}}),sn.data.Data.setSelected=function(t,n){var r=0;return t&&e.query(t).each(function(e){r|=e.setSelected(n)}),!!r},sn.data.Data.toggleSelected=function(t,n){e.array.isLike(t)||(t=e.query(t).array());var r=e.query(t),i=n?r.any(Nn):r.all(Y);return this.setSelected(t,!i)},sn.data.Data.setVisible=function(t,n){var r=0;return t&&e.query(t).each(function(e){r|=e.setVisible(n)}),!!r},sn.data.Data.toggleVisible=function(t){e.array.isLike(t)||(t=e.query(t).array());var n=e.query(t).all(e.propGet("isVisible"));return sn.data.Data.setVisible(t,!n)},e.space("pvc.data").FlatteningMode=e.set(e.makeEnum(["DfsPre","DfsPost"]),"None",0),e.type("pvc.data.GroupingSpec").init(function(t,n,r){this.type=n||null;var i=[];this.hasCompositeLevels=!1;var s=[];this.levels=e.query(t||void 0).where(function(e){return e.dimensions.length>0}).select(function(t){return i.push(t.id),e.array.append(s,t.dimensionNames()),!this.hasCompositeLevels&&t.dimensions.length>1&&(this.hasCompositeLevels=!0),t._setAccDimNames(s.slice(0)),t},this).array(),this._dimNames=s,this.depth=this.levels.length,this.isSingleLevel=1===this.depth,this.isSingleDimension=this.isSingleLevel&&!this.hasCompositeLevels,this.firstDimension=this.depth>0?this.levels[0].dimensions[0]:null,this.rootLabel=e.get(r,"rootLabel")||"",this.flatteningMode=e.get(r,"flatteningMode")||sn.data.FlatteningMode.None,this._cacheKey=this._calcCacheKey(),this.id=this._cacheKey+"##"+i.join("||")}).add({_calcCacheKey:function(t){return[e.get(t,"flatteningMode")||this.flatteningMode,e.get(t,"reverse")||"false",e.get(t,"isSingleLevel")||this.isSingleLevel,e.get(t,"rootLabel")||this.rootLabel].join("#")},bind:function(t){this.type=t||e.fail.argumentRequired("type"),this.levels.forEach(function(e){e.bind(t)})},dimensions:function(){return e.query(this.levels).prop("dimensions").selectMany()},dimensionNames:function(){return this._dimNames},view:function(e){return e.view(this.dimensionNames())},isDiscrete:function(){var e;return!this.isSingleDimension||!!(e=this.firstDimension)&&e.type.isDiscrete},firstDimensionType:function(){var e=this.firstDimension;return e&&e.type},firstDimensionName:function(){var e=this.firstDimensionType();return e&&e.name},firstDimensionValueType:function(){var e=this.firstDimensionType();return e&&e.valueType},isNull:function(){return!this.levels.length},ensure:function(t){var n;if(t){var r=this._calcCacheKey(t);if(r!==this._cacheKey){var i=e.lazy(this,"_groupingCache");n=e.getOwn(i,r),n||(n=i[r]=this._ensure(t))}}return n||this},_ensure:function(t){var n=this;if(e.get(t,"isSingleLevel")&&!n.isSingleLevel)return n._singleLevelGrouping(t);if(e.get(t,"reverse"))return n._reverse(t);var r=e.get(t,"flatteningMode")||n.flatteningMode,i=e.get(t,"rootLabel")||n.rootLabel;return r!==n.flatteningMode||i!==n.rootLabel?new sn.data.GroupingSpec(n.levels,n.type,{flatteningMode:r,rootLabel:i}):n},_singleLevelGrouping:function(t){var n=!!e.get(t,"reverse"),r=this.dimensions().select(function(e){return n?new sn.data.GroupingDimensionSpec(e.name,!e.reverse,e.type.complexType):e}),i=new sn.data.GroupingLevelSpec(r,this.type);return new sn.data.GroupingSpec([i],this.type,{flatteningMode:null,rootLabel:e.get(t,"rootLabel")||this.rootLabel})},_reverse:function(t){var n=e.query(this.levels).select(function(t){var n=e.query(t.dimensions).select(function(e){return new sn.data.GroupingDimensionSpec(e.name,!e.reverse,e.type.complexType)});return new sn.data.GroupingLevelSpec(n,this.type)},this);return new sn.data.GroupingSpec(n,this.type,{flatteningMode:e.get(t,"flatteningMode")||this.flatteningMode,rootLabel:e.get(t,"rootLabel")||this.rootLabel})},toString:function(){return e.query(this.levels).select(function(e){return""+e}).array().join(", ")}}),e.type("pvc.data.GroupingLevelSpec").init(function(t,n){var r=[],i=[];this.dimensions=e.query(t).select(function(e){return r.push(e.id),i.push(e.name),e}).array(),this._dimNames=i,this.dimensionsInDefOrder=this.dimensions.slice(0),n&&this._sortDimensions(n),this.id=r.join(","),this.depth=this.dimensions.length;var s=this;this.comparer=function(e,t){return s.compare(e,t)}}).add({_sortDimensions:function(e){e.sortDimensionNames(this.dimensionsInDefOrder,function(e){return e.name})},_setAccDimNames:function(e){this._accDimNames=e},accDimensionNames:function(){return this._accDimNames},dimensionNames:function(){return this._dimNames},bind:function(e){this._sortDimensions(e),this.dimensions.forEach(function(t){t.bind(e)})},compare:function(e,t){for(var n=this.dimensions,r=this.depth,i=0;r>i;i++){var s=n[i].compareDatums(e,t);if(s)return s}return 0},key:function(e){for(var t="",n=this._dimNames,r=this.depth,i=e.owner.keySep,s=e.atoms,o=0;r>o;o++){var u=s[n[o]].key;o?t+=i+u:t=u}return t},atomsInfo:function(e){for(var t={},n=this._dimNames,r=this.depth,i=e.atoms,s=0;r>s;s++){var o=n[s];t[o]=i[o]}return{atoms:t,dimNames:n}},toString:function(){return e.query(this.dimensions).select(function(e){return""+e}).array().join("|")}}),e.type("pvc.data.GroupingDimensionSpec").init(function(e,t,n){this.name=e,this.reverse=!!t,this.id=e+":"+(t?"0":"1"),n&&this.bind(n)}).add({type:null,comparer:null,bind:function(t){t||e.fail.argumentRequired("type"),this.type=t.dimensions(this.name),this.comparer=this.type.atomComparer(this.reverse)},compareDatums:function(e,t){if(this.type.isComparable){var n=this.name;return this.comparer(e.atoms[n],t.atoms[n])}return this.reverse?t.id-e.id:e.id-t.id},toString:function(){return this.name+(this.reverse?" desc":"")}}),sn.data.GroupingSpec.parse=function(t,n){if(!t)return new sn.data.GroupingSpec(null,n);var r;e.array.is(t)?r=t:e.string.is(t)&&(r=t.split(/\s*,\s*/));var i=e.query(r).select(function(e){var t=Ct(e,n);return new sn.data.GroupingLevelSpec(t,n)});return new sn.data.GroupingSpec(i,n)};var Cn=/^\s*(.+?)(?:\s+(asc|desc))?\s*$/i;e.type("pvc.data.DataOper").init(function(t){t||e.fail.argumentRequired("linkParent"),this._linkParent=t}).add({key:null,execute:e.method({isAbstract:!0})}),e.type("pvc.data.GroupingOper",sn.data.DataOper).init(function(t,n,r){n||e.fail.argumentRequired("groupingSpecs"),this.base(t,r),this._where=e.get(r,"where"),this._visible=e.get(r,"visible",null),this._selected=e.get(r,"selected",null);var i=this._isNull=e.get(r,"isNull",null);this._postFilter=null!=i?function(e){return e.isNull===i}:null;var s=null==this._selected,o="";this._where&&(o=e.get(r,"whereKey"),o||(r&&null!==o?(o=""+e.nextId("dataOperWhereKey"),r.whereKey=o):s=!1));var u=[];this._groupSpecs=e.array.as(n).map(function(n){if(n instanceof sn.data.GroupingSpec){if(n.type!==t.type)throw e.error.argumentInvalid("groupingSpecText","Invalid associated complex type.")}else n=sn.data.GroupingSpec.parse(n,t.type);return u.push(n.id),n}),s&&(this.key=u.join("!!")+"||visible:"+this._visible+"||isNull:"+this._isNull+"||where:"+o)}).add({execute:function(){var t=_t(e.query(this._linkParent._datums),{visible:this._visible,selected:this._selected,where:this._where}),n=this._group(t);return this._generateData(n,null,this._linkParent)},executeAdd:function(t,n){var r=_t(e.query(n),{visible:this._visible,selected:this._selected,where:this._where}),i=this._group(r);return this._generateData(i,null,this._linkParent,t),i.datums},_group:function(t){var n={isRoot:!0,treeHeight:e.query(this._groupSpecs).select(function(e){var t=e.levels.length;return t?e.flatteningMode?1:t:0}).reduce(e.add,0),datums:[]};return n.treeHeight>0&&this._groupSpecRecursive(n,e.query(t).array(),0),n},_groupSpecRecursive:function(e,t,n){var r=this._groupSpecs[n];r.flatteningMode?this._groupSpecRecursiveFlattened(e,t,r,n):this._groupSpecRecursiveNormal(e,t,r,n)},_groupSpecRecursiveNormal:function(t,n,r,i){function s(t,n,f){var l=o[f],c=f===u-1,h=a&&c;t.groupSpec=r,t.groupLevelSpec=l;for(var p=t.children=this._groupLevelDatums(l,t,n,!1),d=0,v=p.length;v>d;d++){var m=p[d];if(!h){var g=m.datums;m.datums=[],c?this._groupSpecRecursive(m,g,i+1):s.call(this,m,g,f+1)}e.array.append(t.datums,m.datums)}}var o=r.levels,u=o.length,a=i===this._groupSpecs.length-1;t.isRoot&&(t.label=r.rootLabel),s.call(this,t,n,0)},_groupSpecRecursiveFlattened:function(t,n,r,i){function s(t,n,r){for(var h=u[r],d=r===a-1,v=f&&d,m=this._groupLevelDatums(h,t,n,!0),g=f?t.datums:[],y=0,b=m.length;b>y;y++){var w=m[y],E=w.datums;e.array.lazy(t,"_children").push(w);if(e.hasOwn(c,w.key))e.array.append(g,E);else{var S=l.length;o||(p(w),t.isFlattenGroup=!0),v||(w.datums=[],d?this._groupSpecRecursive(w,E,i+1):s.call(this,w,E,r+1)),e.array.append(g,w.datums),o&&(e.hasOwn(c,w.key)&&(w.isFlattenGroup||e.assert("Must be a parent for duplicate keys to exist."),1===w._children.length&&(l.splice(S,l.length-S),w.isDegenerateFlattenGroup=!0)),p(w),t.isFlattenGroup=!0)}}f||this._groupSpecRecursive(t,g,i+1)}var o=r.flatteningMode===sn.data.FlatteningMode.DfsPost,u=r.levels,a=u.length,f=i===this._groupSpecs.length-1,l=[],c={};t.children=l,t.childrenByKey=c;var h={key:"",absKey:"",atoms:{},datums:[],label:r.rootLabel,dimNames:[]},p=function(e){l.push(e),c[e.key]=e};o||p(h),s.call(this,h,n,0),o&&p(h),t.datums=h.datums},_groupLevelDatums:function(t,n,r,i){for(var s,o=[],u={},a=this._postFilter,f=t.comparer,l=function(e,t){return f(e.firstDatum,t.firstDatum)},c=0,h=r.length;h>c;c++){var p=r[c],d=t.key(p),v=e.hasOwnProp.call(u,d)&&u[d];v?(!a||a(p))&&v.datums.push(p):(v=t.atomsInfo(p),v.key=d,v.firstDatum=p,v.datums=!a||a(p)?[p]:[],i&&(s||(s=p.owner.keySep),this._onNewChildNodeFlattened(d,s,v,t,n)),e.array.insert(o,v,l),u[d]=v)}if(a){c=o.length;for(;c--;)o[c].datums.length||o.splice(c,1)}return o},_onNewChildNodeFlattened:function(t,n,r,i,s){e.copy(r.atoms,s.atoms),r.dimNames=i.accDimensionNames();if(s.dimNames.length){var o=s.absKey+n+t;r.absKey=o,r.key=sn.data.Complex.rightTrimKeySep(o,n)}else r.absKey=t},_generateData:function(t,n,r,i){var s,o;if(t.isRoot)i?(s=i,Ot.call(s,t.datums)):(o=!0,s=new sn.data.Data({linkParent:r,datums:t.datums}),s.treeHeight=t.treeHeight,s._groupOper=this);else{i&&(s=r.child(t.key),s&&At.call(s,t.datums));if(!s){o=!0;var u,a;i&&(a=r.childNodes)&&(u=~e.array.binarySearch(a,t.datums[0],n.groupLevelSpec.comparer)),s=new sn.data.Data({parent:r,atoms:t.atoms,atomsDimNames:t.dimNames,datums:t.datums,index:u})}}if(o){t.isFlattenGroup&&(s._isFlattenGroup=!0,s._isDegenerateFlattenGroup=!!t.isDegenerateFlattenGroup);var f=t.label;f&&(s.label+=f,s.absLabel+=f)}var l=t.children,c=l&&l.length;if(c){o&&(s._groupSpec=t.groupSpec,s._groupLevelSpec=t.groupLevelSpec);for(var h=0;c>h;h++)this._generateData(l[h],t,s,i)}else if(o&&!t.isRoot){var p=s.root._leafs;s.leafIndex=p.length,p.push(s)}return s}}),e.type("pvc.data.LinearInterpolationOper").init(function(t,n,r,i,s,o,u){this._newDatums=[],this._data=r;var a=i.flatten(t).children(),f=s.isBound()?s.flatten(n,{visible:!0,isNull:!1}).children().array():[null];this._isCatDiscrete=i.grouping.isDiscrete(),this._stretchEnds=u;var l=this._valDim=t.owner.dimensions(o.firstDimensionName()),c={visible:!0,zeroIfNone:!1};this._catInfos=a.select(function(e,t){var n=r.child(e.key),i={data:n||e,value:e.value,isInterpolated:!1,serInfos:null,index:t};return i.serInfos=f.map(function(e){var t=n;t&&e&&(t=t.child(e.key));var r=t?t.dimensions(l.name).value(c):null;return{data:e,group:t,value:r,isNull:null==r,catInfo:i}}),i}).array(),this._serCount=f.length,this._serStates=e.range(0,this._serCount).select(function(e){return new sn.data.LinearInterpolationOperSeriesState(this,e)},this).array()}).add({interpolate:function(){for(var e;e=this._catInfos.shift();)e.serInfos.forEach(this._visitSeries,this);var t=this._newDatums;t.length&&this._data.owner.add(t)},_visitSeries:function(e,t){this._serStates[t].visit(e)},nextUnprocessedNonNullCategOfSeries:function(e){for(var t=0,n=this._catInfos.length;n>t;){var r=this._catInfos[t++],i=r.serInfos[e];if(!i.isNull)return i}}}),e.type("pvc.data.LinearInterpolationOperSeriesState").init(function(e,t){this.interpolation=e,this.index=t,this._lastNonNull(null)}).add({visit:function(e){e.isNull?this._interpolate(e):this._lastNonNull(e)},_lastNonNull:function(e){return arguments.length&&(this.__lastNonNull=e,this.__nextNonNull=void 0),this.__lastNonNull},_nextNonNull:function(){return this.__nextNonNull},_initInterpData:function(){if(void 0===this.__nextNonNull){var t=this.__lastNonNull,n=this.__nextNonNull=this.interpolation.nextUnprocessedNonNullCategOfSeries(this.index)||null;if(n&&t){var r=t.value,i=n.value,s=i-r;if(this.interpolation._isCatDiscrete){var o=n.catInfo.index-t.catInfo.index;o>=2||e.assert("Must have at least one interpolation point."),this._stepValue=s/o,this._middleIndex=~~(o/2);var u=o-1;this._isOdd=u%2>0}else{var a=+t.catInfo.value,f=+n.catInfo.value,l=f-a;this._steep=s/l,this._middleCat=(f+a)/2}}}},_interpolate:function(t){this._initInterpData();var n=this.__nextNonNull,r=this.__lastNonNull,i=n||r;if(i){var s,o,u=this.interpolation,a=t.catInfo;if(n&&r)if(u._isCatDiscrete){var f=a.index-r.catInfo.index;s=r.value+this._stepValue*f,o=this._isOdd?f<this._middleIndex?r.group:n.group:f<=this._middleIndex?r.group:n.group}else{var l=+a.value,c=+r.catInfo.value;s=r.value+this._steep*(l-c),o=l<this._middleCat?r.group:n.group}else{if(!u._stretchEnds)return;s=i.value,o=i.group}var h=Object.create(o._datums[0].atoms);e.copyOwn(h,a.data.atoms);var p=u._valDim.intern(s,!0);h[p.dimension.name]=p,u._newDatums.push(new sn.data.InterpolationDatum(o.owner,h,"linear"))}}}),e.type("pvc.data.ZeroInterpolationOper").init(function(t,n,r,i,s,o,u){this._newDatums=[],this._data=r;var a=i.flatten(t).children(),f=s.isBound()?s.flatten(n,{visible:!0,isNull:!1}).children().array():[null];this._isCatDiscrete=i.grouping.isDiscrete(),this._stretchEnds=u;var l=this._valDim=t.owner.dimensions(o.firstDimensionName()),c={visible:!0,zeroIfNone:!1};this._catInfos=a.select(function(e,t){var n=r.child(e.key),i={data:n||e,value:e.value,isInterpolated:!1,serInfos:null,index:t};return i.serInfos=f.map(function(e){var t=n;t&&e&&(t=t.child(e.key));var r=t?t.dimensions(l.name).value(c):null;return{data:e,group:t,value:r,isNull:null==r,catInfo:i}}),i}).array(),this._serCount=f.length,this._serStates=e.range(0,this._serCount).select(function(e){return new sn.data.ZeroInterpolationOperSeriesState(this,e)},this).array()}).add({interpolate:function(){for(var e;e=this._catInfos.shift();)e.serInfos.forEach(this._visitSeries,this);var t=this._newDatums;t.length&&this._data.owner.add(t)},_visitSeries:function(e,t){this._serStates[t].visit(e)},nextUnprocessedNonNullCategOfSeries:function(e){for(var t=0,n=this._catInfos.length;n>t;){var r=this._catInfos[t++],i=r.serInfos[e];if(!i.isNull)return i}}}),e.type("pvc.data.ZeroInterpolationOperSeriesState").init(function(e,t){this.interpolation=e,this.index=t,this._lastNonNull(null)}).add({visit:function(e){e.isNull?this._interpolate(e):this._lastNonNull(e)},_lastNonNull:function(e){return arguments.length&&(this.__lastNonNull=e,this.__nextNonNull=void 0),this.__lastNonNull},_nextNonNull:function(){return this.__nextNonNull},_initInterpData:function(){if(void 0===this.__nextNonNull){var t=this.__lastNonNull,n=this.__nextNonNull=this.interpolation.nextUnprocessedNonNullCategOfSeries(this.index)||null;if(n&&t)if(this.interpolation._isCatDiscrete){var r=n.catInfo.index-t.catInfo.index;r>=2||e.assert("Must have at least one interpolation point."),this._middleIndex=~~(r/2);var i=r-1;this._isOdd=i%2>0}else{var s=+t.catInfo.value,o=+n.catInfo.value;this._middleCat=(o+s)/2}}},_interpolate:function(t){this._initInterpData();var n=this.__nextNonNull,r=this.__lastNonNull,i=n||r;if(i){var s,o=this.interpolation,u=t.catInfo;if(n&&r)if(o._isCatDiscrete){var a=u.index-r.catInfo.index;s=this._isOdd?a<this._middleIndex?r.group:n.group:a<=this._middleIndex?r.group:n.group}else{var f=+u.value;s=f<this._middleCat?r.group:n.group}else{if(!o._stretchEnds)return;s=i.group}var l=Object.create(s._datums[0].atoms);e.copyOwn(l,u.data.atoms);var c=o._zeroAtom||(o._zeroAtom=o._valDim.intern(0,!0));l[c.dimension.name]=c,o._newDatums.push(new sn.data.InterpolationDatum(s.owner,l,"zero"))}}}),sn.data.Data.add({load:function(t,n){xt.call(this);var r=e.get(n,"where"),i=e.get(n,"isNull"),s=e.query(t).select(function(e){var t=new sn.data.Datum(this,e);return i&&i(t)&&(t.isNull=!0),r&&!r(t)?null:t},this);kt.call(this,s,{isAdditive:!1,doAtomGC:!0})},clearVirtuals:function(){var t=this._datums;if(t){this._sumAbsCache=null;for(var n,r=this._visibleNotNullDatums,i=this._selectedNotNullDatums,s=this._datumsByKey,o=this._datumsById,u=0,a=t.length;a>u;){var f=t[u];if(f.isVirtual){var l=f.id,c=f.key;t.splice(u,1),delete o[l],delete s[c],i&&f.isSelected&&i.rem(l),f.isVisible&&r.rem(l),a--,n=!0}else u++}if(n){if(!t.length&&this.parent){this.dispose();return}var h=this.childNodes;if(h){u=0,a=h.length;for(;a>u;){var p=h[u];p.clearVirtuals(),p.parent?u++:a--}}this._linkChildren&&this._linkChildren.forEach(function(e){e.clearVirtuals()})}}e.eachOwn(this._dimensions,function(e){ct.call(e)})},add:function(e){xt.call(this),kt.call(this,e,{isAdditive:!0,doAtomGC:!0})},groupBy:function(e,t){var n,r,i=new sn.data.GroupingOper(this,e,t),s=i.key;return s&&(n=this._groupByCache,r=n&&n[s]),r?sn.debug>=7&&sn.log("[GroupBy] Cache key hit '"+s+"'"):(sn.debug>=7&&sn.log("[GroupBy] "+(s?"Cache key not found: '"+s+"'":"No Cache key")),r=i.execute(),s&&((n||(this._groupByCache={}))[s]=r)),r},where:function(t,n){var r;if(t)t=Mt.call(this,t,n),r=Ht.call(this,t,n);else{if(!n)return e.query(this._datums);r=_t(e.query(this._datums),n)}var i=Dt(t,n);return new sn.data.Data({linkParent:this,datums:r,where:i})},datums:function(t,n){return t?(t=Mt.call(this,t,n),Ht.call(this,t,n)):n?_t(e.query(this._datums),n):e.query(this._datums)},datum:function(t,n){return t||e.fail.argumentRequired("whereSpec"),t=Mt.call(this,t,n),Ht.call(this,t,n).first()||null},dimensionsSumAbs:function(t,n){var r=t+":"+ut(n),i=e.getOwn(this._sumAbsCache,r);return null==i&&(i=this.children().where(function(e){return!e._isFlattenGroup||e._isDegenerateFlattenGroup}).select(function(e){return e.dimensions(t).valueAbs(n)||0},this).reduce(e.add,0),(this._sumAbsCache||(this._sumAbsCache={}))[r]=i),i}}),sn.data.Data.add({getInfo:function(){var t=["DATA SUMMARY",sn.logSeparator,"  Dimension",sn.logSeparator];return e.eachOwn(this.dimensions(),function(e,n){var r=e.count(),i=e.type,s=[];s.push('"'+i.label+'"'),s.push(i.valueTypeName),i.isComparable&&s.push("comparable"),i.isDiscrete||s.push("continuous"),i.isHidden&&s.push("hidden"),t.push("  "+n+" ("+s.join(", ")+")"+" ("+r+")\n	"+e.atoms().slice(0,10).map(function(e){return e.label}).join(", ")+(r>10?"...":""))}),t.join("\n")},getValues:function(){return t.range(0,this.getCategoriesSize()).map(function(e){return this._getValuesForCategoryIndex(e)},this)},_getDimensionValues:function(e){return this.dimensions(e).atoms().map(function(e){return e.value})},_getDimensionVisibleValues:function(e){return this.dimensions(e).atoms({visible:!0}).map(function(e){return e.value})},getSeries:function(){return this._getDimensionValues("series")},getVisibleSeriesIndexes:function(){return this.dimensions("series").indexes({visible:!0})},getVisibleCategoriesIndexes:function(){return this.dimensions("category").indexes({visible:!0})},getVisibleSeries:function(){return this._getDimensionVisibleValues("series")},getCategories:function(){return this._getDimensionValues("category")},getVisibleCategories:function(){return this._getDimensionVisibleValues("category")},_getValuesForCategoryIndex:function(t){var n=this.dimensions("category").atoms()[t],r=this.datums({category:n}).uniqueIndex(function(e){return e.atoms.series.key});return this.dimensions("series").atoms().map(function(t){var n=e.getOwn(r,t.key);return n?n.atoms.value.value:null})},getSeriesSize:function(){var e=this.dimensions("series",{assertExists:!1});return e?e.count():0},getCategoriesSize:function(){var e=this.dimensions("category",{assertExists:!1});return e?e.count():0}}),e.scope(function(){var t=e.makeEnum(["Interactive","ShowsActivity","ShowsSelection","ShowsTooltip","Selectable","Unselectable","Hoverable","Clickable","DoubleClickable","SelectableByClick","SelectableByRubberband","SelectableByFocusWindow","Animatable"]);t.ShowsInteraction=t.ShowsActivity|t.ShowsSelection,t.Actionable=t.Hoverable|t.Clickable|t.DoubleClickable|t.SelectableByClick,t.HandlesEvents=t.Actionable|t.ShowsTooltip,t.HandlesClickEvent=t.Clickable|t.SelectableByClick,e.type("pvc.visual.Interactive").addStatic(t).addStatic({ShowsAny:t.ShowsInteraction|t.ShowsTooltip,SelectableAny:t.Selectable|t.SelectableByClick|t.SelectableByRubberband|t.SelectableByFocusWindow}).add({_ibits:-1}).add(e.query(e.ownKeys(t)).object({name:e.firstLowerCase,value:function(e){var n=t[e];return function(){return!!(this._ibits&n)}}}))}),e.type("pvc.visual.Scene").init(function(n,r){sn.debug>=4&&(this.id=e.nextId("scene")),this._renderId=0,this.renderState={},t.Dom.Node.call(this,null),this.parent=n||null;if(n){this.root=n.root;var i=e.get(r,"index",null);n.insertAt(this,i)}else this.root=this,this._active=null,this._panel=e.get(r,"panel")||e.fail.argumentRequired("panel","Argument is required on root scene.");var s,o,u,a,f,l,c,h=e.array.to(e.get(r,"source"));h&&h.length?(this.source=h,s=h[0],s instanceof sn.data.Data?(o=s,f=h,u=o.firstDatum()||e.query(f).select(function(e){return e.firstDatum()}).first(e.notNully)):(s instanceof sn.data.Datum||e.assert("not a datum"),u=s,a=h),l=s.atoms,c=u&&u.atoms||s.atoms):l=c=n?Object.create(n.atoms):{},this.atoms=l,this.firstAtoms=c,f&&(this.groups=f),o&&(this.group=o),a&&(this._datums=a),u&&(this.datum=u),(!s||s.isNull)&&(this.isNull=!0),this.vars=n?Object.create(n.vars):{}}).add(t.Dom.Node).add(sn.visual.Interactive).add({source:null,groups:null,group:null,_datums:null,datum:null,isNull:!1,get:function(e,t){var n=this.vars[e];return n&&n[t||"value"]},getSeries:function(){return this.get("series")},getCategory:function(){return this.get("category")},getValue:function(){return this.get("value")},getTick:function(){return this.get("tick")},getX:function(){return this.get("x")},getY:function(){return this.get("y")},getColor:function(){return this.get("color")},getSize:function(){return this.get("size")},getSeriesLabel:function(){return this.get("series","label")},getCategoryLabel:function(){return this.get("category","label")},getValueLabel:function(){return this.get("value","label")},getTickLabel:function(){return this.get("tick","label")},getXLabel:function(){return this.get("x","label")},getYLabel:function(){return this.get("y","label")},getColorLabel:function(){return this.get("color","label")},getSizeLabel:function(){return this.get("size","label")},data:function(){var e=this.group;if(!e){for(var t=this;!e&&(t=t.parent);)e=t.group;e||(e=this.panel.data)}return e},datums:function(){return this.groups?e.query(this.groups).selectMany(function(e){return e.datums()}):this._datums?e.query(this._datums):e.query()},format:function(t){return e.format(t,this._formatScope,this)},_formatScope:function(t){if("#"===t.charAt(0)){t=t.substr(1).split(".");if(t.length>2)throw e.error.operationInvalid("Scene format mask is invalid.");var n=this.firstAtoms[t[0]];if(n){if(t.length>1)switch(t[1]){case"value":return n.value;case"label":break;default:throw e.error.operationInvalid("Scene format mask is invalid.")}return n}return null}return e.getPath(this.vars,t)},isRoot:function(){return this.root===this},panel:function(){return this.root._panel},chart:function(){return this.root._panel.chart},compatVersion:function(){return this.root._panel.compatVersion()},children:function(){var t=this.childNodes;return t.length?e.query(t):e.query()},leafs:function(){function t(e){for(;e.childNodes.length;)e=e.childNodes[0];return e}var n=this;return e.query(function(e){if(!e){var r=t(n);return r===n?0:(this.item=r,1)}var i=this.item.nextSibling;if(i)return this.item=i,1;for(var s=this.item;s!==n&&(s=s.parentNode);)if(i=s.nextSibling)return this.item=t(i),1;return 0})},anyInteraction:function(){return!!this.root._active||this.anySelected()},isActive:!1,setActive:function(e){e=!!e,this.isActive!==e&&Ft.call(this.root,this.isActive?null:this)},clearActive:function(){return Ft.call(this.root,null)},anyActive:function(){return!!this.root._active},active:function(){return this.root._active},activeSeries:function(){var e,t=this.active();return t&&(e=t.vars.series)&&e.value},isActiveSeries:function(){if(this.isActive)return!0;var e=this.renderState.isActiveSeries;if(null==e){var t;e=null!=(t=this.activeSeries())&&t===this.vars.series.value,this.renderState.isActiveSeries=e}return e},isActiveDatum:function(){return this.isActive?!0:!1},isActiveDescendantOrSelf:function(){return this.isActive?!0:e.lazy(this.renderState,"isActiveDescOrSelf",this._calcIsActiveDescOrSelf,this)},_calcIsActiveDescOrSelf:function(){var e=this.active();if(e)for(;e=e.parent;)if(e===this)return!0;return!1},isVisible:function(){return this._visibleInfo().is},anyVisible:function(){return this._visibleInfo().any},_visibleInfo:function(){return e.lazy(this.renderState,"visibleInfo",this._createVisibleInfo,this)},_createVisibleInfo:function(){var t=this.chart().data.owner.visibleCount()>0,n=t&&this.datums().any(e.propGet("isVisible"));return{any:t,is:n}},isSelected:function(){return this._selectedInfo().is},anySelected:function(){return this._selectedInfo().any},_selectedInfo:function(){return e.lazy(this.renderState,"selectedInfo",this._createSelectedInfo,this)},_createSelectedInfo:function(){var e=this.chart().data.owner.selectedCount()>0,t=e&&this.datums().any(Nn);return{any:e,is:t}},select:function(t){var n=this,r=n.datums().array();if(r.length){var i=n.chart();i._updatingSelections(function(){r=i._onUserSelection(r),r&&r.length&&(i.options.ctrlSelectMode&&e.get(t,"replace",!0)?i.data.replaceSelected(r):sn.data.Data.toggleSelected(r))})}},isSelectedDescendantOrSelf:function(){return this.isSelected()?!0:e.lazy(this.renderState,"isSelectedDescOrSelf",this._calcIsSelectedDescOrSelf,this)},_calcIsSelectedDescOrSelf:function(){var e=this.firstChild;if(e)do if(e.isSelectedDescendantOrSelf())return!0;while(e=e.nextSibling);return!1},toggleVisible:function(){sn.data.Data.toggleVisible(this.datums())&&this.chart().render(!0,!0,!1)}}),sn.visual.Scene.prototype.variable=function(t,n){var r,i=this;if(i._vars&&i._vars[t])void 0!==n&&(r=e.set({},"_"+t+"EvalCore",e.fun.to(n)));else{i.hasOwnProperty("_vars")||(i._vars=e.create(i._vars)),i._vars[t]=!0,r={};var s="_"+t+"Eval";r[t]=qt(t,s);var o=s+"Core";e.hasOwn(i,s)||(r[s]=e.methodCaller(o)),e.hasOwn(i,o)||(r[o]=e.fun.to(void 0===n?null:n))}return r&&i.constructor.add(r),i};var kn=sn.visual.ValueLabelVar=function(e,t,n,r){this.value=e,this.label=t,void 0!==n&&(this.rawValue=n),void 0!==r&&(this.absLabel=r)};e.set(kn.prototype,"rawValue",void 0,"absLabel",void 0,"setValue",function(e){return this.value=e,this},"setLabel",function(e){return this.label=e,this},"clone",function(){return new kn(this.value,this.label,this.rawValue)},"toString",function(){var e=this.label||this.value;return null==e?"":"string"!=typeof e?""+e:e}),kn.fromComplex=function(e){return e?new kn(e.value,e.label,e.rawValue,e.absLabel):new kn(null,"",null)},kn.fromAtom=kn.fromComplex,e.type("pvc.visual.Context").init(function(e,t,n){this.chart=e.chart,this.panel=e,Rt.call(this,t,n)}).add({isPinned:!1,pin:function(){return this.isPinned=!0,this},compatVersion:function(){return this.panel.compatVersion()},finished:function(e){return this.sign.finished(e)},delegate:function(e){return this.sign.delegate(e)},getV1Series:function(){var t;return e.nullyTo(this.scene.firstAtoms&&(t=this.scene.firstAtoms[this.panel._getV1DimName("series")])&&t.rawValue,"Series")},getV1Category:function(){var e;return this.scene.firstAtoms&&(e=this.scene.firstAtoms[this.panel._getV1DimName("category")])&&e.rawValue},getV1Value:function(){var e;return this.scene.firstAtoms&&(e=this.scene.firstAtoms[this.panel._getV1DimName("value")])&&e.value},getV1Datum:function(){return this.panel._getV1Datum(this.scene)},get:function(e,t){return this.scene.get(e,t)},getSeries:function(){return this.scene.get("series")},getCategory:function(){return this.scene.get("category")},getValue:function(){return this.scene.get("value")},getTick:function(){return this.scene.get("tick")},getX:function(){return this.scene.get("x")},getY:function(){return this.scene.get("y")},getColor:function(){return this.scene.get("color")},getSize:function(){return this.scene.get("size")},getSeriesLabel:function(){return this.scene.get("series","label")},getCategoryLabel:function(){return this.scene.get("category","label")},getValueLabel:function(){return this.scene.get("value","label")},getTickLabel:function(){return this.scene.get("tick","label")},getXLabel:function(){return this.scene.get("x","label")},getYLabel:function(){return this.scene.get("y","label")},getColorLabel:function(){return this.scene.get("color","label")},getSizeLabel:function(){return this.scene.get("size","label")},select:function(e){return this.scene.select(e)},toggleVisible:function(){return this.scene.toggleVisible()},click:function(){var e=this;e.clickable()&&e.panel._onClick(e);if(e.selectableByClick()){var t=e.event;e.select({replace:!t||!t.ctrlKey})}},doubleClick:function(){this.doubleClickable()&&this.panel._onDoubleClick(this)},clickable:function(){var e=this;return(e.sign?e.sign.clickable():e.panel.clickable())&&(!e.scene||e.scene.clickable())},selectableByClick:function(){var e=this;return(e.sign?e.sign.selectableByClick():e.panel.selectableByClick())&&(!e.scene||e.scene.selectableByClick())},doubleClickable:function(){var e=this;return(e.sign?e.sign.doubleClickable():e.panel.doubleClickable())&&(!e.scene||e.scene.doubleClickable())},hoverable:function(){var e=this;return(e.sign?e.sign.hoverable():e.panel.hoverable())&&(!e.scene||e.scene.hoverable())}});if(Object.defineProperty)try{Object.defineProperty(sn.visual.Context.prototype,"parent",{get:function(){throw e.error.operationInvalid("The 'this.parent.index' idiom has no equivalent in this version. Please try 'this.pvMark.parent.index'.")}})}catch(Ln){}e.space("pvc.visual").TraversalMode=e.makeEnum(["Tree","FlattenedSingleLevel","FlattenDfsPre","FlattenDfsPost"]),e.type("pvc.visual.Role").init(function(t,n){this.name=t,this.label=e.get(n,"label")||sn.buildTitleFromName(t),this.index=e.get(n,"index")||0,this.dimensionDefaults=e.get(n,"dimensionDefaults")||{},e.get(n,"isRequired",!1)&&(this.isRequired=!0),e.get(n,"autoCreateDimension",!1)&&(this.autoCreateDimension=!0);var r=e.get(n,"defaultSourceRole");r&&(this.defaultSourceRoleName=r);var i=e.get(n,"defaultDimension");i&&(this.defaultDimensionName=i);if(!i&&this.autoCreateDimension)throw e.error.argumentRequired("defaultDimension");var s,o=e.get(n,"requireIsDiscrete");null!=o&&(o||(s=!0));if(null!=s){s=e.get(n,"requireSingleDimension",!1);if(s){e.get(n,"isMeasure",!1)&&(this.isMeasure=!0,e.get(n,"isPercent",!1)&&(this.isPercent=!0));var u=e.get(n,"valueType",null);u!==this.valueType&&(this.valueType=u,this.dimensionDefaults.valueType=u)}}s!==this.requireSingleDimension&&(this.requireSingleDimension=s),o!=this.requireIsDiscrete&&(this.requireIsDiscrete=!!o,this.dimensionDefaults.isDiscrete=this.requireIsDiscrete);var a=e.get(n,"traversalMode");null!=a&&a!==this.traversalMode&&(this.traversalMode=a)}).add({isRequired:!1,requireSingleDimension:!1,valueType:null,requireIsDiscrete:null,isMeasure:!1,isPercent:!1,defaultSourceRoleName:null,defaultDimensionName:null,grouping:null,traversalMode:sn.visual.TraversalMode.FlattenedSingleLevel,rootLabel:"",autoCreateDimension:!1,isReversed:!1,label:null,sourceRole:null,isDefaultSourceRole:!1,firstDimensionType:function(){var e=this.grouping;return e&&e.firstDimensionType()},firstDimensionName:function(){var e=this.grouping;return e&&e.firstDimensionName()},firstDimensionValueType:function(){var e=this.grouping;return e&&e.firstDimensionValueType()},isDiscrete:function(){var e=this.grouping;return e&&e.isDiscrete()},setSourceRole:function(e,t){this.sourceRole=e,this.isDefaultSourceRole=!!t},setIsReversed:function(e){e?this.isReversed=!0:delete this.isReversed},setTraversalMode:function(t){var n=sn.visual.TraversalMode;t=e.nullyTo(t,n.FlattenedSingleLevel),t!==this.traversalMode&&(t===n.FlattenedSingleLevel?delete this.traversalMode:this.traversalMode=t)},setRootLabel:function(e){e!==this.rootLabel&&(e?this.rootLabel=e:delete this.rootLabel,this.grouping&&this._updateBind(this.grouping))},flatten:function(t,n){var r=this.flattenedGrouping(n)||e.fail.operationInvalid("Role is unbound.");return t.groupBy(r,n)},flattenedGrouping:function(e){var t=this.grouping;if(t){e=e?Object.create(e):{};var n=e.flatteningMode;return null==n&&(n=e.flatteningMode=this._flatteningMode()),null!=e.isSingleLevel||n||(e.isSingleLevel=!0),t.ensure(e)}},_flatteningMode:function(){var e=sn.visual.TraversalMode,t=sn.data.FlatteningMode;switch(this.traversalMode){case e.FlattenDfsPre:return t.DfsPre;case e.FlattenDfsPost:return t.DfsPost}return e.None},select:function(t,n){var r=this.grouping;if(r)return e.setUDefaults(n,"flatteningMode",sn.data.FlatteningMode.None),t.groupBy(r.ensure(n),n)},view:function(e){var t=this.grouping;return t?t.view(e):void 0},preBind:function(e){return this.__grouping=e,this},isPreBound:function(){return!!this.__grouping},preBoundGrouping:function(){return this.__grouping},isBound:function(){return!!this.grouping},postBind:function(e){var t=this.__grouping;return t&&(delete this.__grouping,t.bind(e),this.bind(t)),this},bind:function(e){return e=this._validateBind(e),this._updateBind(e),this},_validateBind:function(t){if(t)if(t.isNull())t=null;else{if(this.requireSingleDimension&&!t.isSingleDimension)throw e.error.operationInvalid("Role '{0}' only accepts a single dimension.",[this.name]);var n=this.valueType,r=this.requireIsDiscrete;t.dimensions().each(function(t){var i=t.type;if(n&&i.valueType!==n)throw e.error.operationInvalid("Role '{0}' cannot be bound to dimension '{1}'. \nIt only accepts dimensions of type '{2}' and not of type '{3}'.",[this.name,i.name,sn.data.DimensionType.valueTypeName(n),i.valueTypeName]);if(null!=r&&i.isDiscrete!==r){if(!r)throw e.error.operationInvalid("Role '{0}' cannot be bound to dimension '{1}'. \nIt only accepts {2} dimensions.",[this.name,i.name,r?"discrete":"continuous"]);i._toDiscrete()}},this)}return t},_updateBind:function(e){this.grouping&&this.grouping.dimensions().each(function(e){e.type&&V.call(e.type,this)},this),this.grouping=e,this.grouping&&(this.grouping=this.grouping.ensure({reverse:this.isReversed,rootLabel:this.rootLabel}),this.grouping.dimensions().each(function(e){X.call(e.type,this)},this))}}),e.type("pvc.visual.RoleVarHelper").init(function(t,n,r){var i=e.get(r,"hasPercentSubVar",!1),s=e.get(r,"roleVar"),o=this.grouping=n&&n.grouping;if(o){this.role=n,this.sourceRoleName=n.sourceRole&&n.sourceRole.name;var u=t.panel();this.panel=u,o.isDiscrete()||(this.rootContDim=u.data.owner.dimensions(o.firstDimensionName()),i&&(this.percentFormatter=u.chart.options.percentValueFormat))}if(!s){if(!n)throw e.error.operationInvalid("Role is not defined, so the roleVar argument is required.");s=n.name}if(!o){var a=t.vars[s]=new kn(null,"");i&&(a.percent=new kn(null,""))}this.roleVarName=s,t["is"+e.firstUpperCase(s)+"Bound"]=!!o,e.get(r,"allowNestedVars")&&(this.allowNestedVars=!0)}).add({allowNestedVars:!1,isBound:function(){return!!this.grouping},onNewScene:function(t,n){if(this.grouping){var r=this.roleVarName;if(this.allowNestedVars?!e.hasOwnProp.call(t.vars,r):!t.vars[r]){var i=this.sourceRoleName;if(i){var s=e.getOwn(t.vars,i);if(s){t.vars[r]=s.clone();return}}if(n){var o,u=this.rootContDim;if(u){var a,f,l=t.group,c=l?l.singleDatum():t.datum;if(c)c.isNull||(o=kn.fromAtom(c.atoms[u.name]),null!=o.value&&this.percentFormatter&&(l?(f=l.dimensions(u.name),a=f.valuePercent({visible:!0})):a=t.data().dimensions(u.name).percent(o.value)));else if(l){f=l.dimensions(u.name);var h=f.value({visible:!0,zeroIfNone:!1});if(null!=h){var p=u.format(h);o=new kn(h,p,h),this.percentFormatter&&(a=f.valuePercent({visible:!0}))}}o&&this.percentFormatter&&(o.percent=null==o.value?new kn(null,""):new kn(a,this.percentFormatter.call(null,a)))}else{var d=t.datum;if(d&&!d.isNull){var v=this.grouping.view(d);o=kn.fromComplex(v)}}o||(o=new kn(null,""),this.percentFormatter&&(o.percent=new kn(null,""))),t.vars[r]=o}}}}}),on.prototype.getSign=function(){return this.sign||Ut(this)},on.prototype.getScene=function(){return this.getSign().scene()},on.prototype.getContext=function(){return this.getSign().context()},on.prototype.preBuildInstance=function(e){var t=e.data;t instanceof sn.visual.Scene&&jt.call(t,this.renderId())},e.type("pvc.visual.BasicSign").init(function(t,n){this.chart=t.chart,this.panel=t,!n.sign||e.assert("Mark already has an attached Sign."),this.pvMark=n,n.sign=this}).add({compatVersion:function(){return this.chart.compatVersion()},localProperty:function(e,t){return this.pvMark.localProperty(e,t),this},lock:function(e,t){return this.lockMark(e,this._bindWhenFun(t,e))},optional:function(e,t,n){return this.optionalMark(e,this._bindWhenFun(t,e),n)},lockMark:function(e,t){return this.pvMark.lock(e,t),this},optionalMark:function(e,t,n){return this.pvMark[e](t,n),this},delegate:function(e,t){return this.pvMark.delegate(e,t)},delegateExtension:function(e){return this.pvMark.delegate(e,sn.extensionTag)},delegateNotExtension:function(e){return this.pvMark.delegateExcept(e,sn.extensionTag)},hasDelegate:function(e){return this.pvMark.hasDelegate(e)},_createPropInterceptor:function(e,t){var n=this;return function(){var r=this.sign;return r&&r===n?t.apply(n,arguments):n._getPvSceneProp(e,this.index)}},_getPvSceneProp:function(t,n){var r=this.pvMark,i=r.scene;if(i){var s=r.hasOwnProperty("index")?r.index:Math.min(n,i.length-1);if(null!=s)return i[s][t]}throw e.error.operationInvalid("Cannot evaluate inherited property.")},_bindWhenFun:function(t,n){if(e.fun.is(t)){var r=this;return r._createPropInterceptor(n,function(e){return t.call(r,e)})}return t},_lockDynamic:function(e,t){var n=this;return n.lockMark(e,n._createPropInterceptor(e,function(e){return n[t].call(n,e)}))},scene:function(){var e=this.pvMark.instance(),t=e&&e.data;return t instanceof sn.visual.Scene?t:null},instanceState:function(e){return this.pvMark.instanceState(e)},context:function(e,t){var n;return t||!(n=this.instanceState())?this._createContext(e):n.cccContext||(n.cccContext=this._createContext(e))},_createContext:function(e){return new sn.visual.Context(this.panel,this.pvMark,e)}}),e.type("pvc.visual.Sign",sn.visual.BasicSign).init(function(t,n,r){var i=this;i.base(t,n,r),i._ibits=t._ibits;var s=e.get(r,"extensionId");null!=s&&(i.extensionAbsIds=e.array.to(t._makeExtensionAbsId(s))),i.isActiveSeriesAware=e.get(r,"activeSeriesAware",!0);if(i.isActiveSeriesAware){var o=t.visualRoles,u=o&&o.series;u&&u.isBound()||(i.isActiveSeriesAware=!1)}n.wrapper(e.get(r,"wrapper")||i.createDefaultWrapper()),e.get(r,"freeColor",!0)||i._bindProperty("fillStyle","fillColor","color")._bindProperty("strokeStyle","strokeColor","color")}).postInit(function(e,t,n){this._addInteractive(n),e._addSign(this)}).add({createDefaultWrapper:function(){var e=this;return function(t){return function(n){return t.call(e.context(),n)}}},property:function(t){var n=e.firstUpperCase(t),r="base"+n,i="default"+n,s="normal"+n,o="interactive"+n,u={};return u[t]=function(e,t){this._finished=!1,this._arg=t;var n=this[r](e,t);return null==n?null:this._finished?n:(n=this.showsInteraction()&&e.anyInteraction()?this[o](e,n,t):this[s](e,n,t),this._arg=null,n)},u[r]=function(){return this.delegateExtension()},u[i]=function(){},u[s]=function(e,t){return t},u[o]=function(e,t){return t},this.constructor.add(u),this},anyInteraction:function(e){return e.anyInteraction()},finished:function(e){return this._finished=!0,e},applyExtensions:function(){if(!this._extended){this._extended=!0;var e=this.extensionAbsIds;e&&e.forEach(function(e){this.panel.extendAbs(this.pvMark,e)},this)}return this},intercept:function(e,t){var n=this._createPropInterceptor(e,t);return this._intercept(e,n)},lockDimensions:function(){return this.pvMark.lock("left").lock("right").lock("top").lock("bottom").lock("width").lock("height"),this},_extensionKeyArgs:{tag:sn.extensionTag},_bindProperty:function(t,n,r){var i=this;r||(r=n);var s="default"+e.firstUpperCase(r);if(e.fun.is(i[s])&&!i.pvMark.hasDelegateValue(t,sn.extensionTag)){var o=function(e){return i[s](e,i._arg)};i.pvMark.intercept(t,o,i._extensionKeyArgs)}var u=this._createPropInterceptor(t,function(e){return i[n](e)});return i._intercept(t,u)},_intercept:function(t,n){var r=this.pvMark,i=this.extensionAbsIds;return i&&e.query(i).select(function(e){return this.panel._getExtensionAbs(e,t)},this).where(e.notUndef).each(function(e){e=r.wrap(e,t),r.intercept(t,e,this._extensionKeyArgs)},this),(r._intercepted||(r._intercepted={}))[t]=!0,r.intercept(t,n),this}}).prototype.property("color").constructor.add(sn.visual.Interactive).add({extensionAbsIds:null,_addInteractive:function(t){var n=this,r=e.get;if(n.interactive()){var i=n._ibits,s=sn.visual.Interactive;r(t,"noTooltip")&&(i&=~s.ShowsTooltip),r(t,"noHover")&&(i&=~s.Hoverable),r(t,"noClick")&&(i&=~s.Clickable),r(t,"noDoubleClick")&&(i&=~s.DoubleClickable),r(t,"noSelect")?i&=~s.SelectableAny:this.selectable()&&(r(t,"noClickSelect")&&(i&=~s.SelectableByClick),r(t,"noRubberSelect")&&(i&=~s.SelectableByRubberband)),n.showsInteraction()&&(r(t,"showsInteraction")===!1&&(i&=~s.ShowsInteraction),n.showsActivity()&&r(t,"showsActivity")===!1&&(i&=~s.ShowsActivity),n.showsSelection()&&r(t,"showsSelection")===!1&&(i&=~s.ShowsSelection)),n._ibits=i}n.handlesEvents()?(n.showsTooltip()&&n._addPropTooltip(r(t,"tooltipArgs")),n.hoverable()&&n._addPropHoverable(),n.handlesClickEvent()&&n._addPropClick(),n.doubleClickable()&&n._addPropDoubleClick()):n.pvMark.events("none")},fillColor:function(e){return this.color(e,"fill")},strokeColor:function(e){return this.color(e,"stroke")},defaultColor:function(e){return this.defaultColorSceneScale()(e)},dimColor:function(e,t){return"text"===t?sn.toGrayScale(e,-0.75,null,null):sn.toGrayScale(e,-0.3,null,null)},defaultColorSceneScale:function(){return e.lazy(this,"_defaultColorSceneScale",this._initDefColorScale,this)},_initDefColorScale:function(){var t=this.panel.axes.color;return t?t.sceneScale({sceneVarName:"color"}):e.fun.constant(sn.defaultColor)},mayShowActive:function(e,t){return this.showsActivity()?e.isActive||!t&&this.isActiveSeriesAware&&e.isActiveSeries()||e.isActiveDatum():!1},mayShowNotAmongSelected:function(e){return this.mayShowAnySelected(e)&&!e.isSelected()},mayShowSelected:function(e){return this.showsSelection()&&e.isSelected()},mayShowAnySelected:function(e){return this.showsSelection()&&e.anySelected()},_addPropTooltip:function(n){if(!this.pvMark.hasTooltip){var r=e.create(this.chart._tooltipOptions,e.get(n,"options"));r.isLazy=e.get(n,"isLazy",!0);var i=e.get(n,"buildTooltip")||this._getTooltipFormatter(r);if(i){r.isEnabled=this._isTooltipEnabled.bind(this);var s=e.get(n,"tipsyEvent");s||(s="mouseover"),this.pvMark.localProperty("tooltip").tooltip(this._createTooltipProp(i,r.isLazy)).title(e.fun.constant("")).ensureEvents().event(s,t.Behavior.tipsy(r)).hasTooltip=!0}}},_getTooltipFormatter:function(e){return this.panel._getTooltipFormatter(e)},_isTooltipEnabled:function(){return this.panel._isTooltipEnabled()},_createTooltipProp:function(e,t){var n,r=this;return n=t?function(t){var n,i=r.context(t,!0);return function(){return i&&(n=e(i),i=null),n}}:function(t){var n=r.context(t);return e(n)},function(e){return e&&!e.isIntermediate&&e.showsTooltip()?n(e):void 0}},_addPropHoverable:function(){var e,t,n=this.panel;e="mouseover",t="mouseout",this.pvMark.ensureEvents().event(e,function(e){e.hoverable()&&!n.selectingByRubberband()&&!n.animating()&&(e.setActive(!0),n.renderInteractive())}).event(t,function(e){!e.hoverable()||n.selectingByRubberband()||n.animating()||e.clearActive()&&n.renderInteractive()})},_ignoreClicks:0,_propCursorClick:function(e){var t=this._ibits&e._ibits,n=sn.visual.Interactive;return t&n.HandlesClickEvent||t&n.DoubleClickable?"pointer":null},_addPropClick:function(){var e=this;e.pvMark.cursor(e._propCursorClick.bind(e)).ensureEvents().event("click",e._handleClick.bind(e))},_addPropDoubleClick:function(){var e=this;e.pvMark.cursor(e._propCursorClick.bind(e)).ensureEvents().event("dblclick",e._handleDoubleClick.bind(e))},_handleClick:function(){var e=this,n=e.pvMark,r=n.instance(),i=r.data,s=e.doubleClickable()&&i.doubleClickable();if(s){var o=n.scene,u=n.index,a=t.event;window.setTimeout(function(){if(e._ignoreClicks)e._ignoreClicks--;else try{t.event=a,n.context(o,u,function(){e._handleClickCore()})}catch(r){t.error(r)}finally{delete t.event}},e.chart.options.doubleClickMaxDelay||300)}else e._ignoreClicks?e._ignoreClicks--:e._handleClickCore()},_handleClickCore:function(){this._onClick(this.context())},_handleDoubleClick:function(){var e=this,t=e.scene();t&&t.doubleClickable()&&(e._ignoreClicks=2,e._onDoubleClick(e.context(t)))},_onClick:function(e){e.click()},_onDoubleClick:function(e){e.doubleClick()}}),e.type("pvc.visual.Panel",sn.visual.Sign).init(function(n,r,i){var s=e.get(i,"panel");if(!s){var o=e.get(i,"panelType")||t.Panel;s=r.add(o)}this.base(n,s,i)}).add({_addInteractive:function(t){var n=!0;t=e.setDefaults(t,"noSelect",n,"noHover",n,"noTooltip",n,"noClick",n,"noDoubleClick",n),this.base(t)}}),e.type("pvc.visual.Label",sn.visual.Sign).init(function(e,n,r){var i=n.add(t.Label);this.base(e,i,r)}).add({_addInteractive:function(t){var n=!0;t=e.setDefaults(t,"noSelect",n,"noHover",n,"noTooltip",n,"noClick",n,"noDoubleClick",n,"showsInteraction",!1),this.base(t)},defaultColor:e.fun.constant(t.Color.names.black)});var An=t.Color.names.white;e.type("pvc.visual.ValueLabel",sn.visual.Label).init(function(t,n,r){this.valuesFont=e.get(r,"valuesFont")||t.valuesFont,this.valuesMask=e.get(r,"valuesMask")||t.valuesMask,this.valuesOptimizeLegibility=e.get(r,"valuesOptimizeLegibility",t.valuesOptimizeLegibility),this.valuesOverflow=e.get(r,"valuesOverflow",t.valuesOverflow),this.hideOverflowed="hide"===this.valuesOverflow,this.trimOverflowed=!this.hideOverflowed&&"trim"===this.valuesOverflow,this.hideOrTrimOverflowed=this.hideOverflowed||this.trimOverflowed;var i;i=e.get(r,"noAnchor",!1)?n:n.anchor(t.valuesAnchor),r&&null==r.extensionId&&(r.extensionId="label"),this.base(t,i,r),this.pvMark.font(this.valuesFont),this._bindProperty("text","text")._bindProperty("textStyle","textColor","color").intercept("visible",this.visible)}).prototype.property("text").property("textStyle").constructor.addStatic({maybeCreate:function(e,t,n){return e.valuesVisible&&e.valuesMask?new sn.visual.ValueLabel(e,t,n):null},isNeeded:function(e){return e.valuesVisible&&e.valuesMask}}).add({_addInteractive:function(t){t=e.setDefaults(t,"showsInteraction",!0,"noSelect",!0,"noTooltip",!0,"noClick",!0,"noDoubleClick",!0,"noHover",!0),this.base(t)},visible:function(e){var t=this.getAnchoredToMark();if(t&&!t.visible())return!1;if(!this.hideOrTrimOverflowed)return this.delegate(!0);var n;if(this.hasDelegate(sn.extensionTag)){n=this.delegateExtension();if(null!=n)return n}n=this.delegateNotExtension();if(n===!1)return!1;if(e.isActive&&this.showsActivity())return!0;var r=this.textFitInfo(e);return!r||!r.hide},textFitInfo:function(e){var t=e.renderState,n=t.textFitInfo;return void 0!==n?n:t.textFitInfo=this.calcTextFitInfo(e,this._evalBaseText())||null},calcTextFitInfo:function(){return null},_evalBaseText:function(){var e=this.pvMark,t=e.binds.properties.text.proto;return e.evalInPropertyContext(this.baseText.bind(this),t)},baseText:function(e){var t=e.renderState,n=t.baseText;return void 0!==n?n:this.base(e)},defaultText:function(e){return e.format(this.valuesMask)},normalText:function(e,t){var n;return this.trimOverflowed&&(n=this.textFitInfo(e))?this.trimText(e,t,n):t},interactiveText:function(e,t){var n;return!this.trimOverflowed||e.isActive&&this.showsActivity()||!(n=this.textFitInfo(e))?t:this.trimText(e,t,n)},trimText:function(e,t,n){var r=n&&n.widthMax;return null!=r?sn.text.trimToWidthB(r,t,this.pvMark.font(),".."):t},textColor:function(e){return this.color(e,"text")},backgroundColor:function(t,n){var r=this.instanceState();if(!r)return this.calcBackgroundColor(t,n);var i=e.lazy(r,"cccBgColorCache"),s=e.getOwn(i,n);return s||(s=i[n]=this.calcBackgroundColor(t,n)),s},calcBackgroundColor:function(e){var t=this.getAnchoredToMark();if(t){var n=t.fillStyle();if(n&&n!==An&&this.isAnchoredInside(e,t))return n}return An},getAnchoredToMark:function(){return this.pvMark.target||this.pvMark.parent},isAnchoredInside:function(e,n){if(!n&&!(n=this.getAnchoredToMark()))return!1;var r,i=this.pvMark,s=i.text(),o=t.Text.measure(s,i.font()),u=i.left(),a=i.top();null==u&&(r=i.parent,u=r.width()-(i.right()||0)),null==a&&(r||(r=i.parent),a=r.height()-(i.bottom()||0));var f=t.Label.getPolygon(o.width,o.height,i.textAlign(),i.textBaseline(),i.textAngle(),i.textMargin()).center().plus(u,a),l=n.getShape(n.scene,i.index);return l.containsPoint(f)},maybeOptimizeColorLegibility:function(e,t,n){if(this.valuesOptimizeLegibility){var r=this.backgroundColor(e,n);return r&&r!==An&&r.isDark()===t.isDark()?t.complementary().alpha(.9):t}return t},normalColor:function(e,t,n){return this.maybeOptimizeColorLegibility(e,t,n)},interactiveColor:function(e,t,n){return!this.mayShowActive(e)&&this.mayShowNotAmongSelected(e)?this.dimColor(t,n):this.maybeOptimizeColorLegibility(e,t,n)}}),e.type("pvc.visual.Dot",sn.visual.Sign).init(function(n,r,i){var s=r.add(t.Dot),o=e.get(i,"proto");o&&s.extend(o),i=e.setDefaults(i,"freeColor",!1),this.base(n,s,i);if(!e.get(i,"freePosition",!1)){var u=n.isOrientationVertical()?"left":"bottom",a=n.anchorOrtho(u);this._lockDynamic(u,"x")._lockDynamic(a,"y")}this._bindProperty("shape","shape")._bindProperty("shapeRadius","radius")._bindProperty("shapeSize","size"),this.optional("strokeDasharray",void 0).optional("lineWidth",1.5)}).prototype.property("size").property("shape").constructor.add({y:e.fun.constant(0),x:e.fun.constant(0),radius:function(){this.instanceState().cccRadius=this.delegateExtension()},baseSize:function(t){var n=this.instanceState().cccRadius;return null!=n?e.sqr(n):this.base(t)},defaultSize:e.fun.constant(12),interactiveSize:function(e,t){return this.mayShowActive(e,!0)?2.5*Math.max(t,5):t},interactiveColor:function(e,t,n){if(this.mayShowActive(e,!0)){if("stroke"===n)return t.brighter(1)}else if(this.mayShowNotAmongSelected(e)){if(this.mayShowActive(e))return t.alpha(.8);switch(n){case"fill":return this.dimColor(t,n);case"stroke":return t.alpha(.45)}}return this.base(e,t,n)}}),e.type("pvc.visual.DotSizeColor",sn.visual.Dot).init(function(e,n,r){this.base(e,n,r);var i=this.compatVersion()<=1;this._bindProperty("lineWidth","strokeWidth").intercept("visible",function(e){if(!this.canShow(e))return!1;var t=this.delegateExtension();return null==t&&(t=i||this.defaultVisible(e)),t}),this._initColor(),this._initSize();if(this.isSizeBound){var s=e.axes.size;if(s.scaleUsesAbs()){this.isSizeAbs=!0;var o=this._sceneDefColor;this._sceneDefColor=function(e,n){return"stroke"===n&&e.vars.size.value<0?t.Color.names.black:o.call(this,e,n)},this.pvMark.lineCap("round").strokeDasharray(function(e){return e.vars.size.value<0?"dash":null})}}}).prototype.property("strokeWidth").constructor.add({isColorBound:!1,isColorDiscrete:!1,isSizeBound:!1,isSizeAbs:!1,canShow:function(e){return!e.isIntermediate},defaultVisible:function(e){return!e.isNull&&(!this.isSizeBound&&!this.isColorBound||this.isSizeBound&&null!=e.vars.size.value||this.isColorBound&&(this.isColorDiscrete||null!=e.vars.color.value))},_initColor:function(){var t,n,r=this.panel,i=r.visualRoles.color;if(i){this.isColorDiscrete=i.isDiscrete();var s=r.axes.color;i.isBound()?(this.isColorBound=!0,n=s.sceneScale({sceneVarName:"color"})):s&&(t=s.option("Unbound"))}n||(n=e.fun.constant(t||sn.defaultColor)),this._sceneDefColor=n},_initSize:function(){var t,n,r=this.panel,i=r.plot,s=i.option("Shape"),o=i.option("NullShape"),u=r.visualRoles.size;if(u){var a=r.axes.size,f=a&&a.scale,l=!!f&&u.isBound();if(l){this.isSizeBound=!0;var c=f.min+.05*(f.max-f.min);this.nullSizeShapeHasStrokeOnly="cross"===o,n=function(e){return null!=e.vars.size.value?s:o},t=function(e){var t=e.vars.size.value;return null!=t?f(t):o?c:0}}}t||(n=e.fun.constant(s),t=function(e){return this.base(e)}),this._sceneDefSize=t,this._sceneDefShape=n},defaultColor:function(e,t){return this._sceneDefColor(e,t)},normalColor:function(e,t,n){return"stroke"===n?t.darker():this.base(e,t,n)},interactiveColor:function(e,t,n){if(this.mayShowActive(e,!0))switch(n){case"fill":return this.isSizeBound?t.alpha(.75):t;case"stroke":return t.darker()}else if(this.showsSelection()){var r=e.isSelected(),i=!r&&e.anySelected();if(i){if(this.mayShowActive(e))return t.alpha(.8);switch(n){case"fill":return this.dimColor(t,n);case"stroke":return t.alpha(.45)}}if(r&&a(t))return"stroke"===n&&(t=t.darker(3)),t.darker(2)}return"stroke"===n?t.darker():t},defaultSize:function(e){return this._sceneDefSize(e)},defaultShape:function(e){return this._sceneDefShape(e)},interactiveSize:function(t,n){if(!this.mayShowActive(t,!0))return n;var r=Math.sqrt(n),i=Math.max(1,Math.min(1.1*r,2));return e.sqr(r+i)},defaultStrokeWidth:function(e){return this.nullSizeShapeHasStrokeOnly&&null==e.vars.size.value?1.8:1},interactiveStrokeWidth:function(e,t){return this.mayShowActive(e,!0)?2*t:this.mayShowSelected(e)?1.5*t:t}}),t.LineInterm=function(){t.Line.call(this)},t.LineInterm.prototype=t.extend(t.Line),t.LineInterm.prototype.getNearestInstanceToMouse=function(e,n){var r=t.Line.prototype.getNearestInstanceToMouse.call(this,e,n),i=e[r];return i&&i.data&&i.data.isIntermediate&&r+1<e.length&&r++,r},e.type("pvc.visual.Line",sn.visual.Sign).init(function(n,r,i){var s=r.add(t.LineInterm);this.base(n,s,i),this.lock("segmented","smart").lock("antialias",!0);if(!e.get(i,"freePosition",!1)){var o=n.isOrientationVertical()?"left":"bottom",u=n.anchorOrtho(o);this._lockDynamic(u,"y")._lockDynamic(o,"x")}this._bindProperty("strokeStyle","strokeColor","color")._bindProperty("lineWidth","strokeWidth")}).prototype.property("strokeWidth").constructor.add({_addInteractive:function(t){t=e.setDefaults(t,"noTooltip",!0),this.base(t)},y:e.fun.constant(0),x:e.fun.constant(0),defaultStrokeWidth:e.fun.constant(1.5),interactiveStrokeWidth:function(e,t){return this.mayShowActive(e)?2.5*Math.max(1,t):t},interactiveColor:function(e,n,r){return this.mayShowNotAmongSelected(e)?this.mayShowActive(e)?t.Color.names.darkgray.darker().darker():this.dimColor(n,r):this.base(e,n,r)}}),t.AreaInterm=function(){t.Area.call(this)},t.AreaInterm.prototype=t.extend(t.Area),t.AreaInterm.prototype.getNearestInstanceToMouse=function(e,n){var r=t.Area.prototype.getNearestInstanceToMouse.call(this,e,n),i=e[r];return i&&i.data&&i.data.isIntermediate&&r+1<e.length&&r++,r},e.type("pvc.visual.Area",sn.visual.Sign).init(function(n,r,i){var s=r.add(t.AreaInterm);i||(i={}),i.freeColor=!0,this.base(n,s,i);var o=e.get(i,"antialias",!0);this.lock("segmented","smart").lock("antialias",o);if(!e.get(i,"freePosition",!1)){var u=n.isOrientationVertical()?"left":"bottom",a=n.anchorOrtho(u),f=n.anchorOrthoLength(a);this._lockDynamic(u,"x")._lockDynamic(a,"y")._lockDynamic(f,"dy")}this._bindProperty("fillStyle","fillColor","color"),this.lock("strokeStyle",null).lock("lineWidth",0)}).add({_addInteractive:function(t){t=e.setDefaults(t,"noTooltip",!0),this.base(t)},y:e.fun.constant(0),x:e.fun.constant(0),dy:e.fun.constant(0),interactiveColor:function(e,t,n){return"fill"===n&&this.mayShowNotAmongSelected(e)?this.dimColor(t,n):this.base(e,t,n)}}),e.type("pvc.visual.Bar",sn.visual.Sign).init(function(n,r,i){var s=r.add(t.Bar);i=e.setDefaults(i,"freeColor",!1),this.base(n,s,i),this.normalStroke=e.get(i,"normalStroke",!1),this._bindProperty("lineWidth","strokeWidth")}).prototype.property("strokeWidth").constructor.add({normalColor:function(e,t,n){return"stroke"!==n||this.normalStroke?t:null},interactiveColor:function(e,n,r){if("stroke"===r){if(this.mayShowActive(e,!0))return n.brighter(1.3).alpha(.7);if(!this.normalStroke)return null;if(this.mayShowNotAmongSelected(e))return this.mayShowActive(e)?t.Color.names.darkgray.darker().darker():this.dimColor(n,r);if(this.mayShowActive(e))return n.brighter(1).alpha(.7)}else if("fill"===r){if(this.mayShowActive(e,!0))return n.brighter(.2).alpha(.8);if(this.mayShowNotAmongSelected(e))return this.mayShowActive(e)?t.Color.names.darkgray.darker(2).alpha(.8):this.dimColor(n,r);if(this.mayShowActive(e))return n.brighter(.2).alpha(.8)}return this.base(e,n,r)},defaultStrokeWidth:function(){return.5},interactiveStrokeWidth:function(e,t){return this.mayShowActive(e,!0)?1.3*Math.max(1,t):t}}),t.PieSlice=function(){t.Wedge.call(this)},t.PieSlice.prototype=t.extend(t.Wedge).property("offsetRadius"),t.PieSlice.prototype.midAngle=function(){var e=this.instance();return e.startAngle+e.angle/2},t.PieSlice.prototype.defaults=(new t.PieSlice).extend(t.Wedge.prototype.defaults).offsetRadius(0),e.type("pvc.visual.PieSlice",sn.visual.Sign).init(function(n,r,i){var s=r.add(t.PieSlice);i=e.setDefaults(i,"freeColor",!1),this.base(n,s,i),this._activeOffsetRadius=e.get(i,"activeOffsetRadius",0),this._maxOffsetRadius=e.get(i,"maxOffsetRadius",0),this._resolvePctRadius=e.get(i,"resolvePctRadius"),this._center=e.get(i,"center"),this.optional("lineWidth",.6)._bindProperty("angle","angle")._bindProperty("offsetRadius","offsetRadius")._lockDynamic("bottom","y")._lockDynamic("left","x").lock("top",null).lock("right",null)}).prototype.property("offsetRadius").constructor.add({angle:e.fun.constant(0),x:function(){return this._center.x+this._offsetSlice("cos")},y:function(){return this._center.y-this._offsetSlice("sin")},_offsetSlice:function(e){var t=this.pvMark.offsetRadius()||0;return t&&(t*=Math[e](this.pvMark.midAngle())),t},defaultColor:function(e,t){return"stroke"===t?null:this.base(e,t)},interactiveColor:function(e,t,n){if(this.mayShowActive(e,!0))switch(n){case"fill":return t.brighter(.2).alpha(.8);case"stroke":return t.brighter(1.3).alpha(.7)}else if(this.mayShowNotAmongSelected(e)&&"fill"===n)return this.dimColor(t,n);return this.base(e,t,n)},offsetRadius:function(e){var t=this.base(e);return Math.min(Math.max(0,t),this._maxOffsetRadius)},baseOffsetRadius:function(e){var t=this.base(e)||0;return this._resolvePctRadius(ln.parse(t))},interactiveOffsetRadius:function(e,t){return t+(this.mayShowActive(e,!0)?this._activeOffsetRadius:0)}}),e.type("pvc.visual.Rule",sn.visual.Sign).init(function(n,r,i){var s=r.add(t.Rule),o=e.get(i,"proto");o&&s.extend(o),this.base(n,s,i),e.get(i,"freeStyle")||this._bindProperty("strokeStyle","strokeColor","color")._bindProperty("lineWidth","strokeWidth")}).prototype.property("strokeWidth").constructor.add({_addInteractive:function(t){var n=!0;t=e.setDefaults(t,"noHover",n,"noSelect",n,"noTooltip",n,"noClick",n,"noDoubleClick",n,"showsInteraction",!1),this.base(t)},defaultStrokeWidth:e.fun.constant(1),interactiveStrokeWidth:function(e,t){return this.mayShowActive(e,!0)?2.2*Math.max(1,t):t},interactiveColor:function(e,t,n){return e.datum&&!this.mayShowActive(e,!0)&&this.mayShowNotAmongSelected(e)?this.dimColor(t,n):this.base(e,t,n)}}),e.type("pvc.visual.OptionsBase").init(function(t,n,r,i){this.chart=t,this.type=n,this.index=null==r?0:r,this.name=e.get(i,"name"),this.id=this._buildId(),this.optionId=this._buildOptionId();var s=this._resolvers=[];this._registerResolversFull(s,i),this.option=sn.options(this._getOptionsDefinition(),this)}).add({_buildId:function(){return sn.buildIndexedId(this.type,this.index)},_buildOptionId:function(){return this.id},_chartOption:function(e){return this.chart.options[e]},_getOptionsDefinition:e.method({isAbstract:!0}),_registerResolversFull:function(t,n){var r=e.get(n,"fixed");r&&(this._fixed=r,t.push(sn.options.specify(function(e){return r[e.name]}))),this._registerResolversNormal(t,n);var i=e.get(n,"defaults");i&&(this._defaults=i),t.push(this._resolveDefault)},_registerResolversNormal:function(t,n){e.get(n,"byV1",!0)&&this.chart.compatVersion()<=1&&t.push(this._resolveByV1OnlyLogic),this.name&&t.push(sn.options.specify(function(t){return this._chartOption(this.name+e.firstUpperCase(t.name))})),t.push(this._resolveByOptionId),e.get(n,"byNaked",!this.index)&&t.push(this._resolveByNaked)},_resolveFull:function(e){for(var t=this._resolvers,n=0,r=t.length;r>n;n++)if(t[n].call(this,e))return!0;return!1},_resolveFixed:sn.options.specify(function(e){return this._fixed?this._fixed[e.name]:void 0}),_resolveByV1OnlyLogic:function(e){var t,n=e.data;return n&&(t=n.resolveV1)?t.call(this,e):void 0},_resolveByName:sn.options.specify(function(t){return this.name?this._chartOption(this.name+e.firstUpperCase(t.name)):void 0}),_resolveByOptionId:sn.options.specify(function(t){return this._chartOption(this.optionId+e.firstUpperCase(t.name))}),_resolveByNaked:sn.options.specify(function(t){return this.index?void 0:this._chartOption(e.firstLowerCase(t.name))}),_resolveDefault:function(e){var t,n=e.data;if(n&&(t=n.resolveDefault)&&t.call(this,e))return!0;if(this._defaults){var r=this._defaults[e.name];if(void 0!==r)return e.defaultValue(r),!0}},_specifyChartOption:function(e,t){var n=this._chartOption(t);if(null!=n)return e.specify(n),!0}}),e.type("pvc.visual.MultiChart",sn.visual.OptionsBase).init(function(e){this.base(e,"multiChart",0,{byV1:!1,byNaked:!1})}).add({_getOptionsDefinition:function(){return sn.visual.MultiChart.optionsDef}}).addStatic({optionsDef:{Max:{resolve:"_resolveFull",cast:sn.castPositiveNumber,value:1/0},ColumnsMax:{resolve:"_resolveFull",cast:sn.castPositiveNumber,value:3},SingleRowFillsHeight:{resolve:"_resolveFull",cast:Boolean,value:!0},SingleColFillsHeight:{resolve:"_resolveFull",cast:Boolean,value:!0},Overflow:{resolve:"_resolveFull",cast:sn.parseMultiChartOverflow,value:"grow"}}}),e.type("pvc.visual.SmallChart",sn.visual.OptionsBase).init(function(e){this.base(e,"small",0,{byV1:!1,byNaked:!1})}).add({_getOptionsDefinition:function(){return sn.visual.SmallChart.optionsDef}}).addStatic({optionsDef:{Width:{resolve:"_resolveFull",cast:ln.parse,value:null},Height:{resolve:"_resolveFull",cast:ln.parse,value:null},AspectRatio:{resolve:"_resolveFull",cast:sn.castPositiveNumber,getDefault:function(){return this.chart instanceof sn.PieChart?10/7:5/4}},Margins:{resolve:"_resolveFull",cast:fn.as,value:new fn(new ln(.02))},Paddings:{resolve:"_resolveFull",cast:fn.as,value:0}}});var On=e.type("pvc.visual.Axis",sn.visual.OptionsBase).init(function(e,t,n,r){this.base(e,t,n,r),e._addAxis(this)}).add({scaleTreatsNullAs:function(){return"null"},scaleNullRangeValue:function(){return null},scaleUsesAbs:e.retFalse,scaleSumNormalized:e.retFalse,domainVisibleOnly:e.retTrue,domainIgnoreNulls:e.retFalse,domainGroupOperator:function(){return"flatten"},domainItemValueProp:function(){return"value"},bind:function(t){var n=this;return t||e.fail.argumentRequired("dataCells"),!n.dataCells||e.fail.operationInvalid("Axis is already bound."),n.dataCells=e.array.to(t),n.dataCell=n.dataCells[0],n.role=n.dataCell&&n.dataCell.role,n.scaleType=Wt(n.role.grouping),n._domainData=null,n._domainValues=null,n._domainItems=null,n._checkRoleCompatibility(),this},domainData:function(){this.isBound()||e.fail.operationInvalid("Axis is not bound.");var t=this._domainData;if(!t){var n=this.dataCells.map(en),r=this.chart.partData(n);this._domainData=t=this._createDomainData(r)}return t},domainCellData:function(e){var t=this.dataCells;if(1===t.length)return this.domainData();var n=t[e],r=this.chart.partData(n.dataPartValue);return this._createDomainData(r)},domainCellItems:function(e){var t=this.dataCells;if(1===t.length)return this.domainItems();var n;return n="number"==typeof e?this.domainCellData(e):e,this._selectDomainItems(n).array()},domainValues:function(){var e=this._domainValues;return e||(this._calcDomainItems(),e=this._domainValues),e},domainItems:function(){var e=this._domainItems;return e||(this._calcDomainItems(),e=this._domainItems),e},domainItemValue:function(t){return e.nullyTo(t[this.domainItemValueProp()],"")},isDiscrete:function(){return!!this.role&&this.role.isDiscrete()},isBound:function(){return!!this.role},setScale:function(t,n){return this.isBound()||e.fail.operationInvalid("Axis is not bound."),this.scale=t?n?t:this._wrapScale(t):null,this},_wrapScale:function(t){t.type=this.scaleType;var n;if("discrete"!==t.type){var r=this.scaleUsesAbs(),i=this.scaleTreatsNullAs();if(i&&"null"!==i){var s="min"===i;n=r?function(e){return t(null==e?s?t.domain()[0]:0:0>e?-e:e)}:function(e){return t(null==e?s?t.domain()[0]:0:e)}}else{var o=this.scaleNullRangeValue();n=r?function(e){return null==e?o:t(0>e?-e:e)}:function(e){return null==e?o:t(e)}}}else n=function(e){return t(null==e?"":e)};return e.copy(n,t)},sceneScale:function(t){var n=e.get(t,"sceneVarName")||this.role.name,r=this.role.grouping;if(r.isSingleDimension&&r.firstDimensionValueType()===Number){var i=this.scale,s=e.get(t,"nullToZero",!0),o=function(e){var t=e.vars[n].value;if(null==t){if(!s)return t;t=0}return i(t)};return e.copy(o,i),o}return this.scale.by1(function(e){return e.vars[n].value})},_checkRoleCompatibility:function(){var t=this.dataCells.length;if(t>1){var n,r,i=this._getBoundRoleGrouping(this.role);if("discrete"===this.scaleType)for(r=1;t>r;r++){n=this._getBoundRoleGrouping(this.dataCells[r].role);if(i.id!==n.id)throw e.error.operationInvalid("Discrete roles on the same axis must have equal groupings.")}else{if(!i.firstDimensionType().isComparable)throw e.error.operationInvalid("Continuous roles on the same axis must have 'comparable' groupings.");for(r=1;t>r;r++){n=this._getBoundRoleGrouping(this.dataCells[r].role);if(this.scaleType!==Wt(n))throw e.error.operationInvalid("Continuous roles on the same axis must have scales of the same type.")}}}},_getBoundRoleGrouping:function(t){var n=t.grouping;if(!n)throw e.error.operationInvalid("Axis' role '"+t.name+"' is unbound.");return n},_createDomainData:function(e){var t={visible:this.domainVisibleOnly()?!0:null,isNull:this.chart.options.ignoreNulls||this.domainIgnoreNulls()?!1:null};return this.role[this.domainGroupOperator()](e,t)},_selectDomainItems:function(e){return e.children()},_calcDomainItems:function(){var t=e.hasOwnProp,n={},r=[],i=[],s=this.domainData();this._selectDomainItems(s).each(function(e){var s=this.domainItemValue(e);t.call(n,s)||(n[s]=1,r.push(s),i.push(e))},this),this._domainItems=i,this._domainValues=r},_getOptionsDefinition:function(){return Mn}}),Mn={},_n=e.type("pvc.visual.CartesianAxis",On).init(function(e,t,n,r){var i=e.options;this.orientation=_n.getOrientation(t,i.orientation),this.orientedId=_n.getOrientedId(this.orientation,n),e._allowV1SecondAxis&&1===n&&(this.v1SecondOrientedId="second"+this.orientation.toUpperCase()),this.base(e,t,n,r);var s=this.extensionPrefixes=[this.id+"Axis",this.orientedId+"Axis"];this.v1SecondOrientedId&&s.push(this.v1SecondOrientedId+"Axis"),this._extPrefAxisPosition=s.length,s.push("axis")}).add({bind:function(e){return this.base(e),this._syncExtensionPrefixes(),this},_syncExtensionPrefixes:function(){var e=this.extensionPrefixes;e.length=this._extPrefAxisPosition;var t=this.scaleType;t&&(e.push(t+"Axis"),"discrete"!==t&&e.push("continuousAxis")),e.push("axis")},setScale:function(e){var t=this.scale;this.base(e),t&&(delete this.domain,delete this.ticks,delete this._roundingPaddings);if(e&&!e.isNull&&"discrete"!==this.scaleType){this.domain=e.domain(),this.domain.minLocked=!!e.minLocked,this.domain.maxLocked=!!e.maxLocked;var n=this.option("DomainRoundMode");"nice"===n&&e.nice();var r=this.option("TickFormatter");r&&e.tickFormatter(r)}return this},setTicks:function(t){var n=this.scale;n&&!n.isNull||e.fail.operationInvalid("Scale must be set and non-null."),this.ticks=t;if("discrete"!==n.type&&"tick"===this.option("DomainRoundMode")){delete this._roundingPaddings;var r=t&&t.length;r?this.scale.domain(t[0],t[r-1]):this.scale.domain(this.domain[0],this.domain[1])}},setScaleRange:function(e){var t=this.scale;t.min=0,t.max=e,t.size=e;if("discrete"===t.type){if(t.domain().length>0){var n=this.chart.options.panelSizeRatio||.8;t.splitBandedCenter(t.min,t.max,n)}}else t.range(t.min,t.max);return t},getScaleRoundingPaddings:function(){var t=this._roundingPaddings;if(!t){t={begin:0,end:0,beginLocked:!1,endLocked:!1};var n=this.scale;if(n&&!n.isNull&&"discrete"!==n.type){var r=this.domain;t.beginLocked=r.minLocked,t.endLocked=r.maxLocked;if("numeric"===n.type&&"none"!==this.option("DomainRoundMode")){var i=n.domain(),s=this.domain||e.assert("Original domain must be set"),o=i[1]-i[0];if(o){var u=s[0]-i[0];u>0&&(t.begin=u/o),u=i[1]-s[1],u>0&&(t.end=u/o)}}}this._roundingPaddings=t}return t},calcContinuousTicks:function(e){return null==e&&(e=this.option("DesiredTickCount")),this.scale.ticks(e,{roundInside:"tick"!==this.option("DomainRoundMode"),numberExponentMin:this.option("TickExponentMin"),numberExponentMax:this.option("TickExponentMax")})},_getOptionsDefinition:function(){return Bn},_buildOptionId:function(){return this.id+"Axis"},_registerResolversNormal:function(e){this.chart.compatVersion()<=1&&e.push(this._resolveByV1OnlyLogic),e.push(this._resolveByOptionId,this._resolveByOrientedId),1===this.index&&e.push(this._resolveByV1OptionId),e.push(this._resolveByScaleType,this._resolveByCommonId)},_resolveByOrientedId:sn.options.specify(function(e){return this._chartOption(this.orientedId+"Axis"+e.name)}),_resolveByV1OptionId:sn.options.specify(function(e){return this._chartOption("secondAxis"+e.name)}),_resolveByScaleType:sn.options.specify(function(e){var t=this.scaleType;if(t){var n=e.name,r=this._chartOption(t+"Axis"+n);return void 0===r&&"discrete"!==t&&(r=this._chartOption("continuousAxis"+n)),r}}),_resolveByCommonId:sn.options.specify(function(e){return this._chartOption("axis"+e.name)})});_n.getOrientation=function(e,t){return"base"===e==("vertical"===t)?"x":"y"},_n.getOrientedId=function(e,t){return 0===t?e:e+(t+1)};var Dn={resolve:"_resolveFull",data:{resolveV1:function(e){return this.index||"ortho"!==this.type||this._specifyChartOption(e,this.id+e.name),!0}}},Pn={resolveV1:function(e){if(this.index){if(this._resolveByV1OptionId(e))return!0}else if(this._resolveByOrientedId(e))return!0;return this._resolveDefault(e),!0}},Hn=sn.options.defaultValue(function(){if(!this.typeIndex)return"x"===this.orientation?"bottom":"left";var e=this.chart.axesByType[this.type].first,t=e.option("Position");return sn.BasePanel.oppositeAnchor[t]}),Bn=e.create(Mn,{Visible:{resolve:"_resolveFull",data:{resolveV1:function(t){if(this.index<=1){var n=0===this.index?e.firstUpperCase(this.orientation):"Second";this._specifyChartOption(t,"show"+n+"Scale")}return!0}},cast:Boolean,value:!0},Composite:{resolve:function(e){return this.index>0?(e.specify(!1),!0):this._resolveFull(e)},data:{resolveV1:function(e){return this._specifyChartOption(e,"useCompositeAxis"),!0}},cast:Boolean,value:!1},Size:{resolve:"_resolveFull",data:Pn,cast:$t},SizeMax:{resolve:"_resolveFull",cast:$t},Position:{resolve:"_resolveFull",data:{resolveV1:Pn.resolveV1,resolveDefault:Hn},cast:Vt},FixedMin:Dn,FixedMax:Dn,OriginIsZero:{resolve:"_resolveFull",data:{resolveV1:function(e){switch(this.index){case 0:this._specifyChartOption(e,"originIsZero");break;case 1:this.chart._allowV1SecondAxis&&this._specifyChartOption(e,"secondAxisOriginIsZero")}return!0}},cast:Boolean,value:!0},DomainScope:{resolve:"_resolveFull",cast:Xt,value:"global"},Offset:{resolve:"_resolveFull",data:{resolveV1:function(e){switch(this.index){case 0:this._specifyChartOption(e,"axisOffset");break;case 1:if(this.chart._allowV1SecondAxis){this._specifyChartOption(e,"secondAxisOffset");break}}return!0}},cast:sn.castNumber},LabelSpacingMin:{resolve:"_resolveFull",cast:sn.castNumber},OverlappedLabelsMode:{resolve:"_resolveFull",cast:sn.parseOverlappedLabelsMode,value:"rotatethenhide"},Grid:{resolve:"_resolveFull",data:{resolveV1:function(e){return this.index||this._specifyChartOption(e,this.orientation+"AxisFullGrid"),!0}},cast:Boolean,value:!1},GridCrossesMargin:{resolve:"_resolveFull",cast:Boolean,value:!0},EndLine:{resolve:"_resolveFull",cast:Boolean},ZeroLine:{resolve:"_resolveFull",cast:Boolean,value:!0},RuleCrossesMargin:{resolve:"_resolveFull",cast:Boolean,value:!0},Ticks:{resolve:"_resolveFull",cast:Boolean},DesiredTickCount:{resolve:"_resolveFull",data:{resolveV1:Pn.resolveV1,resolveDefault:function(e){if(this.chart.compatVersion()<=1)return e.defaultValue(5),!0}},cast:sn.castNumber},MinorTicks:{resolve:"_resolveFull",data:Pn,cast:Boolean,value:!0},TickFormatter:{resolve:"_resolveFull",cast:e.fun.as},DomainRoundMode:{resolve:"_resolveFull",data:{resolveV1:Pn.resolveV1,resolveDefault:function(e){if(this.chart.compatVersion()<=1)return e.defaultValue("none"),!0}},cast:sn.parseDomainRoundingMode,value:"tick"},TickExponentMin:{resolve:"_resolveFull",cast:sn.castNumber},TickExponentMax:{resolve:"_resolveFull",cast:sn.castNumber},Title:{resolve:"_resolveFull",cast:String},TitleSize:{resolve:"_resolveFull",cast:Jt},TitleSizeMax:{resolve:"_resolveFull",cast:Jt},TitleFont:{resolve:"_resolveFull",cast:String},TitleMargins:{resolve:"_resolveFull",cast:fn.as},TitlePaddings:{resolve:"_resolveFull",cast:fn.as},TitleAlign:{resolve:"_resolveFull",cast:function(e){var t=this.option("Position");return sn.parseAlign(t,e)}},Font:{resolve:"_resolveFull",cast:String},ClickAction:{resolve:"_resolveFull",data:Pn},DoubleClickAction:{resolve:"_resolveFull",data:Pn},TooltipEnabled:{resolve:"_resolveFull",cast:Boolean,value:!0},TooltipFormat:{resolve:"_resolveFull",cast:e.fun.as,value:null},TooltipAutoContent:{resolve:"_resolveFull",cast:sn.parseTooltipAutoContent,value:"value"}});e.type("pvc.visual.CartesianAxisRootScene",sn.visual.Scene),e.type("pvc.visual.CartesianAxisTickScene",sn.visual.Scene).init(function(t,n){this.base(t,n),this.vars.tick=new kn(e.get(n,"tick"),e.get(n,"tickLabel"),e.get(n,"tickRaw")),e.get(n,"isHidden")&&(this.isHidden=!0)}).add({isHidden:!1}),e.type("pvc.visual.CartesianFocusWindow",sn.visual.OptionsBase).init(function(e){this.base(e,"focusWindow",0,{byNaked:!1});var t=e.axes.base;this.base=new sn.visual.CartesianFocusWindowAxis(this,t)}).add({_getOptionsDefinition:function(){return jn},_exportData:function(){return{base:e.copyProps(this.base,sn.visual.CartesianFocusWindowAxis.props)}},_importData:function(e){var t=e.base;this.base.option.specify({Begin:t.begin,End:t.end,Length:t.length})},_initFromOptions:function(){this.base._initFromOptions()},_onAxisChanged:function(){var e=this.option("Changed");e&&e.call(this.chart.basePanel.context())}});var jn=e.create(Mn,{Changed:{resolve:"_resolveFull",cast:e.fun.as}});e.type("pvc.visual.CartesianFocusWindowAxis",sn.visual.OptionsBase).init(function(t,n){this.window=t,this.axis=n,this.isDiscrete=n.isDiscrete(),this.base(n.chart,"focusWindow"+e.firstUpperCase(n.type),0,{byNaked:!1})}).addStatic({props:["begin","end","length"]}).add({_getOptionsDefinition:function(){return Fn},_initFromOptions:function(){var e=this.option;this.set({begin:e("Begin"),end:e("End"),length:e("Length")})},set:function(t){var n,r,i,s=this,o=e.get(t,"render"),u=e.get(t,"select",!0);t=s._readArgs(t);if(t)n=t.begin,r=t.end,i=t.length;else if(null!=this.begin&&null!=this.end&&null!=this.length)return;var a,f,l=s.axis,c=l.scale,h=s.isDiscrete,p=h?null:l.role.firstDimensionType().cast,d=c.domain();if(h){f=d.length;var v,m,g;if(null!=n){var y=+n;isNaN(y)||(1/0===y?(v=f-1,n=d[v]):y===-1/0&&(v=0,n=d[v])),null==v&&(v=d.indexOf(""+n),0>v&&(v=0,n=d[v]))}if(null!=r){var b=+r;isNaN(b)||(1/0===b?(m=f-1,r=d[m]):b===-1/0&&(m=0,r=d[m])),null==m&&(m=d.indexOf(""+r),0>m&&(m=f-1,r=d[m]))}null!=i&&(i=+i,isNaN(i)?i=null:0>i&&(null!=n||null!=r)&&(a=n,g=v,n=r,v=m,r=a,m=g,i=-i)),null!=n?null!=r?(v>m&&(a=n,g=v,n=r,v=m,r=a,m=g),i=m-v+1):(null==i&&(i=f-v),m=v+i-1,m>f-1&&(m=f-1,i=m-v+1),r=d[m]):null!=r?(null==i&&(i=m),v=m-i+1,0>v&&(v=0,i=m-v+1),n=d[v]):(null==i&&(i=Math.max(~~(f/3),1)),i>f?(i=f,v=0,m=f-1):(g=~~(f/2),v=g-~~(i/2),m=v+i-1),n=d[v],r=d[m])}else{null!=i&&(i=+i,isNaN(i)?i=null:0>i&&(null!=n||null!=r)&&(a=n,n=r,r=a,i=-i));var w,E,S=d[0],x=d[1];f=x-S,null!=n&&(S>n&&(n=S),n>x&&(n=x)),null!=r&&(S>r&&(r=S),r>x&&(r=x)),null!=n?null!=r?(n>r&&(a=n,n=r,r=a),i=r-n):(null==i&&(i=x-n),r=n+i,r>x&&(r=x,i=r-n)):null!=r?(null==i&&(i=r-S),n=r-i,S>n&&(n=S,i=r-n)):(null==i&&(i=Math.max(~~(f/3),1)),i>f?(i=f,n=S,r=x):(a=~~(f/2),n=a-~~(i/2),w=+n,E=+i,r=w+E)),n=p(n),r=p(r),i=p(i);var T=s.option("Constraint");if(T){var N={type:"new",target:"begin",value:n,length:i,length0:i,min:S,max:x,minView:S,maxView:x};T(N),n=p(N.value),i=p(N.length),w=+n,E=+i,r=p(w+E)}}s._set(n,r,i,u,o)},_updatePosition:function(e,t,n,r){var i,s,o,u=this,a=u.axis,f=a.scale;if(u.isDiscrete){var l=f.invertIndex(e),c=f.invertIndex(t)-1,h=f.domain();i=h[l],s=h[c],o=c-l+1}else i=f.invert(e),s=f.invert(t),o=s-i;this._set(i,s,o,n,r)},_constraintPosition:function(e){var t,n=this,r=n.axis,i=r.scale;if(n.isDiscrete){var s=Math.floor(i.invertIndex(e.point,!0));if(s>=0){var o=i.range(),u=i.domain().length,a=(o.max-o.min)/u;s>=u&&("new"===e.type||"resize-begin"===e.type)&&(s=u-1),e.point=s*a}}else if(t=n.option("Constraint")){var f,l,c,h=r.role.firstDimensionType().cast,p=h(i.invert(e.point)),d="begin"===e.target?1:-1,v=e.point+d*e.length,m=h(i.invert(v)),g=h(d*(m-p));e.length===e.length0?f=g:(l=e.point+d*e.length0,c=h(i.invert(l)),f=h(d*(c-p)));var y=h(i.invert(e.min)),b=h(i.invert(e.max)),w={type:e.type,target:e.target,value:p,length:g,length0:f,min:y,max:b,minView:h(i.invert(e.minView)),maxView:h(i.invert(e.maxView))};t(w),+w.value!==+p&&(p=w.value,e.point=i(p));var E=w.length;if(+E!==+g)if(+E===+f)e.length=e.length0;else{var S=+p+d*+E,x=i(S);e.length=x-d*e.point}+w.min!==+y&&(e.min=i(w.min)),+w.max!==+b&&(e.max=i(w.max))}},_compare:function(e,t){return this.isDiscrete?""+e==""+t:+e===+t},_set:function(e,t,n,r,i){var s=this,o=!1;return s._compare(e,s.begin)||(s.begin=e,o=!0),s._compare(t,s.end)||(s.end=t,o=!0),s._compare(n,s.length)||(s.length=n,o=!0),o&&s.window._onAxisChanged(this),r&&s._updateSelection({render:i}),o},_readArgs:function(e){if(e){var t={},n=0,r=function(r){var i=e[r];null!=i?n=!0:i=this[r],t[r]=i};sn.visual.CartesianFocusWindowAxis.props.forEach(r,this);if(n)return t}},_updateSelection:function(t){var n,r,i=this,s=i.axis,o=s.isDiscrete(),u=s.chart,a=s.dataCell,f=a.role,l=u.partData(a.dataPartValue);if(o){r=f.flatten(l);var c=r.child(i.begin),h=r.child(i.end);if(c&&h){var p=c.childIndex(),d=h.childIndex();n=e.range(p,d-p+1).select(function(e){return r.childNodes[e]}).selectMany(e.propGet("_datums")).where(tt).distinct(e.propGet("key"))}}else{r=l;var v=f.firstDimensionName();n=e.query(l._datums).where(tt).where(function(e){var t=e.atoms[v].value;return null!=t&&t>=i.begin&&t<=i.end})}n&&(u.data.replaceSelected(n),u.root.updateSelections(t))}});var Fn=e.create(Mn,{Resizable:{resolve:"_resolveFull",cast:Boolean,value:!0},Movable:{resolve:"_resolveFull",cast:Boolean,value:!0},Begin:{resolve:"_resolveFull"},End:{resolve:"_resolveFull"},Length:{resolve:"_resolveFull"},Constraint:{resolve:"_resolveFull",cast:e.fun.as}});e.type("pvc.visual.ColorAxis",On).add({scaleNullRangeValue:function(){return this.option("Missing")||null},scaleUsesAbs:function(){return this.option("UseAbs")},domainVisibleOnly:function(){return"discrete"!==this.scaleType},bind:function(t){return this.base(t),this._legendGroupScene=null,this._plotList=e.query(t).select(function(e){return e.plot}).distinct(function(e){return e&&e.id}).array(),this},_wrapScale:function(e){var t;t="discrete"===this.scaleType?this.option.isSpecified("Transform")||!this.option.isSpecified("Colors")&&!this.option.isSpecified("Map"):!0;if(t){var n=this.option("Transform");n&&(e=e.transform(n))}return this.base(e)},scheme:function(){return e.lazy(this,"_scheme",this._createScheme,this)},_createColorMapFilter:function(t){var n=e.uniqueIndex(t,function(e){return e.key});return{domain:function(n){return!e.hasOwn(t,n)},color:function(t){return!e.hasOwn(n,t.key)}}},_getBaseScheme:function(){return this.option("Colors")},_createScheme:function(){var t=this,n=t._getBaseScheme();if("discrete"!==t.scaleType)return function(){var e=n.apply(null,arguments);return t._wrapScale(e)};var r=t.option("Map");if(!r)return function(){var e=n.apply(null,arguments);return t._wrapScale(e)};var i=this._createColorMapFilter(r);return function(s){var o;s instanceof Array||(s=e.array.copy(arguments)),s=s.filter(i.domain);var u=n(s),a=u.range().filter(i.color);u.range(a),o=function(t){var n=e.getOwn(r,t);return n||u(t)},e.copy(o,u);var f,l;return o.domain=function(){if(arguments.length)throw e.operationInvalid("The scale cannot be modified.");return f||(f=e.array.append(e.ownKeys(r),s)),f},o.range=function(){if(arguments.length)throw e.operationInvalid("The scale cannot be modified.");return l||(l=e.array.append(e.own(r),a)),l},t._wrapScale(o)}},sceneScale:function(t){var n=e.get(t,"sceneVarName")||this.role.name,r=this.scalesByCateg;if(r){var i=this.option("Missing");return function(e){var t=e.vars[n].value;if(null==t)return i;var s=e.group.parent.absKey;return r[s](t)}}return this.scale.by1(function(e){return e&&e.vars[n].value})},_buildOptionId:function(){return this.id+"Axis"},_getOptionsDefinition:function(){return Rn},_resolveByNaked:sn.options.specify(function(t){return this.index?void 0:this._chartOption(this.id+e.firstUpperCase(t.name))}),_specifyV1ChartOption:function(e,t){return!this.index&&this.chart.compatVersion()<=1&&this._specifyChartOption(e,t)?!0:void 0}});var In,qn={resolveDefault:function(t){return!this.index&&this._specifyChartOption(t,e.firstLowerCase(t.name))?!0:void 0}},Rn=e.create(Mn,{Colors:{resolve:"_resolveFull",getDefault:Qt,data:{resolveV1:function(e){return"discrete"===this.scaleType?0===this.index?this._specifyChartOption(e,"colors"):1===this.index&&this.chart._allowV1SecondAxis&&this._specifyChartOption(e,"secondAxisColor"):this._specifyChartOption(e,"colorRange"),!0},resolveDefault:function(e){0===this.index&&this._specifyChartOption(e,"colors")}},cast:sn.colorScheme},Map:{resolve:"_resolveFull",cast:Kt},Transform:{resolve:"_resolveFull",data:{resolveDefault:function(t){var n=this._plotList;if(n.length<=2){var r=e.query(n).all(function(e){var t=e.name;return"plot2"===t||"trend"===t});if(r)return t.defaultValue(sn.brighterColorTransform),!0}}},cast:e.fun.to},NormByCategory:{resolve:function(e){return this.chart._allowColorPerCategory?this._resolveFull(e):(e.specify(!1),!0)},data:{resolveV1:function(e){return this._specifyV1ChartOption(e,"normPerBaseCategory"),!0}},cast:Boolean,value:!1},ScaleType:{resolve:"_resolveFull",data:{resolveV1:function(e){return this._specifyV1ChartOption(e,"scalingType"),!0}},cast:sn.parseContinuousColorScaleType,value:"linear"},UseAbs:{resolve:"_resolveFull",cast:Boolean,value:!1},Domain:{resolve:"_resolveFull",data:{resolveV1:function(e){return this._specifyV1ChartOption(e,"colorRangeInterval"),!0}},cast:e.array.to},Min:{resolve:"_resolveFull",data:{resolveV1:function(e){return this._specifyV1ChartOption(e,"minColor"),!0}},cast:t.color},Max:{resolve:"_resolveFull",data:{resolveV1:function(e){return this._specifyV1ChartOption(e,"maxColor"),!0}},cast:t.color},Missing:{resolve:"_resolveFull",data:{resolveV1:function(e){return this._specifyV1ChartOption(e,"nullColor"),!0}},cast:t.color,value:t.color("lightgray")},Unbound:{resolve:"_resolveFull",getDefault:function(){var e=this.option("Colors");return e().range()[0]||sn.defaultColor},cast:t.color},LegendVisible:{resolve:"_resolveFull",data:qn,cast:Boolean,value:!0},LegendClickMode:{resolve:"_resolveFull",data:qn,cast:sn.parseLegendClickMode,value:"togglevisible"},LegendDrawLine:{resolve:"_resolveFull",data:qn,cast:Boolean,value:!1},LegendDrawMarker:{resolve:"_resolveFull",data:qn,cast:Boolean,value:!0},LegendShape:{resolve:"_resolveFull",data:qn,cast:sn.parseShape}});e.type("pvc.visual.SizeAxis",On).init(function(t,n,r,i){i=e.set(i,"byNaked",!1),this.base(t,n,r,i)}).add({_buildOptionId:function(){return this.id+"Axis"},scaleTreatsNullAs:function(){return"min"},scaleUsesAbs:function(){return this.option("UseAbs")},setScaleRange:function(t){var n=this.scale;return n.min=t.min,n.max=t.max,n.size=t.max-t.min,n.range(n.min,n.max),sn.debug>=4&&sn.log("Scale: "+sn.stringify(e.copyOwn(n))),this},_getOptionsDefinition:function(){return Un}});var Un=e.create(Mn,{OriginIsZero:{resolve:"_resolveFull",cast:Boolean,value:!1},FixedMin:{resolve:"_resolveFull",cast:sn.castNumber},FixedMax:{resolve:"_resolveFull",cast:sn.castNumber},UseAbs:{resolve:"_resolveFull",cast:Boolean,value:!1}});e.type("pvc.visual.NormalizedAxis",On).init(function(t,n,r,i){i=e.set(i,"byNaked",!1),this.base(t,n,r,i)}).add({_buildOptionId:function(){return this.id+"Axis"},scaleTreatsNullAs:function(){return"zero"},scaleUsesAbs:e.retTrue,scaleSumNormalized:e.retTrue,setScaleRange:function(t){var n=this.scale;return n.min=t.min,n.max=t.max,n.size=t.max-t.min,n.range(n.min,n.max),sn.debug>=4&&sn.log("Scale: "+sn.stringify(e.copyOwn(n))),this},_getOptionsDefinition:function(){return zn}});var zn=e.create(Mn,{OriginIsZero:{value:!0}});e.type("pvc.visual.Legend",sn.visual.OptionsBase).init(function(t,n,r,i){i=e.set(i,"byNaked",!1),this.base(t,n,r,i)}).add({_getOptionsDefinition:function(){return Wn}});var Wn={Position:{resolve:"_resolveFull",cast:sn.parsePosition,value:"bottom"},Size:{resolve:"_resolveFull",cast:Gt},SizeMax:{resolve:"_resolveFull",cast:Gt},Align:{resolve:"_resolveFull",data:{resolveDefault:function(e){var t,n=this.option("Position");return"top"!==n&&"bottom"!==n?t="top":this.chart.compatVersion()<=1&&(t="left"),e.defaultValue(t),!0}},cast:Yt},Margins:{resolve:"_resolveFull",data:{resolveDefault:function(t){if(this.chart.compatVersion()>1){var n=this.option("Position"),r=e.set({},sn.BasePanel.oppositeAnchor[n],5);t.defaultValue(r)}return!0}},cast:fn.as},Paddings:{resolve:"_resolveFull",cast:fn.as,value:5},Font:{resolve:"_resolveFull",cast:String},ItemSize:{resolve:"_resolveFull",cast:Zt}};e.type("pvc.visual.legend.BulletRootScene",sn.visual.Scene).init(function(t,n){this.base(t,n),this._unresolvedMarkerDiam=e.get(n,"markerSize"),this._unresolvedItemPadding=new fn(e.get(n,"itemPadding",5)),this._unresolvedItemSize=hn.to(e.get(n,"itemSize"))||new hn,e.set(this.vars,"horizontal",e.get(n,"horizontal",!1),"font",e.get(n,"font"),"textMargin",e.get(n,"textMargin",6)-3)}).add({layout:function(t){function n(t){var n=t.labelTextSize(),i=!n||!n.width||!n.height;t.isHidden=i;if(!i){var s,u={width:c+n.width,height:Math.max(n.height,l)},f={width:a.width||o.width+u.width,height:a.height||o.height+u.height},h={width:Math.max(0,f.width-o.width),height:Math.max(0,f.height-o.height)};m?s=!m.items.length:(m=new sn.visual.legend.BulletItemSceneSection(0),s=!0);var g=m.size[p]+h[p];s||(g+=o[p]),!s&&g>v&&(r(!1),g=h[p]);var y=m.size;y[p]=g,y[d]=Math.max(y[d],h[d]);var b=m.items.length;m.items.push(t),e.set(t.vars,"section",m,"sectionIndex",b,"textSize",n,"itemSize",f,"itemClientSize",h,"itemContentSize",u)}}function r(e){var t=m.size;y[d]+=t[d],g.length&&(y[d]+=o[d]),y[p]=Math.max(y[p],t[p]),g.push(m),e||(m=new sn.visual.legend.BulletItemSceneSection(g.length))}var i=t.clientSize;if(i.width>0&&i.height>0){var s=t.desiredClientSize,o=this._unresolvedItemPadding.resolve(i),u={width:i.width+o.width,height:i.height+o.height},a=this._unresolvedItemSize.resolve(u),f={width:a.width&&Math.max(0,a.width-o.width),height:a.height&&Math.max(0,a.height-o.height)},l=this._unresolvedMarkerDiam||f.height||15;this.vars.itemPadding=o,this.vars.desiredItemSize=a,this.vars.desiredItemClientSize=f,this.vars.markerSize=l;var c=l+this.vars.textMargin,h=Math.max(0,Math.min(f.width||1/0,s.width||1/0,i.width)-c),p=this.vars.horizontal?"width":"height",d=sn.BasePanel.oppositeLength[p],v=s[p];(!v||0>v)&&(v=i[p]);var m,g=[],y={width:0,height:0};this.childNodes.forEach(function(e){e.childNodes.forEach(n,this)},this);if(!m)return new hn(0,0);r(!0),e.set(this.vars,"sections",g,"contentSize",y,"labelWidthMax",h);var b=this.compatVersion()<=1,w=b?v:y[p],E=s[d];(!E||0>E)&&(E=y[d]);var S=this.vars.size=e.set({},p,Math.min(w,i[p]),d,Math.min(E,i[d]));return S}return new hn(0,0)},defaultGroupSceneType:function(){var t=this._bulletGroupType;return t||(t=e.type(sn.visual.legend.BulletGroupScene),this._bulletGroupType=t),t},createGroup:function(e){var t=this.defaultGroupSceneType();return new t(this,e)}}),e.type("pvc.visual.legend.BulletItemSceneSection").init(function(e){this.index=e,this.items=[],this.size={width:0,height:0}}),e.type("pvc.visual.legend.BulletGroupScene",sn.visual.Scene).init(function(t,n){this.base(t,n),this.extensionPrefix=e.get(n,"extensionPrefix")||"",this._renderer=e.get(n,"renderer"),this.colorAxis=e.get(n,"colorAxis"),this.clickMode=e.get(n,"clickMode"),!this.clickMode&&this.colorAxis&&(this.clickMode=this.colorAxis.option("LegendClickMode"))}).add({hasRenderer:function(){return!!this._renderer},renderer:function(e){if(null!=e)this._renderer=e;else{e=this._renderer;if(!e){var t,n=this.colorAxis;n&&(t={drawRule:n.option("LegendDrawLine"),drawMarker:n.option("LegendDrawMarker"),markerShape:n.option("LegendShape")}),e=new sn.visual.legend.BulletItemDefaultRenderer(t),this._renderer=e}}return e},itemSceneType:function(){var t=this._itemSceneType;if(!t){t=e.type(sn.visual.legend.BulletItemScene);var n=this.clickMode;switch(n){case"toggleselected":t.add(sn.visual.legend.BulletItemSceneSelection);break;case"togglevisible":t.add(sn.visual.legend.BulletItemSceneVisibility)}var r=this.panel();r._extendSceneType("item",t,["isOn","executable","execute","value","labelText"]);var i=sn.makeExtensionAbsId(sn.makeExtensionAbsId("ItemScene",[this.extensionPrefix,"$"]),r._getExtensionPrefix()),s=r.chart._getExtension(i,"value");void 0!==s&&t.prototype.variable("value",s),this._itemSceneType=t}return t},createItem:function(e){var t=this.itemSceneType();return new t(this,e)}}),e.type("pvc.visual.legend.BulletItemScene",sn.visual.Scene).init(function(){this.base.apply(this,arguments);if(!this.executable()){var e=sn.visual.Interactive;this._ibits=e.Interactive|e.ShowsInteraction|e.Hoverable|e.SelectableAny}}).add({isOn:e.fun.constant(!0),executable:e.fun.constant(!1),execute:e.fun.constant(),labelText:function(){return this.value().label},labelTextSize:function(){return t.Text.measure(this.labelText(),this.vars.font)},_valueEval:function(){var e=this._valueEvalCore();return e instanceof kn||(e=new kn(e,e)),e},_valueEvalCore:function(){var e,t,n,r,i,s=this.group||this.datum;return s&&(e=s.value,t=s.rawValue,i=this._getTrendLineSuffix(s),n=s.ensureLabel()+i,r=s.absLabel?s.absLabel+i:n),new kn(e||null,n||"",t,r)},_getTrendLineSuffix:function(e){var t,n;return(t=e.firstDatum())&&(n=t.trend)?" ("+n.label+")":""}}).prototype.variable("value"),e.type("pvc.visual.legend.BulletItemSceneSelection").add({isOn:function(){var e=this.group||this.datum;return!e.owner.selectedCount()||this.isSelected()},executable:function(){return this.chart().selectableByClick()},execute:function(){var e=this.datums().array();if(e.length){var t=this.chart();t._updatingSelections(function(){e=t._onUserSelection(e),e&&e.length&&sn.data.Data.toggleSelected(e,!0)})}}}),e.type("pvc.visual.legend.BulletItemSceneVisibility").add({isOn:function(){return this.datums().any(function(e){return!e.isNull&&e.isVisible})},executable:e.fun.constant(!0),execute:function(){sn.data.Data.toggleVisible(this.datums())&&this.chart().render(!0,!0,!1)}}),e.type("pvc.visual.legend.BulletItemRenderer"),e.type("pvc.visual.legend.BulletItemDefaultRenderer",sn.visual.legend.BulletItemRenderer).init(function(t){this.drawRule=e.get(t,"drawRule",!1),this.drawRule&&(this.rulePvProto=e.get(t,"rulePvProto")),this.drawMarker=!this.drawRule||e.get(t,"drawMarker",!0),this.drawMarker&&(this.markerShape=e.get(t,"markerShape","square"),this.markerPvProto=e.get(t,"markerPvProto"))}).add({drawRule:!1,drawMarker:!0,markerShape:null,rulePvProto:null,markerPvProto:null,create:function(e,t,n,r){var i={},s=this.drawRule,o=function(e){return e.color};if(s){var u=(new on).left(0).top(function(){return this.parent.height()/2}).width(function(){return this.parent.width()}).lineWidth(1,sn.extensionTag).strokeStyle(o,sn.extensionTag),a=this.rulePvProto;a&&(u=a.extend(u)),i.pvRule=(new sn.visual.Rule(e,t,{proto:u,noSelect:!1,noHover:!1,activeSeriesAware:!1,extensionId:sn.makeExtensionAbsId("Rule",[n,"$"]),showsInteraction:!0,wrapper:r})).pvMark}if(this.drawMarker){var f=(new on).left(function(){return this.parent.width()/2}).top(function(){return this.parent.height()/2}).shapeSize(function(){return this.parent.width()},sn.extensionTag).lineWidth(2,sn.extensionTag).fillStyle(o,sn.extensionTag).strokeStyle(o,sn.extensionTag).shape(this.markerShape,sn.extensionTag).angle(s?0:Math.PI/2,sn.extensionTag).antialias(function(){var e=Math.abs(Math.cos(this.angle()));if(0!==e&&1!==e)switch(this.shape()){case"square":case"bar":return!1}return!0},sn.extensionTag),l=this.markerPvProto;l&&(f=l.extend(f)),i.pvDot=(new sn.visual.Dot(e,t,{proto:f,freePosition:!0,activeSeriesAware:!1,noTooltip:!0,noClick:!0,extensionId:sn.makeExtensionAbsId("Dot",[n,"$"]),wrapper:r})).pvMark}return i}}),e.type("pvc.visual.DataCell").init(function(t,n,r,i,s){this.plot=t,this.axisType=n,this.axisIndex=r,this.role=t.chart.visualRoles[i]||e.fail.argumentInvalid("roleName","Role is not defined."),this.dataPartValue=s}),e.type("pvc.visual.ColorDataCell",sn.visual.DataCell).init(function(e,t,n,r,i){this.base(e,t,n,r,i),this._legendGroupScene=null}).add({legendGroupScene:function(e){return arguments.length?(this._legendGroupScene=e,this):this._legendGroupScene}}),e.type("pvc.visual.Plot",sn.visual.OptionsBase).init(function(t,n){var r=e.getPath(t,["plotsByType",this.type]),i=r?r.length:0,s=t.plotList.length;n=e.set(n,"byNaked",!s),this.base(t,this.type,i,n),t._addPlot(this);var o=this.extensionPrefixes=[this.id];this.globalIndex||o.push(""),this.name&&o.push(this.name)}).add({_getOptionsDefinition:function(){return sn.visual.Plot.optionsDef},_resolveByNaked:sn.options.specify(function(t){return this.globalIndex?void 0:this._chartOption(e.firstLowerCase(t.name))}),collectDataCells:function(e){var t=this._getColorDataCell();t&&e.push(t)},_getColorDataCell:function(){var e=this.option("ColorRole");return e?new sn.visual.ColorDataCell(this,"color",this.option("ColorAxis")-1,e,this.option("DataPart")):void 0}}),sn.visual.Plot.optionsDef={Orientation:{resolve:function(e){return e.specify(this._chartOption("orientation")||"vertical"),!0},cast:String},ValuesVisible:{resolve:"_resolveFull",data:{resolveV1:function(e){if(0===this.globalIndex){var t=this._chartOption("showValues");return void 0!==t?e.specify(t):(t="point"!==this.type,e.defaultValue(t)),!0}}},cast:Boolean,value:!1},ValuesAnchor:{resolve:"_resolveFull",cast:sn.parseAnchor},ValuesFont:{resolve:"_resolveFull",cast:String,value:"10px sans-serif"},ValuesMask:{resolve:"_resolveFull",cast:String,value:"{value}"},ValuesOptimizeLegibility:{resolve:"_resolveFull",cast:Boolean,value:!1},ValuesOverflow:{resolve:"_resolveFull",cast:sn.parseValuesOverflow,value:"hide"},DataPart:{resolve:"_resolveFixed",cast:String,value:"0"},ColorRole:{resolve:"_resolveFixed",cast:String,value:"color"},ColorAxis:{resolve:sn.options.resolvers([function(e){if(0===this.globalIndex)return e.specify(1),!0},"_resolveFull"]),cast:function(t){return t=sn.castNumber(t),t=null!=t?e.between(t,1,10):1,t},value:1}},e.type("pvc.visual.CartesianOrthoDataCell",sn.visual.DataCell).init(function(e,t,n,r,i,s,o,u){this.base(e,t,n,r,i),this.isStacked=s,this.nullInterpolationMode=o,this.trend=u}),e.type("pvc.visual.CartesianPlot",sn.visual.Plot).add({collectDataCells:function(t){this.base(t),t.push(new sn.visual.DataCell(this,"base",this.option("BaseAxis")-1,this.option("BaseRole"),this.option("DataPart")));var n=e.array.to(this.option("OrthoRole")),r=this.option("DataPart"),i=this.option("OrthoAxis")-1,s=this.option.isDefined("Stacked")?this.option("Stacked"):void 0,o=this.option("NullInterpolationMode"),u=this.option("Trend");n.forEach(function(e){t.push(new sn.visual.CartesianOrthoDataCell(this,"ortho",i,e,r,s,o,u))},this)},_getOptionsDefinition:function(){return sn.visual.CartesianPlot.optionsDef}}),sn.visual.CartesianPlot.optionsDef=e.create(sn.visual.Plot.optionsDef,{BaseAxis:{value:1},BaseRole:{resolve:"_resolveFixed",cast:String},OrthoAxis:{resolve:function(e){return 0===this.globalIndex?(e.specify(1),!0):this._resolveFull(e)},data:{resolveV1:function(e){return"plot2"===this.name&&this.chart._allowV1SecondAxis&&this._chartOption("secondAxisIndependentScale")&&e.specify(2),!0}},cast:function(t){return t=sn.castNumber(t),null!=t?e.between(t,1,10):1},value:1},OrthoRole:{resolve:sn.options.resolvers(["_resolveFixed","_resolveDefault"])},Trend:{resolve:"_resolveFull",data:{resolveDefault:function(e){var t=this.option("TrendType");if(t)return e.defaultValue({type:t}),!0}},cast:tn},TrendType:{resolve:"_resolveFull",cast:sn.parseTrendType},TrendLabel:{resolve:"_resolveFull",cast:String},NullInterpolationMode:{resolve:"_resolveFull",cast:sn.parseNullInterpolationMode,value:"none"}}),e.type("pvc.visual.CategoricalPlot",sn.visual.CartesianPlot).add({_getOptionsDefinition:function(){return sn.visual.CategoricalPlot.optionsDef}}),sn.visual.CategoricalPlot.optionsDef=e.create(sn.visual.CartesianPlot.optionsDef,{Stacked:{resolve:"_resolveFull",cast:Boolean,value:!1},BaseRole:{value:"category"},OrthoRole:{value:"value"}}),e.type("pvc.visual.BarPlotAbstract",sn.visual.CategoricalPlot).add({_getOptionsDefinition:function(){return sn.visual.BarPlotAbstract.optionsDef}}),sn.visual.BarPlotAbstract.optionsDef=e.create(sn.visual.CategoricalPlot.optionsDef,{BarSizeRatio:{resolve:"_resolveFull",cast:function(e){return e=sn.castNumber(e),null==e?e=1:.05>e?e=.05:e>1&&(e=1),e},value:.9},BarSizeMax:{resolve:"_resolveFull",data:{resolveV1:function(e){return this._specifyChartOption(e,"maxBarSize"),!0}},cast:function(e){return e=sn.castNumber(e),null==e?e=1/0:1>e&&(e=1),e},value:2e3},BarOrthoSizeMin:{resolve:"_resolveFull",cast:sn.castNonNegativeNumber,value:1.5},BarStackedMargin:{resolve:"_resolveFull",cast:function(e){return e=sn.castNumber(e),null!=e&&0>e&&(e=0),e},value:0},OverflowMarkersVisible:{resolve:"_resolveFull",cast:Boolean,value:!0},ValuesAnchor:{value:"center"}}),e.type("pvc.visual.BarPlot",sn.visual.BarPlotAbstract).add({type:"bar"}),e.type("pvc.visual.NormalizedBarPlot",sn.visual.BarPlotAbstract).add({type:"bar",_getOptionsDefinition:function(){return sn.visual.NormalizedBarPlot.optionsDef}}),sn.visual.NormalizedBarPlot.optionsDef=e.create(sn.visual.BarPlotAbstract.optionsDef,{Stacked:{resolve:null,value:!0}}),e.type("pvc.visual.WaterfallPlot",sn.visual.BarPlotAbstract).add({type:"water",_getOptionsDefinition:function(){return sn.visual.WaterfallPlot.optionsDef}}),sn.visual.WaterfallPlot.optionsDef=e.create(sn.visual.BarPlotAbstract.optionsDef,{Stacked:{resolve:null,value:!0},TotalLineLabel:{resolve:"_resolveFull",cast:String,value:"Accumulated"},TotalValuesVisible:{resolve:"_resolveFull",data:{resolveDefault:function(e){return e.defaultValue(this.option("ValuesVisible")),!0}},cast:Boolean},Direction:{resolve:"_resolveFull",cast:sn.parseWaterDirection,value:"down"},AreasVisible:{resolve:"_resolveFull",cast:Boolean,value:!0},AllCategoryLabel:{resolve:"_resolveFull",cast:String,value:"All"}}),e.type("pvc.visual.PointPlot",sn.visual.CategoricalPlot).add({type:"point",_getOptionsDefinition:function(){return sn.visual.PointPlot.optionsDef}}),sn.visual.PointPlot.optionsDef=e.create(sn.visual.CategoricalPlot.optionsDef,{DotsVisible:{resolve:"_resolveFull",data:nn("Dots",!0),cast:Boolean,value:!1},LinesVisible:{resolve:"_resolveFull",data:nn("Lines",!0),cast:Boolean,value:!1},AreasVisible:{resolve:"_resolveFull",data:nn("Areas",!1),cast:Boolean,value:!1},ValuesAnchor:{value:"right"}}),e.type("pvc.visual.MetricXYPlot",sn.visual.CartesianPlot).add({_getOptionsDefinition:function(){return sn.visual.MetricXYPlot.optionsDef}}),sn.visual.MetricXYPlot.optionsDef=e.create(sn.visual.CartesianPlot.optionsDef,{BaseRole:{value:"x"},OrthoAxis:{resolve:null},OrthoRole:{value:"y"}}),e.type("pvc.visual.MetricPointPlot",sn.visual.MetricXYPlot).add({type:"scatter",collectDataCells:function(e){this.base(e);if(this.option("DotsVisible")){var t=this.chart.visualRole(this.option("SizeRole"));t.isBound()&&e.push(new sn.visual.DataCell(this,"size",this.option("SizeAxis")-1,t.name,this.option("DataPart")))}},_getOptionsDefinition:function(){return sn.visual.MetricPointPlot.optionsDef}}),sn.visual.MetricPointPlot.optionsDef=e.create(sn.visual.MetricXYPlot.optionsDef,{SizeRole:{resolve:"_resolveFixed",value:"size"},SizeAxis:{resolve:"_resolveFixed",value:1},Shape:{resolve:"_resolveFull",cast:sn.parseShape,value:"circle"},NullShape:{resolve:"_resolveFull",cast:sn.parseShape,value:"cross"},DotsVisible:{resolve:"_resolveFull",data:rn("Dots"),cast:Boolean,value:!1},LinesVisible:{resolve:"_resolveFull",data:rn("Lines"),cast:Boolean,value:!1},ValuesAnchor:{value:"right"},ValuesMask:{value:"{x},{y}"}}),e.type("pvc.visual.PiePlot",sn.visual.Plot).add({type:"pie",collectDataCells:function(e){this.base(e);var t=this.option("DataPart");e.push(new sn.visual.DataCell(this,"category",0,"category",t)),e.push(new sn.visual.DataCell(this,"angle",0,"value",t))},_getOptionsDefinition:function(){return sn.visual.PiePlot.optionsDef}}),sn.visual.PiePlot.optionsDef=e.create(sn.visual.Plot.optionsDef,{ActiveSliceRadius:{resolve:"_resolveFull",cast:ln.parse,value:new ln(.05)},ExplodedSliceRadius:{resolve:"_resolveFull",cast:ln.parse,value:0},ExplodedSliceIndex:{resolve:"_resolveFull",cast:sn.castNumber,value:null},ValuesAnchor:{cast:sn.parseAnchorWedge,value:"outer"},ValuesVisible:{value:!0},ValuesLabelStyle:{resolve:function(e){var t=this.chart.compatVersion()<=1;return t?(e.specify("inside"),!0):this._resolveFull(e)},cast:function(e){switch(e){case"inside":case"linked":return e}return sn.debug>=2&&sn.log("[Warning] Invalid 'ValuesLabelStyle' value: '"+e+"'."),"linked"},value:"linked"},ValuesMask:{resolve:"_resolveFull",data:{resolveDefault:function(e){return e.defaultValue("linked"===this.option("ValuesLabelStyle")?"{value} ({value.percent})":"{value}"),!0}}},LinkInsetRadius:{resolve:"_resolveFull",cast:ln.parse,value:new ln(.05)},LinkOutsetRadius:{resolve:"_resolveFull",cast:ln.parse,value:new ln(.025)},LinkMargin:{resolve:"_resolveFull",cast:ln.parse,value:new ln(.025)},LinkHandleWidth:{resolve:"_resolveFull",cast:sn.castNumber,value:.5},LinkLabelSize:{resolve:"_resolveFull",cast:ln.parse,value:new ln(.15)},LinkLabelSpacingMin:{resolve:"_resolveFull",cast:sn.castNumber,value:.5}}),e.type("pvc.visual.HeatGridPlot",sn.visual.CategoricalPlot).add({type:"heatGrid",collectDataCells:function(e){this.base(e);if(this.option("UseShapes")){var t=this.chart.visualRole(this.option("SizeRole"));t.isBound()&&e.push(new sn.visual.DataCell(this,"size",this.option("SizeAxis")-1,t.name,this.option("DataPart")))}},_getOptionsDefinition:function(){return sn.visual.HeatGridPlot.optionsDef}}),sn.visual.HeatGridPlot.optionsDef=e.create(sn.visual.CategoricalPlot.optionsDef,{SizeRole:{value:"size"},SizeAxis:{value:1},UseShapes:{resolve:"_resolveFull",cast:Boolean,value:!1},Shape:{resolve:"_resolveFull",cast:sn.parseShape,value:"square"},NullShape:{resolve:"_resolveFull",cast:sn.parseShape,value:"cross"},ValuesVisible:{getDefault:function(){return!this.option("UseShapes")},value:null},ValuesMask:{value:null},ValuesAnchor:{value:"center"},OrthoRole:{value:"series"},OrthoAxis:{resolve:null},NullInterpolationMode:{resolve:null,value:"none"},Stacked:{resolve:null,value:!1}}),e.type("pvc.visual.BoxPlot",sn.visual.CategoricalPlot).add({type:"box",_getOptionsDefinition:function(){return sn.visual.BoxPlot.optionsDef}}),sn.visual.BoxPlot.optionsDef=e.create(sn.visual.CategoricalPlot.optionsDef,{Stacked:{resolve:null,value:!1},OrthoRole:{value:["median","lowerQuartil","upperQuartil","minimum","maximum"]},BoxSizeRatio:{resolve:"_resolveFull",cast:function(e){return e=sn.castNumber(e),null==e?e=1:.05>e?e=.05:e>1&&(e=1),e},value:1/3},BoxSizeMax:{resolve:"_resolveFull",data:{resolveV1:function(e){return this._specifyChartOption(e,"maxBoxSize"),!0}},cast:function(e){return e=sn.castNumber(e),null==e?e=1/0:1>e&&(e=1),e},value:1/0}}),e.type("pvc.visual.BulletPlot",sn.visual.Plot).add({type:"bullet",_getOptionsDefinition:function(){return sn.visual.BulletPlot.optionsDef}}),sn.visual.BulletPlot.optionsDef=e.create(sn.visual.Plot.optionsDef,{ValuesVisible:{value:!0},ColorRole:{value:null}}),e.type("pvc.visual.TreemapPlot",sn.visual.Plot).add({type:"treemap",_getOptionsDefinition:function(){return sn.visual.TreemapPlot.optionsDef},collectDataCells:function(e){this.base(e);var t=this.option("SizeRole");t&&e.push(new sn.visual.DataCell(this,"size",this.option("SizeAxis")-1,t,this.option("DataPart")))}}),sn.visual.TreemapPlot.optionsDef=e.create(sn.visual.Plot.optionsDef,{SizeRole:{resolve:"_resolveFixed",value:"size"},SizeAxis:{resolve:"_resolveFixed",value:1},ValuesAnchor:{cast:sn.parseAnchor,value:"center"},ValuesVisible:{value:!0},ValuesMask:{resolve:"_resolveFull",value:"{category}"},ValuesOptimizeLegibility:{value:!0},LayoutMode:{resolve:"_resolveFull",cast:sn.parseTreemapLayoutMode,value:"squarify"},ColorMode:{resolve:"_resolveFull",cast:sn.parseTreemapColorMode,value:"byparent"},RootCategoryLabel:{resolve:"_resolveFull",cast:String,value:"All"}}),e.type("pvc.visual.SunburstPlot",sn.visual.Plot).add({type:"sunburst",_getOptionsDefinition:function(){return sn.visual.SunburstPlot.optionsDef},collectDataCells:function(e){this.base(e);var t=this.option("SizeRole");t&&e.push(new sn.visual.DataCell(this,"size",this.option("SizeAxis")-1,t,this.option("DataPart")))}}),sn.visual.SunburstPlot.optionsDef=e.create(sn.visual.Plot.optionsDef,{SizeRole:{resolve:"_resolveFixed",value:"size"},SizeAxis:{resolve:"_resolveFixed",value:1},ValuesAnchor:{cast:sn.parseAnchor,value:"center"},ValuesVisible:{value:!0},ValuesMask:{resolve:"_resolveFull",value:"{category}"},ValuesOptimizeLegibility:{value:!0},RootCategoryLabel:{resolve:"_resolveFull",cast:String,value:"All"},SliceOrder:{resolve:"_resolveFull",cast:sn.parseSunburstSliceOrder,value:"bySizeDescending"},EmptySlicesVisible:{resolve:"_resolveFull",cast:Boolean,value:!1},EmptySlicesLabel:{resolve:"_resolveFull",cast:String,value:""}}),e.type("pvc.Abstract").init(function(){this._syncLog()}).add({invisibleLineWidth:.001,defaultLineWidth:1.5,_logInstanceId:null,_syncLog:function(){if(sn.debug&&"undefined"!=typeof console){var e=this._getLogInstanceId();["log","info",["trace","debug"],"error","warn",["group","groupCollapsed"],"groupEnd"].forEach(function(t){t=t instanceof Array?t:[t,t],s(this,"_"+t[0],t[1],e)},this)}},_getLogInstanceId:function(){return this._logInstanceId||(this._logInstanceId=this._processLogInstanceId(this._createLogInstanceId()))},_createLogInstanceId:function(){return""+this.constructor},_processLogInstanceId:function(t){var n=30,r=t.substr(0,n);return r.length<n&&(r+=e.array.create(n-r.length," ").join("")),"["+r+"]"}}),e.scope(function(){var e=sn.Abstract.prototype,t=function(){this._syncLog()};["log","info","trace","error","warn","group","groupEnd"].forEach(function(n){e["_"+n]=t})}),e.type("pvc.BaseChart",sn.Abstract).add(sn.visual.Interactive).init(function(t){var n=t,r=this.parent=e.get(t,"parent")||null;r?t||e.fail.argumentRequired("options"):(Xn&&Xn(),t=e.mixin.copy({},this.defaults,t)),this.options=t,r?(this.root=r.root,this.smallColIndex=t.smallColIndex,this.smallRowIndex=t.smallRowIndex):(this.root=this,this._format=sn.format()),this.base(),sn.debug>=3&&this._info("NEW CHART\n"+sn.logSeparator.replace(/-/g,"=")+"\n  DebugLevel: "+sn.debug),sn.debug>=3&&!r&&n&&(this._info("OPTIONS:\n",n),sn.debug>=5&&this._trace(sn.stringify(t,{ownOnly:!1,funs:!0}))),r&&r._addChild(this),this._constructData(t),this._constructVisualRoles(t)}).add({_disposed:!1,_animatable:!1,parent:null,children:null,root:null,isCreated:!1,_createVersion:0,renderCallback:void 0,multiChartPageCount:null,multiChartPageIndex:null,_multiChartOverflowClipped:!1,left:0,top:0,width:null,height:null,margins:null,paddings:null,_allowV1SecondAxis:!1,compatVersion:function(e){return(e||this.options).compatVersion},_createLogInstanceId:function(){return""+this.constructor+this._createLogChildSuffix()},_createLogChildSuffix:function(){return this.parent?" ("+(this.smallRowIndex+1)+","+(this.smallColIndex+1)+")":""},_addChild:function(t){t.parent===this||e.assert("Not a child of this chart."),this.children.push(t)},_create:function(e){this._createPhase1(e),this._createPhase2(e)},_createPhase1:function(e){this._createVersion++,this.isCreated=!1,sn.debug>=3&&this._log("Creating"),this.children=[],this.parent||sn.removeTipsyLegends(),this._processOptions(),this.parent||this._checkNoDataI(),!this.parent&&!this.data&&(this._initVisualRoles(),this._bindVisualRolesPreI(),this._complexTypeProj=this._createComplexTypeProject(),this._bindVisualRolesPreII()),this._initData(e),this.parent||this._checkNoDataII();var t=this.visualRoles.multiChart.isBound(),n=this._chartLevel();this._initPlots(t),this._initAxes(t),t&&!this.parent&&this._initMultiCharts(),this.parent||(this._interpolate(t),this._generateTrends(t)),this._setAxesScales(n)},_createPhase2:function(){var e=this.visualRoles.multiChart.isBound();this._initChartPanels(e),this.isCreated=!0},_setSmallLayout:function(t){if(t){var n=this.basePanel;this._setProp("left",t)|this._setProp("top",t)&&n&&e.set(n.position,"left",this.left,"top",this.top),this._setProp("width",t)|this._setProp("height",t)&&n&&(n.size=new hn(this.width,this.height)),this._setProp("margins",t)&&n&&(n.margins=new fn(this.margins)),this._setProp("paddings",t)&&n&&(n.paddings=new fn(this.paddings))}},_setProp:function(e,t){var n=t[e];if(null!=n)return this[e]=n,!0},_processOptions:function(){var e=this.options;return this.parent||(this.width=e.width,this.height=e.height,this.margins=e.margins,this.paddings=e.paddings),this.compatVersion()<=1&&(e.plot2=this._allowV1SecondAxis&&!!e.secondAxis),this._processFormatOptions(e),this._processDataOptions(e),this._processOptionsCore(e),this._processExtensionPoints(),e},_processOptionsCore:function(e){if(this.parent)this._ibits=this.parent._ibits,this._tooltipOptions=this.parent._tooltipOptions;else{var r="batik"!==t.renderer();r&&(r=e.interactive,null==r&&(r=!0));var i;if(r){var s=sn.visual.Interactive;i=s.Interactive|s.ShowsInteraction,this._processTooltipOptions(e)&&(i|=s.ShowsTooltip),e.animate&&n.support.svg&&(i|=s.Animatable);var o=!1;if(e.selectable){i|=s.Selectable;switch(sn.parseSelectionMode(e.selectionMode)){case"rubberband":i|=s.SelectableByRubberband|s.SelectableByClick;break;case"focuswindow":i|=s.SelectableByFocusWindow,o=!0}}o||"emptyspaceclick"!==sn.parseClearSelectionMode(e.clearSelectionMode)||(i|=s.Unselectable),e.hoverable&&(i|=s.Hoverable),e.clickable&&(i|=s.Clickable|s.DoubleClickable)}else i=0;this._ibits=i}},_tooltipDefaults:{gravity:"s",delayIn:200,delayOut:80,offset:2,opacity:.9,html:!0,fade:!0,useCorners:!1,arrowVisible:!0,followMouse:!1,format:void 0,className:""},_processTooltipOptions:function(t){var n=this.compatVersion()<=1,r=t.tooltip,i=t.tooltipEnabled;return null==i&&(r&&(i=r.enabled),null==i&&(n&&(i=t.showTooltips),null==i&&(i=!0))),i?(r=r?e.copy(r):{},n&&this._importV1TooltipOptions(r,t),e.eachOwn(this._tooltipDefaults,function(n,i){var s=t["tooltip"+e.firstUpperCase(i)];void 0!==s?r[i]=s:void 0===r[i]&&(r[i]=n)})):r={},this._tooltipOptions=r,i},_importV1TooltipOptions:function(e,t){var n=t.tipsySettings;if(n){this.extend(n,"tooltip");for(var r in n)void 0===e[r]&&(e[r]=n[r]);null==e.html&&(e.html=!1)}},_processFormatOptions:function(e){if(!this.parent){var t=e.format;void 0!=t&&this.format(t);var n=this._format;this._processFormatOption(e,n,"number","valueFormat"),this._processFormatOption(e,n,"percent","percentValueFormat")}},_processFormatOption:function(e,n,r,i){var s=n[r]();if(s!==sn.format.defaults[r]())e[i]=s;else{var o=e[i];o&&o!==s&&(o._nullWrapped||(e[i]=o=t.Format.createFormatter(o),o._nullWrapped=1),n[r](o))}},_processDataOptions:function(e){if(!this.parent){var t=e.dataSeparator;if(void 0===t){var n=e.dataOptions;n&&(t=n.separator)}e.dataSeparator=t||"~"}},format:function(t){var n=this.root;if(n!==this)return n.format.apply(n,arguments);var r=this._format;if(arguments.length){if(!t)throw e.error.argumentRequired("format");if(t!==r){if(!e.is(t,Sn)){if(r)return e.configure(r,t),this;t=Sn(t)}this._format=t}return this}return r},render:function(e,t,n){var r;sn.debug>1&&sn.group("CCC RENDER"),this._suspendSelectionUpdate();try{this.useTextMeasureCache(function(){try{for(;;){!this.isCreated||t?this._create({reloadData:n}):!this.parent&&this.isCreated&&sn.removeTipsyLegends(),this.basePanel.render({bypassAnimation:e,recreate:t});if(!this._isMultiChartOverflowClip){this._isMultiChartOverflowClipRetry=!1;break}t=!0,n=!1,this._isMultiChartOverflowClipRetry=!0,this._isMultiChartOverflowClip=!1,this._multiChartOverflowClipped=!0}}catch(i){i instanceof NoDataException?(sn.debug>1&&this._log("No data found."),this._addErrorPanelMessage("No data found",!0)):(r=!0,sn.logError(i.message),sn.debug>0&&this._addErrorPanelMessage("Error: "+i.message,!1))}})}finally{r||this._resumeSelectionUpdate(),sn.debug>1&&sn.groupEnd()}return this},_addErrorPanelMessage:function(e,n){var r=this.options,i=(new t.Panel).canvas(r.canvas).width(this.width).height(this.height),s=i.anchor("center").add(t.Label).text(e);n&&this.extend(s,"noDataMessage"),i.render()},useTextMeasureCache:function(e,n){var r=this.root,i=r._textMeasureCache||(r._textMeasureCache=t.Text.createCache());return t.Text.usingCache(i,e,n||this)},animate:function(e,t){return this.basePanel.animate(e,t)},animatingStart:function(){return this.basePanel.animatingStart()},animatable:function(){return this._animatable&&this.base()},isOrientationVertical:function(e){return(e||this.options.orientation)===sn.orientation.vertical},isOrientationHorizontal:function(e){return(e||this.options.orientation)===sn.orientation.horizontal},dispose:function(){this._disposed||(this._disposed=!0)},defaults:{width:400,height:300,orientation:"vertical",ignoreNulls:!0,crosstabMode:!0,isMultiValued:!1,seriesInRows:!1,groupedLabelSep:void 0,animate:!0,titlePosition:"top",titleAlign:"center",legend:!1,legendPosition:"bottom",v1StyleTooltipFormat:function(e,t,n,r){return e+", "+t+":  "+this.chart.options.valueFormat(n)+(r&&r.percent?" ("+r.percent.label+")":"")},clickable:!1,doubleClickMaxDelay:300,hoverable:!1,selectable:!1,selectionMode:"rubberband",ctrlSelectMode:!0,clearSelectionMode:"emptySpaceClick",compatVersion:1/0}});var Xn=function(){var e=sn.BaseChart.prototype.defaults;e.valueFormat||(e.valueFormat=Sn.defaults.number()),e.percentValueFormat||(e.percentValueFormat=Sn.defaults.percent()),Xn=null};sn.BaseChart.add({visualRoles:null,visualRoleList:null,_serRole:null,_dataPartRole:null,_measureVisualRoles:null,visualRole:function(t){var n=e.getOwn(this.visualRoles,t);if(!n)throw e.error.operationInvalid("roleName","There is no visual role with name '{0}'.",[t]);return n},measureVisualRoles:function(){return this._measureVisualRoles},measureDimensionsNames:function(){return e.query(this._measureVisualRoles).select(function(e){return e.firstDimensionName()}).where(e.notNully).array()},_constructVisualRoles:function(){var e=this.parent;e?(this.visualRoles=e.visualRoles,this.visualRoleList=e.visualRoleList,this._measureVisualRoles=e._measureVisualRoles,["_multiChartRole","_serRole","_colorRole","_dataPartRole"].forEach(function(t){var n=e[t];n&&(this[t]=n)},this)):(this.visualRoles={},this.visualRoleList=[],this._measureVisualRoles=[])},_hasDataPartRole:e.fun.constant(!1),_getSeriesRoleSpec:e.fun.constant(null),_getColorRoleSpec:e.fun.constant(null),_addVisualRole:function(t,n){n=e.set(n,"index",this.visualRoleList.length);var r=new sn.visual.Role(t,n);return this.visualRoleList.push(r),this.visualRoles[t]=r,r.isMeasure&&this._measureVisualRoles.push(r),r},_initVisualRoles:function(){this._multiChartRole=this._addVisualRole("multiChart",{defaultDimension:"multiChart*",requireIsDiscrete:!0}),this._hasDataPartRole()&&(this._dataPartRole=this._addVisualRole("dataPart",{defaultDimension:"dataPart",requireSingleDimension:!0,requireIsDiscrete:!0,dimensionDefaults:{isHidden:!0,comparer:e.compare}}));var t=this._getSeriesRoleSpec();t&&(this._serRole=this._addVisualRole("series",t));var n=this._getColorRoleSpec();n&&(this._colorRole=this._addVisualRole("color",n))},_assertUnboundRoleIsOptional:function(t){if(t.isRequired)throw e.error.operationInvalid("Chart type requires unassigned role '{0}'.",[t.name])},_bindVisualRolesPreI:function(){e.eachOwn(this.visualRoles,function(e){e.setIsReversed(!1)});var t=[],n=this.options,r=n.visualRoles;this.visualRoleList.forEach(function(e){var t=e.name,i=n[t+"Role"];void 0!==i&&(r||(r=n.visualRoles={}),void 0===r[t]&&(r[t]=i))});var i;if(r){i={};var s=e.query(e.keys(r)).select(this.visualRole,this).array();s.sort(function(e,t){return e.index-t.index}),s.forEach(function(n){var s,o,u=n.name,a=r[u];if(e.object.is(a)){e.nullyTo(a.isReversed,!1)&&n.setIsReversed(!0),o=a.from;if(o&&o!==u){var f=this.visualRoles[o]||e.fail.operationInvalid("Source role '{0}' is not supported by the chart type.",[o]);n.setSourceRole(f),t.push(n)}else s=a.dimensions}else s=a;if(void 0!==s){s||this._assertUnboundRoleIsOptional(n);var l=sn.data.GroupingSpec.parse(s);n.preBind(l),l.dimensions().each(function(t){e.hasOwn(i,t.name)?delete i[t.name]:i[t.name]=n})}},this)}this._sourcedRoles=t,this._dimsBoundToSingleRole=i},_bindVisualRolesPreII:function(){var t=this._dimsBoundToSingleRole;t&&(delete this._dimsBoundToSingleRole,e.eachOwn(t,this._setRoleBoundDimensionDefaults,this));var n=this._sourcedRoles;delete this._sourcedRoles,e.query(this.visualRoleList).where(function(e){return e.defaultSourceRoleName&&!e.sourceRole&&!e.isPreBound()}).each(function(e){var t=this.visualRoles[e.defaultSourceRoleName];t&&(e.setSourceRole(t,!0),n.push(e))},this),n.forEach(function(e){var t=e.sourceRole;t.isReversed&&e.setIsReversed(!e.isReversed),!e.defaultDimensionName&&t.isPreBound()&&e.preBind(t.preBoundGrouping())})},_setRoleBoundDimensionDefaults:function(e,t){this._complexTypeProj.setDimDefaults(t,e.dimensionDefaults)},_bindVisualRolesPostI:function(){function t(t,n){e.array.lazy(h,t).push(n)}function n(e){return c.hasDim(e)}function r(n,r){e.array.is(r)?r.forEach(function(e){t(e,n)}):t(r,n),n.setSourceRole(null),n.preBind(sn.data.GroupingSpec.parse(r))}function i(e,t){t.length&&(e.requireSingleDimension?r(e,t[0]):r(e,t))}function s(e,t){c.setDim(t,{isHidden:!0}),r(e,t)}function o(e){l._assertUnboundRoleIsOptional(e),e.bind(null),e.setSourceRole(null)}function u(e){e.preBoundGrouping().dimensionNames().forEach(t)}function a(t){if(!t.sourceRole||t.isDefaultSourceRole){var u=t.defaultDimensionName;if(u){var a=u.match(/^(.*?)(\*)?$/)||e.fail.argumentInvalid("defaultDimensionName"),f=a[1],l=a[2];if(l){var h=c.groupDimensionsNames(f);if(h){i(t,h);return}}else if(n(f)){r(t,f);return}t.autoCreateDimension?s(t,f):t.sourceRole?p.push(t):o(t)}else t.sourceRole?p.push(t):o(t)}else p.push(t)}function f(e){var t=e.sourceRole;t.isPreBound()?e.preBind(t.preBoundGrouping()):o(e)}var l=this,c=l._complexTypeProj,h={},p=[];e.query(l.visualRoleList).where(function(e){return e.isPreBound()}).each(u),e.query(l.visualRoleList).where(function(e){return!e.isPreBound()}).each(a),p.forEach(f),e.query(e.ownKeys(h)).where(function(e){return 1===h[e].length}).each(function(e){var t=h[e][0];l._setRoleBoundDimensionDefaults(t,e)})},_bindVisualRolesPostII:function(t){e.query(this.visualRoleList).where(function(e){return e.isPreBound()}).each(function(e){e.postBind(t)})},_logVisualRoles:function(){var t=e.ownKeys(this.visualRoles),n=Math.max(10,e.query(t).select(function(e){return e.length}).max()),r=e.string.padRight("VisualRole",n)+" < Dimension(s)",i=["VISUAL ROLES MAP SUMMARY",sn.logSeparator,r,e.string.padRight("",n+1,"-")+"+--------------"];e.eachOwn(this.visualRoles,function(t,r){i.push(e.string.padRight(r,n)+" | "+(t.grouping||"-"))}),i.push(""),this._log(i.join("\n"))},_getDataPartDimName:function(){var e=this._dataPartRole;if(e){if(e.isBound())return e.firstDimensionName();var t=e.preBoundGrouping();return t?t.firstDimensionName():e.defaultDimensionName}}}),sn.BaseChart.add({dataEngine:null,data:null,_partsDataCache:null,_visibleDataCache:null,resultset:[],metadata:[],_trendable:!1,_interpolatable:!1,_constructData:function(t){this.parent&&(this.dataEngine=this.data=t.data||e.fail.argumentRequired("options.data"))},_checkNoDataI:function(){if(!this.allowNoData&&!this.resultset.length)throw new NoDataException},_checkNoDataII:function(){if(!(this.allowNoData||this.data&&this.data.count()))throw this.data=null,new NoDataException},_initData:function(t){if(!this.parent){var n=this.data;n?e.get(t,"reloadData",!0)?this._onReloadData():(n.disposeChildren(),n.clearVirtuals()):this._onLoadData()}delete this._partsDataCache,delete this._visibleDataCache,sn.debug>=3&&this._log(this.data.getInfo())},_onLoadData:function(){var t=this.data,n=this._translation;!t&&!n||e.assert("Invalid state.");var r=this.options,i=this._getDataPartDimName(),s=this._complexTypeProj||e.assert("Invalid state."),o=this._createDimensionsOptions(r);if(this.metadata.length){var u=this._createTranslationOptions(r,o,i);n=this._translation=this._createTranslation(u),sn.debug>=3&&(this._log(n.logSource()),this._log(n.logTranslatorType())),n.configureType()}i&&!s.isReadOrCalc(i)&&this._addDefaultDataPartCalculation(i),n&&sn.debug>=3&&this._log(n.logVItem()),this._bindVisualRolesPostI();var a=new sn.data.ComplexType;s.configureComplexType(a,o),this._bindVisualRolesPostII(a),sn.debug>=3&&(this._log(a.describe()),this._logVisualRoles()),t=this.dataEngine=this.data=new sn.data.Data({type:a,labelSep:r.groupedLabelSep,keySep:r.dataSeparator});if(n){var f={where:this._getLoadFilter(),isNull:this._getIsNullDatum()},l=n.execute(t);t.load(l,f)}},_onReloadData:function(){var t=this.data,n=this._translation;t&&n||e.assert("Invalid state."),n.setSource(this.resultset),sn.debug>=3&&this._log(n.logSource());var r={where:this._getLoadFilter(),isNull:this._getIsNullDatum()},i=n.execute(t);t.load(i,r)},_createComplexTypeProject:function(){var e=this.options,t=new sn.data.ComplexTypeProject(e.dimensionGroups),n=e.dimensions;for(var r in n)t.setDim(r,n[r]);var i=this._getDataPartDimName();i&&(t.setDim(i),this._addPlot2SeriesDataPartCalculation(t,i));var s=e.calculations;return s&&s.forEach(function(e){t.setCalc(e)}),t},_getLoadFilter:function(){var e=this.options,t=e.dataOptions,n=e.dataWhere;return void 0!==n?n:t&&t.where},_getIsNullDatum:function(){var e=this.measureDimensionsNames(),t=e.length;return t?function(n){for(var r=n.atoms,i=0;t>i;i++)if(null!=r[e[i]].value)return!1;return!0}:void 0},_createTranslation:function(e){var t=this._getTranslationClass(e);return new t(this,this._complexTypeProj,this.resultset,this.metadata,e)},_getTranslationClass:function(e){return e.crosstabMode?sn.data.CrosstabTranslationOper:sn.data.RelationalTranslationOper},_createDimensionsOptions:function(e){return{isCategoryTimeSeries:e.timeSeries,formatProto:this._format,timeSeriesFormat:e.timeSeriesFormat,dimensionGroups:e.dimensionGroups}},_createTranslationOptions:function(t,n,r){var i=t.dataOptions||{},s=t.dataMeasuresInColumns;void 0===s&&(s=i.measuresInColumns);var o=t.dataCategoriesCount;void 0===o&&(o=i.categoriesCount);var u=t.dataIgnoreMetadataLabels;void 0===u&&(u=i.ignoreMetadataLabels);var a,f,l=t.plot2;if(l){if(this._allowV1SecondAxis&&this.compatVersion()<=1)f=t.secondAxisIdx;else{a=null!=this._serRole&&t.plot2Series&&e.array.as(t.plot2Series);if(!a||!a.length)a=null,f=t.plot2SeriesIndexes}a||(f=sn.parseDistinctIndexArray(f,-1/0)||-1)}return e.create(n,{compatVersion:this.compatVersion(),plot2DataSeriesIndexes:f,seriesInRows:t.seriesInRows,crosstabMode:t.crosstabMode,isMultiValued:t.isMultiValued,dataPartDimName:r,readers:t.readers,measuresIndexes:t.measuresIndexes,multiChartIndexes:t.multiChartIndexes,ignoreMetadataLabels:u,separator:t.dataSeparator,measuresInColumns:s,categoriesCount:o,measuresIndex:i.measuresIndex||i.measuresIdx,measuresCount:i.measuresCount||i.numMeasures})},_addPlot2SeriesDataPartCalculation:function(t,n){if(!(this.compatVersion()<=1)){var r=this.options,i=this._serRole,s=null!=i&&r.plot2&&r.plot2Series&&e.array.as(r.plot2Series);if(s&&s.length){var o,u,a,f,l=!1,c=e.query(s).uniqueIndex();t.setCalc({names:n,calculation:function(t,r){l||(i.isBound()&&(o=i.grouping.dimensionNames(),u=t.owner.dimensions(n)),l=!0);if(u){var s=sn.data.Complex.compositeKey(t,o);r[n]=e.hasOwnProp.call(c,s)?f||(f=u.intern("1")):a||(a=u.intern("0"))}}})}}},_addDefaultDataPartCalculation:function(e){var t,n;this._complexTypeProj.setCalc({names:e,calculation:function(r,i){t||(t=r.owner.dimensions(e)),i[e]=n||(n=t.intern("0"))}})},partData:function(t,n){n||(n=this.data);if(null==t)return n;if(this.parent)return this.root.partData(t,n);var r=this._dataPartRole;if(!r||!r.isBound())return n;var i="\0"+n.id+":"+e.nullyTo(t,""),s=e.lazy(this,"_partsDataCache"),o=s[i];return o||(o=this._createPartData(n,r,t),s[i]=o),o},_createPartData:function(t,n,r){var i=n.firstDimensionName(),s=t.dimensions(i).getDistinctAtoms(e.array.to(r)),o=Pt([e.set({},i,s)]);return t.where(null,{where:o})},visibleData:function(t,n){var r=e.get(n,"baseData")||this.data;if(this.parent)return n=n?Object.create(n):{},n.baseData=r,this.root.visibleData(t,n);var i=!!e.get(n,"inverted",!1),s=!!this.options.ignoreNulls||!!e.get(n,"ignoreNulls",!0),o="\0"+r.id+"|"+i+"|"+s+"|"+(null!=t?t:null),u=e.lazy(this,"_visibleDataCache"),a=u[o];if(!a){var f=this.partData(t,r);n=n?Object.create(n):{},n.visible=!0,n.isNull=s?!1:null,a=u[o]=this._createVisibleData(f,n)}return a},_createVisibleData:function(e,t){var n=this._serRole;return n&&n.isBound()?n.flatten(e,t):e.where(null,t)},_initMultiCharts:function(){var t=this;t.multiOptions=new sn.visual.MultiChart(t),t.smallOptions=new sn.visual.SmallChart(t);var n,r,i,s,o=t.multiOptions.option,u=t.visualRoles.multiChart.flatten(t.data,{visible:!0,isNull:null}),a=u.childNodes;t._isMultiChartOverflowClipRetry?(r=t._clippedMultiChartRowsMax,n=t._clippedMultiChartColsMax,s=n,i=r*n):i=o("Max");var f=Math.min(a.length,i);0===f?n=r=s=0:t._isMultiChartOverflowClipRetry||(s=o("ColumnsMax"),n=Math.min(f,s),n>=1&&isFinite(n)||e.assert("Must be at least 1 and finite"),r=Math.ceil(f/n),r>=1||e.assert("Must be at least 1")),t._multiInfo={data:u,smallDatas:a,count:f,rowCount:r,colCount:n,colsMax:s}},_interpolate:function(t){if(this._interpolatable){var n=e.query(this.axesList).selectMany(e.propGet("dataCells")).where(function(e){var t=e.nullInterpolationMode;return!!t&&"none"!==t}).distinct(function(e){return e.role.name+"|"+(e.dataPartValue||"")}).array();this._eachLeafDatasAndDataCells(t,n,this._interpolateDataCell,this)}},_generateTrends:function(t){var n=this._getDataPartDimName();if(this._trendable&&n){var r=e.query(this.axesList).selectMany(e.propGet("dataCells")).where(e.propGet("trend")).distinct(function(e){return e.role.name+"|"+(e.dataPartValue||"")}).array(),i=[];this._eachLeafDatasAndDataCells(t,r,function(e,t){this._generateTrendsDataCell(i,e,t)},this),i.length&&this.data.owner.add(i)}},_eachLeafDatasAndDataCells:function(e,t,n,r){var i=t.length;if(i){var s,o;e?(s=this._multiInfo.smallDatas,o=this._multiInfo.count):(s=[this.data],o=1);for(var u=0;o>u;u++)for(var a=s[u],f=0;i>f;f++)n.call(r,t[f],a,f,u)}},_interpolateDataCell:function(){},_generateTrendsDataCell:function(){},_getTrendDataPartAtom:function(){var e=this._getDataPartDimName();return e?this.data.owner.dimensions(e).intern("trend"):void 0},setData:function(e,t){return this.setResultset(e&&e.resultset),this.setMetadata(e&&e.metadata),n.extend(this.options,t),this},setResultset:function(t){return!this.parent||e.fail.operationInvalid("Can only set resultset on root chart."),this.resultset=t||[],this.resultset.length||this._warn("Resultset is empty"),this},setMetadata:function(t){return!this.parent||e.fail.operationInvalid("Can only set metadata on root chart."),this.metadata=t||[],this.metadata.length||this._warn("Metadata is empty"),this}}),sn.BaseChart.add({_initPlots:function(e){this.plotPanelList=null;if(this.parent){var t=this.root;this.plots=t.plots,this.plotList=t.plotList,this.plotsByType=t.plotsByType}else this.plots={},this.plotList=[],this.plotsByType={},this._initPlotsCore(e)},_initPlotsCore:function(){},_addPlot:function(t){var n=this.plotsByType,r=this.plots,i=t.type,s=t.index,o=t.name,u=t.id;if(o&&e.hasOwn(r,o))throw e.error.operationInvalid("Plot name '{0}' already taken.",[o]);if(e.hasOwn(r,u))throw e.error.operationInvalid("Plot id '{0}' already taken.",[u]);var a=e.array.lazy(n,i);if(e.hasOwn(a,s))throw e.error.operationInvalid("Plot index '{0}' of type '{1}' already taken.",[s,i]);t.globalIndex=this.plotList.length,a[s]=t,this.plotList.push(t),r[u]=t,o&&(r[o]=t)},_collectPlotAxesDataCells:function(t,n){var r=[];t.collectDataCells(r),r.length&&e.query(r).where(function(e){return e.role.isBound()}).each(function(t){var r=e.array.lazy(n,t.axisType);e.array.lazy(r,t.axisIndex).push(t)})},_addPlotPanel:function(t){e.lazy(this,"plotPanels")[t.plot.id]=t,e.array.lazy(this,"plotPanelList").push(t)},_createPlotPanels:function(){throw e.error.notImplemented()}}),sn.BaseChart.add({colors:null,axes:null,axesList:null,axesByType:null,_axisClassByType:{color:sn.visual.ColorAxis,size:sn.visual.SizeAxis,base:_n,ortho:_n},_axisCreateChartLevel:{color:1,size:2,base:3,ortho:3},_axisSetScaleChartLevel:{color:1,size:2,base:2,ortho:2},_axisCreationOrder:["color","size","base","ortho"],_axisCreateIfUnbound:{},_chartLevel:function(){var e=0;return this.parent||(e|=1),(this.parent||!this.visualRoles.multiChart.isBound())&&(e|=2),e},_initAxes:function(){this.axes={},this.axesList=[],this.axesByType={},delete this._rolesColorScale;var t;this.parent?t=this.root._dataCellsByAxisTypeThenIndex:(t={},this.plotList.forEach(function(e){this._collectPlotAxesDataCells(e,t)},this),this._dataCellsByAxisTypeThenIndex=t);var n=this._chartLevel();this._axisCreationOrder.forEach(function(e){if(0!==(this._axisCreateChartLevel[e]&n)){var r,i=t[e];i?(r=this._axisClassByType[e],r&&i.forEach(function(t,n){new r(this,e,n)},this)):this._axisCreateIfUnbound[e]&&(r=this._axisClassByType[e],r&&new r(this,e,0))}},this),this.parent&&this.root.axesList.forEach(function(t){e.hasOwn(this.axes,t.id)||this._addAxis(t)},this),e.eachOwn(t,function(e,t){this._axisCreateChartLevel[t]&n&&e.forEach(function(e,n){var r=this.axes[sn.buildIndexedId(t,n)];r.isBound()||r.bind(e)},this)},this)},_addAxis:function(t){this.axes[t.id]=t,t.chart===this&&(t.axisIndex=this.axesList.length),this.axesList.push(t);var n=e.array.lazy(this.axesByType,t.type),r=n.count||0;return t.typeIndex=r,n[t.index]=t,r||(n.first=t),n.count=r+1,"color"===t.type&&t.isBound()&&this._onColorAxisScaleSet(t),this},_getAxis:function(e,t){var n=this.axesByType[e];return n&&null!=t&&+t>=0?n[t]:void 0},_setAxesScales:function(e){this.axesList.forEach(function(t){this._axisSetScaleChartLevel[t.type]&e&&t.isBound()&&this._setAxisScale(t,e)},this)},_setAxisScale:function(e,t){this._setAxisScaleByScaleType(e,t)},_setAxisScaleByScaleType:function(t,n){switch(t.scaleType){case"discrete":this._setDiscreteAxisScale(t,n);break;case"numeric":this._setNumericAxisScale(t,n);break;case"timeSeries":this._setTimeSeriesAxisScale(t,n);break;default:throw e.error("Unknown axis scale type.")}},_describeScale:function(t,n){n.isNull&&sn.debug>=3&&this._log(e.format("{0} scale for axis '{1}'- no data",[t.scaleType,t.id]))},_setDiscreteAxisScale:function(e){if("color"!==e.type){var n=e.domainValues(),r=new t.Scale.ordinal;n.length?r.domain(n):r.isNull=!0,this._describeScale(e,r),e.setScale(r)}else this._setDiscreteColorAxisScale(e)},_setTimeSeriesAxisScale:function(e){var n=this._getContinuousVisibleExtentConstrained(e),r=new t.Scale.linear;if(n){var i=n.min,s=n.max,o=1,u=function(){var e=s-i;e&&Math.abs(e)<o&&(s=i=new Date(Math.round((i+s)/2)),e=0),e?0>e&&(!n.maxLocked||n.minLocked?s=new Date(i.getTime()+sn.time.intervals.h):i=new Date(s.getTime()-sn.time.intervals.h)):(n.minLocked||(i=new Date(i.getTime()-sn.time.intervals.h)),(!n.maxLocked||n.minLocked)&&(s=new Date(s.getTime()+sn.time.intervals.h)))};u(),r.domain(i,s),r.minLocked=n.minLocked,r.maxLocked=n.maxLocked}else r.isNull=!0;this._describeScale(e,r),e.setScale(r)},_setNumericAxisScale:function(e){if("color"!==e.type){var n=this._getContinuousVisibleExtentConstrained(e),r=new t.Scale.linear;if(n){var i=n.min,s=n.max,o=1e-10,u=function(){var e=s-i;e&&Math.abs(e)<=o&&(i=(i+s)/2,i=s=+i.toFixed(10),e=0),e?0>e&&(!n.maxLocked||n.minLocked?s=Math.abs(i)>o?1.01*i:.1:i=Math.abs(s)>o?.99*s:-0.1):(n.minLocked||(i=Math.abs(i)>o?.99*i:-0.1),(!n.maxLocked||n.minLocked)&&(s=Math.abs(s)>o?1.01*s:.1))};u();var a=e.option.isDefined("OriginIsZero")&&e.option("OriginIsZero");a&&(0===i?n.minLocked=!0:0===s?n.maxLocked=!0:i*s>0&&(i>0?n.minLocked||(n.minLocked=!0,i=0):n.maxLocked||(n.maxLocked=!0,s=0),u())),r.domain(i,s),r.minLocked=n.minLocked,r.maxLocked=n.maxLocked}else r.isNull=!0;this._describeScale(e,r),e.setScale(r)}else this._setNumericColorAxisScale(e)},_warnSingleContinuousValueRole:function(t){t.grouping.isSingleDimension||this._warn("A linear scale can only be obtained for a single dimension role."),t.grouping.isDiscrete()&&this._warn(e.format("The single dimension of role '{0}' should be continuous.",[t.name]))},_getContinuousVisibleExtentConstrained:function(e,t,n){var r,i=function(){return r||(r=this.data.owner.dimensions(e.role.grouping.firstDimensionName()))},s=!1,o=!1;null==t&&e.option.isDefined("FixedMin")&&(t=e.option("FixedMin"),null!=t&&(t=i.call(this).read(t)),s=null!=t,s&&(t=t.value,0>t&&e.scaleUsesAbs()&&(t=-t))),null==n&&e.option.isDefined("FixedMax")&&(n=e.option("FixedMax"),null!=n&&(n=i.call(this).read(n)),o=null!=n,o&&(n=n.value,0>n&&e.scaleUsesAbs()&&(n=-n)));if(null==t||null==n){var u=this._getContinuousVisibleExtent(e);if(!u)return null;null==t&&(t=u.min),null==n&&(n=u.max)}return{min:t,max:n,minLocked:s,maxLocked:o}},_getContinuousVisibleExtent:function(t){var n=t.dataCells;return 1===n.length?this._getContinuousVisibleCellExtent(t,n[0]):e.query(n).select(function(e){return this._getContinuousVisibleCellExtent(t,e)},this).reduce(sn.unionExtents,null)},_getContinuousVisibleCellExtent:function(t,n){var r=n.role;this._warnSingleContinuousValueRole(r);if("series"===r.name)throw e.error.notImplemented();var i=t.scaleSumNormalized(),s=this.visibleData(n.dataPartValue),o=r.firstDimensionName();if(i){var u=s.dimensionsSumAbs(o);if(u)return{min:0,max:u}}else{var a=t.scaleUsesAbs(),f=s.dimensions(o).extent({abs:a});if(f){var l=f.min.value,c=f.max.value;return{min:a?Math.abs(l):l,max:a?Math.abs(c):c}}}},_setDiscreteColorAxisScale:function(e){var t=e.domainValues(),n=e.scheme()(t);this._describeScale(e,n),e.setScale(n,!0),this._onColorAxisScaleSet(e)},_setNumericColorAxisScale:function(t){if(1!==t.dataCells.length)throw e.error("Can't handle multiple continuous datacells in color axis.");this._warnSingleContinuousValueRole(t.role);var n=this.visibleData(t.dataCell.dataPartValue),r=t.option("NormByCategory"),i={type:t.option("ScaleType"),colors:t.option("Colors")().range(),colorDomain:t.option("Domain"),colorMin:t.option("Min"),colorMax:t.option("Max"),colorMissing:t.option("Missing"),data:n,colorDimension:t.role.firstDimensionName(),normPerBaseCategory:r};if(r)t.scalesByCateg=f(i);else{var s=l(i);this._describeScale(t,s),t.setScale(s)}this._onColorAxisScaleSet(t)},_onColorAxisScaleSet:function(e){switch(e.index){case 0:this.colors=e.scheme();break;case 1:this._allowV1SecondAxis&&(this.secondAxisColor=e.scheme())}},_getRoleColorScale:function(t){return e.lazy(e.lazy(this,"_rolesColorScale"),t,this._createRoleColorScale,this)},_createRoleColorScale:function(t){function n(t){var n=""+t;e.hasOwnProp.call(s,n)||(s[n]=i(t))}var r,i,s={};return this.axesByType.color.forEach(function(e){var s=e.role,o=s.name===t||s.sourceRole&&s.sourceRole.name===t;o&&e.scale&&(0===e.index||e.option.isSpecified("Colors")||e.option.isSpecified("Map"))&&(i=e.scale,r||(r=i),e.domainValues().forEach(n))},this),r?(i=function(t){var n=""+t;if(e.hasOwnProp.call(s,n))return s[n];var i=r(t);return s[n]=i,i},e.copy(i,r),i):sn.createColorScheme()()},_onLaidOut:function(){}}),sn.BaseChart.add({basePanel:null,titlePanel:null,legendPanel:null,_multiChartPanel:null,_initChartPanels:function(e){this._initBasePanel(),this._initTitlePanel();var t=this._initLegendPanel(),n=e&&!this.parent;n&&this._initMultiChartPanel(),t&&this._initLegendScenes(t);if(!n){var r=this.options;this._createContent({margins:e?r.smallContentMargins:r.contentMargins,paddings:e?r.smallContentPaddings:r.contentPaddings,clickAction:r.clickAction,doubleClickAction:r.doubleClickAction})}},_createContent:function(){},_initBasePanel:function(){var e=this.parent;this.basePanel=new sn.BasePanel(this,e&&e._multiChartPanel,{margins:this.margins,paddings:this.paddings,size:{width:this.width,height:this.height}})},_initTitlePanel:function(){var t=this,n=t.options,r=n.title;e.empty(r)||(this.titlePanel=new sn.TitlePanel(t,t.basePanel,{title:r,font:n.titleFont,anchor:n.titlePosition,align:n.titleAlign,alignTo:n.titleAlignTo,offset:n.titleOffset,keepInBounds:n.titleKeepInBounds,margins:n.titleMargins,paddings:n.titlePaddings,titleSize:n.titleSize,titleSizeMax:n.titleSizeMax}))},_initLegendPanel:function(){var t=this.options;if(t.legend){var n=new sn.visual.Legend(this,"legend",0);return this.legendPanel=new sn.LegendPanel(this,this.basePanel,{anchor:n.option("Position"),align:n.option("Align"),alignTo:t.legendAlignTo,offset:t.legendOffset,keepInBounds:t.legendKeepInBounds,size:n.option("Size"),sizeMax:n.option("SizeMax"),margins:n.option("Margins"),paddings:n.option("Paddings"),font:n.option("Font"),scenes:e.getPath(t,"legend.scenes"),textMargin:t.legendTextMargin,itemPadding:t.legendItemPadding,itemSize:n.option("ItemSize"),markerSize:t.legendMarkerSize})}},_getLegendBulletRootScene:function(){return this.legendPanel&&this.legendPanel._getBulletRootScene()},_initMultiChartPanel:function(){var e=this.basePanel,t=this.options;this._multiChartPanel=new sn.MultiChartPanel(this,e,{margins:t.contentMargins,paddings:t.contentPaddings}),this._multiChartPanel.createSmallCharts(),e._children.unshift(e._children.pop())},_coordinateSmallChartsLayout:function(){},_initLegendScenes:function(t){var n=this.axesByType.color;if(n){var r,i,s,o=0,u=this,a=function(e,t){if("togglevisible"===e.option("LegendClickMode")){void 0===r&&(r=u._getTrendDataPartAtom()||null,r&&(i=r.dimension.name));if(r&&t.firstAtoms()[i]===r)return"none"}},f=function(){return s||(s=t._getBulletRootScene())};e.query(n).where(function(e){return e.option("LegendVisible")&&e.isBound()&&e.isDiscrete()}).each(function(e){for(var t=e.scale,n=-1,r=e.dataCells,i=r.length;++n<i;){var s=r[n],u=e.domainCellData(n),l=f().createGroup({source:u,colorAxis:e,clickMode:a(e,u),extensionPrefix:sn.buildIndexedId("",o++)});s.legendGroupScene(l),e.domainCellItems(u).forEach(function(n){var r=l.createItem({source:n}),i=e.domainItemValue(n);r.color=t(i)})}})}}}),sn.BaseChart.add({_updateSelectionSuspendCount:0,_lastSelectedDatums:null,clearSelections:function(){return this.data.owner.clearSelected()&&this.updateSelections(),this},_updatingSelections:function(e,t){this._suspendSelectionUpdate();try{e.call(t||this)}finally{this._resumeSelectionUpdate()}},_suspendSelectionUpdate:function(){this===this.root?this._updateSelectionSuspendCount++:this.root._suspendSelectionUpdate()},_resumeSelectionUpdate:function(){this===this.root?this._updateSelectionSuspendCount>0&&(--this._updateSelectionSuspendCount||this.updateSelections()):this.root._resumeSelectionUpdate()},renderInteractive:function(){return this.useTextMeasureCache(function(){this.basePanel.renderInteractive()},this),this},renderResize:function(e,t){return void 0!==e&&(this.options.width=e),void 0!==t&&(this.options.height=t),this.render(!0,!0,!1)},updateSelections:function(t){if(this===this.root){if(this._inUpdateSelections||this._updateSelectionSuspendCount)return this;var n=this._calcSelectedChangedDatums();if(!n)return this;sn.removeTipsyLegends(),this._inUpdateSelections=!0;try{var r=this.options.selectionChangedAction;if(r){var i=this.data.selectedDatums(),s=n.values();r.call(this.basePanel.context(),i,s)}e.get(t,"render",!0)&&this.useTextMeasureCache(function(){this.basePanel.renderInteractive()},this)}finally{this._inUpdateSelections=!1}}else this.root.updateSelections();return this},_calcSelectedChangedDatums:function(){if(this.data){var e,t=this.data.selectedDatumMap(),n=this._lastSelectedDatums;if(n){e=n.symmetricDifference(t);if(!e.count)return}else{if(!t.count)return;e=t.clone()}return this._lastSelectedDatums=t,e}},_onUserSelection:function(e){if(!e||!e.length)return e;if(this===this.root){var t=this.options.userSelectionAction;return t?t.call(this.basePanel.context(),e)||e:e}return this.root._onUserSelection(e)}}),sn.BaseChart.add({_processExtensionPoints:function(){var t;if(this.parent)t=this.parent._components;else{var n=this.options.extensionPoints;t={};if(n)for(var r in n){var i,s,o=r.indexOf("_");if(o>0){i=r.substring(0,o),s=r.substr(o+1);if(i&&s){var u=e.getOwn(t,i)||(t[i]=new e.OrderedMap);u.add(s,n[r])}}}}this._components=t},extend:function(t,n,r){e.array.is(n)?n.forEach(function(e){this._extendCore(t,e,r)},this):this._extendCore(t,n,r)},_extendCore:function(t,n,r){if(t){var i=e.getOwn(this._components,n);if(i){t.borderPanel&&(t=t.borderPanel);var s=sn.debug>=3?[]:null,o=e.get(r,"constOnly",!1),u=t.wrap,a={tag:sn.extensionTag},f=t instanceof on,l=f&&(u||o),c=function(n,r){if(null!=n){var i=typeof n;if("object"===i){if("svg"===r||"css"===r){var s=t.propertyValue(r);s&&(n=e.copy(s,n))}else if(n instanceof Array)return n.map(function(e){return c(e,r)})}else if(l&&"function"===i){if(o)return;"add"!==r&&"call"!==r&&(n=u.call(t,n,r))}}return n},h=function(e,n){n instanceof Array?e.apply(t,n):e.call(t,n)};i.forEach(function(e,n){if(t.isLocked&&t.isLocked(n))s&&s.push(n+": locked extension point!");else if(t.isIntercepted&&t.isIntercepted(n))s&&s.push(n+":"+sn.stringify(e)+" (controlled)");else{s&&s.push(n+": "+sn.stringify(e)),e=c(e,n);if(void 0!==e){var r=t[n];"function"==typeof r?f&&t.properties[n]?t.intercept(n,e,a):e instanceof Array?e.forEach(function(e){h(r,e)}):h(r,e):t[n]=e}}}),s&&(s.length?this._log("Applying Extension Points for: '"+n+"'\n	* "+s.join("\n	* ")):sn.debug>=5&&this._log("No Extension Points for: '"+n+"'"))}}else sn.debug>=4&&this._log("Applying Extension Points for: '"+n+"' (target mark does not exist)")},_getExtension:function(t,n){var r;if(e.array.is(t))for(var i,s=t.length-1;s>=0;){r=e.getOwn(this._components,t[s--]);if(r&&void 0!==(i=r.get(n)))return i}else{r=e.getOwn(this._components,t);if(r)return r.get(n)}},_getComponentExtensions:function(t){return e.getOwn(this._components,t)},_getConstantExtension:function(t,n){var r=this._getExtension(t,n);return e.fun.is(r)?void 0:r}}),e.type("pvc.BasePanel",sn.Abstract).add(sn.visual.Interactive).init(function(t,r,i){this.chart=t,this.base(),this.axes=Object.create(t.axes);if(i){i.scenes&&(this._sceneTypeExtensions=i.scenes,delete i.scenes);var s=i.axes;s&&(e.copy(this.axes,s),delete i.axes)}n.extend(this,i),this.axes.color||(this.axes.color=t.axes.color),this.position={};var o=i&&i.margins;r||void 0!==o||(o=3),this.margins=new fn(o),this.paddings=new fn(i&&i.paddings),this.size=new hn(i&&i.size),this.sizeMax=new hn(i&&i.sizeMax),r?(this.parent=r,this.isTopRoot=!1,this.isRoot=r.chart!==t,this.root=this.isRoot?this:r.root,this.topRoot=r.topRoot,this._ibits=r._ibits,this.isRoot&&(this.position.left=t.left,this.position.top=t.top),r._addChild(this)):(this.parent=null,this.root=this,this.topRoot=this,this.isRoot=!0,this.isTopRoot=!0,this._ibits=t._ibits),this.data=(this.isRoot?t:r).data;if(this.isRoot)this.anchor=null,this.align=null,this.alignTo=null,this.offset=null;else{this.align=sn.parseAlign(this.anchor,this.align);var u=this.alignTo,a=this.anchor;null==u||""===u||"left"!==a&&"right"!==a?u=this.align:"page-middle"!==u&&(u=isNaN(+u.charAt(0))?sn.parseAlign(a,u):ln.parse(u)),this.alignTo=u,this.offset=new pn(this.offset)}if(null==this.borderWidth){var f,l=this._getExtensionId();if(l){var c=this._getExtension(l,"strokeStyle");null!=c&&(f=+this._getConstantExtension(l,"lineWidth"),(isNaN(f)||!isFinite(f))&&(f=null))}this.borderWidth=null==f?0:1.5}var h=sn.visual.Interactive,p=this._ibits;p=e.bit.set(p,h.Clickable,t._ibits&h.Clickable&&!!this.clickAction),p=e.bit.set(p,h.DoubleClickable,t._ibits&h.DoubleClickable&&!!this.doubleClickAction),this._ibits=p}).add({chart:null,parent:null,_children:null,type:t.Panel,_extensionPrefix:"",_rubberSelectableMarks:null,height:null,width:null,borderWidth:null,anchor:"top",pvPanel:null,margins:null,paddings:null,isRoot:!1,isTopRoot:!1,root:null,topRoot:null,_layoutInfo:null,_signs:null,data:null,dataPartValue:null,_animating:0,_selectingByRubberband:!1,_v1DimRoleName:{series:"series",category:"category",value:"value"},_sceneTypeExtensions:null,clickAction:null,doubleClickAction:null,compatVersion:function(e){return this.chart.compatVersion(e)},_createLogInstanceId:function(){return""+this.constructor+this.chart._createLogChildSuffix()},_getLegendBulletRootScene:function(){return this.chart._getLegendBulletRootScene()},_addChild:function(t){t.parent===this||e.assert("Child has a != parent."),(this._children||(this._children=[])).push(t)},_addSign:function(t){e.array.lazy(this,"_signs").push(t),t.selectableByRubberband()&&e.array.lazy(this,"_rubberSelectableMarks").push(t.pvMark)},visibleData:function(e){return this.chart.visibleData(this.dataPartValue,e)},partData:function(){return this.chart.partData(this.dataPartValue)},layout:function(t,n){if(!this._layoutInfo||e.get(n,"force",!1)){var r=e.get(n,"referenceSize");!r&&t&&(r=e.copyOwn(t));var i=this.size.resolve(r),s=this.sizeMax.resolve(r);if(!t){if(null==i.width||null==i.height)throw e.error.operationInvalid("Panel layout without width or height set.");t=e.copyOwn(i)}!r&&t&&(r=e.copyOwn(t)),null!=s.width&&t.width>s.width&&(t.width=s.width),null!=s.height&&t.height>s.height&&(t.height=s.height);var o=this.borderWidth/2,u=(e.get(n,"margins")||this.margins).resolve(r),a=(e.get(n,"paddings")||this.paddings).resolve(r),f=fn.inflate(u,o),l=fn.inflate(a,o),c=f.width+l.width,h=f.height+l.height,p=new hn(Math.max(t.width-c,0),Math.max(t.height-h,0)),d=e.copyOwn(i);null!=d.width&&(d.width=Math.max(d.width-c,0)),null!=d.height&&(d.height=Math.max(d.height-h,0));var v=this._layoutInfo||null,m=e.get(n,"canChange",!0),g=this._layoutInfo={canChange:m,referenceSize:r,realMargins:u,realPaddings:a,borderWidth:this.borderWidth,margins:f,paddings:l,desiredClientSize:d,clientSize:p,pageClientSize:v?v.pageClientSize:p.clone(),previous:v};v&&(delete v.previous,delete v.pageClientSize);var y,b=this._calcLayout(g);b?(g.clientSize=b,y={width:b.width+c,height:b.height+h}):(y=t,b=p),this.isVisible=b.width>0&&b.height>0,delete g.desiredClientSize,this.width=y.width,this.height=y.height,!m&&v&&delete g.previous,sn.debug>=5&&(this._log("Size       = "+sn.stringify(y)),this._log("Margins    = "+sn.stringify(g.margins)),this._log("Paddings   = "+sn.stringify(g.paddings)),this._log("ClientSize = "+sn.stringify(g.clientSize))),this._onLaidOut()}},_onLaidOut:function(){this.isRoot&&this.chart._onLaidOut()},_calcLayout:function(t){function n(e,t,n){for(var r=0;e--;){if(t.call(n,e,r)===!1)return!0;r++}return!1}function r(t,n){h&&p._group("LayoutCycle #"+(n+1)+" (remaining: "+t+")");try{var r=t>0;l=new fn(0),c=e.copyOwn(f);for(var s,o=0,u=b.length;u>o;){s=b[o],h&&p._group("SIDE Child #"+(o+1)+" at "+s.anchor);try{if(i.call(this,s,r))return!0}finally{h&&p._groupEnd()}o++}o=0,u=y.length;for(;u>o;){s=y[o],h&&p._group("FILL Child #"+(o+1));try{if(i.call(this,s,r))return!0}finally{h&&p._groupEnd()}o++}return!1}finally{h&&p._groupEnd()}}function i(e,t){var r,i=!1;return w.canChange=t,n(3,function(n,f){h&&p._group("Attempt #"+(f+1));try{w.paddings=r,w.canChange=n>0,e.layout(new hn(c),w);if(e.isVisible){i=o.call(this,e,t);if(i)return!1;var l=e._layoutInfo.requestPaddings;if(s(r,l)){r=l;if(n>0)return r=new fn(r),h&&this._log("Child requested paddings change: "+sn.stringify(r)),!0;sn.debug>=2&&this._warn("Child requests paddings change but iterations limit has been reached.")}u.call(this,e),"fill"!==e.anchor&&a.call(this,e)}return!1}finally{h&&p._groupEnd()}},this),i}function s(t,n){return n?e.query(fn.names).each(function(e){var r=t&&t[e]||0,i=n&&n[e]||0;return Math.abs(i-r)>=.1?!1:void 0}):!1}function o(e,t){var n=!1,r=e.width-c.width;r>0&&(sn.debug>=3&&this._log("Child added width = "+r),t?(n=!0,c.width+=r,f.width+=r):sn.debug>=2&&this._warn("Child wanted more width, but layout iterations limit has been reached."));var i=e.height-c.height;return i>0&&(sn.debug>=3&&this._log("Child added height ="+i),t?(n=!0,c.height+=i,f.height+=i):sn.debug>=2&&this._warn("Child wanted more height, but layout iterations limit has been reached.")),n}function u(n){var r,i=n.anchor,s=n.align,o=n.alignTo;"fill"===i?(i="left",r=l.left+c.width/2-n.width/2,s=o="middle"):r=l[i];var u,a;switch(s){case"top":case"bottom":case"left":case"right":u=s,a=0;break;case"center":case"middle":u=m[v[i]],a=-n[d[u]]/2}var f,h;switch(o){case"top":case"bottom":case"left":case"right":h=o,f=h!==u?c[d[u]]:0;break;case"center":case"middle":h=m[v[i]],f=c[d[u]]/2;break;case"page-center":case"page-middle":h=m[v[i]];var p=d[u],y=Math.min(c[p],t.pageClientSize[p]);f=y/2}var b=l[h]+f+a,w=n.offset.resolve(c);w&&(r+=w[g[i]]||0,b+=w[g[u]]||0),n.keepInBounds&&(0>r&&(r=0),0>b&&(b=0)),n.setPosition(e.set({},i,r,u,b))}function a(e){var t=e.anchor,n=d[t],r=e[n];l[t]+=r,c[n]-=r}var f,l,c,h,p=this;if(p._children){var d=sn.BasePanel.orthogonalLength,v=sn.BasePanel.relativeAnchor,m=sn.BasePanel.leftTopAnchor,g=pn.namesSidesToOffset,y=[],b=[];p._children.forEach(function(t){var n=t.anchor;n&&("fill"===n?y.push(t):(e.hasOwn(v,n)||e.fail.operationInvalid("Unknown anchor value '{0}'",[n]),b.push(t)))}),h=sn.debug>=5,f=e.copyOwn(t.clientSize);var w={force:!0,referenceSize:f};h&&p._group("CCC DOCK LAYOUT clientSize = "+sn.stringify(f));try{n(5,r,p)}finally{h&&p._groupEnd()}}return f},invalidateLayout:function(){this._layoutInfo=null,this._children&&this._children.forEach(function(e){e.invalidateLayout()})},_create:function(n){if(!this.pvPanel||n){var r;delete this._invalidDataError,this.pvPanel=null,this.pvRootPanel&&(this.pvRootPanel=null),delete this._signs;try{this.layout()}catch(i){if(!(i instanceof InvalidDataException))throw i;this._invalidDataError=r=i}if(this.isTopRoot&&this.chart._isMultiChartOverflowClip)return;if(!this.isVisible)return;this.isRoot&&this._creating();var s=this._layoutInfo.margins,o=this._layoutInfo.paddings;if(this.isTopRoot){this.pvRootPanel=this.pvPanel=(new t.Panel).canvas(this.chart.options.canvas);var u=new sn.visual.Scene(null,{panel:this});this.pvRootPanel.lock("data",[u]);if(s.width>0||s.height>0)this.pvPanel.width(this.width).height(this.height),this.pvPanel=this.pvPanel.add(t.Panel)}else this.pvPanel=this.parent.pvPanel.add(this.type);var a=this.pvPanel,f=this.width-s.width,l=this.height-s.height;a.width(f).height(l),sn.debug>=15&&(s.width>0||s.height>0)&&(this.isTopRoot?this.pvRootPanel:this.parent.pvPanel).add(this.type).width(this.width).height(this.height).left(null!=this.position.left?this.position.left:null).right(null!=this.position.right?this.position.right:null).top(null!=this.position.top?this.position.top:null).bottom(null!=this.position.bottom?this.position.bottom:null).strokeStyle("orange").lineWidth(1).strokeDasharray("- .");var c={};e.eachOwn(this.position,function(e,t){a[t](e+s[t]),c[this.anchorLength(t)]=!0},this),c.width||(s.left>0&&a.left(s.left),s.right>0&&a.right(s.right)),c.height||(s.top>0&&a.top(s.top),s.bottom>0&&a.bottom(s.bottom)),(o.width>0||o.height>0)&&(this.pvPanel=a.add(t.Panel).width(f-o.width).height(l-o.height).left(o.left).top(o.top)),a.borderPanel=a,a.paddingPanel=this.pvPanel,this.pvPanel.paddingPanel=this.pvPanel,this.pvPanel.borderPanel=a,sn.debug>=15&&(this.pvPanel.strokeStyle("lightgreen").lineWidth(1).strokeDasharray("- "),this.pvPanel!==a&&a.strokeStyle("blue").lineWidth(1).strokeDasharray(". "));var h=this._getExtensionId();new sn.visual.Panel(this,null,{panel:a,extensionId:h});if(!r)try{this._createCore(this._layoutInfo)}catch(i){if(!(i instanceof InvalidDataException))throw i;this._invalidDataError=r=i}if(r){var p=a.anchor("center").add(t.Label).text(r.message);this.chart.extend(p,"invalidDataMessage")}this.isTopRoot&&(this.chart._multiChartOverflowClipped&&this._addMultichartOverflowClipMarker(),this._initSelection()),this.applyExtensions();if(this.isRoot&&sn.debug>5){var d=["SCALES SUMMARY",sn.logSeparator];this.chart.axesList.forEach(function(e){var t=e.scale;if(t){var n=t.domain&&t.domain(),r=t.range&&t.range();d.push(e.id),d.push("    domain: "+(n?sn.stringify(n):"?")),d.push("    range : "+(r?sn.stringify(r):"?"))}},this),this._log(d.join("\n"))}}},_creating:function(){this._children&&this._children.forEach(function(e){e._creating()})},_createCore:function(){this._children&&this._children.forEach(function(e){e._create()})},render:function(t){if(!this.isTopRoot)return this.topRoot.render(t);this._create(e.get(t,"recreate",!1));if((!this.isTopRoot||!this.chart._isMultiChartOverflowClip)&&this.isVisible){var n=this.pvRootPanel;if(this._invalidDataError)n.render();else{this._onRender();var r=this._animating,i=this.chart.animatable();this._animating=i&&!e.get(t,"bypassAnimation",!1)?1:0;try{n.render();if(this._animating){this._animating=2;var s=this;n.transition().duration(2e3).ease("cubic-in-out").start(function(){r?r=0:(s._animating=0,s._onRenderEnd(!0))})}else this._onRenderEnd(!1)}finally{this._animating=0}}}},_onRender:function(){var e=this.chart.options.renderCallback;if(e)if(this.compatVersion()<=1)e.call(this.chart);else{var t=this.context();e.call(t,t.scene)}},_onRenderEnd:function(e){this._children&&this._children.forEach(function(t){t._onRenderEnd(e)})},renderInteractive:function(){if(this.isVisible){var e=this._getSelectableMarks();if(e&&e.length)e.forEach(function(e){e.render()});else if(!this._children){this.pvPanel.render();return}this._children&&this._children.forEach(function(e){e.renderInteractive()})}},_getSelectableMarks:function(){return this._rubberSelectableMarks},animate:function(e,t){return 1===this.topRoot._animating?e:t},animatingStart:function(){return 1===this.topRoot._animating},animating:function(){return this.topRoot._animating>0},setPosition:function(t){for(var n in t)if(e.hasOwn(fn.namesSet,n)){var r=t[n];null===r?delete this.position[n]:(r=+r,!isNaN(r)&&isFinite(r)&&(this.position[n]=r))}},createAnchoredSize:function(e,t){return this.isAnchorTopOrBottom()?new hn(t.width,Math.min(t.height,e)):new hn(Math.min(t.width,e),t.height)},applyExtensions:function(){this._signs&&this._signs.forEach(function(e){e.applyExtensions()})},extend:function(e,t,n){this.chart.extend(e,this._makeExtensionAbsId(t),n)},extendAbs:function(e,t,n){this.chart.extend(e,t,n)},_extendSceneType:function(t,n,r){var i=e.get(this._sceneTypeExtensions,t);i&&sn.extendType(n,i,r)},_absBaseExtId:{abs:"base"},_absSmallBaseExtId:{abs:"smallBase"},_getExtensionId:function(){return this.isRoot?this.chart.parent?this._absSmallBaseExtId:this._absBaseExtId:void 0},_getExtensionPrefix:function(){return this._extensionPrefix},_makeExtensionAbsId:function(e){return sn.makeExtensionAbsId(e,this._getExtensionPrefix())},_getExtension:function(e,t){return this.chart._getExtension(this._makeExtensionAbsId(e),t)},_getExtensionAbs:function(e,t){return this.chart._getExtension(e,t)},_getConstantExtension:function(e,t){return this.chart._getConstantExtension(this._makeExtensionAbsId(e),t)},getPvPanel:function(n){var r=this.pvPanel;if(!n)return r;if(!this.parent)throw e.error.operationInvalid("Layers are not possible in a root panel.");if(!r)throw e.error.operationInvalid("Cannot access layer panels without having created the main panel.");var i=null;this._layers?i=this._layers[n]:this._layers={};if(!i){var s=this.parent.pvPanel;i=s.borderPanel.add(this.type).extend(r.borderPanel);var o=i;r!==r.borderPanel&&(i=o.add(t.Panel).extend(r)),o.borderPanel=o,o.paddingPanel=i,i.paddingPanel=i,i.borderPanel=o,this.initLayerPanel(i,n),this._layers[n]=i}return i},initLayerPanel:function(){},_getV1DimName:function(e){var t=this._v1DimName||(this._v1DimNameCache={}),n=t[e];if(null==n){var r=this.chart.visualRoles[this._v1DimRoleName[e]];n=r?r.firstDimensionName():"",t[e]=n}return n},_getV1Datum:function(e){return e.datum},context:function(){var e=this._context;return!e||e.isPinned?e=this._context=new sn.visual.Context(this):Rt.call(e),e},_isTooltipEnabled:function(){return!this.selectingByRubberband()&&!this.animating()},_getTooltipFormatter:function(e){var t=this.compatVersion()<=1,n=e.format;if(!n){if(!t)return this._summaryTooltipFormatter;n=this.chart.options.v1StyleTooltipFormat;if(!n)return}return t?function(e){return n.call(e.panel,e.getV1Series(),e.getV1Category(),e.getV1Value()||"",e.getV1Datum())}:function(e){return n.call(e,e.scene)}},_summaryTooltipFormatter:function(t){function n(t,n){l.push("<b>"+t+"</b>: "+(e.html.escape(n)||" - ")+"<br/>")}function r(e,t){var n;return n=s?s.dimensions(t).valuePercent(f):a.dimensions(t).percent(e.value,f),p(n)}var i=t.scene;if(!i.datum)return"";var s=i.group,o=s&&s.count()>1,u=i.datum;if(!o&&(!u||u.isNull))return"";var a=i.data(),f={visible:!0},l=[];u.isInterpolated?l.push("<i>Interpolation</i>: "+e.html.escape(u.interpolation)+"<br/>"):u.isTrend&&l.push("<i>"+e.html.escape(u.trend.label)+"</i><br/>");var c=a.type,h=t.panel.stacked===!1?null:c.getPlayingPercentVisualRoleDimensionMap(),p=h?t.chart.options.percentValueFormat:null,d=o?s.atoms:i.datum.atoms,v=c.sortDimensionNames(e.keys(d)),m=!1;return v.forEach(function(t){var i=d[t],s=i.dimension.type;if(!(s.isHidden||o&&null==i.value)){m=!0;var u=i.label;h&&h.has(t)&&(u+=" ("+r(i,t)+")"),n(e.html.escape(i.dimension.type.label),u)}}),o&&(m&&l.push("<hr />"),l.push("<b>#</b>: "+s._datums.length+"<br/>"),c.sortDimensionNames(s.freeDimensionsNames()).forEach(function(t){var i=s.dimensions(t);if(!i.type.isHidden){var o,u=e.html.escape(i.type.label);i.type.valueType===Number?(o=i.format(i.value(f)),h&&h.has(t)&&(o+=" ("+r(null,t)+")"),u="&sum; "+u):o=i.atoms(f).map(function(e){return e.label||"- "}).join(", "),n(u,o)}})),'<div style="text-align: left;">'+l.join("\n")+"</div>"},_onClick:function(e){var t=this.clickAction;t&&(this.compatVersion()<=1?this._onV1Click(e,t):t.call(e,e.scene))},_onDoubleClick:function(e){var t=this.doubleClickAction;t&&(this.compatVersion()<=1?this._onV1DoubleClick(e,t):t.call(e,e.scene))},_onV1Click:function(e,t){t.call(e.pvMark,e.getV1Series(),e.getV1Category(),e.getV1Value(),e.event,e.getV1Datum())},_onV1DoubleClick:function(e,t){t.call(e.pvMark,e.getV1Series(),e.getV1Category(),e.getV1Value(),e.event,e.getV1Datum())},_addMultichartOverflowClipMarker:function(){function t(e){var t=e.shapeRadius();if(null==t){var n=e.shapeSize();null!=n&&(t=Math.sqrt(n))}return t||r}var n=10,r=5,i=(new sn.visual.Dot(this,this.pvPanel,{noSelect:!0,noHover:!0,noClick:!0,noDoubleClick:!0,noTooltip:!1,freePosition:!0,extensionId:"multiChartOverflowMarker"})).lock("data").pvMark.shape("triangle").shapeRadius(r).top(null).left(null).bottom(function(){return t(this)+n}).right(function(){return t(this)+n}).shapeAngle(0).lineWidth(1.5).strokeStyle("red").fillStyle("rgba(255, 0, 0, 0.2)");e.fun.is(i.tooltip)&&i.tooltip("Some charts did not fit the available space.")},selectingByRubberband:function(){return this.topRoot._selectingByRubberband},_initSelection:function(){var n=this,r=n.chart;if(n.interactive()){var i=n.unselectable(),s=n.selectableByRubberband();if(s||i){var o=n.data,u=n.pvRootPanel||n.pvPanel.paddingPanel;n._getExtensionAbs("base","fillStyle")||u.fillStyle(sn.invisibleFill),u.lock("events","all");if(s){var a=4;n._selectingByRubberband=!1;var f,l,c,h=this.selectBar=(new sn.visual.Bar(n,u,{extensionId:"rubberBand",normalStroke:!0,noHover:!0,noSelect:!0,noClick:!0,noDoubleClick:!0,noTooltip:!0})).override("defaultStrokeWidth",e.fun.constant(1.5)).override("defaultColor",function(e,t){return"stroke"===t?"#86fe00":"rgba(203, 239, 163, 0.6)"}).override("interactiveColor",function(e,t){return t}).pvMark.lock("visible",function(){return!!l}).lock("left",function(){return l.x}).lock("right").lock("top",function(){return l.y}).lock("bottom").lock("width",function(){return l.dx}).lock("height",function(){return l.dy}).lock("cursor").lock("events","none");u.intercept("data",function(){var e=this.delegate();return e&&e.forEach(function(e){null==e.x&&(e.x=e.y=e.dx=e.dy=0)}),e}).event("mousedown",t.Behavior.select().autoRender(!1)).event("select",function(e){if(l)l=new t.Shape.Rect(e.x,e.y,e.dx,e.dy);else{if(n.animating())return;if(e.dx*e.dx+e.dy*e.dy<=a)return;l=new t.Shape.Rect(e.x,e.y,e.dx,e.dy),n._selectingByRubberband=!0,f||(f=u.toScreenTransform()),n.rubberBand=l.apply(f)}h.render()}).event("selectend",function(){if(l){var e=arguments[arguments.length-1];f||(f=u.toScreenTransform());var t=l.apply(f);l=null,n._selectingByRubberband=!1,h.render();try{n._processRubberBand(t,e)}finally{c=new Date}}}),i&&u.event("click",function(){if(c){var e=new Date-c;if(300>e){c=null;return}}o.clearSelected()&&r.updateSelections()})}else i&&u.event("click",function(){o.clearSelected()&&r.updateSelections()})}}},_processRubberBand:function(e,t,n){this.rubberBand=e;try{this._onRubberBandSelectionEnd(t,n)}finally{this.rubberBand=null}},_onRubberBandSelectionEnd:function(e,t){sn.debug>=20&&this._log("rubberBand "+sn.stringify(this.rubberBand)),t=Object.create(t||{}),t.toggle=!1;var n=this._getDatumsOnRubberBand(e,t);if(n){var r=this.chart;r._updatingSelections(function(){var i=!e.ctrlKey&&r.options.ctrlSelectMode;i?(r.data.owner.clearSelected(),sn.data.Data.setSelected(n,!0)):t.toggle?sn.data.Data.toggleSelected(n):sn.data.Data.setSelected(n,!0)})}},_getDatumsOnRubberBand:function(t,n){var r=new e.Map;this._getDatumsOnRect(r,this.rubberBand,n);var i=r.values();return i.length&&(i=this.chart._onUserSelection(i),i&&!i.length&&(i=null)),i},_getDatumsOnRect:function(e,t,n){this._getOwnDatumsOnRect(e,t,n);var r=this._children;r&&r.forEach(function(r){r._getDatumsOnRect(e,t,n)})},_getOwnDatumsOnRect:function(t,n,r){var i=this;if(!i.isVisible)return!1;var s=i._getSelectableMarks();if(!s||!s.length)return!1;var o=t.count,u=e.get(r,"markSelectionMode"),a=function(e){e.isNull||t.set(e.id,e)},f=function(e){e.selectableByRubberband()&&e.datums().each(a)},l=function(e){e.eachSceneWithDataOnRect(n,f,null,u)};return s.forEach(l),o<t.count},isAnchorTopOrBottom:function(e){return e||(e=this.anchor),"top"===e||"bottom"===e},isOrientationVertical:function(e){return this.chart.isOrientationVertical(e)},isOrientationHorizontal:function(e){return this.chart.isOrientationHorizontal(e)}}).addStatic({relativeAnchor:{top:"left",bottom:"left",left:"bottom",right:"bottom"},leftBottomAnchor:{top:"bottom",bottom:"bottom",left:"left",right:"left"},leftTopAnchor:{top:"top",bottom:"top",left:"left",right:"left"},horizontalAlign:{top:"right",bottom:"left",middle:"center",right:"right",left:"left",center:"center"},verticalAlign:{top:"top",bottom:"bottom",middle:"middle",right:"bottom",left:"top",center:"middle"},verticalAlign2:{top:"top",bottom:"bottom",middle:"middle",right:"top",left:"bottom",center:"middle"},relativeAnchorMirror:{top:"right",bottom:"right",left:"top",right:"top"},oppositeAnchor:{top:"bottom",bottom:"top",left:"right",right:"left"},parallelLength:{top:"width",bottom:"width",right:"height",left:"height"},orthogonalLength:{top:"height",bottom:"height",right:"width",left:"width"},oppositeLength:{width:"height",height:"width"}}),e.scope(function(){var t=sn.BasePanel,n={},r={anchorOrtho:"relativeAnchor",anchorOrthoMirror:"relativeAnchorMirror",anchorOpposite:"oppositeAnchor",anchorLength:"parallelLength",anchorOrthoLength:"orthogonalLength"};e.eachOwn(r,function(e,r){var i=t[e];n[r]=function(e){return i[e||this.anchor]}}),t.add(n)}),e.type("pvc.PlotPanel",sn.BasePanel).init(function(e,t,n,r){this.base(e,t,r),this.plot=n,this._extensionPrefix=n.extensionPrefixes,this.dataPartValue=n.option("DataPart"),this.axes.color=e._getAxis("color",(n.option("ColorAxis")||0)-1),this.orientation=n.option("Orientation"),this.valuesVisible=n.option("ValuesVisible"),this.valuesAnchor=n.option("ValuesAnchor"),this.valuesMask=n.option("ValuesMask"),this.valuesFont=n.option("ValuesFont"),this.valuesOverflow=n.option("ValuesOverflow"),this.valuesOptimizeLegibility=n.option("ValuesOptimizeLegibility");var i=this.visualRoles=Object.create(e.visualRoles),s=n.option("ColorRole");i.color=s?e.visualRole(s):null,this.chart._addPlotPanel(this)}).add({anchor:"fill",visualRoles:null,_getExtensionId:function(){var e=["chart","plot"];return this.plotName&&e.push(this.plotName),e},defaultLegendGroupScene:function(){var t=this.axes.color;return t&&t.option("LegendVisible")&&t.isBound()?e.query(t.dataCells).where(function(e){return e.plot===this.plot},this).select(function(e){return e.legendGroupScene()}).first(e.notNully):void 0},isOrientationVertical:function(){return this.orientation===sn.orientation.vertical},isOrientationHorizontal:function(){return this.orientation===sn.orientation.horizontal}}),e.type("pvc.MultiChartPanel",sn.BasePanel).add({anchor:"fill",createSmallCharts:function(){var t,n=this.chart,r=n._multiInfo;if(r&&(t=r.count)){var i,s,o,u=this._getCoordinatedRootAxesByScopeType();u&&(i={},s=function(t,n,r){var s=e.array.lazy(i,n);e.array.lazy(s,r).push(t)},o=function(e){u.row&&s(e,"row",e.smallRowIndex),u.column&&s(e,"column",e.smallColIndex),u.global&&s(e,"global",0)});for(var a=this._buildSmallChartsBaseOptions(),f=n.constructor,l=r.smallDatas,c=r.colCount,h=0;t>h;h++){var p=l[h],d=h%c,v=Math.floor(h/c),m=e.set(Object.create(a),"smallColIndex",d,"smallRowIndex",v,"title",p.absLabel,"data",p),g=new f(m);u?(g._createPhase1(),o(g)):g._create()}if(u){var y=this;e.eachOwn(u,function(e,t){e.forEach(function(e){i[t].forEach(function(t){y._coordinateScopeAxes(e.id,t)})})}),n.children.forEach(function(e){e._createPhase2()})}r.coordScopesByType=i}},_getCoordinatedRootAxesByScopeType:function(){var t=!1,n=e.query(this.chart.axesList).multipleIndex(function(e){if("discrete"!==e.scaleType&&e.option.isDefined("DomainScope")){var n=e.option("DomainScope");if("cell"!==n)return t=!0,n}});return t?n:null},_coordinateScopeAxes:function(t,n){var r=e.query(n).select(function(e){var n=e.axes[t].scale;if(!n.isNull){var r=n.domain();return{min:r[0],max:r[1]}}}).reduce(sn.unionExtents,null);r&&n.forEach(function(e){var n=e.axes[t],i=n.scale;i.isNull||(i.domain(r.min,r.max),n.setScale(i))})},_buildSmallChartsBaseOptions:function(){var t=this.chart,n=t.options;return e.set(Object.create(n),"parent",t,"legend",!1,"titleFont",n.smallTitleFont,"titlePosition",n.smallTitlePosition,"titleAlign",n.smallTitleAlign,"titleAlignTo",n.smallTitleAlignTo,"titleOffset",n.smallTitleOffset,"titleKeepInBounds",n.smallTitleKeepInBounds,"titleMargins",n.smallTitleMargins,"titlePaddings",n.smallTitlePaddings,"titleSize",n.smallTitleSize,"titleSizeMax",n.smallTitleSizeMax)},_calcLayout:function(t){var n=this.chart,r=n._multiInfo;if(r){var i=n.multiOptions.option,s=n.smallOptions.option,o=t.clientSize,u=t.previous,a=u?u.initialClientWidth:o.width,f=u?u.initialClientHeight:o.height,l=s("Width");null!=l&&(l=ln.resolve(l,a));var c=s("Height");null!=c&&(c=ln.resolve(c,f));var h=s("AspectRatio"),p=r.rowCount,d=r.colCount;null==l&&(isFinite(r.colsMax)?l=o.width/d:(null==c&&(c=f),l=h*c)),null==c&&(c=1===p&&i("SingleRowFillsHeight")||1===d&&i("SingleColFillsHeight")?f:l/h);var v=l*d,m=c*p;if(!n._isMultiChartOverflowClipRetry){n._isMultiChartOverflowClip=!1;switch(i("Overflow")){case"fit":v>a&&(v=a,l=v/d),m>f&&(m=f,c=m/p);break;case"clip":var g=d,y=p,b=v>a;b&&(g=Math.floor(a/l));var w=m>f;w&&(y=Math.floor(f/c));if(w||b)n._isMultiChartOverflowClip=!0,n._clippedMultiChartRowsMax=y,n._clippedMultiChartColsMax=g}}return e.set(t,"initialClientWidth",a,"initialClientHeight",f,"width",l,"height",c),{width:v,height:Math.max(o.height,m)}}},_getExtensionId:function(){return"content"},_createCore:function(t){var n=this.chart;!n._isMultiChartOverflowClip||e.assert("Overflow&clip condition should be resolved.");var r=n._multiInfo;if(r){var i=n.smallOptions.option,s=i("Margins"),o=i("Paddings");n.children.forEach(function(e){e._setSmallLayout({left:e.smallColIndex*t.width,top:e.smallRowIndex*t.height,width:t.width,height:t.height,margins:this._buildSmallMargins(e,s,r),paddings:o})},this);var u=r.coordScopesByType;u&&n._coordinateSmallChartsLayout(u),this.base(t)}},_buildSmallMargins:function(e,t,n){var r=n.colCount-1,i=n.rowCount-1,s=e.smallColIndex,o=e.smallRowIndex,u={};return s>0&&(u.left=t.left),r>s&&(u.right=t.right),o>0&&(u.top=t.top),i>o&&(u.bottom=t.bottom),u}}),e.type("pvc.TitlePanelAbstract",sn.BasePanel).init(function(e,t,n){n||(n={});var r=n.anchor||this.anchor;if(null==n.size){var i=n.titleSize;null!=i&&(n.size=(new hn).setSize(i,{singleProp:this.anchorOrthoLength(r)}))}if(null==n.sizeMax){var s=n.titleSizeMax;null!=s&&(n.sizeMax=(new hn).setSize(s,{singleProp:this.anchorOrthoLength(r)}))}null==n.paddings&&(n.paddings=this.defaultPaddings),this.base(e,t,n);if(void 0===n.font){var o=this._getExtension("label","font");"string"==typeof o&&(this.font=o)}}).add({pvLabel:null,anchor:"top",title:null,titleSize:void 0,font:"12px sans-serif",defaultPaddings:2,_extensionPrefix:"title",_calcLayout:function(e){var n=new hn,r=this.anchor,i=this.anchorLength(r),s=this.anchorOrthoLength(r),o=t.Text.measureWidth(this.title,this.font)+2,u=e.clientSize[i],a=e.desiredClientSize[i];null==a?a=o>u?u:o:a>u&&(a=u);var f;f=o>a?sn.text.justify(this.title,a,this.font):this.title?[this.title]:[];var l=t.Text.fontHeight(this.font),c=f.length*l,h=e.clientSize[s],p=e.desiredClientSize[s];null==p?p=c:p>h&&(p=h);if(c>p){var d=Math.max(1,Math.floor(p/l));if(f.length>d){var v=f[d];f.length=d,c=p=d*l;var m=f[d-1]+" "+v;f[d-1]=sn.text.trimToWidthB(a,m,this.font,"..")}}return e.lines=f,e.topOffset=(p-c)/2,e.lineSize={width:a,height:l},e.a_width=i,e.a_height=s,n[i]=a,n[s]=p,n},_createCore:function(e){var t,n=this._buildScene(e),r={top:0,right:Math.PI/2,bottom:0,left:-Math.PI/2},i=sn.BasePanel.horizontalAlign[this.align],s=sn.BasePanel.leftTopAnchor[this.anchor];this.compatVersion()<=1&&(t=function(e){return function(){return e.call(this)}}),this.pvLabel=(new sn.visual.Label(this,this.pvPanel,{extensionId:"label",wrapper:t})).lock("data",n.lineScenes).pvMark[s](function(t){return e.topOffset+t.vars.size.height/2+this.index*t.vars.size.height}).textAlign(i)[this.anchorOrtho(s)](function(e){switch(this.textAlign()){case"center":return e.vars.size.width/2;case"left":return 0;case"right":return e.vars.size.width}}).text(function(e){return e.vars.textLines[this.index]}).font(this.font).textBaseline("middle").textAngle(r[this.anchor])},_buildScene:function(t){var n=new sn.visual.Scene(null,{panel:this,source:this.chart.data}),r=t.lines;return n.vars.size=t.lineSize,n.vars.textLines=r,n.lineScenes=e.array.create(r.length,n),n},_getExtensionId:e.fun.constant("")}),e.type("pvc.TitlePanel",sn.TitlePanelAbstract).init(function(e,t,n){n||(n={});var r=e.compatVersion()<=1;if(r){var i=n.titleSize;null==i&&(n.titleSize=25)}this._extensionPrefix=e.parent?"smallTitle":"title",this.base(e,t,n)}).add({font:"14px sans-serif",defaultPaddings:4}),e.type("pvc.LegendPanel",sn.BasePanel).init(function(e,t,n){this.base(e,t,n);if(void 0===n.font){var r=this._getConstantExtension("label","font");r&&(this.font=r)}var i=sn.visual.Interactive;this._ibits&i.Interactive&&(this._ibits|=i.Clickable)}).add({pvRule:null,pvDot:null,pvLabel:null,anchor:"bottom",pvLegendPanel:null,textMargin:6,itemPadding:2.5,itemSize:null,markerSize:15,font:"10px sans-serif",_calcLayout:function(e){return this._getBulletRootScene().layout(e)},_createCore:function(e){var n=e.clientSize,r=this._getBulletRootScene(),i=r.vars.itemPadding,s=r.vars.contentSize,o=this.isAnchorTopOrBottom(),u=o?"top":"left",a=this.anchorOpposite(u),f=this.anchorLength(u),l=this.anchorOrthoLength(u),c=o?"center":"middle",h=o?"left":"top",p=this.anchorOpposite(h),d=0;switch(this.align){case p:d=n[f]-s[f];break;case c:d=(n[f]-s[f])/2}this.pvPanel.borderPanel.overflow("hidden");var v,m=this.pvPanel.add(t.Panel).data(r.vars.sections)[h](d)[u](function(){var e=this.sibling();return e?e[u]+e[l]+i[l]:0})[f](function(e){return e.size[f]})[l](function(e){return e.size[l]});this.compatVersion()<=1&&(v=function(e){return function(t){return e.call(this,t.vars.value.rawValue)}});var g=this.pvLegendPanel=(new sn.visual.Panel(this,m,{extensionId:"panel",wrapper:v,noSelect:!1,noHover:!0,noClick:!1,noClickSelect:!0})).pvMark.lock("data",function(e){return e.items})[p](null)[a](null)[h](function(e){var t=e.vars.itemPadding,n=this.sibling();return n?n[h]+n[f]+t[f]:0})[u](o?function(e){var t=e.vars;return t.section.size.height/2-t.itemClientSize.height/2}:0).height(function(e){return e.vars.itemClientSize.height}).width(o?function(e){return e.vars.itemClientSize.width}:function(){return this.parent.width()}).def("hidden","false").fillStyle(function(){return"true"==this.hidden()?"rgba(200,200,200,1)":"rgba(200,200,200,0.0001)"}),y=(new sn.visual.Panel(this,g,{extensionId:"markerPanel"})).pvMark.left(0).top(0).right(null).bottom(null).width(function(e){return e.vars.markerSize}).height(function(e){return e.vars.itemClientSize.height});sn.debug>=20&&(m.strokeStyle("red").lineWidth(.5).strokeDasharray("."),g.strokeStyle("green").lineWidth(.5).strokeDasharray("."),y.strokeStyle("blue").lineWidth(.5).strokeDasharray(".")),r.childNodes.forEach(function(e){var t=(new sn.visual.Panel(this,y)).pvMark.visible(function(t){return t.parent===e});e.renderer().create(this,t,e.extensionPrefix,v)},this),this.pvLabel=(new sn.visual.Label(this,y.anchor("right"),{extensionId:"label",noTooltip:!1,noClick:!1,wrapper:v})).intercept("textStyle",function(e){this._finished=!1;var t=this.delegateExtension()||"black";return this._finished||e.isOn()?t:sn.toGrayScale(t,null,void 0,150)}).pvMark.textAlign("left").text(function(e){var t=e.labelText(),n=e.vars;return n.textSize.width>n.labelWidthMax&&(t=sn.text.trimToWidthB(n.labelWidthMax,t,n.font,"..",!1)),t}).textMargin(function(e){return e.vars.textMargin}).font(function(e){return e.vars.font}).textDecoration(function(e){return e.isOn()?"":"line-through"}),sn.debug>=16&&y.anchor("right").add(t.Panel)[this.anchorLength()](0)[this.anchorOrthoLength()](0).fillStyle(null).strokeStyle(null).lineWidth(0).add(t.Line).data(function(e){var t=e.vars,n=sn.text.getLabelBBox(Math.min(t.labelWidthMax,t.textSize.width),2*t.textSize.height/3,"left","middle",0,t.textMargin),r=n.source.points();return r.length>1&&(r=r.concat(r[0])),r}).left(function(e){return e.x}).top(function(e){return e.y}).strokeStyle("red").lineWidth(.5).strokeDasharray("-")},_onClick:function(t){var n=t.scene;e.fun.is(n.execute)&&n.executable()&&n.execute()},_getExtensionPrefix:function(){return"legend"},_getExtensionId:function(){return"area"},_getSelectableMarks:function(){return[this.pvLegendPanel]},_getBulletRootScene:function(){var e=this._rootScene;return e||(e=new sn.visual.legend.BulletRootScene(null,{panel:this,source:this.chart.data,horizontal:this.isAnchorTopOrBottom(),font:this.font,markerSize:this.markerSize,textMargin:this.textMargin,itemPadding:this.itemPadding,itemSize:this.itemSize}),this._rootScene=e),e},_getTooltipFormatter:function(e){return e.isLazy=!1,function(e){var t=e.scene.vars.value,n=t.absLabel||t.label,r=e.pvMark.text();return n!==r?n:""}}}),e.type("pvc.CartesianAbstract",sn.BaseChart).init(function(e){this.axesPanels={},this.base(e)}).add({_gridDockPanel:null,axesPanels:null,yAxisPanel:null,xAxisPanel:null,secondXAxisPanel:null,secondYAxisPanel:null,yScale:null,xScale:null,_getSeriesRoleSpec:function(){return{isRequired:!0,defaultDimension:"series*",autoCreateDimension:!0,requireIsDiscrete:!0}},_getColorRoleSpec:function(){return{isRequired:!0,defaultDimension:"color*",defaultSourceRole:"series",requireIsDiscrete:!0}},_addAxis:function(e){this.base(e);switch(e.type){case"base":case"ortho":this.axes[e.orientedId]=e,e.v1SecondOrientedId&&(this.axes[e.v1SecondOrientedId]=e)}return this},_setAxisScale:function(e,t){this.base(e,t);var n="ortho"===e.type,r=n||"base"===e.type;r&&(n&&1===e.index?this.secondScale=e.scale:e.index||(this[e.orientation+"Scale"]=e.scale))},_createContent:function(t){this._createFocusWindow(),this._gridDockPanel=new sn.CartesianGridDockingPanel(this,this.basePanel,{margins:t.margins,paddings:t.paddings}),["base","ortho"].forEach(function(t){var n=this.axesByType[t];n&&e.query(n).reverse().each(function(e){this._createAxisPanel(e)},this)},this),this._createPlotPanels(this._gridDockPanel,{clickAction:t.clickAction,doubleClickAction:t.doubleClickAction})},_createFocusWindow:function(){if(this.selectableByFocusWindow()){var e,t=this.focusWindow;t&&(e=t._exportData()),t=this.focusWindow=new sn.visual.CartesianFocusWindow(this),e&&t._importData(e),t._initFromOptions()}else this.focusWindow&&delete this.focusWindow},_createAxisPanel:function(t){if(t.option("Visible")){var n,r=t.option("Title");e.empty(r)||(n=new sn.AxisTitlePanel(this,this._gridDockPanel,t,{title:r,font:t.option("TitleFont")||t.option("Font"),anchor:t.option("Position"),align:t.option("TitleAlign"),margins:t.option("TitleMargins"),paddings:t.option("TitlePaddings"),titleSize:t.option("TitleSize"),titleSizeMax:t.option("TitleSizeMax")}));var i=new sn.AxisPanel(this,this._gridDockPanel,t,{anchor:t.option("Position"),size:t.option("Size"),sizeMax:t.option("SizeMax"),clickAction:t.option("ClickAction"),doubleClickAction:t.option("DoubleClickAction"),useCompositeAxis:t.option("Composite"),font:t.option("Font"),labelSpacingMin:t.option("LabelSpacingMin"),grid:t.option("Grid"),gridCrossesMargin:t.option("GridCrossesMargin"),ruleCrossesMargin:t.option("RuleCrossesMargin"),zeroLine:t.option("ZeroLine"),desiredTickCount:t.option("DesiredTickCount"),showTicks:t.option("Ticks"),showMinorTicks:t.option("MinorTicks")});return n&&(i.titlePanel=n),this.axesPanels[t.id]=i,this.axesPanels[t.orientedId]=i,t.index<=1&&t.v1SecondOrientedId&&(this[t.v1SecondOrientedId+"AxisPanel"]=i),i}},_onLaidOut:function(){this.plotPanelList&&this.plotPanelList[0]&&["base","ortho"].forEach(function(e){var t=this.axesByType[e];t&&t.forEach(this._setCartAxisScaleRange,this)},this)},_setCartAxisScaleRange:function(e){var t=this.plotPanelList[0]._layoutInfo,n=t.clientSize,r="x"===e.orientation?n.width:n.height;return e.setScaleRange(r),e.scale},_getAxesRoundingPaddings:function(){function e(e,t,r){var i=n[e];null==i||t>i?(n[e]=t,n[e+"Locked"]=r):r&&(n[e+"Locked"]=r)}function t(t){if(t){var n=t.getScaleRoundingPaddings();if(n){var r="x"===t.orientation;e(r?"left":"bottom",n.begin,n.beginLocked),e(r?"right":"top",n.end,n.endLocked)}}}var n={},r=this.axesByType;return["base","ortho"].forEach(function(e){var n=r[e];n&&n.forEach(t)}),n},markEventDefaults:{strokeStyle:"#5BCBF5",lineWidth:"0.5",textStyle:"#5BCBF5",verticalOffset:10,verticalAnchor:"bottom",horizontalAnchor:"right",forceHorizontalAnchor:!1,horizontalAnchorSwapLimit:80,font:"10px sans-serif"},markEvent:function(r,i,s){var o=this,u=o.axes.base,a=o.axes.ortho,f=u.role,l=u.scale,c=o.data.owner.dimensions(f.grouping.firstDimensionName());if(u.isDiscrete())return o._warn("Can only mark events in charts with a continuous base scale."),o;var h=n.extend({},o.markEventDefaults,s),p=c.read(r,i),d=l(p.value),v=l.range(),m=v[1];if(d<v[0]||d>m)return this._warn("Cannot mark event because it is outside the base scale's domain."),this;var g=this.plotPanelList[0].pvPanel,y=a.scale.range()[1],b=h.horizontalAnchor;if(!h.forceHorizontalAnchor){var w="right"===b,E=w?m-d:d,S=t.Text.measureWidth(p.label,h.font);S>E&&(b=w?"left":"right")}var x="top"===h.verticalAnchor?h.verticalOffset:y-h.verticalOffset,T=g.add(t.Line).data([0,y]).bottom(e.identity).left(d).lineWidth(h.lineWidth).strokeStyle(h.strokeStyle);return T.anchor(b).visible(function(){return!this.index}).top(x).add(t.Label).font(h.font).text(p.label).textStyle(h.textStyle),o},defaults:{panelSizeRatio:.9,timeSeries:!1,timeSeriesFormat:"%Y-%m-%d"}}),e.type("pvc.GridDockingPanel",sn.BasePanel).add({anchor:"fill",_calcLayout:function(t){function n(e,r){m&&v._group("LayoutCycle "+(M?"- Disaster MODE":"#"+(r+1)));try{var i,s,a,f,l=t.canChange!==!1&&!M&&e>0,c=!1;i=0,s=N.length;for(;s>i;){m&&v._group("SIDE Child #"+(i+1));try{a=u(N[i],l);if(!M&&a){f=!1,0!==(a&A)&&(m&&v._log("SIDE Child #"+(i+1)+" changed overflow paddings"),c||(c=!0,t.requestPaddings=t.paddings)),0!==(a&L)&&(e>0?(m&&v._log("SIDE Child #"+(i+1)+" changed normal paddings"),f=!0):sn.debug>=2&&v._warn("SIDE Child #"+(i+1)+" changed paddings but no more iterations possible."));if(0!==(a&k))return M=!0,n(0),!1;if(f)return!0}}finally{m&&v._groupEnd()}i++}if(c)return m&&v._log("Restarting due to overflowPaddings change"),!1;i=0,s=T.length;for(;s>i;){m&&v._group("FILL Child #"+(i+1));try{a=o(T[i],l);if(!M&&a){f=!1,0!==(a&L)&&(e>0?(sn.debug>=5&&v._log("FILL Child #"+(i+1)+" increased paddings"),f=!0):sn.debug>=2&&v._warn("FILL Child #"+(i+1)+" increased paddings but no more iterations possible."));if(0!==(a&k))return M=!0,n(0),!1;if(f)return!0}}finally{m&&v._groupEnd()}i++}return!1}finally{m&&v._groupEnd()}}function r(e,t){for(var n=0;e--;){if(t(e,n)===!1)return!0;n++}return!1}function i(t){var n=t.anchor;if(n)if("fill"===n){T.push(t);var r=t.paddings.resolve(x.referenceSize);y=fn.resolvedMax(y,r)}else e.hasOwn(E,n)||e.fail.operationInvalid("Unknown anchor value '{0}'",[n]),N.push(t)}function s(e,t){m&&v._group("SIDE Child #"+(t+1));try{var n=0,r=e.anchor;return x.paddings=c(r,y),e.layout(new hn(b),x),e.isVisible&&(n|=h(r,y,e),a(r,e),f(r,e)),n}finally{m&&v._groupEnd()}}function o(e,t){var n=0,r=e.anchor;return x.paddings=c(r,y),x.canChange=t,e.layout(new hn(b),x),e.isVisible&&(n|=h(r,y,e,t),a(r,e),l(e,r)),n}function u(n,r){var i=0;if(n.isVisible){var s=n.anchor,o=S[s],u=w[s],a=b[o],f=n[u],d=new hn(e.set({},o,a,u,f));x.paddings=c(s,y),x.canChange=r,n.layout(d,x),n.isVisible&&(i=h(s,y,n,r)|p(s,t.paddings,n,r),i||l(n,n.align))}return i}function a(t,n){var r;"fill"===t?(t="left",r=g.left+b.width/2-n.width/2):r=g[t],n.setPosition(e.set({},t,r))}function f(e,t){var n=w[e],r=t[n];g[e]+=r,b[n]-=r}function l(t,n){var r;"fill"===n&&(n="middle");var i;switch(n){case"top":case"bottom":case"left":case"right":r=n,i=g[r];break;case"middle":r="bottom",i=g.bottom+b.height/2-t.height/2;break;case"center":r="left",i=g.left+b.width/2-t.width/2}t.setPosition(e.set({},r,i))}function c(e,t){var n=new fn;return d(e).forEach(function(e){n.set(e,t[e])}),n}function h(t,n,r,i){var s=r._layoutInfo.requestPaddings,o=0;if(s){m&&sn.debug>=10&&(v._log("=> clientSize="+sn.stringify(r._layoutInfo.clientSize)),v._log("<= requestPaddings="+sn.stringify(s))),d(t).forEach(function(e){var t=n[e]||0,r=Math.floor(1e4*(s[e]||0))/1e4,u=r-t,a=Math.max(1,Math.abs(.01*t));0!==u&&Math.abs(u)>=a&&(i?(o|=L,n[e]=r,m&&v._log("Changed padding "+e+" <- "+r)):sn.debug>=2&&v._warn("CANNOT change but child wanted to: "+e+"="+r))});if(o){var u=fn.names.map(function(e){return(n[e]||0).toFixed(0)}).join("|");e.hasOwn(C,u)?(sn.debug>=2&&v._warn("LOOP detected!!!!"),o|=k):C[u]=!0,n.width=n.left+n.right,n.height=n.top+n.bottom}}return o}function p(e,t,n,r){var i=n._layoutInfo.overflowPaddings||O,s=0;return m&&sn.debug>=10&&v._log("<= overflowPaddings="+sn.stringify(i)),d(e).forEach(function(e){if(i.hasOwnProperty(e)){var n=t[e]||0,o=Math.floor(1e4*(i[e]||0))/1e4;o-=g[e];var u=o-n,a=Math.max(1,Math.abs(.05*n));u>=a&&(r?(s|=A,t[e]=o,m&&v._log("changed overflow padding "+e+" <- "+o)):sn.debug>=2&&v._warn("CANNOT change overflow padding but child wanted to: "+e+"="+o))}}),s&&(t.width=t.left+t.right,t.height=t.top+t.bottom),s}function d(e){switch(e){case"left":case"right":return fn.vnames;case"top":case"bottom":return fn.hnames;case"fill":return fn.names}}var v=this;if(v._children){var m=sn.debug>=5,g=new fn(0),y=new fn(0),b=e.copyOwn(t.clientSize),w=sn.BasePanel.orthogonalLength,E=sn.BasePanel.relativeAnchor,S=sn.BasePanel.parallelLength,x={force:!0,referenceSize:t.clientSize},T=[],N=[],C={},k=1,L=2,A=4,O=new fn,M=!1;m&&v._group("CCC GRID LAYOUT clientSize = "+sn.stringify(b));try{this._children.forEach(i),m&&v._group("Phase 1 - Determine MARGINS and FILL SIZE from SIDE panels");try{N.forEach(s)}finally{m&&(v._groupEnd(),v._log("Final FILL margins = "+sn.stringify(g)),v._log("Final FILL border size = "+sn.stringify(b)))}m&&v._group("Phase 2 - Determine COMMON PADDINGS");try{r(9,n)}finally{m&&(v._groupEnd(),v._log("Final FILL clientSize = "+sn.stringify({width:b.width-y.width,height:b.height-y.height})),v._log("Final COMMON paddings = "+sn.stringify(y)))}t.gridMargins=new fn(g),t.gridPaddings=new fn(y),t.gridSize=new hn(b)}finally{m&&v._groupEnd()}}}}),e.type("pvc.CartesianGridDockingPanel",sn.GridDockingPanel).init(function(e,t,n){this.base(e,t,n),this._plotBgPanel=new sn.PlotBgPanel(e,this)}).add({_getExtensionId:function(){return this.chart.parent?"smallContent":"content"},_createCore:function(t){var n=this.chart,r=n.axes,i=r.x,s=r.y;i.isBound()||(i=null),s.isBound()||(s=null),i&&i.option("Grid")&&(this.xGridRule=this._createGridRule(i)),s&&s.option("Grid")&&(this.yGridRule=this._createGridRule(s)),this.base(t),n.focusWindow&&this._createFocusWindow(t);var o;o=n.compatVersion()<=1?!!i.option("EndLine")||!!s.option("EndLine"):e.get(n.options,"plotFrameVisible",!0),o&&(this.pvFrameBar=this._createFrame(t,r)),i&&"discrete"!==i.scaleType&&i.option("ZeroLine")&&(this.xZeroLine=this._createZeroLine(i,t)),s&&"discrete"!==s.scaleType&&s.option("ZeroLine")&&(this.yZeroLine=this._createZeroLine(s,t))},_createGridRule:function(n){var r=n.scale;if(!r.isNull){var i=n.role.grouping.isDiscrete(),s=this._getAxisGridRootScene(n);if(s){var o=this._layoutInfo.gridMargins,u=this._layoutInfo.gridPaddings,a="x"===n.orientation?"left":"bottom",f=this.anchorLength(a),l=this.anchorOrtho(a),c=this.anchorOpposite(l),h=o[a]+u[a],p=o[l],d=o[c],v=s.leafs().array(),m=v.length;i&&m&&v.push(v[m-1]);var g;this.compatVersion()<=1&&(g=function(e){return function(t){return e.call(this,t.vars.tick.rawValue)}});var y=(new sn.visual.Rule(this,this.pvPanel,{extensionId:n.extensionPrefixes.map(function(e){return e+"Grid"}),wrapper:g})).lock("data",v).lock(f,null).override("defaultColor",e.fun.constant(t.color("#f0f0f0"))).pvMark.antialias(!0)[l](p)[c](d).zOrder(-12).events("none");if(i){var b=r.range().step/2;y[a](function(e){var t=h+r(e.vars.tick.value),n=this.index===m;return t+(n?b:-b)})}else y[a](function(e){return h+r(e.vars.tick.value)});return y}}},_getAxisGridRootScene:function(e){var t=e.isDiscrete(),n=t?e.domainData():this.data,r=new sn.visual.CartesianAxisRootScene(null,{panel:this,source:n});if(t)n.childNodes.forEach(function(e){new sn.visual.CartesianAxisTickScene(r,{source:e,tick:e.value,tickRaw:e.rawValue,tickLabel:e.label})});else{var i=e.ticks||e.calcContinuousTicks();i.forEach(function(t){new sn.visual.CartesianAxisTickScene(r,{tick:t,tickRaw:t,tickLabel:e.scale.tickFormat(t)})},this)}return r},_createFrame:function(e,t){if(!t.base.scale.isNull&&(!t.ortho.scale.isNull||t.ortho2&&!t.ortho2.scale.isNull)){var n=e.gridMargins,r=n.left,i=n.right,s=n.top,o=n.bottom,u=[];return this.compatVersion()<=1&&(u.push("xAxisEndLine"),u.push("yAxisEndLine")),u.push("plotFrame"),(new sn.visual.Panel(this,this.pvPanel,{extensionId:u})).pvMark.lock("left",r).lock("right",i).lock("top",s).lock("bottom",o).lock("fillStyle",null).events("none").strokeStyle("#666666").lineWidth(1).antialias(!1).zOrder(-8)}},_createZeroLine:function(n,r){var i=n.scale;if(!i.isNull){var s=i.domain();if(s[0]*s[1]<-1e-12){var o="x"===n.orientation?"left":"bottom",u=this.anchorLength(o),a=this.anchorOrtho(o),f=this.anchorOpposite(a),l=r.gridMargins,c=r.gridPaddings,h=l[o]+c[o]+i(0),p=l[a],d=l[f],v=new sn.visual.Scene(null,{panel:this});return(new sn.visual.Rule(this,this.pvPanel,{extensionId:n.extensionPrefixes.map(function(e){return e+"ZeroLine"})})).lock("data",[v]).lock(u,null).lock(a,p).lock(f,d).lock(o,h).override("defaultColor",e.fun.constant(t.color("#666666"))).pvMark.events("none").lineWidth(1).antialias(!0).zOrder(-9)}}},_createFocusWindow:function(n){function r(){B[T]=0-k[g],B[N]=D+k[g]+k[E]}function i(){var e=arguments[arguments.length-1],t="end"===e.drag.phase;u._selectingByRubberband=!t,z.render(),X.render();var n=B[S],r=B[S]+B[x];if(!v){var i=_-n;n=_-r,r=i}f._updatePosition(n,r,t,!0)}function s(e,t){var n,r,i=e.m,s=i[K],o=B[Q];switch(t){case"new":n=0,r="begin";break;case"resize-begin":n=B[K]+o-s,r="begin";break;case"move":n=o,r="begin";break;case"resize-end":n=s-B[K],r="end"}var u=e.min[K],a=e.max[K],l={type:t,target:r,point:s,length:n,length0:o,min:u,max:a,minView:0,maxView:_};f._constraintPosition(l),i[K]=l.point;switch(t){case"new":l.length!==n&&(e[Q+"min"]=n=l.length);break;case"resize-begin":l.max=Math.min(l.max,B[K]+B[Q]);break;case"resize-end":l.min=Math.max(l.min,B[K])}e.min[K]=l.min,e.max[K]=l.max}var o=this,u=o.topRoot,a=o.chart,f=a.focusWindow.base,l=f.axis,c=l.scale;if(!c.isNull){var h=f.option("Resizable"),p=f.option("Movable"),d=l.isDiscrete(),v=a.isOrientationVertical(),m=v?"left":"top",g=v?"top":"left",y=o.anchorOrthoLength(m),b=o.anchorOpposite(m),w=o.anchorOrthoLength(g),E=o.anchorOpposite(g),S=v?"x":"y",x="d"+S,T=v?"y":"x",N="d"+T,C=n.gridMargins,k=n.gridPaddings,L={left:C.left+k.left,right:C.right+k.right,top:C.top+k.top,bottom:C.bottom+k.bottom};L.width=L.left+L.right,L.height=L.top+L.bottom;var A=n.clientSize,O=A[y],M=A[w],_=O-L[y],D=M-L[w],P=k[m],H=k[b],B=new sn.visual.Scene(null,{panel:this}),j=d?c.range().step:0,F=j/2;B[S]=c(f.begin)-F,B[x]=j+(c(f.end)-F)-B[S],r();var I=function(e){return function(){return B[e]}},q=function(){var e=B[S];return Math.max(0,Math.min(_,e))},R=function(){var e=q(),t=B[S]+B[x];return t=Math.max(0,Math.min(_,t)),t-e},U=function(e,t){return(new sn.visual.Bar(o,e,{extensionId:t,normalStroke:!0,noHover:!0,noSelect:!0,noClick:!0,noDoubleClick:!0,noTooltip:!0,showsInteraction:!1})).pvMark.lock("data").lock("visible").lock(m,q).lock(y,R).lock(g,I(T)).lock(w,I(N)).lock(E).lock(b).sign},z=this._plotBgPanel.pvPanel.borderPanel;z.lock("data",[B]),p&&h?z.paddingPanel.events("all").cursor("crosshair").event("mousedown",t.Behavior.select().autoRender(!1).collapse(v?"y":"x").positionConstraint(function(e){var t="start"===e.phase?"new":"resize-end";return s(e,t)})).event("selectstart",function(){r(),i.apply(null,arguments)}).event("select",i).event("selectend",i):z.paddingPanel.events("all");var W=U(z.paddingPanel,"focusWindowBg").override("defaultColor",e.fun.constant(sn.invisibleFill)).pvMark;p?W.events("all").cursor("move").event("mousedown",t.Behavior.drag().autoRender(!1).collapse(v?"y":"x").positionConstraint(function(e){s(e,"move")})).event("drag",i).event("dragend",i):W.events("none");var X=(new sn.visual.Panel(o,o.pvPanel)).pvMark.lock("data",[B]).lock("visible").lock("fillStyle",sn.invisibleFill).lock("left",L.left).lock("right",L.right).lock("top",L.top).lock("bottom",L.bottom).lock("zOrder",10).events(function(){var e=B.drag;return e&&"end"!==e.phase?"all":"none"}).cursor(function(){var e=B.drag;return e&&"end"!==e.phase?"drag"===e.type||"select"===e.type&&!h?"move":v?"ew-resize":"ns-resize":null}).antialias(!1),V="rgba(20, 20, 20, 0.1)";(new sn.visual.Bar(o,X,{extensionId:"focusWindowBaseCurtain",normalStroke:!0,noHover:!0,noSelect:!0,noClick:!0,noDoubleClick:!0,noTooltip:!0,showsInteraction:!1})).override("defaultColor",function(e,t){return"stroke"===t?null:V}).pvMark.lock("data",[B,B]).lock("visible").events("none").lock(m,function(){return this.index?q()+R():-P}).lock(b,function(){return this.index?-H:null}).lock(y,function(){return this.index?null:P+q()}).lock(g,I(T)).lock(w,I(N)).lock(E);var $=U(X,"focusWindow").override("defaultColor",e.fun.constant(null)).pvMark.events("none"),J=function(n){var r="left"===n||"top"===n?"begin":"end",u=o.anchorOpposite(n),a="linear-gradient(to "+u+", "+V+", #444 90%)",l=(new sn.visual.Bar(o,$.anchor(n),{extensionId:f.id+"Grip"+e.firstUpperCase(r),normalStroke:!0,noHover:!0,noSelect:!0,noClick:!0,noDoubleClick:!0,noTooltip:!0,showsInteraction:!1})).override("defaultColor",function(e,t){return"stroke"===t?null:a}).pvMark.lock("data").lock("visible")[g](B[T])[w](B[N]);if(h){var c="resize-"+r;l.events("all")[y](5).cursor(v?"ew-resize":"ns-resize").event("mousedown",t.Behavior.resize(n).autoRender(!1).positionConstraint(function(e){s(e,c)}).preserveOrtho(!0)).event("resize",i).event("resizeend",i)}else l.events("none")[y](1);return l};J(m),J(b);var K=S,Q=x}},_getDatumsOnRect:function(t,n,r){var i,s,o=this.chart,u=o.axesPanels.x,a=o.axesPanels.y;u&&(i=new e.Map,u._getDatumsOnRect(i,n,r),i.count||(i=null)),a&&(s=new e.Map,a._getOwnDatumsOnRect(s,n,r),s.count||(s=null)),i&&s?(i.intersect(s,t),r.toggle=!0):i?t.copy(i):s?t.copy(s):o.plotPanelList.forEach(function(e){e._getDatumsOnRect(t,n,r)},this)}}),e.type("pvc.CartesianAbstractPanel",sn.PlotPanel).init(function(e,t,n,r){function i(e){u[e.type]=e,u[e.orientedId]=e,e.v1SecondOrientedId&&(u[e.v1SecondOrientedId]=e)}function s(e,t){var n=a[e];if(null==n||t>n)f=!0,a[e]=t}function o(e){var t=e&&e.option("Offset");null!=t&&t>0&&1>t&&("x"===e.orientation?(s("left",t),s("right",t)):(s("top",t),s("bottom",t)))}this.base(e,t,n,r);var u=this.axes;i(e._getAxis("base",n.option("BaseAxis")-1)),i(e._getAxis("ortho",n.option("OrthoAxis")-1));var a={},f=!1,l=e.axesByType;["base","ortho"].forEach(function(e){var t=l[e];t&&t.forEach(o)}),f&&(this.offsetPaddings=a)}).add({offsetPaddings:null,_calcLayout:function(e){e.requestPaddings=this._calcRequestPaddings(e)},_calcRequestPaddings:function(e){var t,n=this.offsetPaddings;if(n){var r=this.chart._getAxesRoundingPaddings(),i=e.clientSize,s=e.paddings;fn.names.forEach(function(e){var o=sn.BasePanel.orthogonalLength[e],u=i[o],a=s[o],f=u+a;if(!r[e+"Locked"]){var l=f*(n[e]||0),c=u*(r[e]||0);(t||(t={}))[e]=Math.max(l-c,0)}},this)}return t},_createCore:function(){this.pvPanel.zOrder(-10);var t,n=this.chart.options.leafContentOverflow||"auto";t="auto"===n?e.query(["ortho","base"]).select(function(e){return this.axes[e]},this).any(function(e){return null!=e.option("FixedMin")||null!=e.option("FixedMax")}):"hidden"===n,t&&this.pvPanel.borderPanel.overflow("hidden")}}),e.type("pvc.PlotBgPanel",sn.BasePanel).init(function(e,t,n){this.base(e,t,n)}).add({anchor:"fill",_getExtensionId:function(){return"plotBg"},_createCore:function(e){this.pvPanel.borderPanel.lock("zOrder",-13).antialias(!1),this.base(e)}}),e.type("pvc.CategoricalAbstract",sn.CartesianAbstract).init(function(e){this.base(e);var t=this.parent;t&&(this._catRole=t._catRole)}).add({_interpolatable:!0,_initVisualRoles:function(){this.base(),this._catRole=this._addVisualRole("category",this._getCategoryRoleSpec())},_getCategoryRoleSpec:function(){return{isRequired:!0,defaultDimension:"category*",autoCreateDimension:!0}},_createVisibleData:function(t,n){var r=this._serRole&&this._serRole.flattenedGrouping(),i=this._catRole.flattenedGrouping();return r?t.groupBy(e.get(n,"inverted",!1)?[r,i]:[i,r],n):t.groupBy(i,n)},_interpolateDataCell:function(e,t){var n=this._getNullInterpolationOperType(e.nullInterpolationMode);if(n){this._warnSingleContinuousValueRole(e.role);var r=e.dataPartValue,i=this.partData(r,t),s=this.visibleData(r,{baseData:t});s.childCount()>0&&(new n(t,i,s,this._catRole,this._serRole,e.role,!0)).interpolate()}},_getNullInterpolationOperType:function(t){switch(t){case"linear":return sn.data.LinearInterpolationOper;case"zero":return sn.data.ZeroInterpolationOper;case"none":break;default:throw e.error.argumentInvalid("nullInterpolationMode",""+t)}},_generateTrendsDataCell:function(t,n,r){function i(n){var r=h?null:function(e){return e.atoms[l].value},i=function(e){var t=v.child(e.key);return t&&n&&(t=t.child(n.key)),t?t.dimensions(c).value(p):null},s=e.create(a,{rows:e.query(y),x:r,y:i}),o=f.model(s);o&&y.forEach(function(r,s){var u=h?s:r.atoms[l].value,f=o.sample(u,i(r),s);if(null!=f){var p,d=v.child(r.key),y=d||r;if(n){var b=d&&d.child(n.key);b?p=Object.create(b._datums[0].atoms):(p=Object.create(y._datums[0].atoms),e.copyOwn(p,n.atoms))}else p=Object.create(y._datums[0].atoms);p[c]=f,p[g]=m,t.push(new sn.data.TrendDatum(y.owner,p,a))}},this)}var s=this._serRole,o=this._catRole,u=n.role,a=n.trend,f=a.info;this._warnSingleContinuousValueRole(u);var l,c=u.firstDimensionName(),h=o.isDiscrete();h||(l=o.firstDimensionName());var p={zeroIfNone:!1},d=this.partData(n.dataPartValue,r),v=this.visibleData(n.dataPartValue,{baseData:r}),m=this._getTrendDataPartAtom(),g=m.dimension.name,y=o.flatten(r,{visible:!0}).childNodes,b=s&&s.isBound()?s.flatten(d,{visible:!0}).children():e.query([null]);b.each(i,this)},_getContinuousVisibleCellExtent:function(t,n){var r=n.role;switch(r.name){case"series":case"category":return this.base(t,n)}this._warnSingleContinuousValueRole(r);var i=n.dataPartValue,s=r.firstDimensionName(),o=this.visibleData(i),u=t.scaleUsesAbs();return"ortho"===t.type&&n.isStacked?o.children().select(function(e){var t=this._getStackedCategoryValueExtent(e,s,u);return t?{range:t,group:e}:void 0},this).where(e.notNully).reduce(function(e,t){return this._reduceStackedCategoryValueExtent(e,t.range,t.group)}.bind(this),null):o.leafs().select(function(e){var t=e.dimensions(s).value();return u&&0>t?-t:t}).range()},_getStackedCategoryValueExtent:function(e,t,n){var r=null,i=null;return e.children().select(function(e){var r=e.dimensions(t).value();return n&&0>r?-r:r}).each(function(e){null!=e&&(e>=0?r+=e:i+=e)}),null==r&&null==i?null:{max:r||0,min:i||0}},_reduceStackedCategoryValueExtent:function(e,t){return sn.unionExtents(e,t)},_coordinateSmallChartsLayout:function(t){this.base(t);var n,r=0,i=null,s={};this.children.forEach(function(t){t.basePanel.layout();var o,u=t.titlePanel;u&&(n||(n=u.anchorOrthoLength()),o=u[n],o>r&&(r=o));var a=t.axesPanels;i||(i=e.query(e.ownKeys(a)).where(function(e){return e===a[e].axis.id}).select(function(e){return s[e]={axis:0,title:0},e}).array()),i.forEach(function(e){var t=a[e],n=s[e],r="x"===t.axis.orientation?"height":"width";o=t[r],o>n.axis&&(n.axis=o);var i=t.titlePanel;i&&(o=i[r],o>n.title&&(n.title=o))})},this),this.children.forEach(function(e){if(r>0){var t=e.titlePanel;t.size=t.size.clone().set(n,r)}var o=e.axesPanels;i.forEach(function(e){var t=o[e],n=s[e],r="x"===t.axis.orientation?"height":"width";t.size=t.size.clone().set(r,n.axis);var i=t.titlePanel;i&&(i.size=i.size.clone().set(r,n.title))}),e.basePanel.invalidateLayout()},this)}}),e.type("pvc.CategoricalAbstractPanel",sn.CartesianAbstractPanel).init(function(e,t,n,r){this.base(e,t,n,r),this.stacked=n.option("Stacked")}),e.type("pvc.AxisPanel",sn.BasePanel).init(function(t,n,r,i){i=e.create(i,{anchor:r.option("Position")});var s=i.anchor||this.anchor;this.axis=r,this.base(t,n,i),this.roleName=r.role.name,this.isDiscrete=r.role.isDiscrete(),this._extensionPrefix=r.extensionPrefixes,null==this.labelSpacingMin&&(this.labelSpacingMin=this.isDiscrete?.25:1.5),null==this.showTicks&&(this.showTicks=!this.isDiscrete);if(void 0===i.font){var o=this._getConstantExtension("label","font");o&&(this.font=o)}if(void 0===i.tickLength){var u=+this._getConstantExtension("ticks",this.anchorOrthoLength(s));!isNaN(u)&&isFinite(u)&&(this.tickLength=u)}}).add({pvRule:null,pvTicks:null,pvLabel:null,pvRuleGrid:null,pvScale:null,isDiscrete:!1,roleName:null,axis:null,anchor:"bottom",tickLength:6,scale:null,ruleCrossesMargin:!0,font:"9px sans-serif",labelSpacingMin:null,desiredTickCount:null,showMinorTicks:!0,showTicks:null,hiddenLabelText:"·",_isScaleSetup:!1,_createLogInstanceId:function(){return this.base()+" - "+this.axis.id},getTicks:function(){return this._layoutInfo&&this._layoutInfo.ticks},_calcLayout:function(e){var t=this.axis.scale;return this._isScaleSetup||(this.pvScale=t,this.scale=t,this.extend(t,"scale"),this._isScaleSetup=!0),t.isNull?e.axisSize=0:this._calcLayoutCore(e),this.createAnchoredSize(e.axisSize,e.clientSize)},_calcLayoutCore:function(e){var t=e.desiredClientSize[this.anchorOrthoLength()];e.axisSize=t,this.isDiscrete&&this.useCompositeAxis?null==e.axisSize&&(e.axisSize=50):(this._readTextProperties(e),this._calcTicks(),"discrete"===this.scale.type&&(this._tickIncludeModulo=this._calcDiscreteTicksIncludeModulo()),this._calcAxisSizeFromLabel(e),null==e.axisSize&&(e.axisSize=e.requiredAxisSize),this._calcMaxTextLengthThatFits(),this._calcOverflowPaddings())},_calcAxisSizeFromLabel:function(e){this._calcTicksLabelBBoxes(e),this._calcAxisSizeFromLabelBBox(e)},_readTextProperties:function(t){var n=this._getExtension("label","textAngle");t.isTextAngleFixed=null!=n,t.textAngle=e.number.as(n,0),t.textMargin=e.number.as(this._getExtension("label","textMargin"),3);var r=this._getExtension("label","textAlign");"string"!=typeof r&&(r=this.isAnchorTopOrBottom()?"center":"left"==this.anchor?"right":"left"),t.textAlign=r;var i=this._getExtension("label","textBaseline");if("string"!=typeof i)switch(this.anchor){case"right":case"left":case"center":i="middle";break;case"bottom":i="top";break;default:i="bottom"}t.textBaseline=i},_calcAxisSizeFromLabelBBox:function(e){var t=e.maxLabelBBox,n=this._getLabelBBoxQuadrantLength(t,this.anchor),r=this.tickLength+n,i=t.sourceAngle;0===i&&this.isAnchorTopOrBottom()||(r+=this.tickLength),e.requiredAxisSize=r},_getLabelBBoxQuadrantLength:function(e,t){var n;switch(t){case"left":n=-e.x;break;case"right":n=e.x2;break;case"top":n=-e.y;break;case"bottom":n=e.y2}return Math.max(n,0)},_calcOverflowPaddings:function(){this._layoutInfo.canChange?this._calcOverflowPaddingsFromLabelBBox():sn.debug>=2&&this._warn("Layout cannot change. Skipping calculation of overflow paddings.")},_calcOverflowPaddingsFromLabelBBox:function(){var t=null,n=this,r=n._layoutInfo,i=r.ticks,s=i.length;if(s){var o=r.ticksBBoxes,u=r.paddings,a=n.isAnchorTopOrBottom(),f=a?"left":"bottom",l=a?"right":"top",c=n.scale,h="discrete"===c.type,p=r.clientSize[n.anchorLength()];this.axis.setScaleRange(p);var d=function(r,s,o,a){var f=n._getLabelBBoxQuadrantLength(r,s);if(f>1){var l=c(h?i[a].value:i[a]),d=o?l-f:l+f,v=Math.max(0,o?-d:d-p);if(v>1){v-=u[s]||0;if(v>1){h&&(v*=1.05);if(t){var m=t[s];(null==m||v>m)&&(t[s]=v)}else t=e.set({},s,v)}}}};o.forEach(function(e,t){d(e,f,!0,t),d(e,l,!1,t)}),sn.debug>=6&&t&&n._log("OverflowPaddings = "+sn.stringify(t))}r.overflowPaddings=t},_calcMaxTextLengthThatFits:function(){var e=this._layoutInfo;if(this.compatVersion()<=1)e.maxTextWidth=null;else{var n=e.clientSize[this.anchorOrthoLength()],r=Math.min(e.axisSize,n);if(r>=e.requiredAxisSize-this.tickLength)e.maxTextWidth=null;else{var i,s,o=e.maxLabelBBox,u=r-2*this.tickLength;switch(this.anchor){case"left":s=t.vector(0,1),i=t.vector(-u,0);break;case"right":s=t.vector(0,1),i=t.vector(u,0);break;case"top":s=t.vector(1,0),i=t.vector(0,-u);break;case"bottom":s=t.vector(1,0),i=t.vector(0,u)}var a=i.norm(),f=o.source.points(),l=f[0],c=f[1],h=f[2],p=f[3],d=h.minus(p),v=c.minus(l),m=t.SvgScene.lineIntersect,g=m(i,s,l,v),y=m(i,s,p,d),b=o.sourceTextWidth,w=b,E=g.minus(l),S=E.length();b>=S&&E.dot(d)>=0&&(w=l.dot(a)<c.dot(a)?S:g.minus(c).length());var x=y.minus(p),T=x.length();b>=T&&x.dot(d)>=0&&(w=p.dot(a)<h.dot(a)?Math.min(w,T):Math.min(w,y.minus(h).length()));if("center"===o.sourceAlign){var N=b-w;w-=N}e.maxTextWidth=w,sn.debug>=3&&this._log("Trimming labels' text at length "+w.toFixed(2)+"px maxOrthoLength="+u.toFixed(2)+"px")}}},_calcTicks:function(){var n=this._layoutInfo;n.textHeight=2*t.Text.fontHeight(this.font)/3,n.maxTextWidth=null,this.axis.setTicks(null);switch(this.scale.type){case"discrete":this._calcDiscreteTicks();break;case"timeSeries":this._calcTimeSeriesTicks();break;case"numeric":this._calcNumberTicks(n);break;default:throw e.error.operationInvalid("Undefined axis scale type")}this.axis.setTicks(n.ticks);var r=n.clientSize[this.anchorLength()];this.axis.setScaleRange(r),null==n.maxTextWidth&&this._calcTicksTextLength(n)},_calcDiscreteTicks:function(){var n=this.axis,r=this._layoutInfo;r.ticks=n.domainItems();var i,s,o=n.role.grouping;if(o.isSingleDimension&&(s=o.firstDimensionType())&&s.valueType===Date){var u=e.query(n.domainValues()).range();if(u&&u.min!==u.max){var a=new t.Scale.linear(u.min,u.max);a.ticks();var f=n.option("TickFormatter");f&&a.tickFormatter(f);var l=n.domainValues();i=function(e,t){return a.tickFormat(l[t])}}}i||(i=function(e){return e.absLabel}),r.ticksText=r.ticks.map(i),this._clearTicksTextDeps(r)},_clearTicksTextDeps:function(e){e.maxTextWidth=e.ticksTextLength=e.ticksBBoxes=null},_calcTimeSeriesTicks:function(){this._calcContinuousTicks(this._layoutInfo,this.desiredTickCount)},_calcNumberTicks:function(){var e=this.desiredTickCount;if(null==e){if(this.isAnchorTopOrBottom()){this._calcNumberHTicks();return}e=this._calcNumberVDesiredTickCount()}this._calcContinuousTicks(this._layoutInfo,e)},_calcContinuousTicks:function(e,t){this._calcContinuousTicksValue(e,t),this._calcContinuousTicksText(e)},_calcContinuousTicksValue:function(e,t){e.ticks=this.axis.calcContinuousTicks(t),sn.debug>4&&(this._log("DOMAIN: "+sn.stringify(this.scale.domain())),this._log("TICKS:  "+sn.stringify(e.ticks)))},_calcContinuousTicksText:function(e){var t=e.ticksText=e.ticks.map(function(e){return this.scale.tickFormat(e)},this);return this._clearTicksTextDeps(e),t},_calcTicksTextLength:function(e){var n=0,r=this.font,i=e.ticksText||this._calcContinuousTicksText(e),s=e.ticksTextLength=i.map(function(e){var i=t.Text.measureWidth(e,r);return i>n&&(n=i),i});return e.maxTextWidth=n,e.ticksBBoxes=null,s},_calcTicksLabelBBoxes:function(e){var t,n=this,r=n._layoutInfo,i=e.ticksTextLength||n._calcTicksTextLength(e),s=r.maxTextWidth;e.ticksBBoxes=i.map(function(e){var r=n._calcLabelBBox(e);return t||e!==s||(t=r),r},n),r.maxLabelBBox=t},_calcLabelBBox:function(e){var t=this._layoutInfo;return sn.text.getLabelBBox(e,t.textHeight,t.textAlign,t.textBaseline,t.textAngle,t.textMargin)},_calcDiscreteTicksIncludeModulo:function(){var e=this.axis.option("OverlappedLabelsMode");if("hide"!==e&&"rotatethenhide"!==e)return 1;var n=this._layoutInfo,r=n.ticks,i=r.length;if(2>=i)return 1;var s=this.scale.range().step,o=n.textHeight,u=n.maxTextWidth;if(u>0&&o>0&&s>0){var a=o*this.labelSpacingMin,f=a,l=t.Text.measureWidth("x",this.font),c=l+a,h=n.textAngle,p=this.isAnchorTopOrBottom(),d=Math.abs(Math[p?"sin":"cos"](h)),v=Math.abs(Math[p?"cos":"sin"](h)),m=1e-8>d?1/0:Math.ceil((f+o)/(s*d)),g=1e-8>v?1/0:Math.ceil((c+u)/(s*v)),y=Math.min(m,g);return(!isFinite(y)||1>y||Math.ceil(i/y)<2)&&(y=1),y}return 1},_tickMultipliers:[1,2,5,10],_calcNumberVDesiredTickCount:function(){var e=this._layoutInfo,n=e.textHeight*(1+Math.max(0,this.labelSpacingMin)),r=e.clientSize[this.anchorLength()],i=Math.max(1,~~(r/n));if(1>=i)return 1;var s=this.scale.domain(),o=s[1]-s[0];if(0>=o)return i;for(var u,a=o/i,f=Math.floor(t.log(a,10)),l=Math.pow(10,f),c=this._tickMultipliers,h=0;h<c.length;h++){u=c[h]*l;if(u>=a)break}return Math.max(1,Math.floor(o/u))},_calcNumberHTicks:function(){for(var e,t,n,r,i,s=this._layoutInfo,o=s.clientSize[this.anchorLength()],u=s.textHeight*Math.max(0,this.labelSpacingMin),a=this._calcNumberHDesiredTickCount(u),f=sn.debug>=7;;){f&&this._log("calculateNumberHTicks TickCount IN desired = "+a),n={},this._calcContinuousTicksValue(n,a);var l=n.ticks,c=l.length;if(l.exponentOverflow){if(null!=e){if(1===e){r&&(n=r);break}i&&(n=i);break}l.exponent===this.exponentMin?(r=n,e=1):(i=n,e=-1)}else if(null==t||c!==t){f&&this._log("calculateNumberHTicks TickCount desired/resulting = "+a+" -> "+c),t=c,this._calcContinuousTicksText(n);var h=this._calcNumberHLength(n,u),p=n.excessLength=h-o,d=n.error=Math.abs(p/o);f&&(this._log("calculateNumberHTicks error="+(p>=0?"+":"-")+(100*n.error).toFixed(0)+"% count="+c+" step="+l.step),this._log("calculateNumberHTicks Length client/resulting = "+o+" / "+h+" spacing = "+u));if(p>0){if(1===a){3===c&&1>=d?(n.ticks.splice(1,1),n.ticksText.splice(1,1),n.ticks.step*=2):(n.ticks.length=1,n.ticksText.length=1),delete n.maxTextWidth;break}if(r){n=r;break}i=n,e=-1}else{if(.05>=d||-1===e)break;r=n,e=1}}a+=e}n&&(s.ticks=n.ticks,s.ticksText=n.ticksText,s.maxTextWidth=n.maxTextWidth,sn.debug>=5&&this._log("calculateNumberHTicks RESULT error="+(n.excessLength>=0?"+":"-")+(100*n.error).toFixed(0)+"% count="+n.ticks.length+" step="+n.ticks.step)),f&&this._log("calculateNumberHTicks END")},_calcNumberHDesiredTickCount:function(e){var n=this._layoutInfo,r=this.scale.domain().map(function(e){e=+e.toFixed(2);var n=this.scale.tickFormat(e);return t.Text.measureWidth(n,this.font)},this),i=Math.max((r[1]+r[0])/2,n.textHeight),s=n.clientSize[this.anchorLength()];return Math.max(1,~~(s/(i+e)))},_calcNumberHLength:function(n,r){var i=n.ticksText,s=e.query(i).select(function(e){return t.Text.measureWidth(e,this.font)},this).max();return Math.max(s,(i.length-1)*(s+r))},_createCore:function(){if(!this.scale.isNull){var t=this._layoutInfo.clientSize,n=this._layoutInfo.paddings,r=this.anchorOrtho(),i=this.anchorOpposite(r),s=this.anchorOrthoLength(r),o=this.ruleCrossesMargin?-n[r]:0,u=t[s]+(this.ruleCrossesMargin?n[i]:0),a=u-o;this._rSize=a;var f=this._getRootScene();this.pvRule=(new sn.visual.Rule(this,this.pvPanel,{extensionId:"rule"})).lock("data",[f]).override("defaultColor",e.fun.constant("#666666")).lock(this.anchorOpposite(),0).lock(r,o).lock(s,a).pvMark.zOrder(30).strokeDasharray(null).lineCap("square"),this.isDiscrete?this.useCompositeAxis?this.renderCompositeOrdinalAxis():this.renderOrdinalAxis():this.renderLinearAxis()}},_getExtensionId:function(){return""},_getRootScene:function(){if(!this._rootScene){var e=this._rootScene=new sn.visual.CartesianAxisRootScene(null,{panel:this,source:this._getRootData()}),t=this._layoutInfo,n=t.ticks,r=t.ticksText;if(this.isDiscrete)if(this.useCompositeAxis)this._buildCompositeScene(e);else{var i=this._tickIncludeModulo,s=this.hiddenLabelText;e.vars.tickIncludeModulo=i,e.vars.hiddenLabelText=s;var o,u,a,f;if(i>2){sn.debug>=3&&this._info("Showing only one in every "+i+" tick labels");var l=e.group.owner.keySep;a=function(){var t=o.map(function(e){return e.key}).join(l),n=u.slice(0,10).join(", ")+(u.length>10?", ...":""),r=new sn.visual.CartesianAxisTickScene(e,{source:o,tick:t,tickRaw:t,tickLabel:n,isHidden:!0});r.dataIndex=f,o=u=f=null}}n.forEach(function(t,n){var s=0!==n%i;if(s&&i>2)null==f&&(f=n),(o||(o=[])).push(t),(u||(u=[])).push(r[n]);else{o&&a();var l=new sn.visual.CartesianAxisTickScene(e,{source:t,tick:t.value,tickRaw:t.rawValue,tickLabel:r[n],isHidden:s});l.dataIndex=n}}),o&&a()}else n.forEach(function(t,n){var i=new sn.visual.CartesianAxisTickScene(e,{tick:t,tickRaw:t,tickLabel:r[n]});i.dataIndex=n},this)}return this._rootScene},_buildCompositeScene:function(e){function t(e){var r=e.group;if(n){var i=e.vars.tick;e.nodeValue=e.value=i.rawValue,e.nodeLabel=e.label=i.label}r.childCount()&&r.children().each(function(n){var r=new sn.visual.CartesianAxisTickScene(e,{source:n,tick:n.value,tickRaw:n.rawValue,tickLabel:n.label});r.dataIndex=n.childIndex(),t(r)})}var n=this.compatVersion()<=1;e.vars.tick=new kn("",""),t(e)},_getRootData:function(){var e;if(this.isDiscrete&&this.useCompositeAxis){var t=this.anchor,n={visible:this.axis.domainVisibleOnly()?!0:null,isNull:this.chart.options.ignoreNulls||this.axis.domainIgnoreNulls()?!1:null,reverse:"bottom"==t||"left"==t};e=this.axis.role.select(this.data,n)}else e=this.data;return e},renderOrdinalAxis:function(){var e,n=this.scale,r=this.hiddenLabelText,i=this._tickIncludeModulo,s=i*n.range().step/2,o=this.anchorOpposite(),u=this.anchorLength(),a=this.anchorOrtho(),f=this.anchorOrthoLength(),l=this.pvRule,c=this._getRootScene(),h=this._layoutInfo,p=this.compatVersion()<=1;if(p){var d=function(e){this.value=this.absValue=e.rawValue,this.nodeName=""+(this.value||""),this.path=this.nodeName?[this.nodeName]:[],this.label=this.absLabel=e.label};d.prototype.toString=function(){return""+this.value},e=function(e){return function(t){var n=Object.create(this);return n.index=this.parent.index,e.call(n,new d(t.vars.tick))}}}var v=(new sn.visual.Panel(this,this.pvPanel,{extensionId:"ticksPanel"})).lock("data",c.childNodes).lock(o,0).lockMark(a,function(e){return e.isHidden?n(e.previousSibling.vars.tick.value)+s:n(e.vars.tick.value)}).lock("strokeDasharray",null).lock("strokeStyle",null).lock("fillStyle",null).lock("lineWidth",0).pvMark.zOrder(20);(p||this.showTicks)&&(this.pvTicks=(new sn.visual.Rule(this,v,{extensionId:"ticks",wrapper:e})).lock("data").intercept("visible",function(e){return!e.isHidden&&this.delegateExtension(!0)}).optional("lineWidth",1).lock(o,0).lock(a,0).lock(u,null).optional(f,2*this.tickLength/3).override("defaultColor",function(){return p?t.Color.names.transparent:l.scene?l.scene[0].strokeStyle:"#666666"}).pvMark);var m=this.font,g=this._layoutInfo.maxTextWidth;isFinite(g)||(g=0),this.pvLabel=(new sn.visual.Label(this,v,{extensionId:"label",showsInteraction:!0,noClick:!1,noDoubleClick:!1,noSelect:!1,noTooltip:!1,noHover:!1,wrapper:e})).intercept("visible",function(e){return e.isHidden?!!e.vars.hiddenLabelText:this.delegateExtension(!0)}).intercept("text",function(e){var t;return e.isHidden?t=r:(t=this.delegateExtension(),void 0===t&&(t=e.vars.tick.label),!g||this.showsInteraction()&&e.isActive||(t=sn.text.trimToWidthB(g,t,m,"..",!1))),t}).pvMark.zOrder(40).lock(o,this.tickLength).lock(a,0).font(m).textStyle("#666666").textAlign(h.textAlign).textBaseline(h.textBaseline),this._debugTicksPanel(v)},_getTooltipFormatter:function(e){if(this.axis.option("TooltipEnabled")){e.gravity=this._calcTipsyGravity();var t=this.axis.option("TooltipFormat");if(t)return function(e){return t.call(e,e.scene)};var n=this.axis.option("TooltipAutoContent");if("summary"===n)return this._summaryTooltipFormatter;if("value"===n)return e.isLazy=!1,function(e){return e.scene.vars.tick.label}}},_debugTicksPanel:function(e){if(sn.debug>=16){var n=this._layoutInfo,r=n.ticksBBoxes||this._calcTicksLabelBBoxes(n);e.add(t.Panel)[this.anchorOpposite()](this.tickLength)[this.anchorOrtho()](0)[this.anchorLength()](0)[this.anchorOrthoLength()](0).fillStyle(null).strokeStyle(null).lineWidth(0).visible(function(e){return!e.isHidden}).add(t.Line).data(function(e){var t=r[e.dataIndex],n=t.source.points();return n.length>1&&(n=n.concat(n[0])),n}).left(function(e){return e.x}).top(function(e){return e.y}).strokeStyle("red").lineWidth(.5).strokeDasharray("-")}},renderLinearAxis:function(){var e,n=this.scale,r=this.pvRule,i=this.anchorOpposite(),s=this.anchorLength(),o=this.anchorOrtho(),u=this.anchorOrthoLength(),a=this._getRootScene();this.compatVersion()<=1&&(e=function(e){return function(t){var n=Object.create(this);return n.index=this.parent.index,e.call(n,t.vars.tick.rawValue)}});var f=(new sn.visual.Panel(this,this.pvPanel,{extensionId:"ticksPanel"})).lock("data",a.childNodes).lock(i,0).lockMark(o,function(e){return n(e.vars.tick.value)}).lock("strokeStyle",null).lock("fillStyle",null).lock("lineWidth",0).pvMark.zOrder(20);if(this.showTicks){var l=this.pvTicks=(new sn.visual.Rule(this,f,{extensionId:"ticks",wrapper:e})).lock("data").override("defaultColor",function(){return r.scene?r.scene[0].strokeStyle:"#666666"}).lock(i,0).lock(o,0).lock(s,null).optional(u,this.tickLength).pvMark;if(this.showMinorTicks){var c=this._layoutInfo,h=c.ticks,p=h.length,d=p>1?Math.abs(n(h[1])-n(h[0]))/2:0;this.pvMinorTicks=(new sn.visual.Rule(this,this.pvTicks,{extensionId:"minorTicks",wrapper:e})).lock("data").intercept("visible",function(e){var t=e.childIndex()<p-1&&(!l.scene||l.scene[0].visible);return t&&this.delegateExtension(!0)}).override("defaultColor",function(){return l.scene?l.scene[0].strokeStyle:t.Color.names.d}).lock(i,0).lock(s,null).optional(u,this.tickLength/2).lockMark(o,d).pvMark}}this.renderLinearAxisLabel(f,e),this._debugTicksPanel(f)},renderLinearAxisLabel:function(e,t){var n=this.anchorOpposite(),r=this.anchorOrtho(),i=this.font,s=this._layoutInfo.maxTextWidth;isFinite(s)||(s=0);var o=this.pvLabel=(new sn.visual.Label(this,e,{extensionId:"label",noHover:!1,showsInteraction:!0,wrapper:t})).lock("data").optional("text",function(e){var t=e.vars.tick.label;return!s||this.showsInteraction()&&e.isActive||(t=sn.text.trimToWidthB(s,t,i,"..",!1)),t}).pvMark.lock(n,this.tickLength).lock(r,0).zOrder(40).font(this.font).textStyle("#666666"),u=this.pvPanel.root;this.isAnchorTopOrBottom()?o.textBaseline(n).textAlign(function(e){var t;if(0===this.index){t=o.toScreenTransform().transformHPosition(o.left());if(0>=t)return"left"}else if(this.index===e.parent.childNodes.length-1){t=o.toScreenTransform().transformHPosition(o.left());if(t>=u.width())return"right"}return"center"}):o.textAlign(n).textBaseline(function(e){var t;if(0===this.index){t=o.toScreenTransform().transformVPosition(o.top());if(t>=u.height())return"bottom"}else if(this.index===e.parent.childNodes.length-1){t=o.toScreenTransform().transformVPosition(o.top());if(0>=t)return"top"}return"middle"})},_onV1Click:function(e,t){this.isDiscrete&&this.useCompositeAxis&&t.call(e.pvMark,e.scene,e.event)},_onV1DoubleClick:function(e,t){this.isDiscrete&&this.useCompositeAxis&&t.call(e.pvMark,e.scene,e.event)},_getSelectableMarks:function(){return this.isDiscrete&&this.isVisible&&this.pvLabel?this.base():void 0},renderCompositeOrdinalAxis:function(){var n=this.isAnchorTopOrBottom(),r=n?"h":"v",i=2,s=2,o=this.font,u=t.Text.fontHeight(o)/2,a=this._pvLayout=this._getCompositeLayoutSingleCluster();a.node.def("fitInfo",null).height(function(e){var t=sn.text.getFitInfo(e.dx,e.dy,e.vars.tick.label,o,u);return t.h||("v"===r&&t.v?s=Math.min(i,e.depth):i=Math.min(i,e.depth)),this.fitInfo(t),e.dy}),a.node.add(t.Bar).fillStyle("rgba(127,127,127,.001)").strokeStyle(function(e){return 1!==e.maxDepth&&e.maxDepth?"rgba(127,127,127,0.3)":null}).lineWidth(function(e){return 1!==e.maxDepth&&e.maxDepth?.5:0}).text(function(e){return e.vars.tick.label});var f,l=.3,c=1.27,h=n?"center":"left"==this.anchor?"right":"left";this.compatVersion()<=1&&(f=function(e){return function(t){return e.call(this,t)}}),this.pvLabel=(new sn.visual.Label(this,a.label,{extensionId:"label",noClick:!1,noDoubleClick:!1,noSelect:!1,noTooltip:!1,noHover:!1,showsInteraction:!0,wrapper:f,tooltipArgs:{options:{offset:2*u}}})).pvMark.def("lblDirection","h").textAngle(function(e){if(e.depth>=s&&e.depth<i)return this.lblDirection("v"),-Math.PI/2;if(e.depth>=i){var t=e.dy/e.dx,n=Math.atan(t);if(n>c)return this.lblDirection("v"),-Math.PI/2;if(n>l)return this.lblDirection("d"),-n}return this.lblDirection("h"),0}).textMargin(1).textAlign(function(e){return"v"!=r||e.depth>=s||e.depth>=i?"center":h}).left(function(e){return"v"!=r||e.depth>=s||e.depth>=i?e.x+e.dx/2:"right"==h?e.x+e.dx:e.x}).font(o).textStyle("#666666").text(function(t){var n=t.vars.tick.label;if(!t.isActive||!this.sign.showsInteraction()){var r=this.fitInfo();switch(this.lblDirection()){case"h":if(!r.h)return sn.text.trimToWidthB(t.dx,n,o,"..");break;case"v":if(!r.v)return sn.text.trimToWidthB(t.dy,n,o,"..");break;case"d":if(!r.d){var i=Math.sqrt(e.sqr(t.dy)+e.sqr(t.dx));return sn.text.trimToWidthB(i-u,n,o,"..")}}}return n})},_getCompositeLayoutSingleCluster:function(){var n=this._getRootScene(),r=this.anchor,i=n.group.treeHeight,s=this._layoutInfo.axisSize;i++;var o=s/i,u=i>2?1/12*s:0;o-=u;var a=i/(i-1),f=sn.BasePanel.orthogonalLength[r],l="width"==f?"left"===r?[-o,0]:[o,0]:"top"===r?[0,-o]:[0,o];this.pvRule.sign.override("defaultColor",e.fun.constant(null)).override("defaultStrokeWidth",e.fun.constant(0));var c=this.pvRule.add(t.Panel)[f](s).strokeStyle(null).lineWidth(0).add(t.Panel)[f](s*a).strokeStyle(null).lineWidth(0);return c.transform(t.Transform.identity.translate(l[0],l[1])),c.add(t.Layout.Cluster.Fill).nodes(n.nodes()).orient(r)},_calcTipsyGravity:function(){switch(this.anchor){case"bottom":return"s";case"top":return"n";case"left":return"w";case"right":return"e"}return"s"}}),e.type("pvc.AxisTitlePanel",sn.TitlePanelAbstract).init(function(e,t,n,r){this.axis=n,this.base(e,t,r),this._extensionPrefix=n.extensionPrefixes.map(function(e){return e+"Title"})}).add({_calcLayout:function(e){var t=this.axis.scale;return!t||t.isNull?new hn(0,0):this.base(e)},_createCore:function(e){var t=this.axis.scale;return t&&!t.isNull?this.base(e):void 0}}),e.type("pvc.PiePanel",sn.PlotPanel).init(function(e,t,n,r){var i=n.option("ValuesLabelStyle");this.base(e,t,n,r),this.explodedOffsetRadius=n.option("ExplodedSliceRadius"),this.explodedSliceIndex=n.option("ExplodedSliceIndex"),this.activeOffsetRadius=n.option("ActiveSliceRadius"),this.labelStyle=i,"linked"===i&&(this.linkInsetRadius=n.option("LinkInsetRadius"),this.linkOutsetRadius=n.option("LinkOutsetRadius"),this.linkMargin=n.option("LinkMargin"),this.linkHandleWidth=n.option("LinkHandleWidth"),this.linkLabelSize=n.option("LinkLabelSize"),this.linkLabelSpacingMin=n.option("LinkLabelSpacingMin"))}).add({pvPie:null,pvPieLabel:null,valueRoleName:"value",_getV1Datum:function(e){var t=e.datum;if(t){var n=Object.create(t);n.percent=e.vars.value.percent,t=n}return t},_calcLayout:function(n){function r(t){return e.between(ln.resolve(t,u),0,u)}function i(t){return e.between(ln.resolve(t,o),0,o)}var s=n.clientSize,o=s.width,u=Math.min(o,s.height)/2;if(!u)return new hn(0,0);var a=t.vector(s.width/2,s.height/2),f=this._getConstantExtension("label","font");e.string.is(f)||(f=this.valuesFont);var l=u;if(this.valuesVisible&&"linked"===this.labelStyle){var c=r(this.linkInsetRadius),h=r(this.linkOutsetRadius),p=i(this.linkMargin),d=i(this.linkLabelSize),v=e.number.to(this._getConstantExtension("label","textMargin"),3),m=2*t.Text.fontHeight(f)/3,g=this.linkHandleWidth*m;p+=g;var y=this.linkLabelSpacingMin*m,b=Math.max(0,o/2-u),w=Math.max(0,h+p+d-b),E=h+m,S=Math.max(0,E,w);S>=l?(this.valuesVisible=!1,sn.debug>=2&&this._log("Hiding linked labels due to insufficient space.")):(l-=S,n.link={insetRadius:c,outsetRadius:h,elbowRadius:l+h,linkMargin:p,handleWidth:g,labelSize:d,maxTextWidth:d-v,labelSpacingMin:y,textMargin:v,lineHeight:m})}var x=r(this.explodedOffsetRadius),T=0;this.hoverable()&&(T=r(this.activeOffsetRadius));var N=x+T,C=l-N;if(0>C)return new hn(0,0);n.resolvePctRadius=r,n.center=a,n.clientRadius=u,n.normalRadius=C,n.explodedOffsetRadius=x,n.activeOffsetRadius=T,n.maxOffsetRadius=N,n.labelFont=f},_createCore:function(n){var r,i=this,s=i.chart,o=this._buildScene(),u=n.center,a=n.normalRadius,f=["slice"];this.compatVersion()<=1&&(f.push(""),r=function(e){return function(t){return e.call(this,t.vars.value.value)}}),this.pvPie=(new sn.visual.PieSlice(this,this.pvPanel,{extensionId:f,center:u,activeOffsetRadius:n.activeOffsetRadius,maxOffsetRadius:n.maxOffsetRadius,resolvePctRadius:n.resolvePctRadius,wrapper:r,tooltipArgs:{options:{useCorners:!0,gravity:function(){var e=this.midAngle(),t=Math.cos(e)>=0,n=Math.sin(e)>=0;return t?n?"nw":"sw":n?"ne":"se"}}}})).lock("data",o.childNodes).override("angle",function(e){return e.vars.value.angle}).override("defaultOffsetRadius",function(){var e=i.explodedSliceIndex;return null==e||e==this.pvMark.index?n.explodedOffsetRadius:0}).lockMark("outerRadius",function(){return s.animate(0,a)}).localProperty("innerRadiusEx",ln.parse).intercept("innerRadius",function(){var e=this.delegateExtension();if(null==e){var t=this.pvMark.innerRadiusEx();e=null!=t?ln.resolve(t,this.pvMark.outerRadius())||0:0}return e>0?s.animate(0,e):0}).pvMark;if(this.valuesVisible){this.valuesFont=n.labelFont;if("inside"===this.labelStyle)this.pvPieLabel=sn.visual.ValueLabel.maybeCreate(this,this.pvPie,{wrapper:r}).override("defaultText",function(e){return e.vars.value.sliceLabel}).override("calcTextFitInfo",function(e,n){var r=this.pvMark,s=r.textMargin();if(!(-0.000001>s)){var o=r.textBaseline();if("middle"===o){var u=sn.normAngle(i.pvPie.midAngle()),a=sn.normAngle(r.textAngle()),f=Math.abs(u-a)<1e-6,l=!1;if(!f){var c=sn.normAngle(a+Math.PI);l=Math.abs(u-c)<1e-6}if(f||l){var h=r.name(),p=r.textAlign(),d="outer"===h?p===(f?"right":"left"):!1;if(d){var v=!1,m=t.Text.measure(n,r.font()),g=.85*m.height,y=i.pvPie.outerRadius(),b=i.pvPie.innerRadius(),w=e.vars.value.angle,E=g+s/2,S=w<Math.PI?Math.max(b,E/(2*Math.tan(w/2))):b,x=y-s-S;return v|=0>=x,x-=s,v|=this.hideOverflowed&&m.width>x,{hide:v,widthMax:x}}}}}}).pvMark.textMargin(10);else if("linked"===this.labelStyle){var l=n.link;o.layoutLinkLabels(n),this.pvLinkPanel=this.pvPanel.add(t.Panel).data(o.childNodes).localProperty("pieSlice").pieSlice(function(){return i.pvPie.scene[this.index]});var c=!1,h=!0;this.pvLinkLine=(new sn.visual.Line(this,this.pvLinkPanel,{extensionId:"linkLine",freePosition:h,noClick:h,noDoubleClick:h,noSelect:h,noTooltip:h,noHover:h,showsActivity:c})).lockMark("data",function(e){var t=this.parent.pieSlice(),n=t.startAngle+t.angle/2,r=t.outerRadius-l.insetRadius,i=t.left+r*Math.cos(n),s=t.top+r*Math.sin(n),o=e.childNodes[0];return o&&o._isFirstDynamicScene?(o.x=i,o.y=s):(o=new sn.visual.PieLinkLineScene(e,i,s,0),o._isFirstDynamicScene=h),e.childNodes}).override("defaultColor",function(e,t){return"stroke"===t?"black":this.base(e,t)}).override("defaultStrokeWidth",e.fun.constant(.5)).pvMark.lock("visible").lock("top",function(e){return e.y}).lock("left",function(e){return e.x}),this.pvPieLabel=(new sn.visual.Label(this,this.pvLinkPanel,{extensionId:"label",noClick:c,noDoubleClick:c,noSelect:c,noHover:c,showsInteraction:h})).lockMark("data",function(e){return e.lineScenes}).intercept("textStyle",function(e){this._finished=c;var t=this.delegate();return t&&!this._finished&&!this.mayShowActive(e)&&this.mayShowNotAmongSelected(e)&&(t=this.dimColor(t,"text")),t}).pvMark.lock("visible").left(function(e){return e.vars.link.labelX}).top(function(e){return e.vars.link.labelY+(this.index+1)*l.lineHeight}).textAlign(function(e){return e.vars.link.labelAnchor}).textMargin(l.textMargin).textBaseline("bottom").text(function(e){return e.vars.link.labelLines[this.index]});if(sn.debug>=20){this.pvPanel.add(t.Panel).zOrder(-10).left(u.x-n.clientRadius).top(u.y-n.clientRadius).width(2*n.clientRadius).height(2*n.clientRadius).strokeStyle("red"),this.pvPanel.strokeStyle("green");var p=t.Colors.category10();this.pvLinkLine.segmented(h).strokeStyle(function(){return p(this.index)})}}this.pvPieLabel.font(n.labelFont)}},_getExtensionId:function(){var e=[{abs:"content"}];return this.chart.parent&&e.push({abs:"smallContent"}),e.concat(this.base())},renderInteractive:function(){this.pvPanel.render()},_buildScene:function(){var e=new sn.visual.PieRootScene(this);return this.sum=e.vars.sumAbs.value,e}}),e.type("pvc.visual.PieRootScene",sn.visual.Scene).init(function(t){function n(e,t){if(t){var n=t._datums;if(1===n.length)return n[0].atoms[o].label}return u.format(e)}var r=t.axes.category,i=r.domainData();this.base(null,{panel:t,source:i});var s=new sn.visual.RoleVarHelper(this,t.visualRoles.color,{roleVar:"color"}),o=t.visualRoles[t.valueRoleName].firstDimensionName(),u=i.dimensions(o),a=t.chart.options.percentValueFormat,f=t.axes.angle.scale,l=f.isNull?0:f.domain()[1];this.vars.sumAbs=new kn(l,n(l));var c=this,h=e.type(sn.visual.PieCategoryScene).init(function(e,t){this.base(c,{source:e}),this.vars.category=kn.fromComplex(e);var r=new kn(t,n(t,e));r.angle=f(t);var i=Math.abs(t)/l;r.percent=new kn(i,a(i)),this.vars.value=r,r.sliceLabel=this.sliceLabel(),s.onNewScene(this,!0)});t._extendSceneType("category",h,["sliceLabel","sliceLabelMask"]);var p=r.domainItems();if(p.length){p.forEach(function(e){var t=e.dimensions(o).value();0!==t&&new h(e,t)});if(!c.childNodes.length&&!t.visualRoles.multiChart.isBound())throw new InvalidDataException("Unable to create a pie chart, please check the data values.")}}).add({layoutLinkLabels:function(e){var t=-Math.PI/2,n=[],r=[];this.childNodes.forEach(function(i){t=i.layoutI(e,t),(i.vars.link.dir>0?r:n).push(i)}),this._distributeLabels(-1,n,e),this._distributeLabels(1,r,e)},_distributeLabels:function(t,n,r){n.sort(function(t,n){return e.compare(t.vars.link.targetY,n.vars.link.targetY)}),this._distributeLabelsDownwards(n,r)&&this._distributeLabelsUpwards(n,r)&&this._distributeLabelsEvenly(n,r),n.forEach(function(e){e.layoutII(r)})},_distributeLabelsDownwards:function(e,t){for(var n=t.link,r=n.labelSpacingMin,i=t.clientSize.height,s=!1,o=0,u=e.length-1;u>o;o++){var a=e[o].vars.link;!o&&a.labelTop()<0&&(s=!0);var f=e[o+1].vars.link,l=a.labelBottom()+r;if(f.labelTop()<l){var c=f.labelHeight/2,h=l+c,p=i-c;h>p?(s=!0,f.targetY=p):f.targetY=h}}return s},_distributeLabelsUpwards:function(e,t){for(var n=t.link,r=n.labelSpacingMin,i=!1,s=e.length-1;s>0;s--){var o=e[s-1].vars.link,u=e[s].vars.link;1===s&&o.labelTop()<0&&(i=!0);var a=u.labelTop()-r;if(o.labelBottom()>a){var f=o.labelHeight/2,l=a-f,c=f;c>l?(i=!0,o.targetY=c):o.targetY=l}}return i},_distributeLabelsEvenly:function(e,t){var n=0;e.forEach(function(e){n+=e.vars.link.labelHeight});var r=t.clientSize.height-n,i=r;e.length>1&&(i/=e.length-1);var s=0;return e.forEach(function(e){var t=e.vars.link,n=t.labelHeight/2;s+=n,t.targetY=s,s+=n+i}),!0}}),e.type("pvc.visual.PieLinkLabelVar").add({labelTop:function(){return this.targetY-this.labelHeight/2},labelBottom:function(){return this.targetY+this.labelHeight/2}}),e.type("pvc.visual.PieCategoryScene",sn.visual.Scene).add({sliceLabelMask:function(){return this.panel().valuesMask},sliceLabel:function(){return this.format(this.sliceLabelMask())},layoutI:function(t,n){var r=this.vars.value,i=n+r.angle,s=(n+i)/2,o=this.vars.link=new sn.visual.PieLinkLabelVar,u=t.link,a=sn.text.justify(r.sliceLabel,u.maxTextWidth,t.labelFont),f=a.length;o.labelLines=a,o.labelHeight=f*u.lineHeight,this.lineScenes=e.array.create(f,this);var l=Math.cos(s),c=Math.sin(s),h=l>=0,p=h?1:-1;o.labelAnchor=h?"left":"right";var d=t.center,v=u.elbowRadius,m=d.x+v*l,g=d.y+v*c,y=d.x+p*v,b=y+p*u.linkMargin;return new sn.visual.PieLinkLineScene(this,m,g),new sn.visual.PieLinkLineScene(this,y,g),o.elbowY=g,o.targetY=g+0,o.targetX=b,o.dir=p,i},layoutII:function(e){var t=this.vars.link,n=t.targetY,r=t.targetX,i=e.link.handleWidth;i>0&&new sn.visual.PieLinkLineScene(this,r-t.dir*i,n),new sn.visual.PieLinkLineScene(this,r,n),t.labelX=r,t.labelY=n-t.labelHeight/2}}),e.type("pvc.visual.PieLinkLineScene",sn.visual.Scene).init(function(e,t,n,r){this.base(e,{source:e.group,index:r}),this.x=t,this.y=n}).add(t.Vector),e.type("pvc.PieChart",sn.BaseChart).add({_animatable:!0,_axisClassByType:{category:sn.visual.Axis,angle:sn.visual.NormalizedAxis},_axisCreateChartLevel:{category:2,angle:2},_axisSetScaleChartLevel:{category:2,angle:2},_axisCreationOrder:function(){var e=sn.BaseChart.prototype._axisCreationOrder.slice();return e.push("category","angle"),e}(),pieChartPanel:null,_getColorRoleSpec:function(){return{isRequired:!0,defaultSourceRole:"category",defaultDimension:"color*",requireIsDiscrete:!0}},_initVisualRoles:function(){this.base(),this._addVisualRole("category",{isRequired:!0,defaultDimension:"category*",autoCreateDimension:!0}),this._addVisualRole("value",{isMeasure:!0,isRequired:!0,isPercent:!0,requireSingleDimension:!0,requireIsDiscrete:!1,valueType:Number,defaultDimension:"value"})},_initPlotsCore:function(){new sn.visual.PiePlot(this)},_createVisibleData:function(e,t){return this.visualRoles.category.flatten(e,t)},_setAxisScale:function(e,t){this.base(e,t),2&t&&"angle"===e.type&&e.setScaleRange({min:0,max:2*Math.PI})},_createContent:function(t){this.base();var n=this.compatVersion()<=1;if(n){var r=sn.castNumber(this.options.innerGap)||.95;r=e.between(r,.1,1),t.paddings=(100*(1-r)/2).toFixed(2)+"%"}else null==t.paddings&&(t.paddings=new ln(.025));var i=this.plots.pie;this.pieChartPanel=new sn.PiePanel(this,this.basePanel,i,e.create(t,{scenes:e.getPath(this.options,"pie.scenes")}))}}),e.type("pvc.BarAbstractPanel",sn.CategoricalAbstractPanel).add({pvBar:null,pvBarLabel:null,pvCategoryPanel:null,pvSecondLine:null,pvSecondDot:null,_creating:function(){var e=this.defaultLegendGroupScene();if(e&&!e.hasRenderer()){var t=e.colorAxis,n=t.option("LegendDrawLine"),r=!n||t.option("LegendDrawMarker");if(r){var i={drawMarker:!0,markerShape:t.option("LegendShape"),drawRule:n,markerPvProto:new on};this.extend(i.markerPvProto,"",{constOnly:!0}),e.renderer(new sn.visual.legend.BulletItemDefaultRenderer(i))}}},_createCore:function(){this.base();var e,n,r=this,i=r.chart,s=r.plot,o=!!r.stacked,u=r.isOrientationVertical(),a=r.visibleData({ignoreNulls:!1}),f=r.axes.ortho,l=r.axes.base,c=l.domainItems(),h=r.visualRoles.series.flatten(r.partData(),{visible:!0,isNull:i.options.ignoreNulls?!1:null}).childNodes,p=r._buildScene(a,h,c),d=f.scale,v=d(0),m=f.sceneScale({sceneVarName:"value",nullToZero:!1}),g=l.sceneScale({sceneVarName:"category"}),y=s.option("BarSizeRatio"),b=s.option("BarSizeMax"),w=s.option("BarStackedMargin"),E=s.option("BarOrthoSizeMin"),S=l.scale.range(),x=S.band,T=S.step,N=S.margin,C=u===o;o?e=x:(n=h.length,e=n?1===n?x:y*x/n:0),e>b&&(e=b),r.barWidth=e,r.barStepWidth=T;var k;r.compatVersion()<=1&&(k=function(e){return function(t){var n=Object.create(this.parent),r=Object.create(this);r.parent=n;var i=t.parent.childIndex(),s=t.childIndex();return o?(n.index=i,r.index=s):(n.index=s,r.index=i),e.call(r,t.vars.value.rawValue)}}),r.pvBarPanel=(new sn.visual.Panel(r,r.pvPanel,{panelType:t.Layout.Band,extensionId:"panel"})).lock("layers",p.childNodes).lockMark("values",function(e){return e.childNodes}).lockMark("orient",u?"bottom-left":"left-bottom").lockMark("layout",o?"stacked":"grouped").lockMark("verticalMode",r._barVerticalMode()).lockMark("yZero",v).optionalMark("hZero",E).pvMark.band.x(g).w(x).differentialControl(r._barDifferentialControl()).item.order(C?"reverse":null).h(function(e){var t=m(e);return null!=t?i.animate(0,t-v):null}).w(e).horizontalRatio(y).verticalMargin(w).end;var L=4>=e||2>N,A=this.pvBar=(new sn.visual.Bar(r,r.pvBarPanel.item,{extensionId:"",freePosition:!0,wrapper:k})).lockDimensions().pvMark.antialias(function(e){if(L)return!0;var t=m(e),n=null==t?0:Math.abs(t-v);return 1e-8>n});s.option("OverflowMarkersVisible")&&this._addOverflowMarkers(k);var O=sn.visual.ValueLabel.maybeCreate(r,A,{wrapper:k});if(O){var M;O.hideOrTrimOverflowed&&(M=x,!o&&n>1&&(M/=n)),r.pvBarLabel=O.override("calcTextFitInfo",function(e,n){var r=this.pvMark,i=r.textMargin();if(!(-0.000001>i)){var s=r.textAngle(),o=Math.sin(s),a=Math.abs(o)<1e-6,f=!a&&Math.abs(Math.cos(s))<1e-6;if(a||f&&u){var l,c,h,p=A.height(),d=A.width(),v=u?p:d,m=u?d:p,g=t.Text.measure(n,r.font()),y=.75*g.height,b=g.width,w=r.name(),E=r.textBaseline(),S=r.textAlign(),x="center"===w,T=!1;if(u)if(a){c=x||w===E;if(!c)return;T|=x&&"middle"!==E?y+i>v/2:y+2*i>v}else T|=y>v,h="center"===S,c=x,c||h||(c=o>=1e-6?"left"===S?"top"===w:"bottom"===w:"left"===S?"bottom"===w:"top"===w),c?(l=!x||h?v-2*i:(v-i)/2,T|=("middle"===E?y>m:y>m/2)||this.hideOverflowed&&b>l):T|=y>=Math.max(m,M);else T|=y>v,c=x||w===S,c?(l=x&&"center"!==S?(v-i)/2:v-2*i,T|=("middle"===E?y>m:y>m/2)||this.hideOverflowed&&b>l):T|=y>=Math.max(m,M);return{hide:T,widthMax:l}}}}).pvMark}},_barVerticalMode:function(){return null},_barDifferentialControl:function(){return null},_getV1Datum:function(e){var t=e.datum;if(t){var n=Object.create(t);n.percent=e.vars.value.percent,t=n}return t},_addOverflowMarkers:function(e){var t=this.axes.ortho;null!=t.option("FixedMax")&&(this.pvOverflowMarker=this._addOverflowMarker(!1,t.scale,e)),null!=t.option("FixedMin")&&(this.pvUnderflowMarker=this._addOverflowMarker(!0,t.scale,e))},_addOverflowMarker:function(e,t,n){var r,i=this.isOrientationVertical(),s=i?"bottom":"left",o=this.anchorOpposite(s),u=this.anchorOrthoLength(s),a=this.anchorLength(s),f=this._layoutInfo.paddings,l=e?t.min-f[s]:t.max+f[o];return r=e?i?0:Math.PI/2:i?Math.PI:-Math.PI/2,(new sn.visual.Dot(this,this.pvBar.anchor("center"),{noSelect:!0,noHover:!0,noClick:!0,noDoubleClick:!0,noTooltip:!0,freePosition:!0,extensionId:e?"underflowMarker":"overflowMarker",wrapper:n})).intercept("visible",function(t){var n=this.delegateExtension();if(void 0!==n&&!n)return!1;var r=t.vars.value.value;if(null==r)return!1;var i=this.pvMark.scene.target[this.pvMark.index],o=i[s]+(r>0?i[u]:0);return e?l>o:o>l}).lock(o,null).lock("shapeSize").pvMark.shape("triangle").shapeRadius(function(){return Math.min(Math.sqrt(10),this.scene.target[this.index][a]/2)}).shapeAngle(r).lineWidth(1.5).strokeStyle("red").fillStyle("white")[s](function(){return l+(e?1:-1)*(this.shapeRadius()+2)})},renderInteractive:function(){this.pvPanel.render()},_buildScene:function(e,t,n){function r(t){var r=new sn.visual.Scene(i,{source:t}),s=t.key;r.vars.series=kn.fromComplex(t),u.onNewScene(r,!1),n.forEach(function(t){var n=e.child(t.key),i=n&&n.child(s),a=new sn.visual.Scene(r,{source:i}),f=a.vars.category=kn.fromComplex(n);f.group=n,o.onNewScene(a,!0),u.onNewScene(a,!0)})}var i=new sn.visual.Scene(null,{panel:this,source:e}),s=this.visualRoles,o=new sn.visual.RoleVarHelper(i,s.value,{roleVar:"value",hasPercentSubVar:this.stacked}),u=new sn.visual.RoleVarHelper(i,s.color,{roleVar:"color"});return t.forEach(r),i}}),e.type("pvc.BarAbstract",sn.CategoricalAbstract).init(function(e){this.base(e);var t=this.parent;t&&(this._valueRole=t._valueRole)}).add({_initVisualRoles:function(){this.base(),this._addVisualRole("value",{isMeasure:!0,isRequired:!0,isPercent:this.options.stacked,requireSingleDimension:!0,requireIsDiscrete:!1,valueType:Number,defaultDimension:"value"}),this._valueRole=this.visualRoles.value},_getCategoryRoleSpec:function(){var e=this.base();return e.requireIsDiscrete=!0,e},_initData:function(){this.base.apply(this,arguments);var e=this.data;this._valueDim=e.dimensions(this._valueRole.firstDimensionName())}}),e.type("pvc.BarPanel",sn.BarAbstractPanel).add({}),e.type("pvc.BarChart",sn.BarAbstract).add({_animatable:!0,_trendable:!0,_allowV1SecondAxis:!0,_initPlotsCore:function(){var e=this.options,t=new sn.visual.BarPlot(this),n=t.option("Trend");if(e.plot2){var r=new sn.visual.PointPlot(this,{name:"plot2",fixed:{DataPart:"1"},defaults:{ColorAxis:2,LinesVisible:!0,DotsVisible:!0}});n||(n=r.option("Trend"))}this._trendable=!!n,n&&new sn.visual.PointPlot(this,{name:"trend",fixed:{DataPart:"trend",TrendType:"none",ColorRole:"series",NullInterpolatioMode:"none"},defaults:{ColorAxis:2,LinesVisible:!0,DotsVisible:!1}})},_hasDataPartRole:function(){return!0},_createPlotPanels:function(e,t){var n=this.plots,r=n.bar,i=new sn.BarPanel(this,e,r,Object.create(t));this.barChartPanel=i;var s=n.plot2;if(s){sn.debug>=3&&this._log("Creating Point panel.");var o=new sn.PointPanel(this,e,s,Object.create(t));i.pvSecondLine=o.pvLine,i.pvSecondDot=o.pvDot,o._applyV1BarSecondExtensions=!0}var u=n.trend;u&&(sn.debug>=3&&this._log("Creating Trends Point panel."),new sn.PointPanel(this,e,u,Object.create(t)))}}),e.type("pvc.NormalizedBarPanel",sn.BarAbstractPanel).add({_barVerticalMode:function(){return"expand"}}),e.type("pvc.NormalizedBarChart",sn.BarAbstract).add({_processOptionsCore:function(e){e.stacked=!0,this.base(e)},_getContinuousVisibleExtentConstrained:function(e,t,n){return"ortho"===e.type?{min:0,max:100,minLocked:!0,maxLocked:!0}:this.base(e,t,n)},_initPlotsCore:function(){new sn.visual.NormalizedBarPlot(this)},_createPlotPanels:function(e,t){var n=this.plots.bar;this.barChartPanel=new sn.NormalizedBarPanel(this,e,n,Object.create(t))}}),e.type("pvc.visual.legend.WaterfallBulletGroupScene",sn.visual.legend.BulletGroupScene).init(function(t,n){n=e.set(n,"clickMode","none"),this.base(t,n),this.createItem(n)}).add({renderer:function(e){return null!=e&&(this._renderer=e),this._renderer},itemSceneType:function(){return sn.visual.legend.WaterfallBulletItemScene}}),e.type("pvc.visual.legend.WaterfallBulletItemScene",sn.visual.legend.BulletItemScene).init(function(t,n){this.base.apply(this,arguments);var r=sn.visual.Interactive;this._ibits=r.Interactive|r.ShowsInteraction,this.color=e.get(n,"color"),this.vars.value=new kn(null,e.get(n,"label"))}),e.type("pvc.WaterfallPanel",sn.BarAbstractPanel).add({pvWaterfallLine:null,ruleData:null,_barDifferentialControl:function(){var e=this.chart._isFalling;return function(t){if(e&&!this.index)return 1;var n=t.vars.category.group,r=n._isFlattenGroup&&!n._isDegenerateFlattenGroup;return r?-2:e?-1:1}},_creating:function(){var e=this._getLegendBulletRootScene();if(e){var t=e.firstChild;if(t&&!t.hasRenderer()){var n={drawRule:!0,drawMarker:!1,rulePvProto:new on};this.extend(n.rulePvProto,"line",{constOnly:!0}),t.renderer(new sn.visual.legend.BulletItemDefaultRenderer(n))}}},_createCore:function(){this.base();var n=this.chart,r=this.isOrientationVertical(),i=r?"bottom":"left",s=this.anchorOrtho(i),o=this._buildRuleScene(),u=n.axes.ortho.scale,a=u(0),f=n.axes.ortho.sceneScale({sceneVarName:"value"}),l=n.axes.base.sceneScale({sceneVarName:"category"}),c=n.axes.base.scale,h=this.barWidth/2,p=this.barWidth,d=this.barStepWidth,v=n._isFalling,m=n._waterColor;if(this.plot.option("AreasVisible")){var g=t.Colors.category10(),y=this._buildWaterGroupScene(),b=u.range(),w=.04*(b[1]-b[0]);this.pvWaterfallGroupPanel=(new sn.visual.Panel(this,this.pvPanel,{extensionId:"group"})).lock("data",y.childNodes).pvMark.zOrder(-1).fillStyle(function(){return g(0).alpha(.15)})[s](function(e){var t=e.vars.category;return c(t.valueLeft)-d/2})[this.anchorLength(i)](function(e){var t=e.vars.category,n=Math.abs(c(t.valueRight)-c(t.valueLeft));return n+d})[i](function(e){var t=e.vars.value,r=u(t.valueBottom)-w/2;return n.animate(a,r)})[this.anchorOrthoLength(i)](function(e){var t=e.vars.value,r=u(t.valueTop)-u(t.valueBottom)+w;return n.animate(0,r)})}this.pvBar.sign.override("baseColor",function(e,n){var r=this.base(e,n);return"fill"!==n||e.vars.category.group._isFlattenGroup?r:t.color(r).alpha(.5)}),this.pvWaterfallLine=(new sn.visual.Rule(this,this.pvPanel,{extensionId:"line",noTooltip:!1,noHover:!1,noSelect:!1,noClick:!1,noDoubleClick:!1})).lock("data",o.childNodes).optional("visible",function(e){return v&&!!e.previousSibling||!v&&!!e.nextSibling}).optional(i,function(e){return a+n.animate(0,f(e)-a)}).optional(this.anchorLength(i),d+p).optional(s,v?function(e){return l(e)-d-h}:function(e){return l(e)-h}).override("defaultColor",e.fun.constant(m)).pvMark.antialias(!0).lineCap("butt"),this.plot.option("TotalValuesVisible")&&(this.pvWaterfallLabel=(new sn.visual.Label(this,this.pvWaterfallLine,{extensionId:"lineLabel"})).intercept("visible",function(e){return e.vars.category.group._isFlattenGroup?!1:v||!!e.nextSibling}).pvMark[i](function(e){return a+n.animate(0,f(e)-a)})[this.anchorOrtho(i)](l).textAlign(r?"center":"left").textBaseline(function(e){if(!r)return"middle";var t=e.vars.direction;if(null==t)return"bottom";var n=!v;return n===("up"===t)?"bottom":"top"}).textStyle(t.Color.names.darkgray.darker(2)).textMargin(5).text(function(e){return e.vars.value.label}))},_buildRuleScene:function(){function t(e){var t=e.group,n=new sn.visual.Scene(s,{source:t}),r=n.vars.category=kn.fromComplex(t);r.group=t;var i=e.offset;n.vars.value=new kn(i,this.chart._valueDim.format(i))}function n(e,t){var n=e.vars.value.value;e.vars.direction=t&&r!==n?i===n>r?"up":"down":null,r=n}var r,i,s=new sn.visual.Scene(null,{panel:this,source:this.visibleData({ignoreNulls:!1})}),o=this.chart._ruleInfos;if(o){o.forEach(t,this);var u=e.query(s.childNodes);i=!this.chart._isFalling,i||(u=u.reverse()),u.each(n,this)}return s},_buildWaterGroupScene:function(){function t(e,r){var i=e.children().where(function(e){return""!==e.key});if(i.next()){r&&n(e,r),r++;do t(i.item,r);while(i.next())}}function n(e,t){var n=new sn.visual.Scene(f,{source:e}),u=n.vars.category=kn.fromComplex(e);u.group=e,u.level=t;var a,l,c,h,p,d=n.vars.value={},v=s[e.absKey],m=v.offset,g=v.range,y=-g.min+g.max;o?(a=i(e),l=s[a.absKey],c=v.group.value,h=l.group.value,p=m-g.max):(a=r(e),l=s[a.absKey],c=l.group.value,h=v.group.value,p=m-g.max),u.valueLeft=c,u.valueRight=h,d.valueHeight=y,d.valueBottom=p,d.valueTop=p+y}function r(e){var t=e.childNodes,n=t&&t[0];return n?r(n):e}function i(e){var t=e.childNodes,n=t&&t[t.length-1];return n?i(n):e}var s,o,u=this.chart,a=u._catRole.select(u.partData(this.dataPartValue),{visible:!0}),f=new sn.visual.Scene(null,{panel:this,source:a}),l=u._ruleInfos;return l&&(s=e.query(l).object({name:function(e){return e.group.absKey}}),o=u._isFalling,t(a,0)),f}}),e.type("pvc.WaterfallChart",sn.BarAbstract).init(function(e){this.base(e);var t=this.parent;t&&(this._isFalling=t._isFalling)}).add({_animatable:!0,_isFalling:!0,_ruleInfos:null,_waterColor:t.color("#1f77b4").darker(),_processOptionsCore:function(e){e.stacked=!0,e.baseAxisComposite=!1,this.base(e),e.plot2=!1},_initPlotsCore:function(){var e=new sn.visual.WaterfallPlot(this);this._isFalling="down"===e.option("Direction");var t=this._isFalling?"FlattenDfsPre":"FlattenDfsPost";this._catRole.setTraversalMode(sn.visual.TraversalMode[t]),this._catRole.setRootLabel(e.option("AllCategoryLabel"))},_initLegendScenes:function(e){var n=this.plots.water,r=sn.makeExtensionAbsId("line",n.extensionPrefixes),i=this._getConstantExtension(r,"strokeStyle");i&&(this._waterColor=t.color(i));var s=e._getBulletRootScene();new sn.visual.legend.WaterfallBulletGroupScene(s,{extensionPrefix:sn.buildIndexedId("",1),label:n.option("TotalLineLabel"),color:this._waterColor}),this.base(e)},_reduceStackedCategoryValueExtent:function(e,t,n){var r,i=e?e.offset:0,s=t.min+t.max;if(!e)return t?(r=i+s,this._ruleInfos=[{offset:r,group:n,range:t}],{min:t.min,max:t.max,offset:r}):null;var o=this._isFalling,u=n._isFlattenGroup&&!n._isDegenerateFlattenGroup;if(u){var a=-t.min;if(a>0){var f=i+a;f>e.max&&(e.max=f)}var l=-t.max;if(0>l){var c=i+l;c<e.min&&(e.min=c)}}else{var h=o?-1:1;r=e.offset=i+h*s,r>e.max?e.max=r:r<e.min&&(e.min=r)}return this._ruleInfos.push({offset:o?i:e.offset,group:n,range:t}),e},_createPlotPanels:function(t,n){this.wfChartPanel=new sn.WaterfallPanel(this,t,this.plots.water,e.create(n,{waterfall:this.options.waterfall}))}}),e.type("pvc.PointPanel",sn.CategoricalAbstractPanel).init(function(e,t,n,r){this.base(e,t,n,r),this.linesVisible=n.option("LinesVisible"),this.dotsVisible=n.option("DotsVisible"),this.areasVisible=n.option("AreasVisible"),!this.linesVisible&&!this.dotsVisible&&!this.areasVisible&&(this.linesVisible=!0,n.option.specify({LinesVisible:!0})),this.visualRoles.value=e.visualRole(n.option("OrthoRole"))}).add({pvLine:null,pvArea:null,pvDot:null,pvLabel:null,pvScatterPanel:null,_creating:function(){var n=this.defaultLegendGroupScene();if(n&&!n.hasRenderer()){var r=n.colorAxis,i=e.nullyTo(r.option("LegendDrawMarker",!0),this.dotsVisible||this.areasVisible),s=!i||e.nullyTo(r.option("LegendDrawLine",!0),this.linesVisible&&!this.areasVisible);if(i||s){var o={drawMarker:i,drawRule:s};if(i){var u=r.option("LegendShape",!0);this.dotsVisible?(u||(u="circle"),o.markerPvProto=(new t.Dot).lineWidth(1.5,sn.extensionTag).shapeSize(12,sn.extensionTag)):o.markerPvProto=new on,o.markerShape=u,this._applyV1BarSecondExtensions&&this.chart.extend(o.markerPvProto,"barSecondDot",{constOnly:!0}),this.extend(o.markerPvProto,"dot",{constOnly:!0})}s&&(o.rulePvProto=(new t.Line).lineWidth(1.5,sn.extensionTag),this._applyV1BarSecondExtensions&&this.chart.extend(o.rulePvProto,"barSecondLine",{constOnly:!0}),this.extend(o.rulePvProto,"line",{constOnly:!0})),n.renderer(new sn.visual.legend.BulletItemDefaultRenderer(o))}}},_createCore:function(){this.base();var n=this,r=this.chart,i=this.stacked,s=this.dotsVisible,o=this.areasVisible,u=this.linesVisible,a=this.isOrientationVertical()?"bottom":"left",f=this.axes.base,l=f.domainItems(),c=f.role.grouping.isDiscrete(),h=this.visibleData({ignoreNulls:!1}),p=this._buildScene(h,l,c);o?this.pvPanel.zOrder(-7):this.pvPanel.zOrder(1),this.pvScatterPanel=(new sn.visual.Panel(this,this.pvPanel,{extensionId:"panel"})).lock("data",p.childNodes).pvMark;var d,v=o&&u&&!i?.5:null;this.compatVersion()<=1&&(d=i?function(e){return function(t){return e.call(this,t.vars.value.rawValue)}}:function(e){return function(t){var n={category:t.vars.category.rawValue,value:t.vars.value.rawValue},r=Object.create(this);return r.index=t.dataIndex,e.call(r,n)}});var m=c&&i?function(e){return!e.isNull||e.isIntermediate}:function(e){return!e.isNull},g=r.selectableByFocusWindow();this.pvArea=(new sn.visual.Area(this,this.pvScatterPanel,{extensionId:"area",noTooltip:!1,wrapper:d,noSelect:g,noRubberSelect:!0,showsSelection:!g})).lockMark("data",function(e){return e.childNodes}).lockMark("visible",m).override("x",function(e){return e.basePosition}).override("y",function(e){return e.orthoPosition}).override("dy",function(e){return r.animate(0,e.orthoLength)}).override("color",function(e,t){return o?this.base(e,t):null}).override("baseColor",function(e,t){var n=this.base(e,t);return!this._finished&&n&&null!=v&&(n=n.alpha(v)),n}).override("dimColor",function(e,t){return i?sn.toGrayScale(e,1,null,null).brighter():this.base(e,t)}).lock("events",o?"painted":"none").pvMark;var y=s&&!u&&!o,b=i&&o,w=["line"];this._applyV1BarSecondExtensions&&w.push({abs:"barSecondLine"});var E=!y&&m,S=o&&!u;this.pvLine=(new sn.visual.Line(this,this.pvArea.anchor(this.anchorOpposite(a)),{extensionId:w,freePosition:!0,wrapper:d,noTooltip:S,noDoubleClick:S,noClick:S,noHover:S,noSelect:S||g,showsSelection:!g})).lockMark("visible",E).override("defaultColor",function(e,t){var n=this.base(e,t);return!this._finished&&b&&n&&(n=n.darker(.6)),n}).override("normalColor",function(e,t){return u?t:null}).override("interactiveColor",function(e,t,n){return u||this.mayShowAnySelected(e)||this.mayShowActive(e)?this.base(e,t,n):null}).override("baseStrokeWidth",function(e){var t;return u&&(t=this.base(e)),null==t?1.5:t}).intercept("strokeDasharray",function(e){var t=this.delegateExtension();if(void 0===t){var n=e.isInterpolated;if(!n){var r=e.nextSibling;n=r&&r.isIntermediate&&r.isInterpolated;if(!n){var i=e.previousSibling;n=i&&e.isIntermediate&&i.isInterpolated}}t=n?". ":null}return t}).pvMark;var x=!(o&&c&&i);w=["dot"],this._applyV1BarSecondExtensions&&w.push({abs:"barSecondDot"}),this.pvDot=(new sn.visual.Dot(this,this.pvLine,{extensionId:w,freePosition:!0,wrapper:d})).intercept("visible",function(e){return!e.isNull&&!e.isIntermediate&&this.delegateExtension(!0)}).override("color",function(e,n){if(!s){var r=e.isActive||!x&&e.isSingle||x&&e.isAlone;if(!r)return sn.invisibleFill}var i=this.base(e,n);return e.isInterpolated&&"fill"===n?i&&t.color(i).brighter(.5):i}).override("defaultColor",function(e,t){var n=this.base(e,t);return!this._finished&&b&&n&&(n=n.darker(.6)),n}).override("baseSize",function(t){if(!s){var r=t.isActive||!x&&t.isSingle||x&&t.isAlone;if(r&&!t.isActive){var i=Math.max(n.pvLine.lineWidth(),.2)/2;return e.sqr(i)}}return t.isInterpolated?.8*this.base(t):this.base(t)}).pvMark;var T=sn.visual.ValueLabel.maybeCreate(this,this.pvDot,{wrapper:d});T&&(this.pvLabel=T.pvMark)},renderInteractive:function(){this.pvScatterPanel.render()},_buildScene:function(t,n,r){function i(e){for(var t,n=[],r=e.childNodes,i=0,u=null,a=0,f=0,l=r.length;l>a;a++,f++){var c=r[f],p=2*a;n[p]=c,s.call(this,t,c,S&&S[p]),c.isAlone&&!u&&(u=c),c.isNull||i++;if(t){var d=o.call(this,e,t,c,f,S&&S[p-1]);d&&(n[p-1]=d,f++)}t=c}1===i&&u&&1===l&&(u.isSingle=!0),h&&(S=n)}function s(e,t,n){var i=t.vars.value.accValue;n&&(t.isNull&&!r?i=b:i+=n.vars.value.accValue,t.vars.value.accValue=i),t.basePosition=E(t),t.orthoPosition=w,t.orthoLength=y(i)-w;var s=!e||e.isNull,o=s&&!t.isNull;if(o){var u=t.nextSibling;o=!u||u.isNull}t.isAlone=o,t.isSingle=!1}function o(e,t,n,i,s){var o=t.isNull||n.isNull;if(o&&!this.areasVisible)return null;var u,a,f;if(o){if(s&&r){var l=s.vars.value;a=l.accValue,u=l[c.name]}else u=a=b;f=h&&r?n.basePosition-E.range().step/2:t.isNull?n.basePosition:t.basePosition}else{var p=t.vars.value,v=n.vars.value;u=(v.value+p.value)/2,a=(v.accValue+p.accValue)/2,f=(n.basePosition+t.basePosition)/2}var g=new sn.visual.Scene(e,{index:i,source:n.source});g.dataIndex=n.dataIndex,g.vars.category=n.vars.category;var S=new kn(u,m.format(u),u);return S.accValue=a,g.vars.value=S,g.ownerScene=n,g.isInterpolated=n.isInterpolated,g.isIntermediate=!0,g.isSingle=!1,g.isNull=o,g.isAlone=o&&n.isNull&&t.isNull,g.basePosition=f,g.orthoPosition=w,g.orthoLength=y(a)-w,d.onNewScene(g,!0),g}function u(e){for(var t,n,r=e.childNodes,i=r.length;i&&(t=r[0]).isNull;){n=t.nextSibling;if(n&&!n.isNull)break;e.removeAt(0),i--}for(;i&&(t=r[i-1]).isNull;){n=t.previousSibling;if(n&&!n.isNull)break;e.removeAt(i-1),i--}}var a=new sn.visual.Scene(null,{panel:this,source:t}),f=this.chart,l=this.visualRoles.series,c=this.visualRoles.value,h=this.stacked,p=new sn.visual.RoleVarHelper(a,c,{roleVar:"value",hasPercentSubVar:h}),d=new sn.visual.RoleVarHelper(a,this.visualRoles.color,{roleVar:"color"}),v=c.firstDimensionName(),m=t.owner.dimensions(v),g=l.isBound()?l.flatten(this.partData(),{visible:!0,isNull:f.options.ignoreNulls?!1:null}):null,y=this.axes.ortho.scale,b=e.scope(function(){var e=y.domain(),t=e[0],n=e[1];return t*n>=0?t>=0?t:n:0}),w=y(b),E=this.axes.base.sceneScale({sceneVarName:"category"});(g?g.children():e.query([null])).each(function(r){var i=new sn.visual.Scene(a,{source:r||t});i.vars.series=kn.fromComplex(r),d.onNewScene(i,!1),n.forEach(function(n,s){var o=t.child(n.key),u=o;u&&r&&(u=u.child(r.key));var a=new sn.visual.Scene(i,{source:u});a.dataIndex=s,a.vars.category=kn.fromComplex(o),p.onNewScene(a,!0);var f=a.vars.value,l=f.value;f.accValue=null!=l?l:b,d.onNewScene(a,!0);var c=null!=u&&u.datums().prop("isInterpolated").any(e.truthy);a.isInterpolated=c,a.isNull=null==l,a.isIntermediate=!1},this)},this);var S,x=a.children().reverse().array();return x.forEach(i,this),x.forEach(u,this),a}}),e.type("pvc.PointAbstract",sn.CategoricalAbstract).add({_animatable:!0,_trendable:!0,_processOptionsCore:function(e){e.panelSizeRatio=1,this.base(e)},_hasDataPartRole:function(){return!0},_initVisualRoles:function(){this.base(),this._addVisualRole("value",{isMeasure:!0,isRequired:!0,isPercent:this.options.stacked,requireSingleDimension:!0,requireIsDiscrete:!1,valueType:Number,defaultDimension:"value"})},_initPlotsCore:function(){var e=this.options,t=this._createPointPlot(),n=t.option("Trend");if(e.plot2){var r=new sn.visual.PointPlot(this,{name:"plot2",fixed:{DataPart:"1"},defaults:{ColorAxis:2,LinesVisible:!0,DotsVisible:!0}});n||(n=r.option("Trend"))}this._trendable=!!n,n&&new sn.visual.PointPlot(this,{name:"trend",fixed:{DataPart:"trend",TrendType:"none",ColorRole:"series",NullInterpolatioMode:"none"},defaults:{ColorAxis:2,LinesVisible:!0,DotsVisible:!1}})},_initAxes:function(e){this.base(e);var t=this.axesByType.base;t&&t.forEach(function(e){var t="discrete"===e.scaleType;t||e.option.defaults({Offset:.01})}),t=this.axesByType.ortho,t&&t.forEach(function(e){e.option.defaults({Offset:.04})})},_createPlotPanels:function(e,t){var n=this.plots,r=n.point;this.scatterChartPanel=new sn.PointPanel(this,e,r,Object.create(t));var i=n.plot2;i&&(sn.debug>=3&&this._log("Creating second Point panel."),new sn.PointPanel(this,e,i,Object.create(t)));var s=n.trend;s&&(sn.debug>=3&&this._log("Creating Trends Point panel."),new sn.PointPanel(this,e,s,Object.create(t)))},defaults:{tooltipOffset:10}}),e.type("pvc.DotChart",sn.PointAbstract).add({_createPointPlot:function(){return new sn.visual.PointPlot(this,{fixed:{DotsVisible:!0}})}}),e.type("pvc.LineChart",sn.PointAbstract).add({_createPointPlot:function(){return new sn.visual.PointPlot(this,{fixed:{LinesVisible:!0}})}}),e.type("pvc.AreaChart",sn.PointAbstract).add({_createPointPlot:function(){return new sn.visual.PointPlot(this,{fixed:{AreasVisible:!0}})}}),sn.mStackedLineChart=e.type("pvc.StackedLineChart",sn.PointAbstract).add({_createPointPlot:function(){return new sn.visual.PointPlot(this,{fixed:{LinesVisible:!0,Stacked:!0}})}}),e.type("pvc.StackedDotChart",sn.PointAbstract).add({_createPointPlot:function(){return new sn.visual.PointPlot(this,{fixed:{DotsVisible:!0,Stacked:!0}})}}),sn.mStackedAreaChart=e.type("pvc.StackedAreaChart",sn.PointAbstract).add({_createPointPlot:function(){return new sn.visual.PointPlot(this,{fixed:{AreasVisible:!0,Stacked:!0},defaults:{LinesVisible:!0}})}}),e.type("pvc.HeatGridPanel",sn.CategoricalAbstractPanel).init(function(e,t,n,r){this.base(e,t,n,r),this.axes.size=e._getAxis("size",n.option("SizeAxis")-1);var i=this.visualRoles,s=n.option("SizeRole");i.size=e.visualRole(s),this.useShapes=n.option("UseShapes"),this.shape=n.option("Shape"),this.nullShape=n.option("NullShape")}).add({defaultBorder:1,nullBorder:2,selectedBorder:2,_createCore:function(){var t=this;t.base();var n=t._calcCellSize(),r=t.isOrientationVertical()?"bottom":"left",i=sn.BasePanel.relativeAnchor[r],s=sn.BasePanel.parallelLength[r],o=sn.BasePanel.orthogonalLength[r],u=t.visualRoles.series.flatten(t.partData(),{visible:!0,isNull:t.chart.options.ignoreNulls?!1:null}),a=t._buildScene(t.visibleData({ignoreNulls:!1}),u,n),f=a.isColorBound,l=a.isSizeBound,c=t._buildSignsWrapper(a),h=t.compatVersion()<=1,p=this.axes.base.scale,d=this.axes.ortho.scale,v=p.range().step,m=d.range().step,g=v/2,y=m/2,b=(new sn.visual.Panel(t,t.pvPanel)).pvMark.data(a.childNodes)[r](function(e){return d(e.vars.series.value)-y})[o](m),w=["panel"];h&&w.push("");var E={extensionId:w,wrapper:c};if(!t.useShapes){var S=!1;e.copy(E,{noSelect:S,noHover:S,noClick:S,noDoubleClick:S,freeColor:S,noTooltip:h})}t.pvHeatGrid=(new sn.visual.Panel(t,b,E)).pvMark.lock("data",function(e){return e.childNodes}).lock(i,function(e){return p(e.vars.category.value)-g}).lock(s,v).antialias(!1),t.shapes=t.useShapes?t._createShapesHeatMap(n,c,f,l):t._createNoShapesHeatMap(f),t.valuesVisible&&!t.valuesMask&&(t.valuesMask=t._getDefaultValuesMask(f,l));var x=sn.visual.ValueLabel.maybeCreate(t,t.pvHeatGrid,{wrapper:c});x&&(t.pvHeatGridLabel=x.pvMark)},_calcCellSize:function(){var e=this.axes.x.scale,t=this.axes.y.scale,n=(e.max-e.min)/e.domain().length,r=(t.max-t.min)/t.domain().length;if(!this.isOrientationVertical()){var i=n;n=r,r=i}return{width:n,height:r}},_buildSignsWrapper:function(t){if(this.compatVersion()>1)return null;var n=e.query(t.childNodes).object({name:function(e){return""+e.vars.series.value},value:function(t){return e.query(t.childNodes).object({name:function(e){return""+e.vars.category.value},value:function(e){var t=e.vars.color;return t?""+t.value:null}})}});return function(e){return function(t){var r=n[t.vars.series.value],i=t.vars.category.rawValue,s=Object.create(this.parent),o=Object.create(this);o.parent=s;var u=t.childIndex(),a=t.parent.childIndex();return s.index=u,o.index=a,e.call(o,r,i)}}},_getDefaultValuesMask:function(e,t){var n=this.visualRoles,r=e?"color":t?"size":null;if(r){var i=n[r].firstDimensionName();return"{#"+i+"}"}},_createNoShapesHeatMap:function(e){var t=this._buildGetBaseFillColor(e);return this.pvHeatGrid.sign.override("defaultColor",function(e,n){return"stroke"===n?null:t.call(this.pvMark,e)}).override("interactiveColor",function(e,t,n){return e.isActive?t.alpha(.6):e.anySelected()&&!e.isSelected()?this.dimColor(t,n):this.base(e,t,n)}).override("dimColor",function(e){return sn.toGrayScale(e,.6)}).pvMark.lineWidth(1.5)},_buildGetBaseFillColor:function(t){var n=this.axes.color;return t?n.sceneScale({sceneVarName:"color"}):e.fun.constant(n.option("Unbound"))},_createShapesHeatMap:function(t,n,r,i){var s=this,o=s._calcDotAreaRange(t);i&&s.axes.size.setScaleRange(o);var u={extensionId:"dot",freePosition:!0,activeSeriesAware:!1,wrapper:n,tooltipArgs:s._buildShapesTooltipArgs(r,i)},a=(new sn.visual.DotSizeColor(s,s.pvHeatGrid,u)).override("dimColor",function(e){return sn.toGrayScale(e,.6)}).pvMark;return i||a.sign.override("defaultSize",e.fun.constant(o.max)),a},_calcDotAreaRange:function(t){var n=t.width,r=t.height,i=Math.min(n,r)/2;"diamond"===this.shape&&(i/=Math.SQRT2),i-=2;var s=e.sqr(i),o=12,u=s-o;return 1>=u&&(s=Math.max(s,2),o=1,u=s-o,sn.debug>=2&&this._warn("Using rescue mode dot area calculation due to insufficient space.")),{min:o,max:s,span:u}},_buildShapesTooltipArgs:function(e,t){var n=this.chart;if(this.compatVersion()<=1&&this.showsTooltip()){var r=n.options,i=r.customTooltip;i||(i=function(e,t,n){return null!=n&&void 0!==n[0]?n.join(", "):n});var s=this.visualRoles,o=s.series.grouping.dimensionNames(),u=s.category.grouping.dimensionNames();return{buildTooltip:r.isMultiValued?function(n){var s=n.scene.group;if(!s)return"";var a=sn.data.Complex.values(s,o),f=sn.data.Complex.values(s,u),l=[],c=n.scene.vars;return t&&(l[r.sizeValIdx||0]=c.size.value),e&&(l[r.colorValIdx||0]=c.color.value),i.call(r,a,f,l)}:function(t){var n=t.scene.vars,s=n.series.rawValue,o=n.category.rawValue,u=n[e?"color":"size"],a=u?u.value:null;return i.call(r,s,o,a)}}}},renderInteractive:function(){this.pvPanel.render()},_buildScene:function(e,t,n){function r(e){var t=new sn.visual.Scene(o,{source:e});t.vars.series=kn.fromComplex(e),u.forEach(function(n){i.call(s,t,n,e)})}function i(t,n,r){var i=e.child(n.key).child(r.key),s=new sn.visual.Scene(t,{source:i});s.vars.category=kn.fromComplex(n),f.onNewScene(s,!0),l.onNewScene(s,!0)}var s=this,o=new sn.visual.Scene(null,{panel:s,source:e}),u=e.childNodes,a=s.visualRoles,f=new sn.visual.RoleVarHelper(o,a.color,{roleVar:"color"}),l=new sn.visual.RoleVarHelper(o,a.size,{roleVar:"size"});return o.cellSize=n,t.children().each(r),o}}),e.type("pvc.HeatGridChart",sn.CategoricalAbstract).add({_allowColorPerCategory:!0,_interpolatable:!1,_axisCreateIfUnbound:{color:!0},_processOptionsCore:function(t){this.base(t),e.set(t,"legend",!1,"panelSizeRatio",1);var n="value",r="value2";if(this.compatVersion()<=1){switch(this.options.colorValIdx){case 0:n="value";break;case 1:n="value2";break;default:n="value"}switch(this.options.sizeValIdx){case 0:r="value";break;case 1:r="value2";break;default:r="value"}}this._colorDimName=n,this._sizeDimName=r},_getCategoryRoleSpec:function(){var e=this.base();return e.requireIsDiscrete=!0,e},_getColorRoleSpec:function(){return{isMeasure:!0,requireSingleDimension:!0,requireIsDiscrete:!1,valueType:Number,defaultDimension:this._colorDimName}},_initVisualRoles:function(){this.base(),this._addVisualRole("size",{isMeasure:!0,requireSingleDimension:!0,requireIsDiscrete:!1,valueType:Number,defaultDimension:this._sizeDimName})},_initPlotsCore:function(){new sn.visual.HeatGridPlot(this)},_createPlotPanels:function(e,t){var n=this.plots.heatGrid;this.heatGridChartPanel=new sn.HeatGridPanel(this,e,n,Object.create(t))},defaults:{colorValIdx:0,sizeValIdx:1,measuresIndexes:[2],axisOffset:0,plotFrameVisible:!1,colorNormByCategory:!0,numSD:2}}),e.type("pvc.MetricXYAbstract",sn.CartesianAbstract).add({_processOptionsCore:function(e){this.base(e),e.panelSizeRatio=1},_initVisualRoles:function(){this.base(),this._addVisualRole("x",{isMeasure:!0,isRequired:!0,requireSingleDimension:!0,requireIsDiscrete:!1,defaultDimension:"x",dimensionDefaults:{valueType:this.options.timeSeries?Date:Number}}),this._addVisualRole("y",{isMeasure:!0,isRequired:!0,requireSingleDimension:!0,requireIsDiscrete:!1,defaultDimension:"y",dimensionDefaults:{valueType:Number}})},_generateTrendsDataCell:function(t,n,r){function i(n){var r=function(e){return e.atoms[l].value},i=function(e){return e.atoms[c].value},s=n.datums().sort(null,r).array(),o=e.create(a,{rows:e.query(s),x:r,y:i}),u=f.model(o);u&&s.forEach(function(s,o){var f=r(s);if(f){var v=u.sample(f,i(s),o);if(null!=v){var m=e.set(Object.create(n.atoms),l,f,c,v,d,p);t.push(new sn.data.TrendDatum(h.owner,m,a))}}})}var s=this._serRole,o=this.visualRoles.x,u=n.role,a=n.trend,f=a.info;this._warnSingleContinuousValueRole(u);var l=o.firstDimensionName(),c=u.firstDimensionName(),h=this.visibleData(n.dataPartValue,{baseData:r}),p=this._getTrendDataPartAtom(),d=p.dimension.name;(s.isBound()?h.children():e.query([h])).each(i,this)}}),e.type("pvc.data.MetricPointChartTranslationOper").add({_meaLayoutRoles:["x","y","color","size"],configureType:function(){var e=[],t=[];this.collectFreeDiscreteAndConstinuousIndexes(t,e);var n,r=[],i=e.length;if(i>0){for(var s=this._meaLayoutRoles.length,o=0;s>o&&r.length<i;)this._getUnboundRoleDefaultDimNames(this._meaLayoutRoles[o],1,r),o++;n=r.length,n>0&&(e.length=n,this.defReader({names:r,indexes:e}))}i=t.length,i>0&&(r.length=0,this._getUnboundRoleDefaultDimNames("series",i,r),n=r.length,n>0&&(t.length=n,this.defReader({names:r,indexes:t})))}}),e.type("pvc.MetricPointPanel",sn.CartesianAbstractPanel).init(function(e,t,n,r){this.base(e,t,n,r),this.axes.size=e._getAxis("size",(n.option("SizeAxis")||0)-1);var i=n.option("SizeRole");this.visualRoles.size=i?e.visualRole(i):null,this.linesVisible=n.option("LinesVisible"),this.dotsVisible=n.option("DotsVisible"),!this.linesVisible&&!this.dotsVisible&&(this.linesVisible=!0,n.option.specify({LinesVisible:!0})),this.offsetPaddings||(this.offsetPaddings=new fn(.01))}).add({sizeAxisRatio:.2,sizeAxisRatioTo:"minWidthHeight",autoPaddingByDotSize:!0,_v1DimRoleName:{category:"x",value:"y"},_creating:function(){var n=this.defaultLegendGroupScene();if(n&&!n.hasRenderer()){var r=n.colorAxis,i=e.nullyTo(r.option("LegendDrawMarker",!0),this.dotsVisible),s=e.nullyTo(r.option("LegendDrawLine",!0),this.linesVisible);if(i||s){var o={drawMarker:i,drawRule:s};i&&(o.markerShape=r.option("LegendShape",!0)||"circle",o.markerPvProto=(new t.Dot).lineWidth(1.5,sn.extensionTag).shapeSize(12,sn.extensionTag),this.extend(o.markerPvProto,"dot",{constOnly:!0})),s&&(o.rulePvProto=(new t.Line).lineWidth(1.5,sn.extensionTag),this.extend(o.rulePvProto,"line",{constOnly:!0})),n.renderer(new sn.visual.legend.BulletItemDefaultRenderer(o))}}},_getRootScene:function(){return e.lazy(this,"_rootScene",this._buildScene,this)},_calcLayout:function(e){var t=this._getRootScene();t.isSizeBound&&this.axes.size.setScaleRange(this._calcDotAreaRange(e)),this._calcAxesPadding(e,t)},_getDotDiameterRefLength:function(t){var n=t.clientSize,r=t.paddings;switch(this.sizeAxisRatioTo){case"minWidthHeight":return Math.min(n.width+r.width,n.height+r.height);case"width":return n.width+r.width;case"height":return n.height+r.height}return sn.debug>=2&&this._log(e.format("Invalid option 'sizeAxisRatioTo' value. Assuming 'minWidthHeight'.",[this.sizeAxisRatioTo])),this.sizeRatioTo="minWidthHeight",this._getDotDiameterRefLength(t)},_calcDotRadiusRange:function(e){var t=this._getDotDiameterRefLength(e),n=this.sizeAxisRatio/2*t,r=Math.sqrt(12);return{min:r,max:n}},_calcDotAreaRange:function(t){var n=this._calcDotRadiusRange(t);"diamond"===this.shape&&(n.max/=Math.SQRT2,n.min/=Math.SQRT2);var r=e.sqr(n.max),i=e.sqr(n.min),s=r-i;return 1>=s&&(r=Math.max(r,2),i=1,s=r-i,sn.debug>=3&&this._log("Using rescue mode dot area calculation due to insufficient space.")),{min:i,max:r,span:s}},_calcAxesPadding:function(t,n){var r;if(this.autoPaddingByDotSize){var i=this.axes,s=t.clientSize,o=t.paddings;r={},i.x.setScaleRange(s.width),i.y.setScaleRange(s.height);var u=this.isOrientationVertical(),a=i.x.sceneScale({sceneVarName:u?"x":"y"}),f=i.y.sceneScale({sceneVarName:u?"y":"x"}),l=i.x.scale.max,c=i.y.scale.max,h=n.isSizeBound,p=h?i.size.scale:null;if(!p){var d=e.number.as(this._getExtension("dot","shapeRadius"),0);0>=d?(d=e.number.as(this._getExtension("dot","shapeSize"),0),0>=d&&(d=12)):d=e.sqr(d),p=e.fun.constant(d)}r={};var v;this.offsetPaddings&&(v={},fn.names.forEach(function(e){var t=sn.BasePanel.orthogonalLength[e];v[e]=(this.offsetPaddings[e]||0)*(s[t]+o[t])},this));var m=function(e,t){v&&(t+=v[e]||0),0>t&&(t=0);var n=r[e];(null==n||t>n)&&(r[e]=t)},g=function(e){var t=a(e),n=f(e),r=Math.sqrt(p(h?e.vars.size.value:0));m("left",r-t),m("bottom",r-n),m("right",t+r-l),m("top",n+r-c)};n.children().selectMany(function(e){return e.childNodes}).each(g)}else r=this._calcRequestPaddings(t);t.requestPaddings=r},_createCore:function(){var t=this;t.base();var n=t.chart,r=t._getRootScene(),i=t._buildSignsWrapper(),s=t.compatVersion()<=1;this._finalizeScene(r),t.pvPanel.zOrder(1),this.pvScatterPanel=(new sn.visual.Panel(t,t.pvPanel,{extensionId:"panel"})).lock("data",r.childNodes).pvMark;var o=n.selectableByFocusWindow(),u=r.isColorBound&&this.visualRoles.color.isDiscrete(),a=(new sn.visual.Line(t,t.pvScatterPanel,{extensionId:"line",wrapper:i,noTooltip:!1,noSelect:o,showsSelection:!o})).lockMark("data",function(e){return e.childNodes}).intercept("visible",function(e){if(!t.linesVisible)return!1;var n=this.delegateExtension();return null==n&&(n=!e.isNull&&(!r.isSizeBound&&!r.isColorBound||r.isSizeBound&&null!=e.vars.size.value||r.isColorBound&&(u||null!=e.vars.color.value))),n}).override("x",function(e){return e.basePosition}).override("y",function(e){return e.orthoPosition});t.pvLine=a.pvMark;var f=(new sn.visual.DotSizeColor(t,t.pvLine,{extensionId:"dot",wrapper:i,activeSeriesAware:t.linesVisible})).override("x",function(e){return e.basePosition}).override("y",function(e){return e.orthoPosition}).override("color",function(e,n){return t.dotsVisible||e.isActive||e.isSingle?this.base(e,n):sn.invisibleFill});r.isSizeBound?t.autoPaddingByDotSize&&"minWidthHeight"===t.sizeAxisRatioTo||t.pvPanel.borderPanel.overflow("hidden"):f.override("baseSize",function(n){if(!t.dotsVisible&&n.isSingle){var r=Math.max(t.pvLine.scene[this.pvMark.index].lineWidth,.2)/2;return e.sqr(r)}return this.base(n)}),t.pvDot=f.pvMark,t.pvDot.rubberBandSelectionMode="center";if(sn.visual.ValueLabel.isNeeded(t)){var l=["label"];s&&l.push("lineLabel");var c=sn.visual.ValueLabel.maybeCreate(t,t.pvDot,{extensionId:l,wrapper:i});c&&(t.pvHeatGridLabel=c.pvMark)}},_buildSignsWrapper:function(){return this.compatVersion()>1?null:function(e){return function(t){var n={category:t.vars.x.rawValue,value:t.vars.y.rawValue},r=Object.create(this);return r.index=t.dataIndex,e.call(r,n)}}},renderInteractive:function(){this.pvScatterPanel.render()},_buildScene:function(){function e(e){var t=new sn.visual.Scene(i,{source:e});t.vars.series=kn.fromComplex(e),o.onNewScene(t,!1),e.datums().each(function(e,n){var r=e.atoms[a.name];if(null!=r.value){var i=e.atoms[f.name];if(null!=i.value){var s=new sn.visual.Scene(t,{source:e});s.dataIndex=n,s.vars.x=kn.fromAtom(r),s.vars.y=kn.fromAtom(i),u.onNewScene(s,!0),o.onNewScene(s,!0),s.isIntermediate=!1}}})}function t(e){for(var t,r=e.childNodes,i=0,s=0,o=r.length;o>i;i++,s++){var u=r[s];u.isSingle=!t&&!u.nextSibling;if(t){var a=n(e,t,u,s);a&&s++}t=u}}function n(e,t,n,r){var i=+n.vars.y.value,s=+t.vars.y.value,l=+n.vars.x.value,c=+t.vars.x.value,h=f.type.cast.call(null,(i+s)/2),p=a.type.cast.call(null,(l+c)/2),d=new sn.visual.Scene(e,{index:r,source:n.datum});return d.dataIndex=n.dataIndex,d.vars.x=new kn(p,a.format(p),p),d.vars.y=new kn(h,f.format(h),h),u.onNewScene(d,!0),o.onNewScene(d,!0),d.ownerScene=n,d.isIntermediate=!0,d.isSingle=!1,d}var r=this.visibleData({ignoreNulls:!1}),i=new sn.visual.Scene(null,{panel:this,source:r}),s=this.visualRoles,o=new sn.visual.RoleVarHelper(i,s.color,{roleVar:"color"}),u=new sn.visual.RoleVarHelper(i,s.size,{roleVar:"size"}),a=r.owner.dimensions(s.x.firstDimensionName()),f=r.owner.dimensions(s.y.firstDimensionName());return r.children().each(e,this),i.children().each(t,this),i},_finalizeScene:function(e){var t=this.axes,n=t.base.sceneScale({sceneVarName:"x"}),r=t.ortho.sceneScale({sceneVarName:"y"});return e.children().selectMany(function(e){return e.childNodes}).each(function(e){e.basePosition=n(e),e.orthoPosition=r(e)}),e}}),e.type("pvc.MetricPointAbstract",sn.MetricXYAbstract).add({_trendable:!0,_initPlotsCore:function(){var e=this._createPointPlot(),t=e.option("Trend");(this._trendable=!!t)&&new sn.visual.MetricPointPlot(this,{name:"trend",fixed:{DataPart:"trend",TrendType:"none",NullInterpolatioMode:"none",ColorRole:"series",SizeRole:null,SizeAxis:null,OrthoAxis:1},defaults:{ColorAxis:2,LinesVisible:!0,DotsVisible:!1}})},_hasDataPartRole:function(){return!0},_getColorRoleSpec:function(){return{defaultSourceRole:"series",defaultDimension:"color*",dimensionDefaults:{valueType:Number}}},_initVisualRoles:function(){this.base(),this._addVisualRole("size",{isMeasure:!0,requireSingleDimension:!0,requireIsDiscrete:!1,defaultDimension:"size",dimensionDefaults:{valueType:Number}})},_getTranslationClass:function(t){return e.type(this.base(t)).add(sn.data.MetricPointChartTranslationOper)},_createPlotPanels:function(t,n){var r=this.options,i=e.set(Object.create(n),"sizeAxisRatio",r.sizeAxisRatio,"sizeAxisRatioTo",r.sizeAxisRatioTo,"autoPaddingByDotSize",r.autoPaddingByDotSize),s=this.plots.scatter;this.scatterChartPanel=new sn.MetricPointPanel(this,t,s,i);var o=this.plots.trend;o&&new sn.MetricPointPanel(this,t,o,Object.create(i))},defaults:{axisOriginIsZero:!1,tooltipOffset:10}}),e.type("pvc.MetricDotChart",sn.MetricPointAbstract).add({_createPointPlot:function(){return new sn.visual.MetricPointPlot(this,{fixed:{DotsVisible:!0}})}}),e.type("pvc.MetricLineChart",sn.MetricPointAbstract).add({_createPointPlot:function(){return new sn.visual.MetricPointPlot(this,{fixed:{LinesVisible:!0}})}}),e.type("pvc.BulletChart",sn.BaseChart).init(function(e){e=e||{};var t=e.dimensionGroups||(e.dimensionGroups={}),n=t.range||(t.range={});void 0===n.valueType&&(n.valueType=Number);var r=t.marker||(t.marker={});void 0===r.valueType&&(r.valueType=Number),this.base(e)}).add({bulletChartPanel:null,allowNoData:!0,_processOptionsCore:function(e){e.legend=!1,e.selectable=!1,this.base(e)},_initVisualRoles:function(){this.base(),this._addVisualRole("title",{defaultDimension:"title*"}),this._addVisualRole("subTitle",{defaultDimension:"subTitle*"}),this._addVisualRole("value",{isMeasure:!0,requireIsDiscrete:!1,valueType:Number,defaultDimension:"value*"}),this._addVisualRole("marker",{isMeasure:!0,requireIsDiscrete:!1,valueType:Number,defaultDimension:"marker*"}),this._addVisualRole("range",{isMeasure:!0,requireIsDiscrete:!1,valueType:Number,defaultDimension:"range*"})},_createTranslation:function(e){var n=this.base(e),r=n.virtualItemSize();if(r)switch(r){case 1:n.defReader({names:"value"});break;case 2:n.defReader({names:["title","value"]});break;case 3:n.defReader({names:["title","value","marker"]});break;default:n.defReader({names:["title","subTitle","value","marker"]}),r>4&&n.defReader({names:"range",indexes:t.range(4,r)})}return n},_initPlotsCore:function(){new sn.visual.BulletPlot(this)},_createContent:function(e){var t=this.plots.bullet;this.bulletChartPanel=new sn.BulletChartPanel(this,this.basePanel,t,e)},defaults:{compatVersion:1,orientation:"horizontal",bulletSize:30,bulletSpacing:50,bulletMargin:100,bulletTitle:"Title",bulletSubtitle:"",bulletTitlePosition:"left",tooltipFormat:function(e,t,n){return this.chart.options.valueFormat(n)},crosstabMode:!1,seriesInRows:!1}}),e.type("pvc.BulletChartPanel",sn.PlotPanel).add({pvBullets:null,pvBullet:null,data:null,onSelectionChange:null,_createCore:function(e){var n,r,i,s,o,u,a,f,l,c=this.chart,h=c.options,p=this.buildData(),d="horizontal"==h.orientation?"left":"bottom";if("horizontal"==h.orientation){n=e.clientSize.width-this.chart.options.bulletMargin-20,r=0;switch(h.bulletTitlePosition){case"top":a=this.chart.options.bulletMargin,s=0,i="left",o=-12,l=parseInt(h.titleSize/2,10);break;case"bottom":a=this.chart.options.bulletMargin,s=0,i="left",o=h.bulletSize+32,l=0;break;case"right":a=5,s=n+5,i="left",o=parseInt(h.bulletSize/2,10),l=0;break;case"left":default:a=this.chart.options.bulletMargin,s=0,o=parseInt(h.bulletSize/2,10),i="right",l=0}u="bottom",f=function(){return this.index*(h.bulletSize+h.bulletSpacing)+l}}else{n=e.clientSize.height-this.chart.options.bulletMargin-20;switch(h.bulletTitlePosition){case"top":a=this.chart.options.bulletMargin,s=0,i="left",o=-20,r=0,f=void 0;break;case"bottom":a=this.chart.options.bulletMargin,s=0,i="left",o=n+20,r=0,f=20;break;case"right":a=5,s=this.chart.options.bulletSize+40,i="left",o=n,r=-Math.PI/2,f=void 0;break;case"left":default:a=this.chart.options.bulletMargin,s=-12,o=this.height-this.chart.options.bulletMargin-20,i="left",r=-Math.PI/2,f=void 0}u="right",a=function(){return h.bulletMargin+this.index*(h.bulletSize+h.bulletSpacing)}}this.pvBullets=this.pvPanel.add(t.Panel).data(p)[sn.BasePanel.orthogonalLength[d]](n)[sn.BasePanel.parallelLength[d]](this.chart.options.bulletSize).margin(20).left(a).top(f),this.pvBullet=this.pvBullets.add(t.Layout.Bullet).orient(d).ranges(function(e){return e.ranges}).measures(function(e){return e.measures}).markers(function(e){return e.markers});if(c.clickable()&&this.clickAction){var v=this;this.pvBullet.cursor("pointer").event("click",function(e){var n=e.title,r=e.subtitle,i=t.event;return v.clickAction(n,r,e.measures,i)})}this.pvBulletRange=this.pvBullet.range.add(t.Bar),this.pvBulletMeasure=this.pvBullet.measure.add(t.Bar).text(function(e,t){return t.formattedMeasures[this.index]}),this.pvBulletMarker=this.pvBullet.marker.add(t.Dot).shape("square").fillStyle("white").text(function(e,t){return t.formattedMarkers[this.index]});if(this.showsTooltip()){var m=this;this.pvBulletMeasure.localProperty("tooltip").tooltip(function(e,t){var n=t.title,r=t.subtitle;return c.options.tooltipFormat.call(m,n,r,e)}),this.pvBulletMarker.localProperty("tooltip").tooltip(function(e,t){var n=t.title,r=t.subtitle;return c.options.tooltipFormat.call(m,n,r,e)}),this.pvBulletMeasure.event("mouseover",t.Behavior.tipsy(this.chart._tooltipOptions)),this.pvBulletMarker.event("mouseover",t.Behavior.tipsy(this.chart._tooltipOptions))}this.pvBulletRule=this.pvBullet.tick.add(t.Rule),this.pvBulletRuleLabel=this.pvBulletRule.anchor(u).add(t.Label).text(this.pvBullet.x.tickFormat),this.pvBulletTitle=this.pvBullet.anchor(d).add(t.Label).font("bold 12px sans-serif").textAngle(r).left(-10).textAlign(i).textBaseline("bottom").left(s).top(o).text(function(e){return e.formattedTitle}),this.pvBulletSubtitle=this.pvBullet.anchor(d).add(t.Label).textStyle("#666").textAngle(r).textAlign(i).textBaseline("top").left(s).top(o).text(function(e){return e.formattedSubtitle});var g="function"==typeof h.axisDoubleClickAction?function(e,t){h.axisDoubleClickAction(e,t)}:null;c.doubleClickable()&&g&&(this.pvBulletTitle.cursor("pointer").events("all").event("dblclick",function(e){g(e,arguments[arguments.length-1])}),this.pvBulletSubtitle.cursor("pointer").events("all").event("dblclick",function(e){g(e,arguments[arguments.length-1])}))},applyExtensions:function(){this.base(),this.extend(this.pvBullets,"bulletsPanel"),this.extend(this.pvBullet,"bulletPanel"),this.extend(this.pvBulletRange,"bulletRange"),this.extend(this.pvBulletMeasure,"bulletMeasure"),this.extend(this.pvBulletMarker,"bulletMarker"),this.extend(this.pvBulletRule,"bulletRule"),this.extend(this.pvBulletRuleLabel,"bulletRuleLabel"),this.extend(this.pvBulletTitle,"bulletTitle"),this.extend(this.pvBulletSubtitle,"bulletSubtitle")},_getExtensionId:function(){return[{abs:"content"}].concat(this.base())},buildData:function(){var t,n=this.chart,r=n.options,i=n.visualRoles.title,s=i.grouping,o=n.visualRoles.subTitle,u=o.grouping,a=n.visualRoles.value,f=a.grouping,l=n.visualRoles.marker,c=l.grouping,h=n.visualRoles.range,p=h.grouping,d={title:r.bulletTitle,formattedTitle:r.bulletTitle,subtitle:r.bulletSubtitle,formattedSubtitle:r.bulletSubtitle,ranges:e.array.to(r.bulletRanges)||[],measures:e.array.to(r.bulletMeasures)||[],markers:e.array.to(r.bulletMarkers)||[]};return e.set(d,"formattedRanges",d.ranges.map(String),"formattedMeasures",d.measures.map(String),"formattedMarkers",d.markers.map(String)),t=f||s||c||u||p?n.data.datums().select(function(e){var t,n=Object.create(d);return f&&(t=f.view(e),n.measures=t.values(),n.formattedMeasures=t.labels()),s&&(t=s.view(e),n.title=t.value,n.formattedTitle=t.label),u&&(t=u.view(e),n.subtitle=t.value,n.formattedSubtitle=t.label),c&&(t=c.view(e),n.markers=t.values(),n.formattedMarkers=t.labels()),p&&(t=p.view(e),n.ranges=t.values(),n.formattedRanges=t.labels()),n},this).array():[d],t}}),e.type("pvc.ParallelCoordinates",sn.BaseChart).init(function(e){e=e||{},e.dimensions=e.dimensions||{},e.dimensions.value||(e.dimensions.value={valueType:null}),this.base(e)}).add({parCoordPanel:null,_createContent:function(t){this.parCoordPanel=new sn.ParCoordPanel(this,this.basePanel,e.create(t,{topRuleOffset:this.options.topRuleOffset,botRuleOffset:this.options.botRuleOffset,leftRuleOffset:this.options.leftRuleOffset,rightRuleOffset:this.options.rightRuleOffset,sortCategorical:this.options.sortCategorical,mapAllDimensions:this.options.mapAllDimensions,numDigits:this.options.numDigits}))},defaults:e.create(sn.BaseChart.prototype.defaults,{compatVersion:1,topRuleOffset:30,botRuleOffset:30,leftRuleOffset:60,rightRuleOffset:60,sortCategorical:!0,mapAllDimensions:!0,numDigits:0})}),e.type("pvc.ParCoordPanel",sn.BasePanel).add({anchor:"fill",pvParCoord:null,dimensions:null,dimensionDescr:null,data:null,retrieveData:function(){var e=this.chart.data,t=this.chart.options.numDigits;this.dimensions=e.getVisibleCategories();var n=e.getValues(),r=e.getVisibleSeriesIndexes(),i=e.getVisibleCategoriesIndexes(),s=e.getCategories(),o=this.chart.options.mapAllDimensions?i.map(function(e){return isNaN(n[e][0])?{categorical:!0,len:0,map:[]}:{categorical:!1,len:0,map:[],displayValue:[]}}):i.map(function(e){return isNaN(n[e][0])?{categorical:!0,len:0,map:[]}:null}),u=function(e,n){var r=o[e],i=null;if(r.categorical)i=r.map[n],null==i&&(i=r.len,r.len++,r.map[n]=i);else{var s=n.toFixed(t);i=r.map[s],null==i&&(i=r.len,r.len++,r.map[s]=i,r.displayValue[s]=n)}return i};for(var a in o)o.hasOwnProperty(a)&&o[a]&&o[a].categorical&&(o[a].displayValue=o[a].map);var f,l,c;if(this.chart.options.sortCategorical||this.chart.options.mapAllDimensions)for(f=0;f<o.length;f++)if(o[f]){for(var h=0;h<n[f].length;h++)u(f,n[f][h]);var p=o[f].map,d=[];for(l in p)p.hasOwnProperty(l)&&d.push(l);d.sort();if(o[f].categorical)for(c=0;c<d.length;c++)p[d[c]]=c;else for(c=0;c<d.length;c++)p[d[c]].index=c}var v=function(e){var t={};for(var r in i)i.hasOwnProperty(r)&&(t[s[r]]=o[r]?u(r,n[r][e]):n[r][e]);return t};this.data=r.map(function(e){return v(e)});var m=this.dimensions.map(function(e){var t={},n=e.split("__");return t.id=e,t.name=n[0],t.unit=n.length>1?n[1]:"",t});for(f=0;f<m.length;f++){l=m[f];var g=i[f];l.orgRowIndex=g;var y,b,w,E,S,x=n[g].length;if(o[g]){y=b=w=E=o[g].displayValue[n[g][0]];for(c=1;x>c;c++)S=o[g].displayValue[n[g][c]],y>S&&(w=y,y=S),S>b&&(E=b,b=S)}else{y=b=w=E=n[g][0];for(c=1;x>c;c++)S=n[g][c],y>S&&(w=y,y=S),S>b&&(E=b,b=S)}var T=(b-E+(w-y))/2;l.min=y,l.max=b,l.step=T,l.categorical=!1;if(o[g]){l.map=o[g].map,l.mapLength=o[g].len,l.categorical=o[g].categorical;if(!l.categorical){l.orgValue=[];var N=o[g].map;for(var C in N)N.hasOwnProperty(C)&&(l.orgValue[N[C]]=0+C)}}}var k=function(e,t){for(var n={},r=0;r<e.length;r++)n[e[r]]=t[r];return n};this.dimensionDescr=k(this.dimensions,m)},_createCore:function(){function e(e){var t=e.dim;return E[t].min=Math.max(b[t].domain()[0],b[t].invert(i-e.y-e.dy)),E[t].max=Math.min(b[t].domain()[1],b[t].invert(i-e.y)),S=t,_.render(),!1}function n(e){if(e.dy<3){var t=e.dim;E[t].min=Math.max(b[t].domain()[0],b[t].invert(0)),E[t].max=Math.min(b[t].domain()[1],b[t].invert(i)),e.y=u,e.dy=c,S=t,_.render()}return!1}var r=this;this.retrieveData();var i=this.height,s=this.chart.options.numDigits,o=this.chart.options.topRuleOffset,u=this.chart.options.botRuleOffset,a=this.chart.options.leftRuleOffset,f=this.width-this.chart.options.rightRuleOffset,l=this.height-o,c=l-u,h=o-12,p=this.dimensions,d=this.dimensionDescr,v=function(e,n){var r=d[e].min,i=d[e].max,s=d[e].step;return n&&(r-=s,i+=s),t.Scale.linear(r,i).range(u,l)},m=function(e){var t=v(e,!0).range(u,l),n=d[e];if(n.orgValue&&!n.categorical){var r=function(e){var r=t(n.orgValue[e]);return r};return r.domain=function(){return t.domain()},r.invert=function(e){return t.invert(e)},r}return t},g=function(e){var t=v(e,!1).range("steelblue","brown");return t},y=t.Scale.ordinal(p).splitFlush(a,f),b=t.dict(p,m),w=t.dict(p,g),E=t.dict(p,function(e){return{min:b[e].domain()[0],max:b[e].domain()[1]}}),S=p[0],x=this.chart.options.mapAllDimensions?function(e){return p.every(function(t){var n=d[t],r=n.orgValue&&!n.categorical?n.orgValue[e[t]]:e[t];return r>=E[t].min&&r<=E[t].max})}:function(e){return p.every(function(t){return e[t]>=E[t].min&&e[t]<=E[t].max})};this.pvParCoord=this.pvPanel.add(t.Panel).data(r.data).visible(x).add(t.Line).data(p).left(function(e){return y(e)}).bottom(function(e,t){var n=b[e](t[e]);return n}).strokeStyle("#ddd").lineWidth(1).antialias(!1);var T=this.pvPanel.add(t.Rule).data(p).left(y).top(o).bottom(u);T.anchor("top").add(t.Label).top(h).font("bold 10px sans-serif").text(function(e){return d[e].name});var N=[],C=6,k=3;for(var L in d)if(d.hasOwnProperty(L)){var A=d[L];if(A.categorical){var O=y(A.id)+C;for(var M in A.map)A.map.hasOwnProperty(M)&&(N[N.length]={x:O,y:b[A.id](A.map[M])+k,label:M})}}this.pvPanel.add(t.Panel).data(N).add(t.Label).left(function(e){return e.x}).bottom(function(e){return e.y}).text(function(e){return e.label}).textAlign("left");var _=this.pvPanel.add(t.Panel);_.add(t.Panel).data(r.data).visible(x).add(t.Line).data(p).left(function(e){return y(e)}).bottom(function(e,t){return b[e](t[e])}).strokeStyle(function(e,t){var n=d[S],r=n.orgValue&&!n.categorical?n.orgValue[t[S]]:t[S];return w[S](r)}).lineWidth(1);var D=_.add(t.Panel).data(p.map(function(e){return{y:u,dy:c,dim:e}})).left(function(e){return y(e.dim)-30}).width(60).fillStyle("rgba(0,0,0,.001)").cursor("crosshair").event("mousedown",t.Behavior.select()).event("select",e).event("selectend",n).add(t.Bar).left(25).top(function(e){return e.y}).width(10).height(function(e){return e.dy}).fillStyle(function(e){return e.dim==S?w[e.dim]((E[e.dim].max+E[e.dim].min)/2):"hsla(0,0,50%,.5)"}).strokeStyle("white").cursor("move").event("mousedown",t.Behavior.drag()).event("dragstart",e).event("drag",e);D.anchor("bottom").add(t.Label).textBaseline("top").text(function(e){return d[e.dim].categorical?"":E[e.dim].min.toFixed(s)+d[e.dim].unit}),D.anchor("top").add(t.Label).textBaseline("bottom").text(function(e){return d[e.dim].categorical?"":E[e.dim].max.toFixed(s)+d[e.dim].unit}),this.extend(this.pvParCoord,"parCoord"),this.extend(this.pvPanel,"chart")}}),e.type("pvc.DataTree",sn.BaseChart).init(function(e){e=e||{},e.dimensionGroups=e.dimensionGroups||{},e.dimensionGroups.value||(e.dimensionGroups.value={valueType:null}),this.base(e)}).add({structEngine:null,structMetadata:null,structDataset:null,DataTreePanel:null,_getColorRoleSpec:function(){return{isRequired:!0,defaultSourceRole:"category",requireIsDiscrete:!0}},setStructData:function(e){this.structDataset=e.resultset,this.structDataset.length||this._log("Warning: Structure-dataset is empty"),this.structMetadata=e.metadata,this.structMetadata.length||this._log("Warning: Structure-Metadata is empty")},_createContent:function(t){var n=this.structEngine,r=n?n.type:new sn.data.ComplexType;r.addDimension("value",{});var i={seriesInRows:!0,crosstabMode:!0},s=new sn.data.CrosstabTranslationOper(r,this.structDataset,this.structMetadata,i);s.configureType(),n||(n=this.structEngine=new sn.data.Data({type:r})),n.load(s.execute(n)),sn.debug>=3&&this._log(this.structEngine.getInfo()),this.dataTreePanel=new sn.DataTreePanel(this,this.basePanel,e.create(t,{topRuleOffset:this.options.topRuleOffset,botRuleOffset:this.options.botRuleOffset,leftRuleOffset:this.options.leftRuleOffset,rightRuleOffset:this.options.rightRuleOffset,boxplotColor:this.options.boxplotColor,valueFontsize:this.options.valueFontsize,headerFontsize:this.options.headerFontsize,border:this.options.border,perpConnector:this.options.perpConnector,numDigits:this.options.numDigits,minVerticalSpace:this.options.minVerticalSpace,connectorSpace:this.options.connectorSpace,minAspectRatio:this.options.minAspectRatio}))},defaults:{compatVersion:1,topRuleOffset:30,botRuleOffset:30,leftRuleOffset:60,rightRuleOffset:60,boxplotColor:"grey",headerFontsize:16,valueFontsize:20,border:2,perpConnector:!1,numDigits:0,connectorSpace:.15,minVerticalSpace:.05,minAspectRatio:2}}),e.type("pvc.DataTreePanel",sn.PlotPanel).add({pvDataTree:null,treeElements:null,structMap:null,structArr:null,hRules:null,vRules:null,rules:null,generatePerpConnectors:function(e){this.hRules=[],this.vRules=[],this.rules=[];for(var t in this.structMap){var n=this.structMap[t];if(null!=n.children){var r=1e4,i=-1e4,s=n.left+n.width;this.hRules.push({left:s,width:e,bottom:n.bottom+n.height/2}),s+=e;for(var o in n.children){var u=this.structMap[n.children[o]],a=u.bottom+u.height/2;a>i&&(i=a),r>a&&(r=a),this.hRules.push({left:s,width:u.left-s,bottom:a})}i>r&&this.vRules.push({left:s,bottom:r,height:i-r})}}},generateLineSegment:function(e,t,n,r){var i=[];i.push({x:e,y:t}),i.push({x:n,y:r}),this.rules.push(i)},generateConnectors:function(e){this.hRules=[],this.vRules=[];if(this.chart.options.perpConnector)this.generatePerpConnectors(e);else{this.rules=[];for(var t in this.structMap){var n=this.structMap[t];if(null!=n.children){var r,i,s,o=1e4,u=-1e4;for(s in n.children)i=this.structMap[n.children[s]],r=i.bottom+i.height/2,r>u&&(u=r),o>r&&(o=r);var a=(u+o)/2,f=n.left+n.width,l=f+e;this.generateLineSegment(f,n.bottom+n.height/2,l,a);for(s in n.children)i=this.structMap[n.children[s]],r=i.bottom+i.height/2,this.generateLineSegment(l,a,i.left,r)}}}},retrieveStructure:function(){var e=this.chart.structEngine,t=this.chart.options,r=e.getVisibleCategories();this.treeElements=e.getVisibleSeries();var i,s=e.getValues(),o=r.length>4;for(i in this.treeElements)this.treeElements[i]=n.trim(this.treeElements[i]);var u=[];u.getElement=function(e){return null==u[e]&&(u[e]={min:1e4,max:-1e4}),u[e]},u.addValue=function(e,t){var n=u.getElement(e);return t<n.min&&(n.min=t),t>n.max&&(n.max=t),n};var a,f,l,c;for(i in this.treeElements)l=this.treeElements[i],a=l[0],f=a.charCodeAt(0),c=parseInt(l.slice(1),10),u.addValue("__cols",f),u.addValue(a,c);var h=u.getElement("__cols"),p=this.innerWidth/(h.max-h.min+1),d=t.connectorSpace*p,v=p-d,m=v/t.minAspectRatio,g=h.min;delete u.__cols;for(i in u){h=u[i];if("function"!=typeof h){var y=h.max-h.min+1;h.gridHeight=this.innerHeight/y,h.cellHeight=h.gridHeight*(1-t.minVerticalSpace),h.cellHeight>m&&(h.cellHeight=m),h.relBottom=(h.gridHeight-h.cellHeight)/2,h.numRows=y}}var b=new RegExp("[\\s\"']+","g");this.structMap={};for(i in this.treeElements){var w={};l=this.treeElements[i],w.box_id=l,this.structMap[l]=w,a=l[0],f=a.charCodeAt(0),c=parseInt(l.slice(1),10),h=u.getElement(a),w.colIndex=f-g,w.rowIndex=h.numRows-(c-h.min)-1,w.left=this.leftOffs+w.colIndex*p,w.width=v,o?(w.bottom=s[4][i],w.height=s[5][i]):(w.bottom=this.botOffs+w.rowIndex*h.gridHeight+h.relBottom,w.height=h.cellHeight),w.label=s[0][i],w.selector=s[1][i],w.aggregation=s[2][i];var E=(s[3][i]||"").replace(b," ");w.children=" "===E||""===E?null:E.split(" ")}this.generateConnectors((p-v)/2),this.structArr=[];for(i in this.structMap)l=this.structMap[i],this.structArr.push(l)},findDataValue:function(e,t){for(var n=0;n<t[0].length;n++)if(t[0][n]==e)return t[1][n];this._log("Error: value with key : "+e+" not found.")},generateBoxPlots:function(){var e=this.chart.options;for(var n in this.structArr){var r=this.structArr[n];if(r.values.length){r.subplot={};var i=r.subplot,s=[],o=15,u=r.width/6;i.hRules=[],i.vRules=[],i.marks=[],i.labels=[],s.push(this.findDataValue("_p5",r.values)),s.push(this.findDataValue("_p25",r.values)),s.push(this.findDataValue("_p50",r.values)),s.push(this.findDataValue("_p75",r.values)),s.push(this.findDataValue("_p95",r.values));var a=!1;if("undefined"!=typeof s[2]){s[4]<s[0]&&(s=s.reverse(),this._log(" dataset "+r.box_id+" repaired (_p95 was smaller than _p5)")),s[4]>s[0]?i.hScale=t.Scale.linear(s[0],s[4]):(a=!0,i.hScale=t.Scale.linear(s[0]-1e-10,s[0]+1e-10)),i.hScale.range(r.left+u,r.left+r.width-u);var f,l=""+s[2];for(f=0;f<s.length;f++)s[f]=i.hScale(s[f]);i.bot=r.bottom+r.height/3,i.top=r.bottom+2*r.height/3,i.mid=(i.top+i.bot)/2,i.textBottom=r.bottom+o,i.textBottom=i.bot-e.valueFontsize-1;var c=3;if(a)i.vRules.push({left:s[0],bottom:i.bot,lWidth:c,height:i.top-i.bot});else{i.hRules.push({left:s[0],width:s[1]-s[0],lWidth:1,bottom:i.mid}),i.hRules.push({left:s[1],width:s[3]-s[1],lWidth:1,bottom:i.bot}),i.hRules.push({left:s[1],width:s[3]-s[1],lWidth:1,bottom:i.top}),i.hRules.push({left:s[3],width:s[4]-s[3],lWidth:1,bottom:i.mid});for(f=0;f<s.length;f++)i.vRules.push({left:s[f],bottom:i.bot,lWidth:2==f?c:1,height:i.top-i.bot})}i.labels.push({left:s[2],bottom:i.textBottom,text:this.labelFixedDigits(l),size:e.smValueFont,color:e.boxplotColor})}}}},labelFixedDigits:function(e){"string"==typeof e&&(e=parseFloat(e));if("number"==typeof e){var t=this.chart.options.numDigits;e=e.toFixed(t)}return""+e},addDataPoint:function(e){var t=this.chart.options;for(var n in this.structArr){var r=this.structArr[n];if(r.values.length){var i=this.findDataValue(e,r.values);if("undefined"!=typeof i){var s=r.subplot,o=s.hScale(i),u="green";s.marks.push({left:o,bottom:s.mid,color:u}),s.labels.push({left:o,bottom:s.textBottom,text:this.labelFixedDigits(i),size:t.valueFont,color:u})}}}},retrieveData:function(){var e,t=this.chart.data,n=this.chart.options,r=t.getVisibleSeries(),i=t.getValues(),s={},o=i.length;for(var u in this.structArr){var a=this.structArr[u];a.values=[];for(e=0;o>e;e++)a.values.push([]);s[a.selector]=a}var f={};for(e in r){var l=s[r[e]];if("undefined"!=typeof l)for(var c in i)l.values[c].push(i[c][e]);else f[r[e]]=!0}for(var h in f)this._log("Could'nt find box for selector: "+h);this.generateBoxPlots();var p=new RegExp("[\\s\"']+","g");if(n.selectParam){var d=n.selectParam.replace(p,"");"undefined"!=d&&d.length>0&&"undefined"!=typeof window[d]&&(d=window[d],this.addDataPoint(d))}},_createCore:function(){var e=this,n=this.chart.options;n.smValueFontsize=Math.round(.6*n.valueFontsize),n.smValueFont=""+n.smValueFontsize+"px sans-serif",n.valueFont=""+n.valueFontsize+"px sans-serif";var r=n.topRuleOffset,i=n.botRuleOffset,s=n.leftRuleOffset;this.innerWidth=this.width-s-n.rightRuleOffset,this.innerHeight=this.height-r-i,this.botOffs=i,this.leftOffs=s,this.retrieveStructure(),this.retrieveData();var o,u=n.headerFontsize+3,a=this.rules;for(o=0;o<a.length;o++)this.pvPanel.add(t.Line).data(a[o]).left(function(e){return e.x}).bottom(function(e){return e.y}).lineWidth(1).strokeStyle("black");this.pvDataTree=this.pvPanel.add(t.Bar).data(e.structArr).left(function(e){return e.left}).bottom(function(e){return e.bottom}).height(function(e){return e.height}).width(function(e){return e.width}).fillStyle("green").add(t.Bar).left(function(e){return e.left+n.border}).bottom(function(e){return e.bottom+n.border}).height(function(e){return e.height-n.border-u}).width(function(e){return e.width-2*n.border}).fillStyle("white").add(t.Label).text(function(e){return e.label}).textAlign("center").left(function(e){return e.left+e.width/2}).bottom(function(e){return e.bottom+e.height-n.headerFontsize-5+n.headerFontsize/5}).font(""+n.headerFontsize+"px sans-serif").textStyle("white").fillStyle("blue");for(o=0;o<this.structArr.length;o++){var f=this.structArr[o];this.pvPanel.add(t.Rule).data(f.subplot.hRules).left(function(e){return e.left}).width(function(e){return e.width}).bottom(function(e){return e.bottom}).lineWidth(function(e){return e.lWidth}).strokeStyle(e.chart.options.boxplotColor),this.pvPanel.add(t.Rule).data(f.subplot.vRules).left(function(e){return e.left}).height(function(e){return e.height}).bottom(function(e){return e.bottom}).lineWidth(function(e){return e.lWidth}).strokeStyle(e.chart.options.boxplotColor),this.pvPanel.add(t.Dot).data(f.subplot.marks).left(function(e){return e.left}).bottom(function(e){return e.bottom}).fillStyle(function(e){return e.color}),this.pvPanel.add(t.Label).data(f.subplot.labels).left(function(e){return e.left}).bottom(function(e){return e.bottom}).font(function(e){return e.size}).text(function(e){return e.text}).textAlign("center").textStyle(function(e){return e.color})}n.perpConnector&&(this.pvPanel.add(t.Rule).data(e.vRules).left(function(e){return e.left}).bottom(function(e){return e.bottom}).height(function(e){return e.height}).strokeStyle("black"),this.pvPanel.add(t.Rule).data(e.hRules).left(function(e){return e.left}).bottom(function(e){return e.bottom}).width(function(e){return e.width}).strokeStyle("black"))},applyExtensions:function(){this.extend(this.pvDataTree,"dataTree")}}),e.type("pvc.data.BoxplotChartTranslationOper").add({_configureTypeCore:function(){var t=[],n=[],r=[];this.collectFreeDiscreteAndConstinuousIndexes(r,n),this._getUnboundRoleDefaultDimNames("category",r.length,t),e.query(sn.BoxplotChart.measureRolesNames).take(n.length).each(function(e){this._getUnboundRoleDefaultDimNames(e,1,t)},this),t.length&&this.defReader({names:t})}}),e.type("pvc.BoxplotPanel",sn.CategoricalAbstractPanel).init(function(e,t,n,r){this.base(e,t,n,r),this.boxSizeRatio=n.option("BoxSizeRatio"),this.maxBoxSize=n.option("BoxSizeMax")}).add({plotType:"box",anchor:"fill",_v1DimRoleName:{value:"median"},_createCore:function(){function t(e,t){var n=this.base(e,t);return"stroke"===t?n.darker(1):n}function n(e){return e.lock(u,function(){return this.pvMark.parent[a]()/2}).override("defaultColor",t),e}function r(e){return e.lockMark(u,function(e){return e.vars.category.boxLeft}).lockMark(a,function(e){return e.vars.category.boxWidth}),e}function i(e){return r(e),e.override("defaultColor",t),e}this.base();var s=this._buildScene(),o=this.isOrientationVertical()?"bottom":"left",u=this.anchorOrtho(o),a=this.anchorLength(o),f=this.anchorOrthoLength(o),l=["panel"];this.compatVersion()<=1&&l.push(""),this.pvBoxPanel=(new sn.visual.Panel(this,this.pvPanel,{extensionId:l})).lock("data",s.childNodes).lockMark(u,function(e){var t=e.vars.category;return t.x-t.width/2}).pvMark[a](function(e){return e.vars.category.width}),this.pvRuleWhiskerUpper=n(new sn.visual.Rule(this,this.pvBoxPanel,{extensionId:"boxRuleWhisker",freePosition:!0,noHover:!1,noSelect:!1,noClick:!1,noDoubleClick:!1,showsInteraction:!0})).intercept("visible",function(e){return e.vars.category.showRuleWhiskerUpper&&this.delegateExtension(!0)}).pvMark.lock(o,function(e){return e.vars.category.ruleWhiskerUpperBottom}).lock(f,function(e){return e.vars.category.ruleWhiskerUpperHeight}),this.pvRuleWhiskerLower=n(new sn.visual.Rule(this,this.pvBoxPanel,{extensionId:"boxRuleWhisker",freePosition:!0,noHover:!1,noSelect:!1,noClick:!1,noDoubleClick:!1,showsInteraction:!0})).intercept("visible",function(e){return e.vars.category.showRuleWhiskerBelow&&this.delegateExtension(!0)}).pvMark.lock(o,function(e){return e.vars.category.ruleWhiskerLowerBottom}).lock(f,function(e){return e.vars.category.ruleWhiskerLowerHeight}),this.pvBar=r(new sn.visual.Bar(this,this.pvBoxPanel,{extensionId:"boxBar",freePosition:!0,normalStroke:!0})).intercept("visible",function(e){return e.vars.category.showBox&&this.delegateExtension(!0)}).lockMark(o,function(e){return e.vars.category.boxBottom}).lockMark(f,function(e){return e.vars.category.boxHeight}).override("defaultColor",t).override("defaultStrokeWidth",e.fun.constant(1)).pvMark,this.pvRuleMin=i(new sn.visual.Rule(this,this.pvBoxPanel,{extensionId:"boxRuleMin",freePosition:!0,noHover:!1,noSelect:!1,noClick:!1,noDoubleClick:!1,showsInteraction:!0})).intercept("visible",function(e){return null!=e.vars.minimum.value&&this.delegateExtension(!0)}).pvMark.lock(o,function(e){return e.vars.minimum.position}),this.pvRuleMax=i(new sn.visual.Rule(this,this.pvBoxPanel,{extensionId:"boxRuleMax",freePosition:!0,noHover:!1,noSelect:!1,noClick:!1,noDoubleClick:!1,showsInteraction:!0})).intercept("visible",function(e){return null!=e.vars.maximum.value&&this.delegateExtension(!0)}).pvMark.lock(o,function(e){return e.vars.maximum.position}),this.pvRuleMedian=i(new sn.visual.Rule(this,this.pvBoxPanel,{extensionId:"boxRuleMedian",freePosition:!0,noHover:!1,noSelect:!1,noClick:!1,noDoubleClick:!1,showsInteraction:!0})).intercept("visible",function(e){return null!=e.vars.median.value&&this.delegateExtension(!0)}).lockMark(o,function(e){return e.vars.median.position}).override("defaultStrokeWidth",e.fun.constant(2)).pvMark},renderInteractive:function(){this.pvBoxPanel.render()},_buildScene:function(){function t(t){var s=new sn.visual.Scene(o,{source:t}),h=s.vars;h.series=new kn(null,"");var p=h.category=new kn(t.value,t.label);e.set(p,"group",t,"x",u(t.value),"width",a,"boxWidth",f,"boxLeft",a/2-f/2),n.measureVisualRoles().forEach(function(e){var n,s=r[e.name];if(s){var o=t.dimensions(s),u=o.value(i);n=new kn(u,o.format(u)),n.position=l(u)}else n=new kn(null,""),n.position=null;h[e.name]=n}),c.onNewScene(s,!0);var d,v,m=null!=h.minimum.value,g=null!=h.lowerQuartil.value,y=null!=h.median.value,b=null!=h.upperQuartil.value,w=g||b;w&&(d=g?h.lowerQuartil.position:y?h.median.position:h.upperQuartil.position,v=b?h.upperQuartil.position:y?h.median.position:h.lowerQuartil.position,w=v!==d,w&&(p.boxBottom=d,p.boxHeight=v-d)),p.showBox=w,w=null!=h.maximum.value,w&&(d=b?h.upperQuartil.position:y?h.median.position:g?h.lowerQuartil.position:m?h.minimum.position:null,w=null!=d,w&&(p.ruleWhiskerUpperBottom=d,p.ruleWhiskerUpperHeight=h.maximum.position-d)),p.showRuleWhiskerUpper=w,w=m,w&&(v=g?h.lowerQuartil.position:y?h.median.position:b?h.upperQuartil.position:null,w=null!=v,w&&(d=h.minimum.position,p.ruleWhiskerLowerHeight=v-d,p.ruleWhiskerLowerBottom=d)),p.showRuleWhiskerBelow=w}var n=this.chart,r=e.query(n.measureVisualRoles()).object({name:function(e){return e.name},value:function(e){return e.firstDimensionName()}}),i={visible:!0,zeroIfNone:!1},s=this.visibleData({ignoreNulls:!1}),o=new sn.visual.Scene(null,{panel:this,source:s}),u=this.axes.base.scale,a=u.range().band,f=Math.min(a*this.boxSizeRatio,this.maxBoxSize),l=this.axes.ortho.scale,c=new sn.visual.RoleVarHelper(o,this.visualRoles.color,{roleVar:"color"});return s.children().each(t,this),o}}),e.type("pvc.BoxplotChart",sn.CategoricalAbstract).add({_processOptionsCore:function(e){this.base.apply(this,arguments),e.stacked=!1},_initVisualRoles:function(){this.base();var t={isMeasure:!0,requireSingleDimension:!0,requireIsDiscrete:!1,valueType:Number};[{name:"median",label:"Median",defaultDimension:"median",isRequired:!0},{name:"lowerQuartil",label:"Lower Quartil",defaultDimension:"lowerQuartil"},{name:"upperQuartil",label:"Upper Quartil",defaultDimension:"upperQuartil"},{name:"minimum",label:"Minimum",defaultDimension:"minimum"},{name:"maximum",label:"Maximum",defaultDimension:"maximum"}].forEach(function(n){this._addVisualRole(n.name,e.create(t,n))},this)},_getTranslationClass:function(t){return e.type(this.base(t)).add(sn.data.BoxplotChartTranslationOper)},_initPlotsCore:function(){new sn.visual.BoxPlot(this),this.options.plot2&&(this._animatable=!0,new sn.visual.PointPlot(this,{name:"plot2",defaults:{LinesVisible:!0,DotsVisible:!0,OrthoRole:"median",ColorAxis:2},fixed:{OrthoAxis:1}}))},_initAxes:function(e){this.base(e);var t=this.axesByType.ortho;t&&t.forEach(function(e){e.option.defaults({Offset:.02})})},_createPlotPanels:function(e,t){var n=this.plots,r=n.box,i=new sn.BoxplotPanel(this,e,r,Object.create(t));this.bpChartPanel=i;var s=n.plot2;if(s){sn.debug>=3&&this._log("Creating Point panel.");var o=new sn.PointPanel(this,e,s,Object.create(t));o._v1DimRoleName.value=s.option("OrthoRole")}},defaults:{crosstabMode:!1}}).addStatic({measureRolesNames:["median","lowerQuartil","upperQuartil","minimum","maximum"]}),e.type("pvc.visual.TreemapDiscreteColorAxis",sn.visual.ColorAxis).init(function(e,t,n,r){this.base(e,t,n,r),this.isByParent="byparent"===e.plots.treemap.option("ColorMode")}).add({domainItemValueProp:function(){return this.role&&this.role.grouping.isSingleDimension?"value":"absKey"},domainGroupOperator:function(){return"select"},_calcAvgColor:function(e){var n=e.length;if(n>1){var r=0,i=0,s=0,o=0;e.forEach(function(e){var t=e.rgb();r+=t.r,i+=t.g,s+=t.b,o+=t.a});var u=Math.floor;return t.rgb(u(r/n),u(i/n),u(s/n),u(o/n))}var a=e[0];return n?a.darker(.7):a},_getBaseScheme:function(){var t=this,n=function(e){return null!=e.value},r=function(e){return e.children().where(n)},i=function(e){return r(e).any()},s=function(e){return r(e).any(i)},o=e.query(this.domainData().nodes()).where(s).array(),u=t.option("Colors");return function(n){var i=n instanceof Array?n:e.array.copy(arguments),s=e.query(o).object({name:function(e){return t.domainItemValue(e)}});e.array.removeIf(i,function(t){return e.hasOwnProp.call(s,t)});var a=u(i),f={},l=function(n){var i,o=t.domainItemValue(n);if(e.hasOwnProp.call(s,o)){i=e.getOwn(f,o);if(!i){var u=r(n).select(l).array();if(!u.length)throw e.assert("Should have at least one child that is also a parent.");i=f[o]=t._calcAvgColor(u)}}else i=a(o);return i};o.forEach(l);var c=function(t){return e.getOwn(f,t)||a(t)};e.copy(c,a);var h,p;return c.domain=function(){if(arguments.length)throw e.error.operationInvalid("The scale cannot be modified.");return h||(h=e.array.append(e.ownKeys(f),i))},c.range=function(){if(arguments.length)throw e.error.operationInvalid("The scale cannot be modified.");return p||(p=e.array.append(e.own(f),a.range()))},c}},_selectDomainItems:function(t){var n=e.query(t.nodes()),r=function(e){return null!=e.value},i=function(e){return e.children().where(r)},s=function(e){return i(e).any()},o=function(e){return!s(e)};return this.isByParent?n.where(function(e){return e.parent?r(e)&&s(e):o(e)||i(e).any(o)}):n.where(function(e){return(!e.parent||r(e))&&o(e)})}}),e.type("pvc.data.TreemapChartTranslationOper").add({_configureTypeCore:function(){var t=[],n=[],r=[];this.collectFreeDiscreteAndConstinuousIndexes(r,n);var i=r.length,s=n.length;i&&this._getUnboundRoleDefaultDimNames("category",i,t),s&&e.query(["size","color"]).take(s).each(function(e){this._getUnboundRoleDefaultDimNames(e,1,t)},this),t.length&&this.defReader({names:t})}}),e.type("pvc.TreemapPanel",sn.PlotPanel).init(function(e,t,n,r){this.base(e,t,n,r),this.axes.size=e._getAxis("size",(n.option("SizeAxis")||0)-1),this.visualRoles.size=e.visualRole(n.option("SizeRole")),this.layoutMode=n.option("LayoutMode")}).add({_createCore:function(n){var r=this,i=n.clientSize,s=r._buildScene();if(s){if(!s.childNodes.length&&!this.visualRoles.multiChart.isBound())throw new InvalidDataException("Unable to create a treemap chart, please check the data values.");var o=e.number.to(r._getConstantExtension("leaf","lineWidth"),1),u=o,a=u/2,f=r.visualRoles.size.isBound()?r.axes.size.scale.by1(function(e){return e.vars.size.value}):100,l=r.pvTreemapPanel=(new sn.visual.Panel(r,r.pvPanel,{panelType:t.Layout.Treemap,extensionId:"panel"})).pvMark.lock("visible",!0).lock("nodes",s.nodes()).lock("left",a).lock("top",a).lock("width",i.width-u).lock("height",i.height-u).lock("size",f).lock("mode",r.layoutMode).lock("order",null).lock("round",!1);l.node.left(function(e){return e.x+a}).top(function(e){return e.y+a}).width(function(e){return e.dx-u}).height(function(e){return e.dy-u});var c,h=r.axes.color;c=r.visualRoles.color.isBound()?h.sceneScale({sceneVarName:"color"}):e.fun.constant(h.option("Unbound"));var p=(new sn.visual.Bar(r,l.leaf,{extensionId:"leaf"})).lockMark("visible").override("defaultColor",function(e){return c(e)}).override("defaultStrokeWidth",function(){return o}).pvMark.antialias(!1).lineCap("round").strokeDasharray(function(e){return e.vars.size.value<0?"dash":null});(new sn.visual.Bar(r,l.node,{extensionId:"ascendant",noHover:!0,noSelect:!0,noClick:!0,noDoubleClick:!0})).intercept("visible",function(e){return!!e.parent&&!!e.firstChild&&this.delegateExtension(!0)}).override("anyInteraction",function(e){return e.anyInteraction()||e.isActiveDescendantOrSelf()}).override("defaultStrokeWidth",function(){return 1.5*u}).override("interactiveStrokeWidth",function(e,t){return this.showsActivity()&&e.isActiveDescendantOrSelf()&&(t=1.5*Math.max(1,t)),t}).override("defaultColor",function(e){return c(e)}).override("normalColor",e.fun.constant(null)).override("interactiveColor",function(e,n,r){if("stroke"===r){if(this.showsActivity()){if(e.isActiveDescendantOrSelf())return t.color(n).brighter(.5);if(e.anyActive())return null}if(this.showsSelection()&&e.isSelectedDescendantOrSelf())return t.color(n).brighter(.5)}return null}).pvMark.antialias(!1);var d=sn.visual.ValueLabel.maybeCreate(r,l.label,{noAnchor:!0});d&&d.pvMark.textMargin(3).sign.optional("textAngle",function(e){var n=this.defaultText(e),r=this.pvMark;return e.dx-2*r.textMargin()>t.Text.measureWidth(n,r.font())?0:e.dx>=e.dy?0:-Math.PI/2}).override("calcTextFitInfo",function(e,n){var r=this.pvMark,i=r.textMargin();if(!(-0.000001>i)){var s=r.textAngle(),o=Math.abs(Math.sin(s))<1e-6,u=!o&&Math.abs(Math.cos(s))<1e-6;if(o||u){var a=!1,f=t.Text.measure(n,r.font()),l=.75*f.height,c=e[u?"dx":"dy"];"middle"!==r.textBaseline()&&(c/=2),c-=2*i,a|=l>c;var h=e[u?"dy":"dx"];return"center"!==r.textAlign()&&(h/=2),h-=2*i,a|=0>=h||this.hideOverflowed&&f.width>h,{hide:a,widthMax:h}}}}).override("getAnchoredToMark",function(){return p})}},_getExtensionId:function(){var e=[{abs:this.chart.parent?"smallContent":"content"}];return e.concat(this.base())},renderInteractive:function(){this.pvTreemapPanel.render()},_buildScene:function(){var e=this.visibleData({ignoreNulls:!1});if(!e.childCount())return null;var t=this.visualRoles,n=new sn.visual.Scene(null,{panel:this,source:e}),r=new sn.visual.RoleVarHelper(n,t.size,{roleVar:"size",allowNestedVars:!0,hasPercentSubVar:!0}),i=t.size.isBound(),s=t.color&&t.color.grouping,o=s&&"byparent"===this.plot.option("ColorMode"),u=function(e){var t=e.group;e.vars.category=kn.fromComplex(t),r.onNewScene(e,!0);if(i&&!e.vars.size.value)return e.parentNode&&e.parentNode.removeChild(e),e;var n=t.children().where(function(e){return null!=e.value}).array();if(s){var a=o&&!n.length?t.parent:t;if(a){var f=s.view(a);e.vars.color=new kn(f.keyTrimmed(),f.label)}else e.vars.color=new kn(null,"")}else e.parent||(e.vars.color=new kn(null,""));return n.length&&n.forEach(function(t){u(new sn.visual.Scene(e,{source:t}))}),e};return u(n)}}),e.type("pvc.TreemapChart",sn.BaseChart).add({_animatable:!1,_axisClassByType:{size:sn.visual.NormalizedAxis},_axisCreateIfUnbound:{color:!0},_getColorRoleSpec:function(){return{defaultSourceRole:"category",defaultDimension:"color*"}},_initVisualRoles:function(){this.base(),this._addVisualRole("category",{isRequired:!0,defaultDimension:"category*",autoCreateDimension:!0}),this._addVisualRole("size",{isMeasure:!0,isRequired:!1,isPercent:!0,requireSingleDimension:!0,requireIsDiscrete:!1,valueType:Number,defaultDimension:"size"})},_getTranslationClass:function(t){return e.type(this.base(t)).add(sn.data.TreemapChartTranslationOper)},_getIsNullDatum:e.fun.constant(),_initPlotsCore:function(){var e=new sn.visual.TreemapPlot(this);null==this.options.legend&&(this.options.legend="byparent"===e.option("ColorMode"));var t=e.option("RootCategoryLabel");this.visualRoles.category.setRootLabel(t),this.visualRoles.color.setRootLabel(t)},_initAxes:function(t){return this.visualRoles.color.isDiscrete()?(e.hasOwnProp.call(this,"_axisClassByType")||(this._axisClassByType=Object.create(this._axisClassByType)),this._axisClassByType.color=sn.visual.TreemapDiscreteColorAxis):delete this._axisClassByType,this.base(t)},_createContent:function(e){this.base();var t=this.plots.treemap;new sn.TreemapPanel(this,this.basePanel,t,e)},_createVisibleData:function(e,t){return this.visualRoles.category.select(e,t)},defaults:{legend:null}}),e.type("pvc.visual.SunburstDiscreteColorAxis",sn.visual.ColorAxis).add({_getOptionsDefinition:function(){return Vn},domainItemValueProp:function(){return this.role&&this.role.grouping.isSingleDimension?"value":"absKey"},domainGroupOperator:function(){return"select"},_selectDomainItems:function(t){var n=e.query(t.nodes()),r=function(e){return null!=e.value};return n.where(function(e){return e.parent?r(e)&&!e.parent.parent:!1})}});var Vn=e.create(Rn,{SliceBrightnessFactor:{resolve:"_resolveFull",cast:sn.castNonNegativeNumber,value:1}});return e.type("pvc.visual.SunburstSlice",sn.visual.Sign).init(function(n,r,i){var s=r.add(t.Wedge);i=e.setDefaults(i,"freeColor",!1),this.base(n,s,i),this._bindProperty("lineWidth","strokeWidth")}).prototype.property("strokeWidth").constructor.add({defaultStrokeWidth:e.fun.constant(.5),interactiveStrokeWidth:function(e,t){return this.showsActivity()&&e.isActiveDescendantOrSelf()?2*Math.max(1,t):t},defaultColor:function(e){return e.color},normalColor:function(e,t,n){return t&&"stroke"===n?t.darker():t},interactiveColor:function(e,t,n){if(this.showsActivity())if("stroke"===n){if(e.isActiveDescendantOrSelf())return t.brighter(2).alpha(.7)}else if(e.isActive)return t.brighter(.2).alpha(.8);return this.mayShowNotAmongSelected(e)?this.dimColor(t,n):this.normalColor(e,t,n)}}),e.type("pvc.data.SunburstChartTranslationOper").add({_configureTypeCore:function(){var e=[],t=[],n=[];this.collectFreeDiscreteAndConstinuousIndexes(n,t);var r=n.length,i=t.length;r&&this._getUnboundRoleDefaultDimNames("category",r,e),i&&this._getUnboundRoleDefaultDimNames("size",1,e),e.length&&this.defReader({names:e})}}),e.type("pvc.SunburstPanel",sn.PlotPanel).init(function(e,t,n,r){this.base(e,t,n,r),this.axes.size=e._getAxis("size",(n.option("SizeAxis")||0)-1),this.visualRoles.size=e.visualRole(n.option("SizeRole")),this.sliceOrder=n.option("SliceOrder"),this.emptySlicesVisible=n.option("EmptySlicesVisible"),this.emptySlicesLabel=this.emptySlicesVisible?n.option("EmptySlicesLabel"):""}).add({_createCore:function(){var n=this._getConstantExtension("label","font");e.string.is(n)&&(this.valuesFont=n);var r=this,i=r._buildScene();if(i){if(!i.childNodes.length&&!this.visualRoles.multiChart.isBound())throw new InvalidDataException("Unable to create a sunburst chart, please check the data values.");var s=r.visualRoles.size.isBound()?r.axes.size.scale.by1(function(e){return e.vars.size.value}):e.fun.constant(100),o=r.pvSunburstPanel=(new sn.visual.Panel(r,r.pvPanel,{panelType:t.Layout.Partition.Fill,extensionId:"panel"})).pvMark.lock("visible",!0).lock("nodes",i.nodes()).lock("size",s).lock("orient","radial"),u=new sn.visual.SunburstSlice(this,o.node,{extensionId:"slice",tooltipArgs:{options:{useCorners:!0,gravity:function(){var e=this.midAngle(),t=Math.cos(e)>=0,n=Math.sin(e)>=0;return t?n?"nw":"sw":n?"ne":"se"}}}}),a=sn.visual.ValueLabel.maybeCreate(r,o.label,{noAnchor:!0});a&&a.override("defaultText",function(e){return e.isRoot()?"":this.base(e)}).override("calcTextFitInfo",function(e,n){var r=this.pvMark,i=r.textMargin();if(!(-0.000001>i)&&"center"===r.textAlign()&&n){var s=sn.normAngle(e.midAngle),o=sn.normAngle(r.textAngle()),u=Math.abs(s-o)<1e-6,a=!1;if(!u){var f=sn.normAngle(o+Math.PI);a=Math.abs(s-f)<1e-6}if(u||a){var l,c=e.innerRadius,h=c,p=e.outerRadius,d=e.angle,v=t.Text.measure(n,r.font()),m=!1;if(d<Math.PI){var g=.85*v.height,y=r.textBaseline(),b="middle"===y?g+i/2:2*(g+3*i/2);h=Math.max(h,b/(2*Math.tan(d/2)))}return l=p-i-h,m|=0>=l,l-=i,m|=this.hideOverflowed&&v.width>l,{hide:m,widthMax:l}}}}).override("getAnchoredToMark",function(){return u.pvMark})}},_getExtensionId:function(){var e=[{abs:this.chart.parent?"smallContent":"content"}];return e.concat(this.base())},renderInteractive:function(){this.pvSunburstPanel.render()},_buildScene:function(){var t=this.visibleData({ignoreNulls:!1}),n=this.emptySlicesVisible,r=this.emptySlicesLabel;if(!t.childCount())return null;var i,s=this.visualRoles,o=new sn.visual.SunburstScene(null,{panel:this,source:t}),u=s.size.isBound(),a=new sn.visual.RoleVarHelper(o,s.size,{roleVar:"size",allowNestedVars:!0,hasPercentSubVar:!0}),f=s.color&&s.color.grouping,l=this.axes.color,c=l.option("SliceBrightnessFactor");i=s.color.isBound()?l.sceneScale({sceneVarName:"color"}):e.fun.constant(l.option("Unbound"));var h=function(e){var t=e.group,i=e.vars.category=kn.fromComplex(t);r&&null==i.value&&(i.value=r),a.onNewScene(e,!0);if(u&&!e.vars.size.value)return e.parentNode&&e.parentNode.removeChild(e),e;var s=t.children();n||(s=s.where(function(e){return null!=e.value}));if(f){var o=f.view(t);e.vars.color=new kn(o.keyTrimmed(),o.label)}else e.vars.color=new kn(null,"");return s.each(function(t){h(new sn.visual.SunburstScene(e,{source:t}))}),e},p=function(e,t,n){var r=null,s=e.parent;s&&(r=i(e),!r&&!s.isRoot()&&(r=s.color,r&&t&&c&&(r=r.brighter(c*t/(n-1))))),e.color=r;var o=e.childNodes,u=o.length;o.forEach(function(e,t){p(e,t,u)})};h(o);if(this.sliceOrder&&u&&"none"!==this.sliceOrder){var d="bysizeascending"===this.sliceOrder?e.ascending:e.descending;o.sort(function(t,n){return d(t.vars.size.value,n.vars.size.value)||e.ascending(t.childIndex(),n.childIndex())})}return p(o,0),o}}),e.type("pvc.visual.SunburstScene",sn.visual.Scene).add({_createSelectedInfo:function(){var e=this.chart().data.owner.selectedCount()>0,t=e&&this.datums().all(Nn);return{any:e,is:t}}}),e.type("pvc.SunburstChart",sn.BaseChart).add({_animatable:!1,_axisClassByType:{size:sn.visual.NormalizedAxis},_axisCreateIfUnbound:{color:!0},_getColorRoleSpec:function(){return{defaultSourceRole:"category",defaultDimension:"color*",requireIsDiscrete:!0}},_initVisualRoles:function(){this.base(),this._addVisualRole("category",{isRequired:!0,defaultDimension:"category*",autoCreateDimension:!0}),this._addVisualRole("size",{isMeasure:!0,isRequired:!1,isPercent:!0,requireSingleDimension:!0,requireIsDiscrete:!1,valueType:Number,defaultDimension:"size"})},_getTranslationClass:function(t){return e.type(this.base(t)).add(sn.data.SunburstChartTranslationOper)},_getIsNullDatum:e.fun.constant(),_initPlotsCore:function(){var e=new sn.visual.SunburstPlot(this);this.options.legend=!1;var t=e.option("RootCategoryLabel");this.visualRoles.category.setRootLabel(t),this.visualRoles.color.setRootLabel(t)},_initAxes:function(t){return e.hasOwnProp.call(this,"_axisClassByType")||(this._axisClassByType=Object.create(this._axisClassByType)),this._axisClassByType.color=sn.visual.SunburstDiscreteColorAxis,this.base(t)},_createContent:function(e){this.base();var t=this.plots.sunburst;new sn.SunburstPanel(this,this.basePanel,t,e)},_createVisibleData:function(e,t){return this.visualRoles.category.select(e,t)}}),sn}),pen.define("cdf/lib/CCC/pvc-d1.0",function(){}),pen.define("cdf/lib/CCC/def",[],function(){function e(e){function t(t,n){return t[e]=r.safe(n),n}function n(t){return r(t[e])}var r=this;return n.init=t,n.propertyName=e,n}function t(e,t){return g[e]=t}function n(e,t){var n=t||m;if(e){var r=e.split("."),i=r.length;if(i){var s,o=0;if(n===p.global){s=r[0];var u=p.getOwn(g,s);u&&(n=u,o++)}for(;i>o;)s=r[o++],n=n[s]||(n[s]={})}}return n}function r(e,t,r){p.fun.is(t)&&(r=t,t=null);var i=n(e,t);if(r){y.push(m);try{r(i)}finally{m=y.pop()}}return i}function i(e,t,n){return!p.hasOwn(e,t)||p.fail.operationInvalid("Name '{0}' is already defined in namespace.",[t]),e[t]=n}function s(e){return function(t){return o(t,c.call(arguments,1),e)}}function o(e,t,n){for(var r=0,i=t.length;i>r;r++){var s=t[r];s&&(s=p.object.as(s.prototype||s),s&&u(e,s,n))}return e}function u(e,t,n){for(var r in t)a(e,r,t[r],n)}function a(e,t,n,r){if(void 0!==n){var i,s=p.object.asNative(e[t]);s?(i=p.object.as(n),i?(h.call(e,t)||(e[t]=s=Object.create(s)),u(s,i,r)):e[t]=n):(i=p.object.asNative(n),i&&(n=(r||Object.create)(i)),e[t]=n)}}function f(e){for(var t in e){var n=p.object.asNative(e[t]);n&&f(e[t]=Object.create(n))}}function l(){for(;this._source.next();){var e=this._selectMany?this._selectMany.call(this._ctx,this._source.item,this._source.index):this._source.item;if(null!=e)return this._manySource=p.query(e),!0}}var c=Array.prototype.slice;Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on non-object");var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}),Object.create||(Object.create=function(){function e(e){t.prototype=e||{};var r=new t;return t.prototype=n,r}var t=function(){},n=t.prototype;return e}()),Function.prototype.bind||(Function.prototype.bind=function(e){var t=c.call(arguments,1),n=this;return function(){return n.apply(e,t.concat(c.call(arguments)))}}),this.JSON||(this.JSON={}),this.JSON.stringify||(this.JSON.stringify=function(e){return""+e});var h=Object.prototype.hasOwnProperty,p={global:this,get:function(e,t,n){var r;return e&&null!=(r=e[t])?r:n},gets:function(e,t){return t.map(function(t){return e[t]})},getPath:function(e,t,n,r){if(!e)return n;if(null!=t){var i=p.array.is(t)?t:t.split("."),s=i.length;if(s)for(var o=0;s>o;){var u=i[o++],a=e[u];if(null==a){if(!r)return n;a=e[u]=null==n||isNaN(+n)?{}:[]}e=a}}return e},setPath:function(e,t,n){if(e&&null!=t){var r=p.array.is(t)?t:t.split(".");if(r.length){var i=r.pop();e=p.getPath(e,r,i,!0),null!=e&&(e[i]=n)}}return e},propGet:function(e,t){return e=""+e,function(n){return n?n[e]:t}},getOwn:function(e,t,n){var r;return e&&h.call(e,t)&&null!=(r=e[t])?r:n},hasOwn:function(e,t){return!!e&&h.call(e,t)},hasOwnProp:h,set:function(e){for(var t=e||{},n=arguments,r=1,i=n.length-1;i>r;r+=2)t[n[r]]=n[r+1];return t},setDefaults:function(e,t){var n,r=e||{},i=arguments,s=i.length;if(2===s&&p.object.is(t))for(n in t)null==r[n]&&(r[n]=t[n]);else{s--;for(var o=1;s>o;o+=2)n=i[o],null==r[n]&&(r[n]=i[o+1])}return r},setUDefaults:function(e,t){var n,r=e||{},i=arguments,s=i.length;if(2===s&&p.object.is(t))for(n in t)void 0===r[n]&&(r[n]=t[n]);else{s--;for(var o=1;s>o;o+=2)n=i[o],void 0===r[n]&&(r[n]=i[o+1])}return r},eachOwn:function(e,t,n){if(e)for(var r in e)h.call(e,r)&&t.call(n,e[r],r,e)},each:function(e,t,n){if(e)for(var r in e)t.call(n,e[r],r,e)},copyOwn:function(e,t){var n,r;arguments.length>=2?(n=e||{},r=t):(n={},r=e);if(r)for(var i in r)h.call(r,i)&&(n[i]=r[i]);return n},copy:function(e,t){var n,r;arguments.length>=2?(n=e||{},r=t):(n={},r=e);if(r)for(var i in r)n[i]=r[i];return n},copyProps:function(e,t,n){var r,i;return arguments.length>=3?(r=e||{},i=t):(r={},i=e,n=t),n&&(i?n.forEach(function(e){r[e]=i[e]}):n.forEach(function(e){r[e]=void 0})),r},keys:function(e){var t=[];for(var n in e)t.push(n);return t},values:function(e){var t=[];for(var n in e)t.push(e[n]);return t},uniqueIndex:function(e,t,n){var r={};for(var i in e){var s=t?t.call(n,e[i]):e[i];null==s||h.call(r,s)||(r[s]=i)}return r},ownKeys:Object.keys,own:function(e,t,n){var r=Object.keys(e);return t?r.map(function(r){return t.call(n,e[r],r)}):r.map(function(t){return e[t]})},scope:function(e,t){return e.call(t)},bit:{set:function(e,t,n){return n||null==n?e|t:e&~t}},compare:function(e,t){return e===t?0:e>t?1:-1},compareReverse:function(e,t){return e===t?0:e>t?-1:1},methodCaller:function(e,t){return t?function(){return t[e].apply(t,arguments)}:function(){return this[e].apply(this,arguments)}},identity:function(e){return e},add:function(e,t){return e+t},negate:function(e){return function(){return!e.apply(this,arguments)}},sqr:function(e){return e*e},noop:function(){},retTrue:function(){return!0},retFalse:function(){return!1},number:{is:function(e){return"number"==typeof e},as:function(e,t){var n=parseFloat(e);return isNaN(n)?t||0:n},to:function(e,t){var n=parseFloat(e);return isNaN(n)?t||0:n}},array:{empty:function(e){return!e||!e.length},is:function(e){return e instanceof Array},isLike:function(e){return e&&null!=e.length&&"string"!=typeof e},as:function(e){return e instanceof Array?e:null!=e?[e]:null},to:function(e){return e instanceof Array?e:null!=e?[e]:null},lazy:function(e,t,n,r){return e[t]||(e[t]=n?n.call(r,t):[])},copy:function(e){return c.apply(e,c.call(arguments,1))}},object:{is:function(e){return e&&"object"==typeof e},isNative:function(e){return!!e&&e.constructor===Object},as:function(e){return e&&"object"==typeof e?e:null},asNative:function(e){return e&&e.constructor===Object?e:null},lazy:function(e,t,n,r){return e[t]||(e[t]=n?n.call(r,t):{})}},string:{is:function(e){return"string"==typeof e},to:function(e,t){return null!=e?String(e):t||""},join:function(e){var t,n,r=arguments,i=r.length;switch(i){case 3:return t=r[1],n=r[2],null!=t&&""!==t?null!=n&&""!==n?""+t+e+(""+n):""+t:null!=n&&""!==n?""+n:"";case 2:return t=r[1],null!=t?""+t:"";case 1:case 0:return""}for(var s=[],o=1;i>o;o++)t=r[o],null!=t&&""!==t&&s.push(""+t);return s.join(e)},padRight:function(e,t,n){e||(e=""),null==n&&(n=" ");var r=~~((t-e.length)/n.length);return r>0?e+(new Array(r+1)).join(n):e}},fun:{is:function(e){return"function"==typeof e},as:function(e){return"function"==typeof e?e:null},to:function(e){return"function"==typeof e?e:p.fun.constant(e)},constant:function(e){return function(){return e}}},nullyTo:function(e,t){return null!=e?e:t},between:function(e,t,n){return Math.max(t,Math.min(e,n))},nully:function(e){return null==e},notNully:function(e){return null!=e},notUndef:function(e){return void 0!==e},empty:function(e){return null==e||""===e},notEmpty:function(e){return null!=e&&""!==e},truthy:function(e){return!!e},falsy:function(e){return!e},firstUpperCase:function(e){if(e){var t=e.charAt(0),n=t.toUpperCase();t!==n&&(e=n+e.substr(1))}return e},firstLowerCase:function(e){if(e){var t=e.charAt(0),n=t.toLowerCase();t!==n&&(e=n+e.substr(1))}return e},format:function(e,t,n){if(null==e||""===e)return"";var r=t&&p.fun.is(t);return e.replace(/(^|[^{])\{([^{}]+)\}/g,function(e,i,s){var o=t?r?t.call(n,s):t[s]:null;return i+(null==o?"":String(o))})},destructuringTypeBind:function(e,t){var n=e.length,r=new Array(n);if(n&&t){var i=t.length;if(i){var s=0,o=0;do{var u=t[s];if(null==u||typeof u===e[o])r[o]=u,s++;o++}while(n>o&&i>s)}}return r},error:function(e){return e instanceof Error?e:new Error(e)},fail:function(e){throw p.error(e)},assert:function(e,t){throw p.error.assertionFailed(e,t)}};p.ascending=p.compare,p.descending=p.compareReverse;var d=p.array.like=p.copyOwn(function(e){return d.is(e)?e:[e]},{is:function(e){return e&&null!=e.length&&"string"!=typeof e},as:function(e){return d.is(e)?e:null}});d.to=d,p.lazy=p.object.lazy,p.shared=function(){function t(e){function t(){r=e}return t}function n(e){if(void 0!==r)throw new Error("Access denied.");var t=(e(),r);return r=void 0,t}var r=void 0;return n.safe=t,n.property=e,n};var v={operationInvalid:function(e,t){return p.error(p.string.join(" ","Invalid operation.",p.format(e,t)))},notImplemented:function(){return p.error("Not implemented.")},argumentRequired:function(e){return p.error(p.format("Required argument '{0}'.",[e]))},argumentInvalid:function(e,t,n){return p.error(p.string.join(" ",p.format("Invalid argument '{0}'.",[e]),p.format(t,n)))},assertionFailed:function(e,t){return p.error(p.string.join(" ","Assertion failed.",p.format(e,t)))}};p.copyOwn(p.error,v),p.eachOwn(v,function(e,t){p.fail[t]=function(){throw e.apply(null,arguments)}});var m=p,g={},y=[];p.space=r,p.globalSpace=t,p.mixin=s(Object.create),p.copyOwn(p.mixin,{custom:s,inherit:p.mixin,copy:s(p.copy),share:s(p.identity)}),p.create=function(){var e=c.call(arguments),t=!0,n=e.shift();"boolean"==typeof n&&(t=n,n=e.shift());var r=n?Object.create(n):{};return t&&f(r),e.length>0&&(e.unshift(r),p.mixin.apply(p,e)),r},p.scope(function(){function e(){return p.error.operationInvalid("Type is locked.")}function t(e,t){if(e)do{var n=p.getOwn(e.constructor,t);if(void 0!==n)return n}while(e=e.base)}function n(e){var t;e&&(e instanceof Array?(t=e,e=t.join(".")):t=e.split(".")),t&&t.length>1?(this.name=t.pop(),this.namespace=t.join(".")):(this.name=e||null,this.namespace=null)}function r(e){this.fun=e.as,this.isAbstract=!!e.isAbstract}function s(e){if(e){if(p.fun.is(e))return new r({as:e});if(e instanceof r)return e;if(p.fun.is(e.as))return new r(e);if(e.isAbstract)return new r({isAbstract:!0,as:p.fail.notImplemented})}return null}function o(e){return s(e)||p.fail.argumentInvalid("fun")}function u(){}function f(e,t){return function(){var n=b.base;b.base=t;try{return e.apply(this,arguments)}finally{b.base=n}}}function l(e,t){return this[e]=f(t,this[e]),this}function c(){return""+this.constructor}function h(e,t){var n=e.prototype=Object.create(t.prototype);return n.constructor=e,n}function d(e){function t(){if(n)for(var e=0;r[e].apply(this,arguments)!==!1&&++e<n;);}var n=1,r=[function(){n=0;if(e.initOrPost)return r.length=0,e.init&&(r.push(e.init),n++),e.post&&(r.push(e.post),n++),t.apply(this,arguments),!1;r=null}];return t}function v(){var e=p.destructuringTypeBind(E,arguments);return m.apply(this,e)}function m(e,t,r){var s,o=new n(e);t?(s=t.safe&&g(t.safe)||p.fail.operationInvalid('Invalid "foreign" base type.'),s.locked=!0):(t=u,s=w);var a=Object.create(s);a.locked=!1,a.base=s,a.methods=Object.create(s.methods);var f=d(a);p.copyOwn(f,y),f.name=o.name,f.typeName=o,f.safe=g.safe(a),f.toString=function(){return""+this.typeName||"Anonymous type"};var v=h(f,t);return a.constructor=f,v.override=l,v.toString=c,o.name&&i(p.space(o.namespace,r),o.name,f),f}var g=p.shared(),y={init:function(t){t||p.fail.argumentRequired("init");var n=g(this.safe);!n.locked||p.fail(e());var r=n.init;return r&&(t=f(t,r)),n.init=t,n.initOrPost=!0,this},postInit:function(t){t||p.fail.argumentRequired("postInit");var n=g(this.safe);!n.locked||p.fail(e());var r=n.post;return r&&(t=f(t,r)),n.post=t,n.initOrPost=!0,this},add:function(t){var n=g(this.safe);!n.locked||p.fail(e());var i=this.prototype,o=n.base;return p.each(t.prototype||t,function(e,t){switch(t){case"base":case"constructor":return;case"toString":if(e===c)return;break;case"override":if(e===l)return}if(e){var u=s(e);if(u){var f,h=n.methods[t];h&&h instanceof r?f=h:o&&(h=o.methods[t],h&&h instanceof r&&(f=h)),n.methods[t]=u,f&&(e=f.override(u)),i[t]=e;return}}a(i,t,e,p.identity)}),this},getStatic:function(e){return t(g(this.safe),e)},addStatic:function(n){var r=g(this.safe);!r.locked||p.fail(e());for(var i in n)if("prototype"!==i){var s=n[i],o=p.object.as(s);if(o){var u=p.getOwn(this,i),a=void 0!==u;a||(u=t(r.base,i));var f=p.object.asNative(u);if(f){if(a){p.mixin(u,s);continue}s=p.create(u,s)}}this[i]=s}return this}};n.prototype.toString=function(){return p.string.join(".",this.namespace+"."+this.name)},p.copyOwn(r.prototype,{override:function(e){if(this.isAbstract)return e.fun;var t=f(e.fun,this.fun);return e.fun=t,t}});var b=u.prototype;b.base=void 0;var w={locked:!0,init:void 0,postInit:void 0,initOrPost:!1,methods:{},constructor:u};u.safe=g.safe(w);var E=["string","function","object"];p.type=v,p.method=o}),p.makeEnum=function(e){var t=1,n={};return e.forEach(function(e){n[e]=t,t<<=1}),n};var b={tryConfigure:1,configure:1};p.copyOwn(p,{classify:function(e,t){return e._class=t,e},classOf:function(e){return e&&(e._class||e.constructor)||void 0},is:function(e,t){return!!e&&(e._class&&e._class===t||e instanceof t)},as:function(e,t,n){return p.is(e,t)?e:n},createIs:function(e){function t(t){return p.is(t,e)}return t},createAs:function(e){function t(t){return p.as(t,e)}return t},factoryArgsConfig:function(e){return e&&e.length&&e[0]||null},factoryArgsProto:function(e){return e&&e.length>1&&e[1]||null},instance:function(e,t,n,r,i){p.classify(e,t);var s=p.instanceFields(e,t,n,r);i&&p.instanceAccessors(e,s,i);var o=p.factoryArgsConfig(r);return o&&p.configure(e,o),s},instanceFields:function(e,t,n,r){var i=p.factoryArgsProto(r);i&&p.is(i,t)||(i=t.defaults);var s=n&&i&&n(i),o=s?Object.create(s):{};return o._proto=i,n?n.init(e,o):o},classAccessors:function(e,t,n){var r=e.prototype||e;for(var i in n)r[i]=p.accessor(null,i,t,n[i]);return p},instanceAccessors:function(e,t,n){var r=p.fun.constant(t);for(var i in n)e[i]=p.accessor(e,i,r,n[i]);return p},accessor:function(e,t,n,r){function i(r){var i=e||this,o=n(i);return arguments.length?s.call(i,o,r):o[t]}function s(e,n){if(void 0!==n){var r=e[t];if(null===n)e._proto&&h.call(e,t)&&(delete e[t],n=e[t],l&&n!==r&&l(n,r,this,t));else if(n!==r){if(d&&(u=d(n)))throw new p.error.argumentInvalid(t,p.string.is(u)?u:"");c&&(n=o.call(this,e,n,r)),null!=n&&(e[t]=n,l&&l(n,r,this,t))}}return this}function o(e,n,r){var i=c(n,this);if(null==i){if(!f)return;if(h.call(e,t)){p.configure(r,n);return}if(!a)return;i=a(n,r)}return i}p.fun.is(r)&&(r={factory:r});var u,a=p.get(r,"factory"),f=p.get(r,"configurable",!!a),l=p.get(r,"change"),c=p.get(r,"cast"),d=p.get(r,"fail");return r=null,i},configure:function(e,t){if(t){var n=e.configure;p.fun.is(n)&&1===n.length?n.call(e,t):p.configureGeneric(e,t)}return e},configureGeneric:function(e,t){var n;return t&&(t.constructor===Object?p.configureSetters(e,t):e!==t&&(n=e.tryConfigure)&&p.fun.is(n)&&n.call(e,t)),e},configureSetters:function(e,t){var n,r,i;for(n in t)n&&"_"!==n.charAt(0)&&!h.call(b,n)&&void 0!==(r=t[n])&&"function"==typeof (i=e[n])&&i.length>=1&&i.call(e,r);return e}}),p.copyOwn(p.array,{create:function(e,t){var n=e>=0?new Array(e):[];if(void 0!==t)for(var r=0;e>r;r++)n[r]=t;return n},append:function(e,t,n){null==n&&(n=0);for(var r=0,i=t.length,s=e.length;i>r;r++)e[s+r]=t[n+r];return e},appendMany:function(e){var t=arguments,n=t.length;if(n>1)for(var r=e.length,i=1;n>i;i++){var s=t[i];if(s)for(var o=0,u=s.length;u>o;)e[r++]=s[o++]}return e},prepend:function(e,t,n){null==n&&(n=0);for(var r=0,i=t.length;i>r;r++)e.unshift(t[n+r]);return e},removeAt:function(e,t){return e.splice(t,1)[0]},insertAt:function(e,t,n){return e.splice(t,0,n),e},removeIf:function(e,t,n){for(var r=0,i=e.length;i>r;)t.call(n,e[r],r)?(i--,e.splice(r,1)):r++;return e},binarySearch:function(e,t,n,r){n||(n=p.compare);for(var i=0,s=e.length-1;s>=i;){var o=i+s>>1,u=n(t,r?r(e[o]):e[o]);if(0>u)s=o-1;else{if(!(u>0))return o;i=o+1}}return~i},insert:function(e,t,n){var r=p.array.binarySearch(e,t,n);return 0>r&&e.splice(~r,0,t),r},remove:function(e,t,n){var r=p.array.binarySearch(e,t,n);return r>=0?e.splice(r,1)[0]:void 0}});var w=1,E={};return p.nextId=function(e){if(e){var t=p.getOwn(E,e)||1;return E[e]=t+1,t}return w++},p.type("Set").init(function(e,t){this.source=e||{},this.count=e?null!=t?t:p.ownKeys(e).length:0}).add({has:function(e){return h.call(this.source,e)},add:function(e){var t=this.source;return h.call(t,e)||(this.count++,t[e]=!0),this},rem:function(e){return h.call(this.source,e)&&(delete this.source[e],this.count--),this},clear:function(){return this.count&&(this.source={},this.count=0),this},members:function(){return p.ownKeys(this.source)}}),p.type("Map").init(function(e,t){this.source=e||{},this.count=e?null!=t?t:p.ownKeys(e).length:0}).add({has:function(e){return h.call(this.source,e)},get:function(e){return h.call(this.source,e)?this.source[e]:void 0},set:function(e,t){var n=this.source;return h.call(n,e)||this.count++,n[e]=t,this},rem:function(e){return h.call(this.source,e)&&(delete this.source[e],this.count--),this},clear:function(){return this.count&&(this.source={},this.count=0),this},copy:function(e){p.eachOwn(e.source,function(e,t){this.set(t,e)},this)},values:function(){return p.own(this.source)},keys:function(){return p.ownKeys(this.source)},clone:function(){return new p.Map(p.copy(this.source),this.count)},symmetricDifference:function(e){if(!this.count)return e.clone();if(!e.count)return this.clone();var t={},n=0,r=this.source,i=e.source;return p.eachOwn(r,function(e,r){h.call(i,r)||(t[r]=e,n++)}),p.eachOwn(i,function(e,i){h.call(r,i)||(t[i]=e,n++)}),new p.Map(t,n)},intersect:function(e,t){return t||(t=new p.Map),p.eachOwn(this.source,function(n,r){e.has(r)&&t.set(r,n)}),t}}),p.type("OrderedMap").init(function(){this._list=[],this._map={}}).add({has:function(e){return h.call(this._map,e)},count:function(){return this._list.length},get:function(e){var t=this._map;return h.call(t,e)?t[e].value:void 0},at:function(e){var t=this._list[e];return t?t.value:void 0},add:function(e,t,n){var r=this._map,i=h.call(r,e)&&r[e];return i?i.value!==t&&(i.value=t):(i=r[e]={key:e,value:t},null==n?this._list.push(i):p.array.insertAt(this._list,n,i)),this},rem:function(e){var t=this._map,n=h.call(t,e)&&t[e];if(n){var r=this._list.indexOf(n);this._list.splice(r,1),delete this._map[e]}return this},clear:function(){return this._list.length&&(this._map={},this._list.length=0),this},keys:function(){return p.ownKeys(this._map)},forEach:function(e,t){return this._list.forEach(function(n){e.call(t,n.value,n.key)})}}),p.html={escape:function(e){return p.string.to(e).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;")}},p.type("Query").add({index:-1,item:void 0,next:function(){var e=this,t=e.index;return-2===t?!1:(t++,e._next(t)?(e.index=t,!0):(e._finish(),!1))},_next:p.method({isAbstract:!0}),_finish:function(){var e=this;e.index>-2&&(e.next=p.retFalse,e.index=-2,delete e.item)},each:function(e,t){for(var n=this;n.next();)if(e.call(t,n.item,n.index)===!1)return!0;return!1},array:function(){for(var e=[],t=this;t.next();)e.push(t.item);return e},sort:function(e,t){e||(e=p.compare);if(t){var n=e;e=function(e,r){return n(t(e),t(r))}}var r=this.array().sort(e);return new p.ArrayLikeQuery(r)},object:function(e){for(var t=p.get(e,"target")||{},n=p.get(e,"name"),r=p.get(e,"value"),i=p.get(e,"context");this.next();){var s=""+(n?n.call(i,this.item,this.index):this.item);t[s]=r?r.call(i,this.item,this.index):this.item}return t},reduce:function(e){var t,n=0;if(arguments.length<2){if(!this.next())throw new TypeError("Length is 0 and no second argument");t=this.item}else t=arguments[1];for(;this.next();)t=e(t,this.item,this.index),++n;return t},count:function(){for(var e=0;this.next();)e++;return e},first:function(e,t,n){for(;this.next();)if(!e||e.call(t,this.item,this.index)){var r=this.item;return this._finish(),r}return n},last:function(e,t,n){for(var r=n;this.next();)(!e||e.call(t,this.item,this.index))&&(r=this.item);return r},any:function(e,t){for(;this.next();)if(!e||e.call(t,this.item,this.index))return this._finish(),!0;return!1},all:function(e,t){for(;this.next();)if(!e.call(t,this.item,this.index))return this._finish(),!1;return!0},min:function(){for(var e=null;this.next();)(null===e||this.item<e)&&(e=this.item);return e},max:function(){for(var e=null;this.next();)(null===e||this.item>e)&&(e=this.item);return e},range:function(){for(var e=null,t=null;this.next();){var n=this.item;null===e?e=t=n:(e>n&&(e=n),n>t&&(t=n))}return null!=e?{min:e,max:t}:null},multipleIndex:function(e,t){var n={};return this.each(function(r){var i=e?e.call(t,r):r;if(null!=i){var s=p.getOwn(n,i)||(n[i]=[]);s.push(r)}}),n},uniqueIndex:function(e,t){var n={};return this.each(function(r){var i=e?e.call(t,r):r;null==i||h.call(n,i)||(n[i]=r)}),n},select:function(e,t){return new p.SelectQuery(this,e,t)},prop:function(e){return new p.SelectQuery(this,function(t){return t?t[e]:void 0})},selectMany:function(e,t){return new p.SelectManyQuery(this,e,t)},union:function(){var e=p.array.append([this],arguments);return new p.SelectManyQuery(new p.ArrayLikeQuery(e))},where:function(e,t){return new p.WhereQuery(this,e,t)},distinct:function(e,t){return new p.DistinctQuery(this,e,t)},skip:function(e){return new p.SkipQuery(this,e)},take:function(e){return 0>=e?new p.NullQuery:isFinite(e)?new p.TakeQuery(this,e):this},whayl:function(e,t){return new p.WhileQuery(this,e,t)},reverse:function(){return new p.ReverseQuery(this)}}),p.type("NullQuery",p.Query).add({next:p.retFalse}),p.type("AdhocQuery",p.Query).init(function(e){this._next=e}),p.type("ArrayLikeQuery",p.Query).init(function(e){function t(){for(;++r<i;)if(h.call(e,r))return n.index=r,n.item=e[r],!0;return n._finish(),!1}var n=this;p.array.isLike(e)||(e=[e]),n._list=e,n._count=e.length;var r=-1,i=e.length;n.next=t}).add({count:function(){var e=this._count;return this.index>=0&&(e-=this.index+1),this._finish(),e}}),p.type("RangeQuery",p.Query).init(function(e,t,n){this._index=e,this._count=t,this._step=null==n?1:n}).add({_next:function(e){if(e<this._count)return this.item=this._index,this._index+=this._step,!0},count:function(){var e=this._count;return this.index>=0&&(e-=this.index+1),this._finish(),e}}),p.type("WhereQuery",p.Query).init(function(e,t,n){function r(){for(;e.next();){var r=e.item;if(t.call(n,r,e.index))return i.item=r,i.index=++s,!0}return i._finish(),!1}var i=this,s=-1;i.next=r}),p.type("WhileQuery",p.Query).init(function(e,t,n){function r(){if(e.next()){var r=e.item;if(t.call(n,r,e.index))return i.item=r,i.index=++s,!0}return i._finish(),!1}var i=this,s=-1;i.next=r}),p.type("SelectQuery",p.Query).init(function(e,t,n){function r(){return e.next()?(i.item=t.call(n,e.item,e.index),i.index=++s,!0):(i._finish(),!1)}var i=this,s=-1;i.next=r}),p.type("SelectManyQuery",p.Query).init(function(e,t,n){this._selectMany=t,this._ctx=n,this._source=e,this._manySource=null}).add({_next:function(){for(;;){if(this._manySource){if(this._manySource.next())return this.item=this._manySource.item,!0;this._manySource=null}if(!l.call(this))break}}}),p.type("DistinctQuery",p.Query).init(function(e,t,n){function r(){for(;e.next();){var r=e.item,u=t?t.call(n,r,e.index):r;if(null!=u&&!h.call(o,u))return i.item=r,i.index=++s,o[u]=!0}return i._finish(),!1}var i=this,s=-1,o={};i.next=r}),p.type("SkipQuery",p.Query).init(function(e,t){this._source=e,this._skip=t}).add({_next:function(){for(;this._source.next();){if(!(this._skip>0))return this.item=this._source.item,!0;this._skip--}}}),p.type("TakeQuery",p.Query).init(function(e,t){this._source=e,this._take=t}).add({_next:function(){if(this._take>0&&this._source.next())return this._take--,this.item=this._source.item,!0}}),p.type("ReverseQuery",p.Query).init(function(e){this._source=e}).add({_next:function(e){e||(this._source instanceof p.Query&&(this._source=this._source instanceof p.ArrayLikeQuery?this._source._list:this._source.array()),this._count=this._source.length);var t=this._count;if(t>e){for(var n=t-e-1,r=this._source;!h.call(r,n);){if(--n<0)return!1;this._count--}return this.item=r[n],!0}}}),p.query=function(e){return void 0===e?new p.NullQuery:e instanceof p.Query?e:p.fun.is(e)?new p.AdhocQuery(e):new p.ArrayLikeQuery(e)},p.range=function(e,t,n){return new p.RangeQuery(e,t,n)},m=p.global,p}),pen.define("cdf/lib/CCC/def",function(){}),pen.require(["cdf/lib/CCC/protovis","cdf/lib/CCC/pvc-d1.0","cdf/lib/CCC/def","cdf/components/core"],function(e,t,n){pvc=t,pv=e,def=n,ChartComponent=UnmanagedComponent.extend({exportChart:function(e,t){var n=this,r=function(e){e=e||{};var t={},r=n.parameters;if(r&&r.length){var i=$.extend({},Dashboards.propertiesArrayToObject(r),e);for(var s in i)if(i.hasOwnProperty(s)){var o=Dashboards.getParameterValue(i[s]);$.isArray(o)&&o.length==1&&(""+o[0]).indexOf(";")>=0&&(o=doCsvQuoting(o[0],";")),typeof o=="function"&&(o=o()),t["param"+s]=o}}var u=n.dashboard.debug;u>1&&(t.paramdebug=!0,t.paramdebugLevel=u);var a=n.name.replace(/render_/,"");return t.script=wd.helpers.cccHelper.getCccScriptPath(a),t.attachmentName=a,t},i=r(t);i.outputType=e||"png";var s=wd.helpers.cggHelper.getCggDrawUrl()+"?"+$.param(i),o=$("#cccExportIFrame");o.length?o[0].src=s:(o=$('<iframe id="cccExportIFrame" style="display:none">'),o[0].src=s,o.appendTo($("body")))},renderChart:function(){var e=this.chartDefinition;e.dataAccessId||e.query||e.endpoint?this.triggerQuery(this.chartDefinition,_.bind(this.render,this)):this.valuesArray!=undefined?this.synchronous(_.bind(function(){this.render(this.valuesArray)},this)):this.synchronous(_.bind(this.render,this))}}),ProtovisComponent=ChartComponent.extend({update:function(){this.parameters==undefined&&(this.parameters=[]),this.renderChart()},render:function(e){$("#"+this.htmlObject).html('<div id="'+this.htmlObject+'protovis"></div>');var t=(new pv.Panel).canvas(this.htmlObject+"protovis").width(this.width).height(this.height);this.vis=t,this.customfunction(t,e),t.root.render()},processdata:function(e){this.render(e)}}),BaseCccComponent=ChartComponent.extend({query:null,chart:null,_preProcessChartDefinition:function(){var e=this.chartDefinition;if(e){var t=e.compatVersion;t==null&&(t=typeof pvc.defaultCompatVersion=="function"?pvc.defaultCompatVersion():1);if(t<=1){"showLegend"in e&&(e.legend=e.showLegend,delete e.showLegend);for(var n in e){var r=/^barLine(.*)$/.exec(n);r&&(p2="secondAxis"+(r[1]||""),e[p2]=e[n],delete e[n])}}}}}),CccComponent=BaseCccComponent.extend({update:function(){this.parameters==null&&(this.parameters=[]);var e=$("#"+this.htmlObject).empty(),t=this;typeof this.chartDefinition.width=="undefined"&&(this.chartDefinition.width=e.width()),typeof this.chartDefinition.height=="undefined"&&(this.chartDefinition.height=e.height()),typeof Modernizr!="undefined"&&Modernizr.svg?this.renderChart():pv.listenForPageLoad(function(){t.renderChart()})},render:function(e){$("#"+this.htmlObject).append('<div id="'+this.htmlObject+'protovis"></div>'),this._preProcessChartDefinition();var t=$.extend({},this.chartDefinition);t.canvas=this.htmlObject+"protovis";if(typeof t.extensionPoints!="undefined"){var n={};t.extensionPoints.forEach(function(e){n[e[0]]=e[1]}),t.extensionPoints=n}this.chart=new this.cccType(t),arguments.length>0&&this.chart.setData(e,{crosstabMode:this.crosstabMode,seriesInRows:this.seriesInRows}),this.chart.render()}}),CccComponent2=BaseCccComponent.extend({query:null,sQuery:null,chart:null,update:function(){var e=null,t=null;this.parameters==undefined&&(this.parameters=[]),$("#"+this.htmlObject).empty();var n=this;this.query=Dashboards.getQuery(this.chartDefinition);var r=$.extend({},this.chartDefinition);r.dataAccessId=r.structDatasource,this.sQuery=Dashboards.getQuery(r);var i=!1,s=function(){e!=null&&t!=null&&!i&&(n.render(e,t),i=!0)};pv.listenForPageLoad(function(){n.query.fetchData(n.parameters,function(t){var r=undefined;typeof n.postFetch=="function"&&(r=n.postFetch(t),$("#"+this.htmlObject).append('<div id="'+this.htmlObject+'protovis"></div>')),r!=undefined&&(t=r),e=t,s()})}),pv.listenForPageLoad(function(){n.sQuery.fetchData(n.parameters,function(e){var r=undefined;typeof n.postFetch=="function"&&(r=n.postFetch(e),$("#"+this.htmlObject).append('<div id="'+this.htmlObject+'protovis"></div>')),r!=undefined&&(e=r),t=e,s()})})},render:function(e,t){$("#"+this.htmlObject).append('<div id="'+this.htmlObject+'protovis"></div>'),this._preProcessChartDefinition();var n=$.extend({},this.chartDefinition);n.canvas=this.htmlObject+"protovis";if(typeof n.extensionPoints!="undefined"){var r={};n.extensionPoints.forEach(function(e){r[e[0]]=e[1]}),n.extensionPoints=r}this.chart=new this.cccType(n),this.chart.setData(e,{crosstabMode:this.crosstabMode,seriesInRows:this.seriesInRows}),this.chart.setStructData(t),this.chart.render()}}),CccAreaChartComponent=CccComponent.extend({cccType:pvc.AreaChart}),CccStackedDotChart=CccComponent.extend({cccType:pvc.StackedDotChart}),CccDotChartComponent=CccComponent.extend({cccType:pvc.DotChart}),CccLineChartComponent=CccComponent.extend({cccType:pvc.LineChart}),CccStackedLineChartComponent=CccComponent.extend({cccType:pvc.StackedLineChart}),CccStackedAreaChartComponent=CccComponent.extend({cccType:pvc.StackedAreaChart}),CccBarChartComponent=CccComponent.extend({cccType:pvc.BarChart}),CccPieChartComponent=CccComponent.extend({cccType:pvc.PieChart}),CccHeatGridChartComponent=CccComponent.extend({cccType:pvc.HeatGridChart}),CccBulletChartComponent=CccComponent.extend({cccType:pvc.BulletChart}),CccWaterfallChartComponent=CccComponent.extend({cccType:pvc.WaterfallChart}),CccMetricDotChartComponent=CccComponent.extend({cccType:pvc.MetricDotChart}),CccMetricLineChartComponent=CccComponent.extend({cccType:pvc.MetricLineChart}),CccParCoordComponent=CccComponent.extend({cccType:pvc.ParallelCoordinates}),CccDataTreeComponent=CccComponent2.extend({cccType:pvc.DataTree}),CccBoxplotChartComponent=CccComponent.extend({cccType:pvc.BoxplotChart}),CccTreemapChartComponent=CccComponent.extend({cccType:pvc.TreemapChart}),CccNormalizedBarChartComponent=CccComponent.extend({cccType:pvc.NormalizedBarChart})}),pen.define("cdf/components/ccc",function(){});var InputBaseComponent=UnmanagedComponent.extend({update:function(){var e=this.queryDefinition;if(this.valuesArray&&this.valuesArray.length>0){var t=_.bind(function(){this.draw(this.valuesArray)},this);this.synchronous(t)}else if(e){var t=_.bind(function(e){var t;this.valueAsId?t=e.resultset.map(function(e){return[e[0],e[0]]}):t=e.resultset,this.draw(t)},this);this.triggerQuery(e,t)}else{var t=_.bind(function(){var e=this.getValuesArray();this.draw(e)},this);this.synchronous(t)}},_getParameterValue:function(){return Dashboards.normalizeValue(Dashboards.ev(Dashboards.getParameterValue(this.parameter)))}}),SelectBaseComponent=InputBaseComponent.extend({visible:!1,draw:function(e){var t=this.placeholder(),n=this.name,r="<select",i=this._allowMultipleValues();i&&(r+=" multiple");var s=this._getPlaceholderText();s&&(r+=" data-placeholder='"+s+"'");var o=this._getListSize(e);o!=null&&(r+=" size='"+o+"'");var u=this.externalPlugin;switch(u){case"chosen":r+=" class='chzn-select'";break;case"hynds":r+=" class='hynds-select'"}r+=">";var a=this._getParameterValue(),f=Dashboards.parseMultipleValues(a),l={},c;Dashboards.eachValuesArray(e,{valueAsId:this.valueAsId},function(e,t,n,i){r+="<option value = '"+Dashboards.escapeHtml(e)+"' >"+Dashboards.escapeHtml(t)+"</option>",i||(c=e),l[e]=!0},this),r+="</select>",t.html(r);var h=!0;if(f!=null){var p=f.length;while(p--)l[f[p]]!==!0&&(h=!1,f.splice(p,1));f.length||(f=null)}var d=f==null,v=!h;d&&this.defaultIfEmpty&&c!=null&&(f=[c],v=!0),$("select",t).val(f==null?[]:f),i&&(this.autoTopValue!=null?(this.topValue(this.autoTopValue),delete this.autoTopValue):this.autoTopIndex!=null&&(this.topIndex(this.autoTopIndex),delete this.autoTopIndex)),this._doAutoFocus(),v&&(Dashboards.setParameter(this.parameter,f),Dashboards.processChange(n));switch(u){case"chosen":t.find("select.chzn-select").chosen(this._readExtraOptions());break;case"hynds":t.find("select.hynds-select").multiselect({multiple:i})}this._listenElement(t)},_allowMultipleValues:function(){return!1},_getPlaceholderText:function(){var e=this.placeholderText;return _.isString(e)&&!_.isEmpty(e)&&e||!1},_getListSize:function(e){return this.size},_readExtraOptions:function(){if(this.externalPlugin&&this.extraOptions)return Dashboards.propertiesArrayToObject(this.extraOptions)},_listenElement:function(e){var t=this,n=t.getValue(),r,i=function(){r&&r();var e=t.dashboard;if(e){var i=t.getValue();e.equalValues(n,i)||(n=i,e.processChange(t.name))}},s=$("select",e);s.keypress(function(e){e.which===13&&i()});var o=this._getChangeMode();if(o!=="timeout-focus")s.on(t._changeTrigger(),i);else{var u=t.changeTimeoutScrollFraction;u=Math.max(0,u!=null?u:1);var a=t.changeTimeoutChangeFraction;a=Math.max(0,a!=null?a:5/8);var f=Math.max(100,t.changeTimeout||2e3),l=u*f,c=a*f,h;r=function(){h!=null&&(clearTimeout(h),h=null)};var p=function(e){r(),t.dashboard&&(h=setTimeout(i,e||f))};s.change(function(){p(c)}).scroll(function(){p(l)}).focusout(i)}},_getChangeMode:function(){var e=this.changeMode;if(e){e=e.toLowerCase();switch(e){case"immediate":case"focus":return e;case"timeout-focus":if(/android|ipad|iphone/i.test(navigator.userAgent))return"focus";return e;default:Dashboards.log("Invalid 'changeMode' value: '"+e+"'.","warn")}}return"immediate"},_changeTrigger:function(){return this._getChangeMode()==="immediate"?"change":/android/i.test(navigator.userAgent)?"change":"focusout"}}),SelectComponent=SelectBaseComponent.extend({defaultIfEmpty:!0,getValue:function(){return this.placeholder("select").val()}}),SelectMultiComponent=SelectBaseComponent.extend({getValue:function(){var e=this.placeholder("select"),t=e.val();return t==null?[]:t},_allowMultipleValues:function(){return this.isMultiple==null||!!this.isMultiple},_getListSize:function(e){var t=this.base(e);return t==null&&(this._allowMultipleValues()||(t=e.length)),t},topIndex:function(e){var t=this.placeholder("select"),n=t[0],r=n.length;if(!r)return arguments.length?this:0;var i=Math.max(1,n.scrollHeight),s=Math.max(1,i/r);if(arguments.length){var o=+e;return o=isNaN(o)?0:Math.max(0,Math.min(o,r-1)),t.scrollTop(Math.ceil(o*s)),this}return Math.round(t.scrollTop()/s)},indexOf:function(e){if(e!=null){var t=this.placeholder("select option"),n=t.length;if(n){e=String(e);for(var r=0;r<n;r++)if(t[r].value===e)return r}}return-1},valueAt:function(e){if(e>=0)return this.placeholder("select :nth-child("+(e+1)+")").val()},topValue:function(e){if(arguments.length){var t=this.indexOf(e);return t>=0&&this.topIndex(t),this}return this.valueAt(this.topIndex())}}),TextInputComponent=BaseComponent.extend({update:function(){var e=this.name,t="<input type='text' id='"+e+"' name='"+e+"' value='"+Dashboards.getParameterValue(this.parameter)+(this.size?"' size='"+this.size:"")+(this.maxLength?"' maxlength='"+this.maxLength:"")+"'>";this.placeholder().html(t),$("#"+e).change(function(){Dashboards.processChange(e)}).keyup(function(t){t.keyCode==13&&Dashboards.processChange(e)}),this._doAutoFocus()},getValue:function(){return $("#"+this.name).val()}}),TextareaInputComponent=BaseComponent.extend({update:function(){var e=this.name,t="<textarea id='"+e+"' name='"+e+(this.numRows?"' rows='"+this.numRows:"")+(this.numColumns?"' cols='"+this.numColumns:"")+"'>"+Dashboards.getParameterValue(this.parameter)+"</textarea>";this.placeholder().html(t),$("#"+e).change(function(){Dashboards.processChange(e)}).keyup(function(t){t.keyCode==13&&Dashboards.processChange(e)})},getValue:function(){return $("#"+this.name).val()}});$.datepicker&&$(function(){$.datepicker.setDefaults($.datepicker.regional[""])});var DateInputComponent=BaseComponent.extend({update:function(){var e=this.dateFormat==undefined||this.dateFormat==null?"yy-mm-dd":this.dateFormat,t=this,n,r;this.startDate=="TODAY"?n=new Date:this.startDate&&(n=$.datepicker.parseDate(e,this.startDate)),this.endDate=="TODAY"?r=new Date:this.endDate&&(r=$.datepicker.parseDate(e,this.endDate)),this.placeholder().html($("<input/>").attr("id",this.name).attr("value",Dashboards.getParameterValue(this.parameter)).css("width","80px")),$(function(){t.placeholder("input").datepicker({dateFormat:e,changeMonth:!0,changeYear:!0,minDate:n,maxDate:r,onSelect:function(e,n){Dashboards.processChange(t.name)}});if(typeof Dashboards.i18nSupport!="undefined"&&Dashboards.i18nSupport!=null){var i=t.placeholder("input");i.datepicker("option",$.datepicker.regional[Dashboards.i18nCurrentLanguageCode]),i.parent().append($("<hidden>").attr("id",t.name+"_hidden")),i.datepicker("option","altField","#"+t.name+"_hidden"),i.datepicker("option","altFormat",e)}t._doAutoFocus()})},getValue:function(){return typeof Dashboards.i18nSupport!="undefined"&&Dashboards.i18nSupport!=null?$("#"+this.name+"_hidden").val():$("#"+this.name).val()}}),DateRangeInputComponent=BaseComponent.extend({update:function(){function f(){u&&a&&(n.fireInputChange(n.startValue,n.endValue),u=a=!1)}var e;this.singleInput==undefined||this.singleInput==1?(e=$("<input/>").attr("id",this.name).attr("value",Dashboards.getParameterValue(this.parameter[0])+" > "+Dashboards.getParameterValue(this.parameter[1])).css("width","170px"),this.placeholder().html(e)):(e=$("<input/>").attr("id",this.name).attr("value",Dashboards.getParameterValue(this.parameter[0])).css("width","80px"),this.placeholder().html(e),e.after($("<input/>").attr("id",this.name+"2").attr("value",Dashboards.getParameterValue(this.parameter[1])).css("width","80px")),this.inputSeparator!=undefined&&e.after(this.inputSeparator));var t=e.offset(),n=this,r=this.earliestDate!=undefined?this.earliestDate:Date.parse("-1years"),i=this.latestDate!=undefined?this.latestDate:Date.parse("+1years"),s=this.leftOffset!=undefined?this.leftOffset:0,o=this.topOffset!=undefined?this.topOffset:15,u,a,l=n.dateFormat==undefined||n.dateFormat==null?"yy-mm-dd":n.dateFormat;$(function(){n.placeholder("input").daterangepicker({posX:t.left+s,posY:t.top+o,earliestDate:r,latestDate:i,dateFormat:l,onOpen:function(){u=a=!1,n.startValue=null,n.endValue=null},onDateSelect:function(e,t){u=!0,n.storeChanges(e,t),f()},onClose:function(){a=!0,f()}}),n._doAutoFocus()})},fireInputChange:function(e,t){this.preChange&&this.preChange(e,t),this.parameter&&(this.parameter.length==2&&Dashboards.setParameter(this.parameter[1],t),this.parameter.length>0&&Dashboards.fireChange(this.parameter[0],e)),this.postChange&&this.postChange(e,t)},storeChanges:function(e,t){this.startValue=e,this.endValue=t}},{fireDateRangeInputChange:function(name,rangeA,rangeB){var object=Dashboards.getComponentByName(name);typeof object.preChange!="undefined"&&object.preChange(rangeA,rangeB);var parameters=eval(name+".parameter");Dashboards.setParameter(parameters[1],rangeB),Dashboards.fireChange(parameters[0],rangeA),typeof object.postChange!="undefined"&&object.postChange(rangeA,rangeB)}}),MonthPickerComponent=BaseComponent.extend({update:function(){var e=this.getMonthPicker(this.name,this.size,this.initialDate,this.minDate,this.maxDate,this.months);this.placeholder().html(e);var t=this;$("#"+this.name).change(function(){Dashboards.processChange(t.name)}),this._doAutoFocus()},getValue:function(){var e=$("#"+this.name).val(),t=e.substring(0,4),n=parseInt(e.substring(5,7)-1),r=new Date(t,n,1),i=this.getMonthPicker(this.name,this.size,r,this.minDate,this.maxDate,this.months);this.placeholder().html(i);var s=this;return $("#"+this.name).change(function(){Dashboards.processChange(s.name)}),e},parseDate:function(e){var t=null,n=0,r=1,i=2,s=e.split("-"),o,u,a;return s.length==3?(o=parseInt(s[n]),u=parseInt(s[r]),a=parseInt(s[i]),t=new Date(Date.UTC(o,u-1,a))):s.length==2&&(o=parseInt(s[n]),u=parseInt(s[r]),t=new Date(Date.UTC(o,u-1))),t},getMonthsAppart:function(e,t){var n,r;e<t?(n=e,r=t):(n=t,r=e);var i=r.getFullYear()-n.getFullYear(),s=i*12,o=r.getMonth()-n.getMonth()+s;return o},normalizeDateToCompare:function(e){var t=e;return t.setDate(1),t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t},getMonthPicker:function(e,t,n,r,i,s){var o="<select";o+=" id='"+e+"'";if(n==undefined||n==null)n=new Date;if(r==undefined||r==null)r=new Date,r.setYear(1980);if(i==undefined||i==null)i=new Date,i.setYear(2060);typeof n=="string"&&(n=this.parseDate(n)),typeof r=="string"&&(r=this.parseDate(r)),typeof i=="string"&&(i=this.parseDate(i));var u=!1;if(s==undefined||s==0)s=this.getMonthsAppart(r,i),u=!0;t!=undefined&&(o+=" size='"+t+"'"),o+=">";var a=new Date(+n);u==1?a.setMonth(a.getMonth()-this.getMonthsAppart(r,a)-1):a.setMonth(a.getMonth()-s/2-1),a=this.normalizeDateToCompare(a);var f=this.normalizeDateToCompare(r),l=this.normalizeDateToCompare(i);for(var c=0;c<=s;c++)a.setMonth(a.getMonth()+1),a>=f&&a<=l&&(o+="<option value = '"+a.getFullYear()+"-"+this.zeroPad(a.getMonth()+1,2)+"' ",a.getFullYear()==n.getFullYear()&&a.getMonth()==n.getMonth()&&(o+="selected='selected'"),o+=">"+Dashboards.monthNames[a.getMonth()]+" "+a.getFullYear()+"</option>");return o+="</select>",o},zeroPad:function(e,t){var n="00000000000000"+e;return n.substring(n.length-t,n.length)}}),ToggleButtonBaseComponent=InputBaseComponent.extend({draw:function(e){var t="",n=Dashboards.getParameterValue(this.parameter);n=typeof n=="function"?n():n;var r=!1,i=[];n instanceof Array||typeof n=="object"&&n.join?i=n:typeof n=="string"&&(i=n.split("|"));var s=this.valueAsId==0?0:1,o=!1;e:for(var u=0;u<i.length;u++)for(var a=0;a<e.length;a++)if(i[u]==e[a][s]){o=!0;break e}!o&&this.defaultIfEmpty&&(i=[e[0][s]],this.currentVal=i,Dashboards.setParameter(this.parameter,i),Dashboards.processChange(this.name)),t+="<ul class='"+(this.verticalOrientation?"toggleGroup vertical":"toggleGroup horizontal")+"'>";for(var u=0,f=e.length;u<f;u++){t+="<li class='"+(this.verticalOrientation?"toggleGroup vertical":"toggleGroup horizontal")+"'><label><input onclick='ToggleButtonBaseComponent.prototype.callAjaxAfterRender(\""+this.name+"\")'",r=!1;for(var l=0,c=i.length;l<c;l++){r=i[l]==e[u][s];if(r)break}if(this.type=="radio"||this.type=="radioComponent"){if(u==0&&!o||o&&e[u][s]==n)t+=" CHECKED";t+=" type='radio'"}else{if(u==0&&!o&&this.defaultIfEmpty||o&&r)t+=" CHECKED";t+=" type='checkbox'"}t+="class='"+this.name+"' name='"+this.name+"' value='"+e[u][s]+"' /> "+e[u][1]+"</label></li>"+(this.separator==undefined||this.separator==null||this.separator=="null"?"":this.separator)}t+="</ul>",this.placeholder().html(t),this.currentVal=null,this._doAutoFocus()},callAjaxAfterRender:function(e){setTimeout(function(){Dashboards.processChange(e)},1)}}),RadioComponent=ToggleButtonBaseComponent.extend({getValue:function(){return this.currentVal!="undefined"&&this.currentVal!=null?this.currentVal:this.placeholder("."+this.name+":checked").val()}}),CheckComponent=ToggleButtonBaseComponent.extend({getValue:function(){if(this.currentVal!="undefined"&&this.currentVal!=null)return this.currentVal;var e=new Array;return this.placeholder("."+this.name+":checked").each(function(t,n){e.push($(this).val())}),e}}),MultiButtonComponent=ToggleButtonBaseComponent.extend({indexes:[],draw:function(e){this.cachedArray=e;var t="pentaho-toggle-button pentaho-toggle-button-up "+(this.verticalOrientation?"pentaho-toggle-button-vertical":"pentaho-toggle-button-horizontal"),n="",r,i=this.valueAsId?1:0,s=1;this.isMultiple==undefined&&(this.isMultiple=!1);var o=$("<div>");o.appendTo(this.placeholder().empty());for(var u=0,a=e.length;u<a;u++){var f=e[u][i],l=e[u][s],c=t+this.getExtraCss(u,a,this.verticalOrientation),h;f=f==null?null:f.replace('"',"&quot;"),l=l==null?null:l.replace('"',"&quot;"),u==0&&(r=f),n="<div class='"+c+"'><button type='button' name='"+this.name+"'>"+l+"</button  >"+"</div>",h=$(n);var p=this;(function(e){h.click(function(){MultiButtonComponent.prototype.clickButton(p.htmlObject,p.name,e,p.isMultiple,p.verticalOrientation)})})(u),o.append(h),this.separator!=undefined&&this.separator!=null&&this.separator!="null"&&u!=e.length-1&&o.append(this.separator)}var d=Dashboards.ev(Dashboards.getParameterValue(this.parameter)),v=!1,m;d==null?m=[]:d instanceof Array||typeof d=="object"&&d.join?m=d:m=d.toString().split("|");var g=!1;this.clearSelections(this.htmlObject,this.name,this.verticalOrientation);for(var u=0;u<e.length;u++){v=!1;for(var y=0,b=m.length;y<b;y++){v=m[y]==e[u][i];if(v)break}if($.isArray(d)&&v||v||e[u][i]==d||e[u][s]==d){MultiButtonComponent.prototype.clickButton(this.htmlObject,this.name,u,this.isMultiple,this.verticalOrientation,!0),g=!0;if(!this.isMultiple)break}}(!g&&!this.isMultiple||!g&&this.isMultiple&&this.defaultIfEmpty)&&e.length>0&&((d==null||d==""||typeof d=="object"&&d.length==0)&&this.parameter&&Dashboards.fireChange(this.parameter,this.isMultiple?[r]:r),MultiButtonComponent.prototype.clickButton(this.htmlObject,this.name,0,this.isMultiple,this.verticalOrientation,!0)),$(".pentaho-toggle-button").hover(function(){$(this).addClass("pentaho-toggle-button-up-hovering")},function(){$(this).removeClass("pentaho-toggle-button-up-hovering")}),$(".pentaho-toggle-button button").hover(function(){$(this).parent().addClass("pentaho-toggle-button-up-hovering")},function(){}),this._doAutoFocus()},getValue:function(){if(this.isMultiple){var e=MultiButtonComponent.prototype.getSelectedIndex(this.name),t=new Array;if(e.length==undefined)t.push(this.getValueByIdx(e));else for(var n=0;n<e.length;n++)t.push(this.getValueByIdx(e[n]));return t}return this.getValueByIdx(MultiButtonComponent.prototype.getSelectedIndex(this.name))},getValueByIdx:function(e){return this.cachedArray[e][this.valueAsId?1:0]},getSelecetedCss:function(e){return"pentaho-toggle-button pentaho-toggle-button-down "+(e?"pentaho-toggle-button-vertical":"pentaho-toggle-button-horizontal")},getUnselectedCss:function(e){return"pentaho-toggle-button pentaho-toggle-button-up "+(e?"pentaho-toggle-button-vertical":"pentaho-toggle-button-horizontal")},clickButton:function(e,t,n,r,i,s){var o=this.getUnselectedCss(i),u=this.getSelecetedCss(i),a=$("#"+e+" button");if(r){this.indexes[t]==undefined?this.indexes[t]=[]:$.isArray(this.indexes[t])||(this.indexes[t]=[this.indexes[t]]);var f=!1;for(var l=0;l<this.indexes[t].length;++l)if(this.indexes[t][l]==n){f=!0,this.indexes[t].splice(l,1);break}f?a[n].parentNode.className=o+this.getExtraCss(n,a.length,i):(a[n].parentNode.className=u+this.getExtraCss(n,a.length,i),this.indexes[t].push(n))}else this.clearSelections(e,t,i),this.indexes[t]=n,a[n].parentNode.className=u+this.getExtraCss(n,a.length,i);s||this.callAjaxAfterRender(t)},clearSelections:function(e,t,n){var r=$("#"+e+" button"),i=this.getUnselectedCss(n);for(var s=0;s<r.length;s++)r[s].parentNode.className=i+this.getExtraCss(s,r.length,n);this.indexes[t]=[]},getExtraCss:function(e,t,n){var r="";return e==0&&t==1?" pentaho-toggle-button-single":(e==0?r+=" "+(n?" pentaho-toggle-button-vertical-first":" pentaho-toggle-button-horizontal-first"):e==t-1&&(r+=" "+(n?" pentaho-toggle-button-vertical-last":" pentaho-toggle-button-horizontal-last")),r)},getSelectedIndex:function(e){return this.indexes[e]}}),AutocompleteBoxComponent=BaseComponent.extend({searchedWord:"",result:[],queryServer:function(e){this.parameters||(this.parameters=[]),this.searchParam?this.parameters=[[this.searchParam,this.getInnerParameterName()]]:this.parameters.length>0&&(this.parameters[0][1]=this.getInnerParameterName()),this.maxResults&&(this.queryDefinition.pageSize=this.maxResults),Dashboards.setParameter(this.getInnerParameterName(),this.getTextBoxValue()),QueryComponent.makeQuery(this)},getTextBoxValue:function(){return this.textbox.val()},getInnerParameterName:function(){return this.parameter+"_textboxValue"},update:function(){this.placeholder().empty();var e=null;this.parameter&&(e=Dashboards.getParameterValue(this.parameter));var t=this;Dashboards.getParameterValue(this.getInnerParameterName)||Dashboards.setParameter(this.getInnerParameterName(),"");var n=t.processChange==undefined?function(e){Dashboards.processChange(e)}:function(e){t.processChange()},r=t.processElementChange==1?function(e){Dashboards.fireChange(t.parameter,e)}:undefined;this.minTextLenght==undefined&&(this.minTextLenght=0);var i={list:function(){var e=t.textbox.val();e.length>=t.minTextLenght&&!(e==""||e==t.searchedWord||t.queryInfo!=null&&t.result.length==t.queryInfo.totalRows&&t.searchedWord!=""&&(t.matchType=="fromStart"?e.indexOf(t.searchedWord)==0:e.indexOf(t.searchedWord)>-1))&&(t.queryServer(e),t.searchedWord=e);var n=[];for(p in t.result)if(t.result.hasOwnProperty(p)){var r={};r.text=t.result[p][0],n.push(r)}return n},matchType:t.matchType==undefined?"fromStart":t.matchType,processElementChange:r,processChange:function(e,t){e.value=t,n(e.name)},multiSelection:t.selectMulti==undefined?!1:t.selectMulti,checkValue:t.checkValue==undefined?!0:t.checkValue,minTextLenght:t.minTextLenght==undefined?0:t.minTextLenght,scrollHeight:t.scrollHeight,applyButton:t.showApplyButton==undefined?!0:t.showApplyButton,tooltipMessage:t.tooltipMessage==undefined?"Click it to Apply":t.tooltipMessage,addTextElements:t.addTextElements==undefined?!0:t.addTextElements,externalApplyButtonId:t.externalApplyButtonId,parent:t};this.autoBoxOpt=this.placeholder().autobox(i),this.autoBoxOpt.setInitialValue(this.htmlObject,e,this.name),this.textbox=this.placeholder("input"),this._doAutoFocus()},getValue:function(){return this.value},processAutoBoxChange:function(){this.autoBoxOpt.processAutoBoxChange()}}),ButtonComponent=ActionComponent.extend({_docstring:function(){return"Button Component that triggers a server action when clicked"},render:function(){var e=this,t=$("<button type='button'/>").text(this.label).unbind("click").bind("click",function(){var t=!0;_.isFunction(e.expression)&&(t=e.expression.apply(e,arguments));if(e.hasAction()&&t!==!1)return e.triggerAction.apply(e)});(_.isUndefined(this.buttonStyle)||this.buttonStyle==="themeroller")&&t.button(),t.appendTo(this.placeholder().empty()),this._doAutoFocus()},disable:function(){this.placeholder("button").attr("disabled","disabled")},enable:function(){this.placeholder("button").removeAttr("disabled")},setLabel:function(e){this.label=e.toString(),this.placeholder("button").text(this.label)}});pen.define("cdf/components/input",function(){});var JFreeChartComponent=BaseComponent.extend({update:function(){var e=this.chartDefinition.queryType=="cda"?"jfreechart-cda.xaction":"jfreechart.xaction";this.callPentahoAction(e)},getParameters:function(){var e=this.chartDefinition;if(e==undefined){Dashboards.log("Fatal - No chartDefinition passed","error");return}typeof e.titleKey!="undefined"&&typeof Dashboards.i18nSupport!="undefined"&&Dashboards.i18nSupport!=null&&(e.title=Dashboards.i18nSupport.prop(e.titleKey));var t=null;if(e.queryType=="cda"&&$.isArray(this.parameters)){var n;for(var r=0;r<this.parameters.length;r++){n=this.parameters[r];if($.isArray(n)&&n.length>=2){var i=n[0],s=n[1];s&&(s=doCsvQuoting(s,"=")),r==0?t="":t+=";",t+=doCsvQuoting(i+"="+s,";")}}}var o=e.chartOptions!=undefined?$.extend({},Dashboards.ev(e.chartOptions),e):e,u=[];for(p in o){var a=p,s=typeof o[p]=="function"?o[p]():o[p];u.push([a,s])}return t!=null&&u.push(["cdaParameterString",t]),u},callPentahoAction:function(e){Dashboards.incrementRunningCalls();var t=this;Dashboards.callPentahoAction(t,"system","pentaho-cdf/actions",e,this.getParameters(),function(n){n!=null&&(t.chartDefinition.caption!=undefined?t.buildCaptionWrapper($(n.find("ExecuteActivityResponse:first-child").text()),e):$("#"+t.htmlObject).html(n.find("ExecuteActivityResponse:first-child").text())),Dashboards.decrementRunningCalls()})},buildCaptionWrapper:function(e,t){var n=function(e,t){var n=t.queryType=="cda"?"jtable-cda.xaction":"jtable.xaction",r=$.extend({solution:"system",path:"pentaho-cdf/actions",action:n,exportType:e},t);Dashboards.post(wd.cdf.endpoints.getExport(),r)},r=this,i=r.chartDefinition,s=$.extend(wd.helpers.jfreechartHelper.getCaption(i,r,n,t),i.caption),u=r.htmlObject+"caption",a=$('<div id="'+u+'" ></div>');e.attr("id",r.htmlObject+"image"),e.attr("rel",r.htmlObject+"caption"),e.attr("class","captify");for(o in s){var f=s[o].show==undefined||(typeof s[o].show=="function"?s[o].show():s[o].show)?!0:!1;this.chartDefinition.queryType!="mdx"&&s[o].title=="Details"&&(f=!1);if(f){var l=s[o].icon!=undefined?typeof s[o].icon=="function"?s[o].icon():s[o].icon:undefined,c=l!=undefined?$('<div id ="'+u+o+'" class=" img '+l+'"></div>'):$('<span id ="'+u+o+'">'+s[o].title+"</span>");s[o].oclass!=undefined&&c.addClass(s[o].oclass),c.attr("title",s[o].title),a.append(c)}}$("#"+r.htmlObject).empty();var h=$('<div class="caption-details">Details</div>');$("#"+r.htmlObject).append(h),$("#"+r.htmlObject).append(e),$("#"+r.htmlObject).append(a),$("img.captify").captify($.extend({bDetails:h,spanWidth:"95%",hideDelay:3e3,hasButton:!1,opacity:"0.5"},i.caption)),h.one("capityFinished",function(t,n){var i=e.offset(),a=h.offset();e.length>1&&(h.bind("mouseenter",function(){$("#"+r.htmlObject+"image").trigger("detailsClick",[this])}),h.css("left",h.position().left+$(e[1]).width()-h.width()-5),h.css("top",h.position().top+$(e[1]).height()-h.height()),$(e[1]).append(e[0]));for(o in s)s[o].callback!=undefined&&$("#"+u+o).bind("click",s[o].callback)})}}),DialComponent=JFreeChartComponent.extend({update:function(){var e=this.chartDefinition;if(e==undefined){Dashboards.log("Fatal - No chartDefinition passed","error");return}e.chartType="DialChart";var t=e.intervals,n=e.colors;if(n!=undefined&&t.length!=n.length){Dashboards.log("Fatal - Number of intervals differs from number of colors","error");return}this.callPentahoAction(e.queryType=="cda"?"jfreechartdial-cda.xaction":"jfreechartdial.xaction")}}),OpenFlashChartComponent=JFreeChartComponent.extend({callPentahoAction:function(){Dashboards.incrementRunningCalls();var myself=this;Dashboards.callPentahoAction(myself,"system","pentaho-cdf/actions","openflashchart.xaction",this.getParameters(),function(e){if(e!=null){var t=wd.helpers.jfreechartHelper.getOpenFlashChart(e.find("ExecuteActivityResponse:first-child").text());getDataFuntion=t.match(/getData.*\(\)/gi),$("#"+myself.htmlObject).html(t)}Dashboards.decrementRunningCalls()}),OpenFlashChartComponent.prototype.onClick=function(value){if(getDataFuntion!=null&&myself.chartDefinition.urlTemplate!=undefined&&myself.chartDefinition.parameterName!=undefined){myself.data=myself.data!=undefined?myself.data:eval("("+eval(getDataFuntion[0])+")");if(myself.data.x_axis!=undefined){var urlTemplate=myself.chartDefinition.urlTemplate.replace("{"+myself.chartDefinition.parameterName+"}",myself.data.x_axis.labels.labels[value]);eval(urlTemplate)}}}}}),TrafficComponent=BaseComponent.extend({update:function(){var e=this.trafficDefinition;if(e==undefined){Dashboards.log("Fatal - No trafficDefinition passed","error");return}var t=e.intervals;t==undefined&&(e.intervals=[-1,1]);var n=[];for(p in e){var r=p,i=typeof e[p]=="function"?e[p]():e[p];n.push([r,i])}Dashboards.incrementRunningCalls();var s=this;Dashboards.callPentahoAction(s,"system","pentaho-cdf/actions","traffic.xaction",n,function(t){var n=$(t).find("VALUE").text(),r="img trafficGreen",i="img trafficYellow",o="img trafficRed",u=$("<div>").attr("class",n<=e.intervals[0]?o:n>=e.intervals[1]?r:i);$("#"+s.htmlObject).html(u);if(e.showValue!=undefined&&e.showValue==1){var a="Value: "+n+" <br /><div align='middle' class='"+o+"'/> &le; "+e.intervals[0]+" &lt;  <div align='middle' class='"+i+"'/> &lt; "+e.intervals[1]+" &le; <div align='middle' class='"+r+"'/> <br/>"+(a!=undefined?a:"");$("#"+s.htmlObject).attr("title",a+(s._tooltip!=undefined?s._tooltip:"")).tooltip({delay:0,track:!0,fade:250})}Dashboards.decrementRunningCalls()})}}),TimePlotComponent=BaseComponent.extend({reset:function(){this.timeplot=undefined,this.chartDefinition.dateRangeInput=this.InitialDateRangeInput,this.listeners=this.InitialListeners},update:function(){var e=this.chartDefinition;this.InitialListeners=this.InitialListeners==undefined?this.listeners:this.InitialListeners,this.InitialDateRangeInput=this.InitialDateRangeInput==undefined?e.dateRangeInput:this.InitialDateRangeInput;if(e.updateOnDateRangeInputChange!=1&&this.timeplot!=undefined&&e.dateRangeInput!=undefined){if(this.updateTimeplot!=0&&this.timeplot._plots.length>0){var t=this.timeplot._plots[this.timeplot._plots.length-1];t._id=="eventPlot"&&t._addSelectEvent(Dashboards.getParameterValue(this.startDateParameter)+" 00:00:00",Dashboards.getParameterValue(this.endDateParameter)+" 23:59:59",t._eventSource,"iso8601",this.geometry._earliestDate,this.geometry._latestDate)}return}e.dateRangeInput!=undefined&&this.timeplot==undefined&&(e.dateRangeInput=Dashboards.getComponent(e.dateRangeInput),this.startDateParameter=e.dateRangeInput.parameter[0],this.endDateParameter=e.dateRangeInput.parameter[1],this.listeners=this.listeners==undefined?[]:this.listeners,this.listeners=this.listeners.concat(this.startDateParameter).concat(this.endDateParameter)),typeof Timeplot!="undefined"&&Dashboards.timePlotColors==undefined&&(Dashboards.timePlotColors=[new Timeplot.Color("#820000"),new Timeplot.Color("#13E512"),new Timeplot.Color("#1010E1"),new Timeplot.Color("#E532D1"),new Timeplot.Color("#1D2DE1"),new Timeplot.Color("#83FC24"),new Timeplot.Color("#A1D2FF"),new Timeplot.Color("#73F321")]);var n=new Timeplot.DefaultTimeGeometry({gridColor:"#000000",axisLabelsPlacement:"top",gridType:"short",yAxisColor:"rgba(255,255,255,0)",gridColor:"rgba(100,100,100,1)"}),r=new Timeplot.DefaultValueGeometry({gridColor:"#000000",min:0,axisLabelsPlacement:"left",gridType:"short",valueFormat:function(e){return toFormatedString(e)}}),i=new Timeplot.DefaultEventSource,s=new Timeplot.DefaultEventSource,o,u=this;if(e==undefined){Dashboards.log("Fatal - No chart definition passed","error");return}e.showValues==undefined&&(e.showValues=!0);var a=typeof e["columns"]=="function"?e.columns():e.columns;if(a==undefined||a.length==0){Dashboards.log("Fatal - No 'columns' property passed in chartDefinition","error");return}var f=$("<div></div>");e.title!=undefined&&f.append('<span style="text-transform: lowercase;">'+e.title+"&nbsp; &nbsp; &nbsp;</span>");var l=[];for(var c=0,h=0;c<a.length;c++,h++){h=h>7?0:h,f.append('<span id="'+u.name+"Plot"+c+'Header" style="color:'+Dashboards.timePlotColors[h].toHexString()+'">'+a[c]+" &nbsp;&nbsp;</span>");var p={id:u.name+"Plot"+c,name:a[c],dataSource:new Timeplot.ColumnSource(i,c+1),valueGeometry:r,timeGeometry:n,lineColor:Dashboards.timePlotColors[h],showValues:e.showValues,hideZeroToolTipValues:e.hideZeroToolTipValues!=undefined?e.hideZeroToolTipValues:!1,showValuesMode:e.showValuesMode!=undefined?e.showValuesMode:"header",toolTipFormat:function(e,t){return t._name+" = "+toFormatedString(e)},headerFormat:function(e,t){return t._name+" = "+toFormatedString(e)+"&nbsp;&nbsp;"}};e.dots==1&&(p.dotColor=Dashboards.timePlotColors[h]),e.fill==1&&(p.fillColor=Dashboards.timePlotColors[h].transparency(.5)),l.push(new Timeplot.createPlotInfo(p))}var s=undefined,d=undefined;if(e.dateRangeInput!=undefined||e.events&&e.events.show==1)this.rangeColor="00FF00",s=new Timeplot.DefaultEventSource,d=Timeplot.createPlotInfo({id:e.dateRangeInput!=undefined?"eventPlot":"events",eventSource:s,timeGeometry:n,lineColor:"#FF0000",rangeColor:this.rangeColor,getSelectedRegion:function(e,t){g.updateDateRangeInput(e,t)}}),l.push(d);$("#"+this.htmlObject).html(f),$("#"+this.htmlObject).append("<div class='timeplot'></div>"),e.height>0&&$("#"+this.htmlObject+" > div.timeplot").css("height",e.height),e.width>0&&$("#"+this.htmlObject+" > div.timeplot").css("width",e.width),timeplot=Timeplot.create($("#"+this.htmlObject+" > div.timeplot")[0],l),u.timeplot=timeplot,u.geometry=n;var v=undefined,m=wd.cdf.endpoints.getCdfXaction("pentaho-cdf/actions","timelinefeeder.xaction",null,e),g=this;if(e.events&&e.events.show==1){var y=wd.cdf.endpoints.getCdfXaction("pentaho-cdf/actions","timelineeventfeeder.xaction",null,e.events);timeplot.loadText(m,",",i,null,null,function(t){timeplot.loadJSON(y,s,function(r){r.events=g.filterEvents(r.events,t);if(e.dateRangeInput){var i=timeplot._plots[timeplot._plots.length-1];i._id=="eventPlot"&&i._addSelectEvent(Dashboards.getParameterValue(u.startDateParameter)+" 00:00:00",Dashboards.getParameterValue(u.endDateParameter)+" 23:59:59",s,"iso8601",n._earliestDate,n._latestDate)}})})}else timeplot.loadText(m,",",i,null,null,function(){if(e.dateRangeInput){var t=timeplot._plots[timeplot._plots.length-1];t._id=="eventPlot"&&t._addSelectEvent(Dashboards.getParameterValue(u.startDateParameter)+" 00:00:00",Dashboards.getParameterValue(u.endDateParameter)+" 23:59:59",s,"iso8601",n._earliestDate,n._latestDate)}})},filterEvents:function(e,t){var n=[],r=MetaLayer.toDateString(new Date(t.earliestDate)),s=MetaLayer.toDateString(new Date(t.latestDate));for(i=0;i<e.length;i++)e[i].start>=r&&(e[i].end==undefined&&e[i].start<=s||e[i].end<=s)&&n.push(e[i]);return n},updateDateRangeInput:function(e,t){var n=function(e){var t="0"+(e.getMonth()+1),n="0"+e.getDate();return e.getFullYear()+"-"+t.substring(t.length-2,t.length)+"-"+n.substring(n.length-2,n.length)};if(this.chartDefinition.dateRangeInput!=undefined){if(e>t){var r=e;e=t,t=r}Dashboards.setParameter(this.startDateParameter,n(e)),Dashboards.setParameter(this.endDateParameter,n(t)),this.updateTimeplot=!1,Dashboards.update(this.chartDefinition.dateRangeInput),Dashboards.fireChange(this.startDateParameter,n(e)),this.updateTimeplot=!0}}});pen.define("cdf/components/jfreechart",function(){});var DashboardsMap={markers:null,data:new Array,dataIdx:0,messageElementId:null,selectedPointDetails:null,mapExpression:null,useMercator:"true",showToolTip:"false",search:function(e,t){var n=this.data[t],r=n[1],i=r[0],s=r[1],o=r[2];if(i!=""&&s!="")return DashboardsMap.getLocation({totalResultsCount:1,geonames:[{lat:i,lng:s}]});var u="http://nominatim.openstreetmap.org/search",a={format:"json",limit:"1",q:o},f=function(e){var t;e&&e.length>0?t={totalResultsCount:e.length,geonames:[{lng:e[0].lon,lat:e[0].lat}]}:t={totalResultsCount:0,geonames:[]},DashboardsMap.getLocation(t)};$.getJSON(u,a,f)},resetSearch:function(){map.removeLayer(markers),markers.destroy(),markers=new OpenLayers.Layer.Markers("Markers"),map.addLayer(markers),this.cleanMessages(),dataIdx=0,this.data=new Array},getLocation:function(e){var t=this.data[dataIdx++];if(e==null||e.totalResultsCount==0){var n=t[0];this.addMessage(n)}else{var r=e.geonames[0],i=t[4],s=t[5];t[6]=r.lng,t[7]=r.lat;var i=this.showMarker(i,t);t[4]=i}if(dataIdx>=this.data.length&&dataIdx>1){var o=markers.getDataExtent();map.zoomToExtent(o)}dataIdx>=this.data.length&&dataIdx==1&&map.setCenter(markers.markers[0].lonlat,4,!1,!1)},showMarker:function(e,t){var n,r,i=t[6],s=t[7];if(t[5]instanceof Array){var o=t[5];n=o[0],r=new OpenLayers.Size(o[1],o[2])}else n=t[5],r=new OpenLayers.Size(21,25);var u=new OpenLayers.Pixel(-(r.w/2),-r.h),a=new OpenLayers.Icon(n,r,u);return this.useMercator=="true"?(marker=new OpenLayers.Marker(lonLatToMercator(new OpenLayers.LonLat(i,s)),a),feature=new OpenLayers.Feature(markers,lonLatToMercator(new OpenLayers.LonLat(i,s)),t)):(marker=new OpenLayers.Marker(new OpenLayers.LonLat(i,s),a),feature=new OpenLayers.Feature(markers,new OpenLayers.LonLat(i,s),t)),feature.marker=marker,marker.events.register("mousedown",feature,DashboardsMap.marker_click),this.showToolTip=="true"&&(marker.events.register("mouseover",feature,DashboardsMap.marker_over),marker.events.register("mouseout",feature,DashboardsMap.marker_out),ttips=new OpenLayers.Control.ToolTips({bgColor:"black",textColor:"white",bold:!0,opacity:.5}),map.addControl(ttips)),markers.addMarker(marker),marker},marker_click:function(e){click_lonlat=this.lonlat;var t=this.data;DashboardsMap.showToolTip=="true"&&ttips.hide(),Dashboards.fireChange("selectedPoint",t[0])},marker_over:function(e){record=this.data,ttips.show({html:record[0]+": "+record[2]})},marker_out:function(e){ttips.hide()},updateInfoWindow:function(e){if(e!=null){var t=$(e).text();show_bubble(click_lonlat,t)}},updateMap:function(){var n=this.data.length;for(idx=0;idx<n;idx++){var value=this.data[idx][2],markers=this.mapMarkers,icon=eval(this.mapExpression),marker=this.data[idx][4];this.data[idx][5]=icon,this.data[idx][4]=this.showMarker(marker,this.data[idx])}},addMessage:function(e){this.messageElementId!=undefined&&(document.getElementById(this.messageElementId).innerHTML=document.getElementById(this.messageElementId).innerHTML+e+"\n <br />")},cleanMessages:function(e){this.messageElementId!=undefined&&(document.getElementById(this.messageElementId).innerHTML="")}},MapComponent=BaseComponent.extend({initMap:!0,update:function(){var div="map";this.mapDiv!=null&&(div=this.mapDiv);var b_layer_control=!0,b_custom_map=!1,b_use_mercator=!0,str_custom_map="";this.showLayerSelector==0&&(b_layer_control=this.showLayerSelector),this.showCustomMap&&(b_custom_map="true",str_custom_map=this.customMapCode),this.useMercator==0&&(b_use_mercator="false",DashboardsMap.useMercator="false"),this.showToolTip==1?DashboardsMap.showToolTip="true":DashboardsMap.showToolTip="false",this.initMap&&(init_map(div,this.initPosLon,this.initPosLat,this.initZoom,b_use_mercator,b_layer_control,b_custom_map,str_custom_map),DashboardsMap.messageElementId=this.messageElementId,this.initMap=!1),DashboardsMap.resetSearch();var p=new Array(this.parameters.length);for(var i=0,len=p.length;i<len;i++){var key=this.parameters[i][0],value=Dashboards.getParameterValue(this.parameters[i][1]);p[i]=[key,value]}html=Dashboards.pentahoAction(this.solution,this.path,this.action,p,null);var myArray=this.parseArray(html,!0),len=myArray.length;if(len>1){var cols=myArray[0],colslength=cols.length;for(var i=1;i<len;i++){var details;if(colslength>4){details=new Array(colslength-4);for(var j=4;j<colslength;j++)details[j-4]=[cols[j],myArray[i][j]]}var value=myArray[i][4],markers=this.markers;DashboardsMap.mapExpression=this.expression(),DashboardsMap.mapMarkers=markers;var icon=eval(this.expression());DashboardsMap.data.push(new Array(myArray[i][0],new Array(myArray[i][1],myArray[i][2],myArray[i][3]),value,details,null,icon,null,null)),DashboardsMap.search(this,DashboardsMap.data.length-1)}}}}),MapBubbleComponent=BaseComponent.extend({update:function(){DashboardsMap.selectedPointDetails=null;for(var e=0;e<DashboardsMap.data.length;e++)if(Dashboards.getParameterValue("selectedPoint")==DashboardsMap.data[e][0]){DashboardsMap.selectedPointDetails=DashboardsMap.data[e][3];break}var t=Dashboards.clone(DashboardsMap.selectedPointDetails);if(this.parameters!=undefined)var n=new Array(this.parameters.length);for(var e=0,r=n.length;e<r;e++){var i=this.parameters[e][0],s=Dashboards.getParameterValue(this.parameters[e][1]);t.push([i,s])}DashboardsMap.updateInfoWindow(Dashboards.pentahoAction(this.solution,this.path,this.action,t,null))}});pen.define("cdf/components/maps",function(){});var NavigatorBaseComponent=BaseComponent.extend({},{path:Dashboards.getQueryParameter("path"),solution:Dashboards.getQueryParameter("solution"),template:Dashboards.getQueryParameter("template"),navigatorResponse:-1,getSolutionJSON:function(e){var t=NavigatorBaseComponent.navigatorResponse,n=t.solution.folders,r,s=0;for(i=0;i<n.length;i++){var o=n[i];if(NavigatorBaseComponent.solution==""||o.solution==NavigatorBaseComponent.solution){var u=[],a=o.folders;a!=undefined&&a.length==undefined?u.push(a):a!=undefined&&a.length>0&&(u=u.concat(a));var f=o.files;return f!=undefined&&f.length==undefined?u.push(f):f!=undefined&&f.length>0&&(u=u.concat(f)),u}}if(s==0){Dashboards.error("Fatal: Solution "+e+" not found in navigation object");return}},browseContent:function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.type=="FOLDER"&&r.path==t)return e=r.folders,e==undefined?[]:(e.length==undefined&&(e=[e]),e)}Dashboards.error("Fatal: path "+(NavigatorBaseComponent.path||Dashboards.getPathParameter())+" not found in navigation object");return},getParentSolution:function(){return(NavigatorBaseComponent.path||Dashboards.getPathParameter()).length>0?NavigatorBaseComponent.solution:""},getParentPath:function(){var e=NavigatorBaseComponent.path||Dashboards.getPathParameter(),t=e.lastIndexOf("/");if(t==-1)return"";var n=e.substring(0,e.lastIndexOf("/"));return n},isAncestor:function(e,t){return e!=NavigatorBaseComponent.solution?!1:!0}}),NavigatorComponent=NavigatorBaseComponent.extend({update:function(){var e=this;NavigatorBaseComponent.navigatorResponse==-1?$.getJSON(wd.cdf.endpoints.getJSONSolution()+"?mode=navigator&path="+NavigatorBaseComponent.path,function(t){e.processNavigatorResponse(t)}):this.processNavigatorResponse(NavigatorBaseComponent.navigatorResponse)},processNavigatorResponse:function(e){NavigatorBaseComponent.navigatorResponse=e;var t=this.includeSolutions?e.solution.folders[0].folders:NavigatorBaseComponent.getSolutionJSON(NavigatorBaseComponent.solution);t.sort(function(e,t){return e.name>t.name});var n=this.generateMenuFromArray(t,0);$("#"+this.htmlObject).html(n),$(function(){$("ul.jd_menu").jdMenu({activateDelay:50,showDelay:50,disableLinks:!1})}),$("ul.jd_menu a").tooltip({showURL:!1,track:!0,delay:1e3,opacity:.5})},generateMenuFromArray:function(e,t){var n="";if(e==undefined)return n;for(var r=0;r<e.length;r++){var i=e[r];n+=this.generateMenuFromFile(i,t+1)}if(n.length>0){var s;if(t==0){var o=this.mode=="vertical"?"jd_menu jd_menu_slate jd_menu_vertical":"jd_menu jd_menu_slate";s='class="'+o+'"'}n="<ul "+s+">"+n+"</ul>"}return n},generateMenuFromFile:function(e,t){var n="";if(e.visible==1){var r=NavigatorBaseComponent.isAncestor(e.solution,e.path)?'class="ancestor"':"",i="";e.path.length>0&&(i="path="+e.path);var s=NavigatorBaseComponent.template!=undefined&&NavigatorBaseComponent.template.length!=undefined&&NavigatorBaseComponent.template.length>0?"&amp;template="+NavigatorBaseComponent.template:"";e.link!=undefined?n+="<li><a "+r+' title="'+e.title+'"  href="'+webAppPath+e.link+'">'+e.title+"</a>":n+="<li><a "+r+' title="'+e.title+'" onClick="return false;" href="'+wd.cdf.endpoints.getRenderHTML()+"?solution="+e.solution+"&amp;"+i+s+'">'+e.title+"</a>";var o=e.folders||[];o.sort(function(e,t){return e.name>t.name});var u=e.files||[];u.sort(function(e,t){return e.name>t.name});var a=this.generateMenuFromArray(o.concat(u));a.length>0&&(a=" &raquo;"+a),n+=a+"</li>"}return n}}),ContentListComponent=NavigatorBaseComponent.extend({update:function(){var e=this,t=this.mode!=4?NavigatorBaseComponent.path||Dashboards.getPathParameter():NavigatorBaseComponent.getParentPath();e.draw(t)},draw:function(e){var t=this;$.getJSON(wd.cdf.endpoints.getJSONSolution()+"?mode=contentList"+(e!=""?"&path="+e:""),function(n){t.processContentListResponse(n,e)})},processContentListResponse:function(e,t){$("#"+this.htmlObject).empty();var n=e.content||[];n.sort(function(e,t){var n=(e.type=="FOLDER"?"000":"")+e.name,r=(t.type=="FOLDER"?"000":"")+t.name;return n>r});var r=$("<ul></ul>").attr("id","contentList-"+this.name).appendTo("#"+this.htmlObject);if(this.mode!=1&&this.mode!=4&&(NavigatorBaseComponent.path||Dashboards.getPathParameter())){var i={name:"Up",title:"Up",type:"FOLDER",description:"Go to parent directory",visible:!0,solution:NavigatorBaseComponent.getParentSolution(),path:t.substring(0,t.lastIndexOf("/"))};n.reverse().push(i),n.reverse()}var s=this;$.each(n,function(e,t){if(s.mode==1&&this.type=="FOLDER")return!0;if(s.mode==2&&this.type!="FOLDER")return!0;if(this.visible==1){var n="",i="",o="",u=NavigatorBaseComponent.template!=undefined&&NavigatorBaseComponent.template.length!=undefined&&NavigatorBaseComponent.template.length>0?"&template="+NavigatorBaseComponent.template:"",a;this.type=="FOLDER"?(n="folder",a=$("<a></a>").attr("target",i).attr("title",this.description).attr("parentPath",t.path).text(this.title).click(function(){s.draw($(this).attr("parentPath"))})):(this.url!=undefined?(n="action greybox",o=webAppPath+this.url):(n="action greybox",o=webAppPath+this.link),a=$("<a></a>").attr("target",i).attr("title",this.description).text(this.title).attr("href",o)),$("<li></li>").attr("class",n).appendTo(r).append(a)}}),$("#contentList-"+this.name+" a").tooltip({showURL:!1}),$("li.greybox a").click(function(){var e=this.title||this.innerHTML||this.href,t=this.href.replace(/'/g,"&#39;");return $.fancybox({type:"iframe",href:t,width:$(window).width(),height:$(window).height()}),!1})}}),PageTitleComponent=NavigatorBaseComponent.extend({update:function(){var e=this;NavigatorBaseComponent.navigatorResponse==-1?$.getJSON(wd.cdf.endpoints.getJSONSolution()+"?mode=contentlist&path="+(NavigatorBaseComponent.path||Dashboards.getPathParameter()),function(t){e.processPageTitleResponse(t)}):this.processPageTitleResponse(NavigatorBaseComponent.navigatorResponse)},processPageTitleResponse:function(e){NavigatorBaseComponent.navigatorResponse=e;var t=this.findPageTitleObject(e.content,e.id);t.title!=undefined&&t.description!=undefined&&$("#"+this.htmlObject).text(t.title+(t.description!=""?" - "+t.description:""))},findPageTitleObject:function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.id==t)return r;if((t+"/").indexOf(r.id+"/")>=0)return this.findPageTitleObject(r.folders,t);continue}}});pen.define("cdf/components/navigation",function(){});var AnalyzerComponent=BaseComponent.extend({update:function(){this.clear();var e=this.getOptions(),t=wd.cdf.endpoints.getAnalyzer(),n=this;this.viewOnly?t+="viewer":t+="editor";var r=this.height?this.height:"480px",i=this.width?this.width:"100%",s=this.generateIframe(this.htmlObject,t,e,r,i);$("#"+this.htmlObject).html(s)},getOptions:function(){var e={solution:this.solution,path:this.path,action:this.action,command:this.command==undefined?"open":this.command,showFieldList:this.showFieldList==undefined?!1:this.showFieldList,showRepositoryButtons:this.showRepositoryButtons==undefined?!1:this.showRepositoryButtons,frameless:this.frameless};return $.map(this.parameters,function(t){e[t[0]]=t.length==3?t[2]:Dashboards.getParameterValue(t[1])}),e},generateIframe:function(e,t,n,r,i){var s='<iframe id="iframe_'+e+'"'+' frameborder="0"'+' height="'+r+'"'+' width="'+i+'"'+' src="'+t+"?";return s+=$.param(n,!0),s+='"></iframe>',s}});pen.define("cdf/components/Pentaho.Analyzer",function(){});var JpivotComponent=BaseComponent.extend({update:function(){this.iframeScrolling==undefined&&(this.iframeScrolling="no");var e='<iframe id="jpivot_'+this.htmlObject+'" scrolling="'+this.iframeScrolling+'" onload="var dynamicHeight = this.contentWindow.document.body.offsetHeight+50; this.style.height = dynamicHeight + \'px\';" frameborder="0" height="'+this.iframeHeight+'" width="'+this.iframeWidth+'" src="',t={},n=new Array(this.parameters.length);for(var r=0,i=n.length;r<i;r++){var s=this.parameters[r][0],o=Dashboards.getParameterValue(this.parameters[r][1]);t[s]=o}e+=wd.cdf.endpoints.getCdfXaction(this.path,this.action,this.solution,t),e+='"></iframe>',$("#"+this.htmlObject).html(e)}}),PivotLinkComponent=BaseComponent.extend({update:function(){var e=this.tooltip==undefined?"View details in a Pivot table":this.tooltip,t=$('<a class="pivotLink"> </a>').html(this.content).attr("href","javascript:PivotLinkComponent.openPivotLink("+this.name+")").attr("title",e);$("#"+this.htmlObject).empty(),$("#"+this.htmlObject).html(t),$("a.pivotLink").tooltip({showURL:!1,track:!0,delay:1e3,opacity:.5})}},{openPivotLink:function(e){var t=wd.cdf.endpoints.getPivot("system","pentaho-cdf/actions","jpivot.xaction")+"&",n=e.pivotDefinition,r=[];for(p in n){var i=p,s=typeof n[p]=="function"?n[p]():n[p];r.push(i+"="+encodeURIComponent(s))}t+=r.join("&");var o=t.replace(/'/g,"&#39;");$.fancybox({type:"iframe",href:o,width:$(window).width(),height:$(window).height()})}});pen.define("cdf/components/Pentaho.JPivot",function(){});var PrptComponent=BaseComponent.extend({getIframeName:function(){return this.htmlObject+"_"+"prptFrame"},getIframe:function(){return'<iframe name="'+this.getIframeName()+'" style="width:100%;height:100%;border:0px" frameborder="0"/>'},startLoading:function(){this.loading||(this.loading=!0,Dashboards.incrementRunningCalls())},stopLoading:function(){this.loading&&(this.loading=!1,Dashboards.decrementRunningCalls())},update:function(){this.clear();var e=this.getOptions(),t=this.getParams(),n=this.getReportOptions();$.each(n,function(e,n){t[e]!=undefined&&delete e});var r={solution:e.solution,path:e.path,action:e.action};delete e.solution,delete e.path,delete e.action,delete n.solution,delete n.path,delete n.action;var i=this.downloadMode,s=e.showParameters?"viewer":"report";if(i==null){var o=e["output-target"];i=(o.indexOf("html")==-1||o.indexOf("mime-message")!=-1)&&o.indexOf("text")==-1}if(e["dashboard-mode"]){e.showParameters&&Dashboards.log("showParameters not supported with IFrame = False");var u=this.usePost?"POST":"GET",a=wd.cdf.endpoints.getReport(r,"report",{ts:(new Date).getTime()});$.each(n,function(e,n){t[e]==undefined&&(t[e]=n)});var f=this;$.ajax({url:a,type:u,data:t,dataType:"html",success:function(e){$("#"+f.htmlObject).html(e)}})}else{var l=$(this.getIframe()),c=$("#"+this.htmlObject);c.empty(),l=l.appendTo(c),this.autoResize&&(this._sHeight==null?(this._sHeight=c.height(),this._sWidth=c.width()):(c.height(this._sHeight),c.width(this._sWidth)));if(this.usePost){$.each(e,function(e,n){t[e]==undefined&&(t[e]=n)});var a=wd.cdf.endpoints.getReport(r,s,{ts:(new Date).getTime()});this._postToUrl(c,l,a,t,this.getIframeName())}else{$.extend(e,{ts:(new Date).getTime()});var a=wd.cdf.endpoints.getReport(r,s,e);e.showParameters&&this.autoResize&&(Dashboards.log("PrptComponent: autoResize disabled because showParameters=true"),this.autoResize=!1),this.startLoading();var f=this;l.load(function(){if(e.showParameters){var t=$(this.contentWindow.document.body),n=t.find("#reportContent");n.load(function(){f.autoResize&&f._resizeToReportFrame(n[0],c,e)})}f.stopLoading()}),l[0].contentWindow.location=a}i&&this.stopLoading()}},getOptions:function(){var e={paginate:this.paginate||!1,showParameters:this.showParameters||!1,autoSubmit:this.autoSubmit||this.executeAtStart||!1,"dashboard-mode":this.iframe==undefined?!1:!this.iframe,solution:this.solution,path:this.path,action:this.action,renderMode:"REPORT",htmlProportionalWidth:!1};this.paginate?(e["output-target"]="table/html;page-mode=page",e["accept-page"]=0):(e["output-target"]="table/html;page-mode=stream",e["accept-page"]=-1);for(var t=0;t<this.parameters.length;t++){var n=this.parameters[t],r=Dashboards.getParameterValue(n[1]);r==null&&n.length==3&&(r=n[2]),e[n[0]]=r}return e},getParams:function(){var e={};this.paginate?(e["output-target"]="table/html;page-mode=page",e["accept-page"]=0):(e["output-target"]="table/html;page-mode=stream",e["accept-page"]=-1);for(var t=0;t<this.parameters.length;t++){var n=this.parameters[t],r=Dashboards.getParameterValue(n[1]);r==null&&n.length==3&&(r=n[2]),e[n[0]]=r}return e},getReportOptions:function(){var e={paginate:this.paginate||!1,showParameters:this.showParameters||!1,autoSubmit:this.autoSubmit||this.executeAtStart||!1,"dashboard-mode":this.iframe==undefined?!1:!this.iframe,solution:this.solution,path:this.path,name:this.action,renderMode:"REPORT",htmlProportionalWidth:!1,"accepted-page":-1};return this.paginate?(e["output-target"]="table/html;page-mode=page",e["accept-page"]=0):(e["output-target"]="table/html;page-mode=stream",e["accept-page"]=-1),e},_postToUrl:function(e,t,n,r,i){this.startLoading();var s=this._getParamsAsForm(document,n,r,this.getIframeName());e[0].appendChild(s);var o=this;t.load(function(){o.autoResize&&o._resizeToReportFrame(t[0],e,r),o.stopLoading()}),s.submit()},_resizeToReportFrame:function(e,t,n){var r=n["output-target"],i=function(e){return e.indexOf("html")!=-1&&e.indexOf("mime")==-1},s=function(e){return e.indexOf("text")!=-1},o=function(e){return e.indexOf("xml")!=-1};try{var u=e.contentWindow.document;if(e.contentWindow.document){var a=null;i(r)||s(r)?a=u.body:o(r)&&(a=u.firstChild);if(a!=null){var f=0,l=0;if(i(r)){var c=$(a);f=c.outerHeight(!0)-c.outerHeight(!1),l=c.outerWidth(!0)-c.outerWidth(!1)}t.height(a.scrollHeight+f),t.width(a.scrollWidth+l)}}}catch(h){Dashboards.log(h)}},_getParamsAsForm:function(e,t,n,r){var i=e.createElement("form");i.setAttribute("method","post"),i.setAttribute("action",t),i.setAttribute("target",r);for(var s in n)if(n.hasOwnProperty(s)){var o=n[s];if($.isArray(o))for(var u=0;u<o.length;u++){var a=e.createElement("input");a.setAttribute("type","hidden"),a.setAttribute("name",s),a.setAttribute("value",o[u]),i.appendChild(a)}else{var a=e.createElement("input");a.setAttribute("type","hidden"),a.setAttribute("name",s),a.setAttribute("value",o),i.appendChild(a)}}return i}}),SchedulePrptComponent=PrptComponent.extend({visible:!1,update:function(){var e=this,t=$("#"+this.htmlObject);$.inArray(t[0].tagName.toUpperCase(),["SPAN","DIV"])>-1&&(t=$("<button/>").appendTo(t.empty()),t[0].tagName=="DIV"&&t.wrap("<span/>"),this.label!=undefined&&t.text(this.label),t.button(),t.addClass("scheduler_button")),t.unbind("click"),t.bind("click",function(){var t=typeof e.preChange=="undefined"?!0:e.preChange();t&&e.schedulePrptComponent(),typeof e.postChange=="undefined"?!0:e.postChange()})},schedulePrptComponent:function(){var e={},t,n=!1;guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,n=e=="x"?t:t&3|8;return n.toString(16)})},triggerError=function(e,t){n=!0,$(t).css("backgroundColor","rgb(255,159,159)");var r=$(t).val();$(t).val(e),setTimeout(function(){$(t).css("backgroundColor","white"),$(t).val(r)},2e3)},getFileName=function(){var e=r.path;return e.substring(e.lastIndexOf("/")+1,e.lastIndexOf("."))},getDefaultLocation=function(){return"/home/"+Dashboards.context.user},getHour=function(){var e=$("#hours").val();return $("#amPm").val()=="pm"?(e=parseInt(e,10)+12,e==24&&(e=12)):e=="12"&&(e=0),e},getUTC=function(e,t){var n=e.split("/");return t?(new Date(n[2],n[0]-1,n[1],23,59,59,0)).getTime():(new Date(n[2],n[0]-1,n[1],0,0,0,0)).getTime()},getISO=function(e){var t=e.split("/");return(new Date(t[2],t[0]-1,t[1],0,0,0,0)).toISOString()},makeSelect=function(e,t,n,r){var i='<select id ="'+r+'">';for(var s=e;s<=t;s+=n)s<10?i+='<option value="'+s+'">0'+s+"</option>":i+='<option value="'+s+'">'+s+"</option>";return i+="</select>",i},validateStartDate=function(e,t){var n=new Date;(isNaN(e)||e<n.getTime())&&triggerError("Incorrect Date, pick date from calendar",t)},validateEndDate=function(e,t){if($("#endByRadio").is(":checked")){var n=new Date,r=$("#rangeStartIn").val(),i=getUTC(r);isNaN(i)||(i>e?triggerError("End Date > Start Date",t):(isNaN(e)||e<n.getTime())&&triggerError("Incorrect Date",t))}},validateName=function(e){e==""&&triggerError("You must choose a name","#nameIn");var t=/[^0-9a-zA-Z ]/;e.match(t)&&triggerError("Invalid characters, alpha-numeric text only.","#nameIn")},startTimeGetter=function(e){var t=getHour(),n=$("#minutes").val(),r=n*6e4+t*36e5,i;return e!=undefined?(i=getUTC($(e).val())+r,validateStartDate(i,e)):(i=getUTC($("#rangeStartIn").val())+r,validateStartDate(i,"#rangeStartIn")),(new Date(i)).toISOString()},endTimeGetter=function(){var e=getUTC($("#endByIn").val(),!0);return validateEndDate(e,"#endByIn"),(new Date(e)).toISOString()},getSelectedDaysOfWeek=function(){var e=new Array,t=0;return $("#sunday").is(":checked")&&(e[t++]=0),$("#monday").is(":checked")&&(e[t++]=1),$("#tuesday").is(":checked")&&(e[t++]=2),$("#wednesday").is(":checked")&&(e[t++]=3),$("#thursday").is(":checked")&&(e[t++]=4),$("#friday").is(":checked")&&(e[t++]=5),$("#saturday").is(":checked")&&(e[t++]=6),e},getDayOfMonth=function(){return dayOfMonth=$("#recurrPatternIn").val(),dayOfMonth<1?triggerError(">0","#recurrPatternIn"):dayOfMonth>31&&triggerError("<=31","#recurrPatternIn"),dayOfMonth},setParameters=function(){e={inputFile:r.path,jobName:$("#nameIn").val(),outputFile:$("#locationIn").val()},n=!1;var t=$("#recurrId").val(),i=$("#nameIn").val();validateName(i);switch(t){case"once":var s=startTimeGetter("#startDateIn"),o={repeatCount:0,repeatInterval:0,startTime:s,uiPassParam:"RUN_ONCE"};e.simpleJobTrigger=o;break;case"seconds":var s=startTimeGetter(),u=$("#recurrPatternInSec").val();u<1&&triggerError(">0","#recurrPatternInSec");if($("#endByRadio").is(":checked"))var a=endTimeGetter();var o={endTime:a,repeatCount:-1,repeatInterval:u,startTime:s,uiPassParam:"SECONDS"};e.simpleJobTrigger=o;break;case"minutes":var s=startTimeGetter(),f=$("#recurrPatternInMin").val();f<1&&triggerError(">0","#recurrPatternInMin");if($("#endByRadio").is(":checked"))var a=endTimeGetter();var o={endTime:a,repeatCount:-1,repeatInterval:f*60,startTime:s,uiPassParam:"MINUTES"};e.simpleJobTrigger=o;break;case"hours":var s=startTimeGetter(),l=$("#recurrPatternInHour").val();l<1&&triggerError(">0","#recurrPatternInHour");if($("#endByRadio").is(":checked"))var a=endTimeGetter();var o={endTime:a,repeatCount:-1,repeatInterval:l*3600,startTime:s,uiPassParam:"HOURS"};e.simpleJobTrigger=o;break;case"daily":if($("#endByRadio").is(":checked"))var a=endTimeGetter();var s=startTimeGetter();if($("#weekDayRadio").is(":checked")){var c={daysOfWeek:[1,2,3,4,5],endTime:a,startTime:s,uiPassParam:"DAILY"};e.complexJobTrigger=c}else if($("#dayRadio").is(":checked")){var h=$("#recurrPatternInDay").val();h<1&&triggerError(">0","#recurrPatternInDay");var o={entTime:a,repeatCount:-1,repeatInterval:h*86400,startTime:s,uiPassParam:"DAILY"};e.simpleJobTrigger=o}break;case"weekly":var s=startTimeGetter();if($("#endByRadio").is(":checked"))var a=endTimeGetter();var c={daysOfWeek:getSelectedDaysOfWeek(),endTime:a,startTime:s,uiPassParam:"WEEKLY"};e.complexJobTrigger=c;break;case"monthly":var s=startTimeGetter();if($("#endByRadio").is(":checked"))var a=endTimeGetter();var c={endTime:a,startTime:s,uiPassParam:"MONTHLY"};$("#monthRadio").is(":checked")?c.daysOfMonth=getDayOfMonth():(c.daysOfWeek=$("#monthOpt2Select").val(),c.weeksOfMonth=$("#monthOpt1Select").val()),e.complexJobTrigger=c;break;case"yearly":var s=startTimeGetter();if($("#endByRadio").is(":checked"))var a=endTimeGetter();var c={endTime:a,startTime:s,uiPassParam:"YEARLY"};$("#yearRadio").is(":checked")?(c.daysOfMonth=getDayOfMonth(),c.monthsOfYear=$("#yearEveryMonth").val()):(c.daysOfWeek=$("#yearOpt2Select").val(),c.monthsOfYear=$("#yearMonthSelect").val(),c.weeksOfMonth=$("#yearOpt1Select").val()),e.complexJobTrigger=c;break;case"cron":var p=$("#cronString").val();validateCron(p);var s=getISO($("#rangeStartIn").val());$("#endByRadio").is(":checked")&&(a=endTimeGetter());var d={cronString:p,endTime:a,startTime:s,uiPassParam:"CRON"};e.cronJobTrigger=d}},validateCron=function(e){var t=e.split(" ");t.length<7?triggerError("Cron Expression too short","#cronString"):t.length>7?triggerError("Cron Expression too long","#cronString"):t[3]!="?"&&t[3]!="*"&&t[5]!="?"&&t[5]!="*"&&triggerError("M+W unsuported.(M+? or W+?)","#cronString")},hideAll=function(){$("#rangeOfRecurrDiv").hide(),$("#cronDiv").hide(),$("#recurrPatternDiv").hide(),$("#startTimeDiv").hide(),$("#rangeOfRecurrOnceDiv").hide(),$("#patternSec").hide(),$("#patternMin").hide(),$("#patternHour").hide(),$("#patternDay").hide(),$("#patternWeek").hide(),$("#patternMonth").hide(),$("#patternYear").hide()},changeOpts=function(){var e=$("#recurrId").val();hideAll();switch(e){case"once":$("#startTimeDiv").show(),$("#rangeOfRecurrOnceDiv").show();break;case"seconds":$("#startTimeDiv").show(),$("#recurrPatternDiv").show(),$("#patternSec").show(),$("#rangeOfRecurrDiv").show();break;case"minutes":$("#startTimeDiv").show(),$("#recurrPatternDiv").show(),$("#patternMin").show(),$("#rangeOfRecurrDiv").show();break;case"hours":$("#startTimeDiv").show(),$("#recurrPatternDiv").show(),$("#patternHour").show(),$("#rangeOfRecurrDiv").show();break;case"daily":$("#startTimeDiv").show(),$("#recurrPatternDiv").show(),$("#patternDay").show(),$("#rangeOfRecurrDiv").show();break;case"weekly":$("#startTimeDiv").show(),$("#recurrPatternDiv").show(),$("#patternWeek").show(),$("#rangeOfRecurrDiv").show();break;case"monthly":$("#startTimeDiv").show(),$("#recurrPatternDiv").show(),$("#patternMonth").show(),$("#rangeOfRecurrDiv").show();break;case"yearly":$("#startTimeDiv").show(),$("#recurrPatternDiv").show(),$("#patternYear").show(),$("#rangeOfRecurrDiv").show();break;case"cron":$("#cronDiv").show(),$("#rangeOfRecurrDiv").show()}},createJobParameter=function(e,t,n,i){return!i&&r.getReportOptions()[e]!=undefined?{name:e,stringValue:new Array(""+r.getReportOptions()[e]),type:n}:{name:e,stringValue:new Array(""+t),type:n}};var r=this,i='<option value="0">January</option><option value="1">February</option><option value="2">March</option><option value="3">April</option><option value="4">May</option><option value="5">June</option><option value="6">July</option><option value="7">August</option><option value="8">September</option><option value="9">October</option><option value="10">November</option><option value="11">December</option>',s='<option value="0">sunday</option><option value="1">monday</option><option value="2">tuesday</option><option value="3">wednesday</option><option value="4">thursday</option><option value="5">friday</option><option value="6">saturday</option>',o='<option value="0">first</option><option value="1">second</option><option value="2">third</option><option value="3">fourth</option><option value="4">last</option>',u='<label id="err" style="display:none">Incorrect Input</label>',a='<div id="nameDiv"><form style="display:inline-block" id="nameForm"><span class="dialog-label">Name:</span><input id="nameIn" type="text" value="'+getFileName()+'"></form></div>',f='<div id="locationDiv"><form style="display:inline-block" id="nameForm"><span class="dialog-label">Location:</span><input id="locationIn" type="text" value="'+getDefaultLocation()+'"></form></div>',l='<div id="groupDiv"><form style="display:inline-block" id="groupForm"><span class="dialog-label">Group:</span><input id="groupIn" type="text" value=""></form></div>',c='<div><form style="display:inline-block" id="descForm"><span class="dialog-label">Description:</span><input id="descIn" type="text" value=""></form></div>',h='<div id = "recurrenceDiv"><br><span class="dialog-title" style="width: 100px; display: inline-block;">Recurrence:</span><select id="recurrId" onChange="changeOpts()" style="margin-left: 0px;"><option value = "once" selected>Run Once</option><option value = "seconds">Seconds</option><option value = "minutes">Minutes</option><option value = "hours">Hours</option><option value = "daily">Daily</option><option value = "weekly">Weekly</option><option value = "monthly">Monthly</option><option value = "yearly">Yearly</option><option value = "cron">Cron</option></select></br></div>',p='<div id="cronDiv"  style="display:none"><form><span class="dialog-label">Cron String:</span><input id="cronString" type="text" value=""></form></div>',d=makeSelect(1,12,1,"hours"),v=makeSelect(0,59,1,"minutes"),m='<select id = "amPm"><option value="am">AM</option><option value="pm">PM</option></select>',g='<div id="startTimeDiv"><br><span class="dialog-title" style="width: 100px; display: inline-block;">Start Time:</span>'+d+v+m+"</div>",y='<div id="recurrPatternDiv" style = "display:none"><div id="patternSec" ><label style="display:inline-block; margin-left: 100px; font-weight: 500;">Every</label>&nbsp;&nbsp;<form style="display:inline-block"><input id= "recurrPatternInSec" type="text" size="3" style="width:30px;"></form><label style="display:inline-block; font-weight: 500;"> second(s)</label></div><div id="patternMin" ><label style="display:inline-block; margin-left: 100px; font-weight: 500;">Every</label>&nbsp;&nbsp;<form style="display:inline-block"><input id= "recurrPatternInMin" type="text" size="3" style="width:30px;"></form><label style="display:inline-block; font-weight: 500;"> minute(s)</label></div><div id="patternHour" ><label style="display:inline-block; margin-left: 100px; font-weight: 500;">Every</label>&nbsp;&nbsp;<form style="display:inline-block"><input id= "recurrPatternInHour" type="text" size="3" style="width:30px;"></form><label style="display:inline-block; font-weight: 500;"> hour(s)</label></div><div id="patternDay" ><input type="radio" name ="day" value="day" id="dayRadio" style="margin-left: 100px; font-weight: 500;" checked> <label style="display:inline-block">Every</label>&nbsp;&nbsp;<form style="display:inline-block"><input id= "recurrPatternInDay" type="text" size="3" style="width:30px;"></form><label style="display:inline-block; font-weight: 500;"> day(s)</label></br><input type="radio" name ="day" value="weekDay" id="weekDayRadio" style="margin-left: 100px;"> Every weekday</div><div id="patternWeek" ><form><div id="errorCheckboxes" style="display:none"><label id="errWeek">Choose at least one week</label></div><input type="checkbox" name="weekday" value="monday" id="monday" style="margin-left: 100px;"> Monday<input type="checkbox" name="weekday" value="tuesday" id="tuesday"> Tuesday<input type="checkbox" name="weekday" value="wednesday" id="wednesday"> Wednesday<input type="checkbox" name="weekday" value="thursday" id="thursday"> Thursday</br><input type="checkbox" name="weekday" value="friday" id="friday" style="margin-left: 100px;"> Friday<input type="checkbox" name="weekday" value="saturday" id="saturday"> Saturday<input type="checkbox" name="weekday" value="sunday" id="sunday"> Sunday</form></div><div id="patternMonth" ><input id="monthRadio" type="radio" name ="month" value="day" style="margin-left: 100px;" checked> <label style="display:inline-block; font-weight: 500;">Day</label>&nbsp;&nbsp;<form style="display:inline-block"><input id= "recurrPatternIn" type="text" size="3" style="width:205px;"></form><label style="display:inline-block; font-weight: 500;"> of every month</label></br><input type="radio" name ="month" value="the" style="margin-left: 100px;"> <label style="display:inline-block; font-weight: 500;">The</label>&nbsp;&nbsp;<select id="monthOpt1Select">'+o+"</select>"+'<select id="monthOpt2Select">'+s+'</select><label style=" font-weight: 500;"> of every month</label>'+"</div>"+'<div id="patternYear" >'+'<input id ="yearRadio" type="radio" name ="year" value="month" style="margin-left: 100px;" checked> <label style="display:inline-block; font-weight: 500;">Every</label>&nbsp;'+'<select id="yearEveryMonth">'+i+'</select><input id="yearDayMonth"type="text" size="3">'+"</br>"+'<input type="radio" name ="year" value="the" style="margin-left: 100px;"> <label style="display:inline-block; font-weight: 500;">The</label>&nbsp;'+'<select id="yearOpt1Select">'+o+"</select>"+'<select id="yearOpt2Select">'+s+'</select><label style=" font-weight: 500;">of&nbsp;&nbsp;</label>'+'<select id="yearMonthSelect">'+i+"</select>"+"</div>"+"</div>",b='<div id="rangeOfRecurrDiv" style="display:none"><br><span class="dialog-title"><strong>Range of Recurrence:</strong> </span><form><span class="dialog-label">Start:</span><input type="text" id="rangeStartIn"></form><form><span class="dialog-label">End:</span><input type="radio" name ="end" value="noEnd" checked> No end date</br><input type="radio" name ="end" value ="endBy" id="endByRadio" style="margin-left:100px;"> End by:&nbsp;&nbsp;<input id= "endByIn" type="text" style="width:187px;"></form></div>',w='<div id="rangeOfRecurrOnceDiv"><form><span class="dialog-label">Start Date:</span><input id= "startDateIn" type="text" value=""></form></div>',E='<div id="mailQuestionDiv"><label>Would you like to email a copy when the schedule runs?</label><input type="radio" name="mailRadio" value="no" id="mailRadioNo" checked onClick=\'$("#mailInfoDiv").hide(350)\'>No</input><input type="radio" name="mailRadio" value="yes" id="mailRadioYes" onClick=\'$("#mailInfoDiv").show(350)\'>Yes</input></div>',S='<div id="mailInfoDiv" style="display:none"><label>To: (Use a semi-colon or comma to separate multiple email adresses.)</label><form><input id="toInput" style="width:100%" type="text"></input></form><label>Subject:</label><form><input id="subjectInput" style="width:100%" type="text" value="'+getFileName()+" schedule has successfully run."+'"></input></form>'+"<label>Attachment Name:</label>"+'<form><input id="attachmentNameInput" style="width:100%" type="text" value="'+$("#nameIn").val()+'"></input></form>'+"<label>Message (optional)</label>"+'<textArea id="messageInput" type="text" rows="4"></textArea>'+"</div>";scheduleRequest=function(t){var n=r.outputTarget?r.outputTarget:"table/html;page-mode=page",i=new Array,s=0;i[s++]=createJobParameter("output-target",n,"string",!0),i[s++]=createJobParameter("accepted-page","0","string"),i[s++]=createJobParameter("showParameters","true","string"),i[s++]=createJobParameter("renderMode","XML","string"),i[s++]=createJobParameter("htmlProportionalWidth","false","string"),t&&(i[s++]=createJobParameter("_SCH_EMAIL_TO",$("#toInput").val(),"string"),i[s++]=createJobParameter("_SCH_EMAIL_CC","","string"),i[s++]=createJobParameter("_SCH_EMAIL_BCC","","string"),i[s++]=createJobParameter("_SCH_EMAIL_SUBJECT",$("#subjectInput").val(),"string"),i[s++]=createJobParameter("_SCH_EMAIL_MESSAGE",$("#messageInput").val(),"string"),i[s++]=createJobParameter("_SCH_EMAIL_ATTACHMENT_NAME",$("#attachmentNameInput").val(),"string"));for(var o=0;o<r.parameters.length;o++)i[s++]=createJobParameter(r.parameters[o][0],r.parameters[o][1],"string",!0);e.jobParameters=i;var u=!1,a=$.ajaxSettings.async;return $.ajaxSetup({async:!1}),$.ajax({url:wd.cdf.endpoints.getScheduledJob(),type:"POST",data:JSON.stringify(e),contentType:"application/json",success:function(e){alert("Successfully scheduled."),u=!0},error:function(e){alert(e.responseText),sucess=!1}}),$.ajaxSetup({async:a}),u};var x=a+f+h+p+g+y+b+w,T=E+S,N=!1;$.ajax({type:"GET",url:wd.cdf.endpoints.getEmailConfig()+"/isValid",success:function(e){N=e}});var C={basicState:{html:x,title:"Schedule Report",buttons:{Cancel:-1,Ok:1},submit:function(r,i,s,o){t=guid();if(r==-1)$.prompt.close();else if(r==1)return setParameters(),n?(e={},!1):N?($("#attachmentNameInput").val($("#nameIn").val()),$.prompt.goToState("mailState"),!1):scheduleRequest()}},mailState:{html:T,title:"Schedule Report",buttons:{Back:-1,Ok:1},submit:function(e,t,n,r){if(e==-1)return $.prompt.goToState("basicState"),!1;if(e==1){if($("#mailRadioNo").is(":checked"))return scheduleRequest();if($("#mailRadioYes").is(":checked")){var i=/^\S+@\S+$/;return $("#toInput").val().match(i)?scheduleRequest(!0):(triggerError("Invalid email","#toInput"),!1)}return!1}}}};$.prompt(C,{classes:"scheduler"}),$(".scheduler #jqi").css("width","510px"),$(document).ready(function(e){$("#startDateIn").datepicker({minDate:0}),$("#rangeStartIn").datepicker({minDate:0}),$("#endByIn").datepicker({minDate:0}),$("#startDateIn").datepicker("setDate",new Date),$("#rangeStartIn").datepicker("setDate",new Date)})}}),ExecutePrptComponent=PrptComponent.extend({visible:!1,update:function(){var e=this,t=$("#"+this.htmlObject);$.inArray(t[0].tagName.toUpperCase(),["SPAN","DIV"])>-1&&(t=$("<button/>").appendTo(t.empty()),t[0].tagName=="DIV"&&t.wrap("<span/>"),this.label!=undefined&&t.text(this.label),t.button()),t.unbind("click"),t.bind("click",function(){var t=typeof e.preChange=="undefined"?!0:e.preChange();t&&e.executePrptComponent(),typeof e.postChange=="undefined"?!0:e.postChange()})},executePrptComponent:function(){var e=this.getOptions(),t={};e.solution&&$.extend(t,{solution:e.solution}),e.path&&$.extend(t,{path:e.path}),e.action&&$.extend(t,{action:e.action}),delete e.solution,delete e.path,delete e.action,$.extend(e,{ts:(new Date).getTime()}),$.fancybox({type:"iframe",href:wd.cdf.endpoints.getReport(t,"viewer",e),width:$(window).width(),height:$(window).height()-50})}});pen.define("cdf/components/Pentaho.Reporting",function(){});var XactionComponent=BaseComponent.extend({update:function(){var e=this;try{if(typeof this.iframe=="undefined"||!this.iframe){var t=new Array(this.parameters?this.parameters.length:0);for(var n=0,r=t.length;n<r;n++){var i=this.parameters[n][0],s=this.parameters[n][1]==""?this.parameters[n][2]:Dashboards.getParameterValue(this.parameters[n][1]);this.value=="NIL"&&(this.value=this.parameters[n][2]),t[n]=[i,s]}if(typeof this.serviceMethod=="undefined"||this.serviceMethod=="ServiceAction"){var o=Dashboards.callPentahoAction(e,this.solution,this.path,this.action,t,null);o!=null&&$("#"+e.htmlObject).html(o.find("ExecuteActivityResponse:first-child").text())}else{var u=Dashboards.pentahoServiceAction(this.serviceMethod,"html",this.solution,this.path,this.action,t,null);$("#"+e.htmlObject).html(u)}}else{var a='<iframe id="iframe_'+this.htmlObject+'"'+' frameborder="0"'+' height="100%"'+' width="100%" />',f=$(a),l=wd.cdf.endpoints.getCdfXaction(this.path,this.action,this.solution)+"&wrapper=false",t=new Array(this.parameters.length);for(var n=0,r=t.length;n<r;n++){var c="&"+encodeURIComponent(this.parameters[n][0])+"=",h="";this.parameters[n][1]==""?h=encodeURIComponent(this.parameters[n][2]):(h=encodeURIComponent(Dashboards.getParameterValue(this.parameters[n][1])),h=="NIL"&&(h=encodeURIComponent(this.parameters[n][2]))),l+=c+h}this.loading||(this.loading=!0,Dashboards.incrementRunningCalls()),f.load(function(){this.contentWindow.document.body.innerHTML&&(e.loading=!1,Dashboards.decrementRunningCalls())}),$("#"+this.htmlObject).empty().append(f),f[0].contentWindow.location=l}}catch(p){}}}),ExecuteXactionComponent=BaseComponent.extend({visible:!1,update:function(){var e=this,t=$("#"+this.htmlObject);$.inArray(t[0].tagName.toUpperCase(),["SPAN","DIV"])>-1&&(t=$("<button/>").appendTo(t.empty()),t[0].tagName=="DIV"&&t.wrap("<span/>"),this.label!=undefined&&t.text(this.label),t.button()),t.unbind("click"),t.bind("click",function(){var t=typeof e.preChange=="undefined"?!0:e.preChange();t&&e.executeXAction(),typeof e.postChange=="undefined"?!0:e.postChange()})},executeXAction:function(){var e=wd.cdf.endpoints.getCdfXaction(this.path,this.action,this.solution)+"&",t=new Array(this.parameters.length),n=[];for(var r=0,i=t.length;r<i;r++){var s=this.parameters[r][0],o=Dashboards.getParameterValue(this.parameters[r][1]);$.isArray(o)?$(o).each(function(e){n.push(s+"="+encodeURIComponent(this))}):n.push(s+"="+encodeURIComponent(o))}e+=n.join("&");var u=e.replace(/'/g,"&#39;");$.fancybox({type:"iframe",href:u,width:$(window).width(),height:$(window).height()-50})}});pen.define("cdf/components/Pentaho.XAction",function(){}),pen.define("cdf/components/pentaho",function(){});var SimpleAutoCompleteComponent=BaseComponent.extend({ph:undefined,completionCallback:undefined,update:function(){var e=this;if(this.ph==undefined){this.ph=$("#"+this.htmlObject).empty(),this.input=$("<input type='text'>").appendTo(this.ph),this.query=Dashboards.getQuery(this.queryDefinition);var e=this;this.input.autocomplete({source:function(t,n){return e.triggerQuery(t.term,n)}}),this.input.change(function(){Dashboards.processChange(e.name)}).keyup(function(t){t.keyCode==13&&Dashboards.processChange(e.name)})}},handleQuery:function(e){var t=this;return function(n){if(typeof t.postFetch=="function"){var r=t.postFetch(n);n=r||n}var i=n.resultset.map(function(e){return e[0]});e(i)}},triggerQuery:function(e,t){var n=$.extend([],this.parameters),r="'"+e+"'";this.searchParam?n.push([this.searchParam,r]):n.length>0&&(this.parameters[0][1]=r),e.length>=this.minTextLength?this.query.fetchData(n,this.handleQuery(t)):t([])},getValue:function(){return this.input.val()}});pen.define("cdf/components/simpleautocomplete",function(){}),$.fn.dataTableExt!=undefined&&($.fn.dataTableExt.oApi.fnLengthChange=function(e,t){e._iDisplayLength=t,e.oApi._fnCalculateEnd(e),e._iDisplayEnd==e.aiDisplay.length&&(e._iDisplayStart=e._iDisplayEnd-e._iDisplayLength,e._iDisplayStart<0&&(e._iDisplayStart=0)),e._iDisplayLength==-1&&(e._iDisplayStart=0),e.oApi._fnDraw(e),$("select",e.oFeatures.l).val(t)},$.extend($.fn.dataTableExt.oSort,{"numeric-asc":function(e,t){return e=e=="-"||e==""?0:$.isNumeric(e)?e*1:0,t=t=="-"||t==""?0:$.isNumeric(t)?t*1:0,e<t?-1:e>t?1:0},"numeric-desc":function(e,t){return e=e=="-"||e==""?0:$.isNumeric(e)?e*1:0,t=t=="-"||t==""?0:$.isNumeric(t)?t*1:0,e<t?1:e>t?-1:0}})),jQuery.fn.DataTable!=undefined&&jQuery.fn.DataTable.ext!=undefined&&(jQuery.extend(jQuery.fn.DataTable.ext.classes,{sPagePrevEnabled:"paginate_enabled_previous",sPagePrevDisabled:"paginate_disabled_previous",sPageNextEnabled:"paginate_enabled_next",sPageNextDisabled:"paginate_disabled_next"}),jQuery.extend(jQuery.fn.DataTable.ext.oJUIClasses,{sPagePrevEnabled:"fg-button ui-button ui-state-default ui-corner-left",sPagePrevDisabled:"fg-button ui-button ui-state-default ui-corner-left ui-state-disabled",sPageNextEnabled:"fg-button ui-button ui-state-default ui-corner-right",sPageNextDisabled:"fg-button ui-button ui-state-default ui-corner-right ui-state-disabled",sPageJUINext:"ui-icon ui-icon-circle-arrow-e",sPageJUIPrev:"ui-icon ui-icon-circle-arrow-w"}),jQuery.extend(jQuery.fn.DataTable.ext.pager,{two_button:{fnInit:function(e,t,n){var r=e.oLanguage.oPaginate,i=e.oClasses,s=function(t){e.oApi._fnPageChange(e,t.data.action)&&n(e)},o=e.bJUI?'<a class="'+e.oClasses.sPagePrevDisabled+'" tabindex="'+e.iTabIndex+'" role="button"><span class="'+e.oClasses.sPageJUIPrev+'"></span></a>'+'<a class="'+e.oClasses.sPageNextDisabled+'" tabindex="'+e.iTabIndex+'" role="button"><span class="'+e.oClasses.sPageJUINext+'"></span></a>':'<a class="'+e.oClasses.sPagePrevDisabled+'" tabindex="'+e.iTabIndex+'" role="button">'+r.sPrevious+"</a>"+'<a class="'+e.oClasses.sPageNextDisabled+'" tabindex="'+e.iTabIndex+'" role="button">'+r.sNext+"</a>";$(t).append(o);var u=$("a",t),a=u[0],f=u[1];e.oApi._fnBindAction(a,{action:"previous"},s),e.oApi._fnBindAction(f,{action:"next"},s),e.aanFeatures.p||(t.id=e.sTableId+"_paginate",a.id=e.sTableId+"_previous",f.id=e.sTableId+"_next",a.setAttribute("aria-controls",e.sTableId),f.setAttribute("aria-controls",e.sTableId))},fnUpdate:function(e,t){if(!e.aanFeatures.p)return;var n=e.oClasses,r=e.aanFeatures.p,i;for(var s=0,o=r.length;s<o;s++)i=r[s].firstChild,i&&(i.className=e._iDisplayStart===0?n.sPagePrevDisabled:n.sPagePrevEnabled,i=i.nextSibling,i.className=e.fnDisplayEnd()==e.fnRecordsDisplay()?n.sPageNextDisabled:n.sPageNextEnabled)}}}));var TableComponent=UnmanagedComponent.extend({ph:undefined,update:function(){if(!this.preExec())return;if(!this.htmlObject)return this.error("TableComponent requires an htmlObject");try{this.block(),this.setup();if(this.chartDefinition.paginateServerside)this.paginatingUpdate();else{var e=_.bind(function(e){this.rawData=e,this.processTableComponentResponse(e)},this),t=this.getSuccessHandler(e);this.queryState.setAjaxOptions({async:!0}),this.queryState.fetchData(this.parameters==undefined?[]:this.parameters,t)}}catch(n){Dashboards.log(n,"exception"),this.unblock()}},paginatingUpdate:function(){var e=this.chartDefinition;this.extraOptions=this.extraOptions||[],this.extraOptions.push(["bServerSide",!0]),this.extraOptions.push(["bProcessing",!0]),this.queryState.setPageSize(parseInt(e.displayLength||10));var t=_.bind(function(e){changedValues=undefined,typeof this.postFetch=="function"&&(changedValues=this.postFetch(e)),changedValues!=undefined&&(e=changedValues),this.processTableComponentResponse(e)},this);this.queryState.setCallback(t),this.queryState.setParameters(this.parameters),this.queryState.setAjaxOptions({async:!0}),this.queryState.fetchData(this.parameters,t)},setup:function(){var e=this.chartDefinition;if(e==undefined){Dashboards.log("Fatal - No chart definition passed","error");return}e.tableId=this.htmlObject+"Table",this.ph=$("#"+this.htmlObject).empty();var t=$.extend({},e);t.drawCallback=undefined,this.queryState=Dashboards.getQuery(t),this.query=this.queryState;var n=this.chartDefinition.sortBy||[],r=[];for(var i=0;i<n.length;i++){var s=n[i][0],o=n[i][1];r.push(s+(o=="asc"?"A":"D"))}this.queryState.setSortBy(r)},pagingCallback:function(e,t,n,r){function i(e){for(var n=0,r=t.length;n<r;n++)if(t[n].name==e)return t[n].value;return null}var s=i("iSortingCols"),o=[];if(s>0)for(var u=0;u<s;u++){var a=i("iSortCol_"+u),f=i("sSortDir_"+u);o.push(a+(f=="asc"?"A":"D"))}var l=this.queryState,c=this;l.setSortBy(o.join(",")),l.setPageSize(parseInt(i("iDisplayLength"))),l.setPageStartingAt(i("iDisplayStart")),l.setSearchPattern(i("sSearch")?i("sSearch"):""),l.fetchData(function(e){if(c.postFetch){var t=c.postFetch(e,r);typeof t!="undefined"&&(e=t)}var s={iTotalRecords:e.queryInfo.totalRows,iTotalDisplayRecords:e.queryInfo.totalRows};s.aaData=e.resultset,s.sEcho=i("sEcho"),c.rawData=e,n(s)})},fnDrawCallback:function(dataTableSettings){var dataTable=dataTableSettings.oInstance,cd=this.chartDefinition,myself=this,handleAddIns=_.bind(this.handleAddIns,this);this.ph.find("tbody tr").each(function(e,t){if(dataTable.fnGetPosition(t)==null)return!0;$(t).children("td").each(function(e,t){var n=handleAddIns(dataTable,t);if(!n&&cd.colFormats){var r=dataTable.fnGetPosition(t);if(r&&typeof r[0]=="number"){var i=r[0],s=r[2],o=cd.colFormats[s],u=myself.rawData.resultset[i][s];o&&typeof u!="undefined"&&u!==null&&$(t).text(sprintf(o,u))}}})});if(cd.urlTemplate!=undefined){var td=$("#"+myself.htmlObject+" td:nth-child(1)");td.addClass("cdfClickable"),td.bind("click",function(e){var regex=new RegExp("{"+cd.parameterName+"}","g"),f=cd.urlTemplate.replace(regex,$(this).text());eval(f)})}typeof cd.drawCallback=="function"&&cd.drawCallback.apply(myself,arguments)},fnInitComplete:function(){this.postExec(),this.unblock()},handleAddIns:function(e,t){var n=this.chartDefinition,r=e.fnGetPosition(t);if(r&&typeof r[0]!="number")return!1;rowIdx=r[0],colIdx=r[2],colType=n.colTypes[colIdx],addIn=this.getAddIn("colType",colType),state={},target=$(t),results=this.rawData;if(!addIn)return!1;try{if(!target.parents("tbody").length)return;return target.get(0).tagName!="TD"&&(target=target.closest("td")),state.rawData=results,state.tableData=e.fnGetData(),state.colIdx=colIdx,state.rowIdx=rowIdx,state.series=results.resultset[state.rowIdx][0],state.category=results.metadata[state.colIdx].colName,state.value=results.resultset[state.rowIdx][state.colIdx],n.colFormats&&(state.colFormat=n.colFormats[state.colIdx]),state.target=target,addIn.call(t,state,this.getAddInOptions("colType",addIn.getName())),!0}catch(i){return Dashboards.log(i,"exception"),!1}},processTableComponentResponse:function(e){var t=this,n=this.chartDefinition,r={};this.ph.trigger("cdfTableComponentProcessResponse");if(typeof n.colHeaders=="undefined"||n.colHeaders.length==0)n.colHeaders=e.metadata.map(function(e){return e.colName});if(typeof n.colTypes=="undefined"||n.colTypes.length==0)n.colTypes=e.metadata.map(function(e){return e.colType.toLowerCase()});var i=TableComponent.getDataTableOptions(n);$.each(this.extraOptions?this.extraOptions:{},function(e,t){r[t[0]]=t[1]});var s=$.extend(n.dataTableOptions,i,r);s.fnDrawCallback=_.bind(this.fnDrawCallback,this),s.fnInitComplete=_.bind(this.fnInitComplete,this);if(s.bServerSide){var t=this;s.fnServerData=function(e,n,r){t.pagingCallback(e,n,r,this)}}e&&(s.aaData=e.resultset),this.ph.html("<table id='"+this.htmlObject+"Table' class='tableComponent' width='100%'></table>"),this.dataTable=$("#"+this.htmlObject+"Table").dataTable(s),this.dataTable.anOpen=[],t.ph.find("table").bind("click",function(e){if(typeof n.clickAction=="function"||t.expandOnClick){var r={},i=$(e.target),s=t.rawData;if(!i.parents("tbody").length)return;i.get(0).tagName!="TD"&&(i=i.closest("td"));var o=t.dataTable.fnGetPosition(i.get(0));r.rawData=t.rawData,r.tableData=t.dataTable.fnGetData(),r.colIdx=o[2],r.rowIdx=o[0],r.series=s.resultset[r.rowIdx][0],r.category=s.metadata[r.colIdx].colName,r.value=s.resultset[r.rowIdx][r.colIdx],r.colFormat=n.colFormats[r.colIdx],r.target=i,t.expandOnClick&&t.handleExpandOnClick(r),n.clickAction&&n.clickAction.call(t,r)}}),t.ph.trigger("cdfTableComponentFinishRendering")},handleExpandOnClick:function(e){var t=this,n=t.expandContainerObject,r="expandingClass";typeof r=="undefined"&&(r="activeRow");var i=e.target.closest("tr"),s=e.target.closest("a");if(s.hasClass("info"))return;var o=i.get(0),u=e.series,a=$("#"+n).html(),f=t.dataTable.anOpen,l=$.inArray(o,f);if(i.hasClass(r))i.removeClass(r),t.dataTable.fnClose(o),f.splice(l,1);else{for(var c=0;c<f.length;c++)$(f[c]).removeClass(r),t.dataTable.fnClose(f[c]),f.splice(c,1);i.addClass(r),f.push(o),t.dataTable.fnOpen(o,a,r);var h=t.queryState.lastResults();$(t.expandParameters).each(function(n,r){Dashboards.fireChange(r[1],h.resultset[e.rowIdx][parseInt(r[0],10)])})}$("td.expandingClass").click(function(e){e.stopPropagation();return})}},{getDataTableOptions:function(options){var dtData={};options.tableStyle=="themeroller"&&(dtData.bJQueryUI=!0),dtData.bInfo=options.info,dtData.iDisplayLength=options.displayLength,dtData.bLengthChange=options.lengthChange,dtData.bPaginate=options.paginate,dtData.bSort=options.sort,dtData.bFilter=options.filter,dtData.sPaginationType=options.paginationType,dtData.sDom=options.sDom,dtData.aaSorting=options.sortBy,typeof options.oLanguage=="string"?dtData.oLanguage=eval("("+options.oLanguage+")"):dtData.oLanguage=options.oLanguage;if(options.colHeaders!=undefined){dtData.aoColumns=new Array(options.colHeaders.length);for(var i=0;i<options.colHeaders.length;i++)dtData.aoColumns[i]={},dtData.aoColumns[i].sClass="column"+i;$.each(options.colHeaders,function(e,t){dtData.aoColumns[e].sTitle=t,t==""&&(dtData.aoColumns[e].bVisible=!1)}),options.colTypes!=undefined&&$.each(options.colTypes,function(e,t){var n=dtData.aoColumns[e];t=="hidden"&&(n.bVisible=!1),n.sClass+=" "+t,n.sType=t}),options.colFormats!=undefined;var bAutoWidth=!0;options.colWidths!=undefined&&$.each(options.colWidths,function(e,t){t!=null&&(dtData.aoColumns[e].sWidth=t,bAutoWidth=!1)}),dtData.bAutoWidth=bAutoWidth,options.colSortable!=undefined&&$.each(options.colSortable,function(e,t){t!=null&&(!t||t=="false")&&(dtData.aoColumns[e].bSortable=!1)}),options.colSearchable!=undefined&&$.each(options.colSearchable,function(e,t){t!=null&&(!t||t=="false")&&(dtData.aoColumns[e].bSearchable=!1)})}return dtData}});pen.define("cdf/components/table",function(){}),pen.define("cdf/CoreComponents",function(){});if(typeof SimileAjax=="undefined"){var SimileAjax={loaded:!1,loadingScriptsCount:0,error:null,params:{bundle:"true"}};SimileAjax.Platform=new Object;var getHead=function(e){return e.getElementsByTagName("head")[0]};SimileAjax.findScript=function(e,t){var n=e.documentElement.getElementsByTagName("head");for(var r=0;r<n.length;r++){var i=n[r].firstChild;while(i!=null){if(i.nodeType==1&&i.tagName.toLowerCase()=="script"){var s=i.src,o=s.indexOf(t);if(o>=0)return s}i=i.nextSibling}}return null},SimileAjax.includeJavascriptFile=function(e,t,n,r){n=n||"";if(e.body==null)try{var i="'"+n.replace(/'/g,"&apos")+"'";e.write("<script src='"+t+"' onerror="+i+(r?" charset='"+r+"'":"")+" type='text/javascript'>"+n+"</script>");return}catch(s){}var o=e.createElement("script");if(n){try{o.innerHTML=n}catch(s){}o.setAttribute("onerror",n)}return r&&o.setAttribute("charset",r),o.type="text/javascript",o.language="JavaScript",o.src=t,getHead(e).appendChild(o)},SimileAjax.includeJavascriptFiles=function(e,t,n){for(var r=0;r<n.length;r++)SimileAjax.includeJavascriptFile(e,t+n[r]);SimileAjax.loadingScriptsCount+=n.length,SimileAjax.includeJavascriptFile(e,SimileAjax.urlPrefix+"scripts/signal.js?"+n.length)},SimileAjax.includeCssFile=function(e,t){if(e.body==null)try{e.write("<link rel='stylesheet' href='"+t+"' type='text/css'/>");return}catch(n){}var r=e.createElement("link");r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("href",t),getHead(e).appendChild(r)},SimileAjax.includeCssFiles=function(e,t,n){for(var r=0;r<n.length;r++)SimileAjax.includeCssFile(e,t+n[r])},SimileAjax.prefixURLs=function(e,t,n){for(var r=0;r<n.length;r++)e.push(t+n[r])},SimileAjax.parseURLParameters=function(e,t,n){t=t||{},n=n||{},typeof e=="undefined"&&(e=location.href);var r=e.indexOf("?");if(r<0)return t;e=(e+"#").slice(r+1,e.indexOf("#"));var i=e.split("&"),s,o={},u=window.decodeURIComponent||unescape;for(var a=0;s=i[a];a++){var f=s.indexOf("="),l=u(s.slice(0,f)),c=o[l];typeof c=="undefined"?c=[]:c instanceof Array||(c=[c]),o[l]=c.concat(u(s.slice(f+1)))}for(var a in o){if(!o.hasOwnProperty(a))continue;var h=n[a]||String,p=o[a];p instanceof Array||(p=[p]),h===Boolean&&p[0]=="false"?t[a]=!1:t[a]=h.apply(this,p)}return t},function(){var e=["jquery-1.2.3.js","platform.js","debug.js","xmlhttp.js","json.js","dom.js","graphics.js","date-time.js","string.js","html.js","data-structure.js","units.js","ajax.js","history.js","window-manager.js"],t=[];if(typeof SimileAjax_urlPrefix=="string")SimileAjax.urlPrefix=SimileAjax_urlPrefix;else{var n=SimileAjax.findScript(document,"simile-ajax-api.js");if(n==null){SimileAjax.error=new Error("Failed to derive URL prefix for Simile Ajax API code files");return}SimileAjax.urlPrefix=n.substr(0,n.indexOf("simile-ajax-api.js"))}SimileAjax.parseURLParameters(n,SimileAjax.params,{bundle:Boolean}),SimileAjax.params.bundle?SimileAjax.includeJavascriptFiles(document,SimileAjax.urlPrefix,["simile-ajax-bundle.js"]):SimileAjax.includeJavascriptFiles(document,SimileAjax.urlPrefix+"scripts/",e),SimileAjax.includeCssFiles(document,SimileAjax.urlPrefix+"styles/",t),SimileAjax.loaded=!0}()}pen.define("cdf/simile/ajax/simile-ajax-api",function(){}),SimileAjax.JSON=new Object,function(){var m={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},s={array:function(e){var t=["["],n,r,i,o=e.length,u;for(i=0;i<o;i+=1)u=e[i],r=s[typeof u],r&&(u=r(u),typeof u=="string"&&(n&&(t[t.length]=","),t[t.length]=u,n=!0));return t[t.length]="]",t.join("")},"boolean":function(e){return String(e)},"null":function(e){return"null"},number:function(e){return isFinite(e)?String(e):"null"},object:function(e){if(e){if(e instanceof Array)return s.array(e);var t=["{"],n,r,i,o;for(i in e)o=e[i],r=s[typeof o],r&&(o=r(o),typeof o=="string"&&(n&&(t[t.length]=","),t.push(s.string(i),":",o),n=!0));return t[t.length]="}",t.join("")}return"null"},string:function(e){return/["\\\x00-\x1f]/.test(e)&&(e=e.replace(/([\x00-\x1f\\"])/g,function(e,t){var n=m[t];return n?n:(n=t.charCodeAt(),"\\u00"+Math.floor(n/16).toString(16)+(n%16).toString(16))})),'"'+e+'"'}};SimileAjax.JSON.toJSONString=function(e){return e instanceof Object?s.object(e):e instanceof Array?s.array(e):e.toString()},SimileAjax.JSON.parseJSON=function(){try{return!/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(this.replace(/"(\\.|[^"\\])*"/g,""))&&eval("("+this+")")}catch(e){return!1}}}(),pen.define("cdf/simile/ajax/scripts/json",function(){}),pen.define("common-repo/pentaho-ajax",[],function(){});var COMPLETE=4,STATUS_OK=200,STATUS_UNAUTHORIZED=401,STATUS_NOT_FOUND=404,base="",pathArray=window.location.pathname.split("/"),webAppPath="/"+pathArray[1];jQuery(function(e){e.datepicker.regional.af={closeText:"Selekteer",prevText:"Vorige",nextText:"Volgende",currentText:"Vandag",monthNames:["Januarie","Februarie","Maart","April","Mei","Junie","Julie","Augustus","September","Oktober","November","Desember"],monthNamesShort:["Jan","Feb","Mrt","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Des"],dayNames:["Sondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrydag","Saterdag"],dayNamesShort:["Son","Maa","Din","Woe","Don","Vry","Sat"],dayNamesMin:["So","Ma","Di","Wo","Do","Vr","Sa"],weekHeader:"Wk",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.af)}),jQuery(function(e){e.datepicker.regional.ar={closeText:"إغلاق",prevText:"&#x3c;السابق",nextText:"التالي&#x3e;",currentText:"اليوم",monthNames:["كانون الثاني","شباط","آذار","نيسان","آذار","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],monthNamesShort:["1","2","3","4","5","6","7","8","9","10","11","12"],dayNames:["السبت","الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة"],dayNamesShort:["سبت","أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة"],dayNamesMin:["سبت","أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة"],weekHeader:"أسبوع",dateFormat:"dd/mm/yy",firstDay:0,isRTL:!0,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.ar)}),jQuery(function(e){e.datepicker.regional.az={closeText:"Bağla",prevText:"&#x3c;Geri",nextText:"İrəli&#x3e;",currentText:"Bugün",monthNames:["Yanvar","Fevral","Mart","Aprel","May","İyun","İyul","Avqust","Sentyabr","Oktyabr","Noyabr","Dekabr"],monthNamesShort:["Yan","Fev","Mar","Apr","May","İyun","İyul","Avq","Sen","Okt","Noy","Dek"],dayNames:["Bazar","Bazar ertəsi","Çərşənbə axşamı","Çərşənbə","Cümə axşamı","Cümə","Şənbə"],dayNamesShort:["B","Be","Ça","Ç","Ca","C","Ş"],dayNamesMin:["B","B","Ç","С","Ç","C","Ş"],weekHeader:"Hf",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.az)}),jQuery(function(e){e.datepicker.regional.bg={closeText:"затвори",prevText:"&#x3c;назад",nextText:"напред&#x3e;",nextBigText:"&#x3e;&#x3e;",currentText:"днес",monthNames:["Януари","Февруари","Март","Април","Май","Юни","Юли","Август","Септември","Октомври","Ноември","Декември"],monthNamesShort:["Яну","Фев","Мар","Апр","Май","Юни","Юли","Авг","Сеп","Окт","Нов","Дек"],dayNames:["Неделя","Понеделник","Вторник","Сряда","Четвъртък","Петък","Събота"],dayNamesShort:["Нед","Пон","Вто","Сря","Чет","Пет","Съб"],dayNamesMin:["Не","По","Вт","Ср","Че","Пе","Съ"],weekHeader:"Wk",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.bg)}),jQuery(function(e){e.datepicker.regional.bs={closeText:"Zatvori",prevText:"&#x3c;",nextText:"&#x3e;",currentText:"Danas",monthNames:["Januar","Februar","Mart","April","Maj","Juni","Juli","August","Septembar","Oktobar","Novembar","Decembar"],monthNamesShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],dayNames:["Nedelja","Ponedeljak","Utorak","Srijeda","Četvrtak","Petak","Subota"],dayNamesShort:["Ned","Pon","Uto","Sri","Čet","Pet","Sub"],dayNamesMin:["Ne","Po","Ut","Sr","Če","Pe","Su"],weekHeader:"Wk",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.bs)}),jQuery(function(e){e.datepicker.regional.ca={closeText:"Tancar",prevText:"&#x3c;Ant",nextText:"Seg&#x3e;",currentText:"Avui",monthNames:["Gener","Febrer","Mar&ccedil;","Abril","Maig","Juny","Juliol","Agost","Setembre","Octubre","Novembre","Desembre"],monthNamesShort:["Gen","Feb","Mar","Abr","Mai","Jun","Jul","Ago","Set","Oct","Nov","Des"],dayNames:["Diumenge","Dilluns","Dimarts","Dimecres","Dijous","Divendres","Dissabte"],dayNamesShort:["Dug","Dln","Dmt","Dmc","Djs","Dvn","Dsb"],dayNamesMin:["Dg","Dl","Dt","Dc","Dj","Dv","Ds"],weekHeader:"Sm",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.ca)}),jQuery(function(e){e.datepicker.regional.cs={closeText:"Zavřít",prevText:"&#x3c;Dříve",nextText:"Později&#x3e;",currentText:"Nyní",monthNames:["leden","únor","březen","duben","květen","červen","červenec","srpen","září","říjen","listopad","prosinec"],monthNamesShort:["led","úno","bře","dub","kvě","čer","čvc","srp","zář","říj","lis","pro"],dayNames:["neděle","pondělí","úterý","středa","čtvrtek","pátek","sobota"],dayNamesShort:["ne","po","út","st","čt","pá","so"],dayNamesMin:["ne","po","út","st","čt","pá","so"],weekHeader:"Týd",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.cs)}),jQuery(function(e){e.datepicker.regional.da={closeText:"Luk",prevText:"&#x3c;Forrige",nextText:"Næste&#x3e;",currentText:"Idag",monthNames:["Januar","Februar","Marts","April","Maj","Juni","Juli","August","September","Oktober","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],dayNames:["Søndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lørdag"],dayNamesShort:["Søn","Man","Tir","Ons","Tor","Fre","Lør"],dayNamesMin:["Sø","Ma","Ti","On","To","Fr","Lø"],weekHeader:"Uge",dateFormat:"dd-mm-yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.da)}),jQuery(function(e){e.datepicker.regional.de={closeText:"schließen",prevText:"&#x3c;zurück",nextText:"Vor&#x3e;",currentText:"heute",monthNames:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthNamesShort:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],dayNames:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],dayNamesShort:["So","Mo","Di","Mi","Do","Fr","Sa"],dayNamesMin:["So","Mo","Di","Mi","Do","Fr","Sa"],weekHeader:"Wo",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.de)}),jQuery(function(e){e.datepicker.regional.el={closeText:"Κλείσιμο",prevText:"Προηγούμενος",nextText:"Επόμενος",currentText:"Τρέχων Μήνας",monthNames:["Ιανουάριος","Φεβρουάριος","Μάρτιος","Απρίλιος","Μάιος","Ιούνιος","Ιούλιος","Αύγουστος","Σεπτέμβριος","Οκτώβριος","Νοέμβριος","Δεκέμβριος"],monthNamesShort:["Ιαν","Φεβ","Μαρ","Απρ","Μαι","Ιουν","Ιουλ","Αυγ","Σεπ","Οκτ","Νοε","Δεκ"],dayNames:["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο"],dayNamesShort:["Κυρ","Δευ","Τρι","Τετ","Πεμ","Παρ","Σαβ"],dayNamesMin:["Κυ","Δε","Τρ","Τε","Πε","Πα","Σα"],weekHeader:"Εβδ",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.el)}),jQuery(function(e){e.datepicker.regional["en-GB"]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional["en-GB"])}),jQuery(function(e){e.datepicker.regional.eo={closeText:"Fermi",prevText:"&lt;Anta",nextText:"Sekv&gt;",currentText:"Nuna",monthNames:["Januaro","Februaro","Marto","Aprilo","Majo","Junio","Julio","Aŭgusto","Septembro","Oktobro","Novembro","Decembro"],monthNamesShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aŭg","Sep","Okt","Nov","Dec"],dayNames:["Dimanĉo","Lundo","Mardo","Merkredo","Ĵaŭdo","Vendredo","Sabato"],dayNamesShort:["Dim","Lun","Mar","Mer","Ĵaŭ","Ven","Sab"],dayNamesMin:["Di","Lu","Ma","Me","Ĵa","Ve","Sa"],weekHeader:"Sb",dateFormat:"dd/mm/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.eo)}),jQuery(function(e){e.datepicker.regional.es={closeText:"Cerrar",prevText:"&#x3c;Ant",nextText:"Sig&#x3e;",currentText:"Hoy",monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],dayNames:["Domingo","Lunes","Martes","Mi&eacute;rcoles","Jueves","Viernes","S&aacute;bado"],dayNamesShort:["Dom","Lun","Mar","Mi&eacute;","Juv","Vie","S&aacute;b"],dayNamesMin:["Do","Lu","Ma","Mi","Ju","Vi","S&aacute;"],weekHeader:"Sm",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.es)}),jQuery(function(e){e.datepicker.regional.et={closeText:"Sulge",prevText:"Eelnev",nextText:"Järgnev",currentText:"Täna",monthNames:["Jaanuar","Veebruar","Märts","Aprill","Mai","Juuni","Juuli","August","September","Oktoober","November","Detsember"],monthNamesShort:["Jaan","Veebr","Märts","Apr","Mai","Juuni","Juuli","Aug","Sept","Okt","Nov","Dets"],dayNames:["Pühapäev","Esmaspäev","Teisipäev","Kolmapäev","Neljapäev","Reede","Laupäev"],dayNamesShort:["Pühap","Esmasp","Teisip","Kolmap","Neljap","Reede","Laup"],dayNamesMin:["P","E","T","K","N","R","L"],weekHeader:"Sm",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.et)}),jQuery(function(e){e.datepicker.regional.eu={closeText:"Egina",prevText:"&#x3c;Aur",nextText:"Hur&#x3e;",currentText:"Gaur",monthNames:["Urtarrila","Otsaila","Martxoa","Apirila","Maiatza","Ekaina","Uztaila","Abuztua","Iraila","Urria","Azaroa","Abendua"],monthNamesShort:["Urt","Ots","Mar","Api","Mai","Eka","Uzt","Abu","Ira","Urr","Aza","Abe"],dayNames:["Igandea","Astelehena","Asteartea","Asteazkena","Osteguna","Ostirala","Larunbata"],dayNamesShort:["Iga","Ast","Ast","Ast","Ost","Ost","Lar"],dayNamesMin:["Ig","As","As","As","Os","Os","La"],weekHeader:"Wk",dateFormat:"yy/mm/dd",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.eu)}),jQuery(function(e){e.datepicker.regional.fa={closeText:"بستن",prevText:"&#x3c;قبلي",nextText:"بعدي&#x3e;",currentText:"امروز",monthNames:["فروردين","ارديبهشت","خرداد","تير","مرداد","شهريور","مهر","آبان","آذر","دي","بهمن","اسفند"],monthNamesShort:["1","2","3","4","5","6","7","8","9","10","11","12"],dayNames:["يکشنبه","دوشنبه","سه‌شنبه","چهارشنبه","پنجشنبه","جمعه","شنبه"],dayNamesShort:["ي","د","س","چ","پ","ج","ش"],dayNamesMin:["ي","د","س","چ","پ","ج","ش"],weekHeader:"هف",dateFormat:"yy/mm/dd",firstDay:6,isRTL:!0,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.fa)}),jQuery(function(e){e.datepicker.regional.fi={closeText:"Sulje",prevText:"&laquo;Edellinen",nextText:"Seuraava&raquo;",currentText:"T&auml;n&auml;&auml;n",monthNames:["Tammikuu","Helmikuu","Maaliskuu","Huhtikuu","Toukokuu","Kes&auml;kuu","Hein&auml;kuu","Elokuu","Syyskuu","Lokakuu","Marraskuu","Joulukuu"],monthNamesShort:["Tammi","Helmi","Maalis","Huhti","Touko","Kes&auml;","Hein&auml;","Elo","Syys","Loka","Marras","Joulu"],dayNamesShort:["Su","Ma","Ti","Ke","To","Pe","Su"],dayNames:["Sunnuntai","Maanantai","Tiistai","Keskiviikko","Torstai","Perjantai","Lauantai"],dayNamesMin:["Su","Ma","Ti","Ke","To","Pe","La"],weekHeader:"Vk",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.fi)}),jQuery(function(e){e.datepicker.regional.fo={closeText:"Lat aftur",prevText:"&#x3c;Fyrra",nextText:"Næsta&#x3e;",currentText:"Í dag",monthNames:["Januar","Februar","Mars","Apríl","Mei","Juni","Juli","August","September","Oktober","November","Desember"],monthNamesShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Des"],dayNames:["Sunnudagur","Mánadagur","Týsdagur","Mikudagur","Hósdagur","Fríggjadagur","Leyardagur"],dayNamesShort:["Sun","Mán","Týs","Mik","Hós","Frí","Ley"],dayNamesMin:["Su","Má","Tý","Mi","Hó","Fr","Le"],weekHeader:"Vk",dateFormat:"dd-mm-yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.fo)}),jQuery(function(e){e.datepicker.regional["fr-CH"]={closeText:"Fermer",prevText:"&#x3c;Préc",nextText:"Suiv&#x3e;",currentText:"Courant",monthNames:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],monthNamesShort:["Jan","Fév","Mar","Avr","Mai","Jun","Jul","Aoû","Sep","Oct","Nov","Déc"],dayNames:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],dayNamesShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],dayNamesMin:["Di","Lu","Ma","Me","Je","Ve","Sa"],weekHeader:"Sm",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional["fr-CH"])}),jQuery(function(e){e.datepicker.regional.fr={closeText:"Fermer",prevText:"&#x3c;Préc",nextText:"Suiv&#x3e;",currentText:"Courant",monthNames:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],monthNamesShort:["Jan","Fév","Mar","Avr","Mai","Jun","Jul","Aoû","Sep","Oct","Nov","Déc"],dayNames:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],dayNamesShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],dayNamesMin:["Di","Lu","Ma","Me","Je","Ve","Sa"],weekHeader:"Sm",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.fr)}),jQuery(function(e){e.datepicker.regional.he={closeText:"סגור",prevText:"&#x3c;הקודם",nextText:"הבא&#x3e;",currentText:"היום",monthNames:["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],monthNamesShort:["1","2","3","4","5","6","7","8","9","10","11","12"],dayNames:["ראשון","שני","שלישי","רביעי","חמישי","שישי","שבת"],dayNamesShort:["א'","ב'","ג'","ד'","ה'","ו'","שבת"],dayNamesMin:["א'","ב'","ג'","ד'","ה'","ו'","שבת"],weekHeader:"Wk",dateFormat:"dd/mm/yy",firstDay:0,isRTL:!0,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.he)}),jQuery(function(e){e.datepicker.regional.hr={closeText:"Zatvori",prevText:"&#x3c;",nextText:"&#x3e;",currentText:"Danas",monthNames:["Siječanj","Veljača","Ožujak","Travanj","Svibanj","Lipanj","Srpanj","Kolovoz","Rujan","Listopad","Studeni","Prosinac"],monthNamesShort:["Sij","Velj","Ožu","Tra","Svi","Lip","Srp","Kol","Ruj","Lis","Stu","Pro"],dayNames:["Nedjelja","Ponedjeljak","Utorak","Srijeda","Četvrtak","Petak","Subota"],dayNamesShort:["Ned","Pon","Uto","Sri","Čet","Pet","Sub"],dayNamesMin:["Ne","Po","Ut","Sr","Če","Pe","Su"],weekHeader:"Tje",dateFormat:"dd.mm.yy.",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.hr)}),jQuery(function(e){e.datepicker.regional.hu={closeText:"bezárás",prevText:"&laquo;&nbsp;vissza",nextText:"előre&nbsp;&raquo;",currentText:"ma",monthNames:["Január","Február","Március","Április","Május","Június","Július","Augusztus","Szeptember","Október","November","December"],monthNamesShort:["Jan","Feb","Már","Ápr","Máj","Jún","Júl","Aug","Szep","Okt","Nov","Dec"],dayNames:["Vasárnap","Hétfö","Kedd","Szerda","Csütörtök","Péntek","Szombat"],dayNamesShort:["Vas","Hét","Ked","Sze","Csü","Pén","Szo"],dayNamesMin:["V","H","K","Sze","Cs","P","Szo"],weekHeader:"Hé",dateFormat:"yy-mm-dd",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.hu)}),jQuery(function(e){e.datepicker.regional.hy={closeText:"Փակել",prevText:"&#x3c;Նախ.",nextText:"Հաջ.&#x3e;",currentText:"Այսօր",monthNames:["Հունվար","Փետրվար","Մարտ","Ապրիլ","Մայիս","Հունիս","Հուլիս","Օգոստոս","Սեպտեմբեր","Հոկտեմբեր","Նոյեմբեր","Դեկտեմբեր"],monthNamesShort:["Հունվ","Փետր","Մարտ","Ապր","Մայիս","Հունիս","Հուլ","Օգս","Սեպ","Հոկ","Նոյ","Դեկ"],dayNames:["կիրակի","եկուշաբթի","երեքշաբթի","չորեքշաբթի","հինգշաբթի","ուրբաթ","շաբաթ"],dayNamesShort:["կիր","երկ","երք","չրք","հնգ","ուրբ","շբթ"],dayNamesMin:["կիր","երկ","երք","չրք","հնգ","ուրբ","շբթ"],weekHeader:"ՇԲՏ",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.hy)}),jQuery(function(e){e.datepicker.regional.id={closeText:"Tutup",prevText:"&#x3c;mundur",nextText:"maju&#x3e;",currentText:"hari ini",monthNames:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","Nopember","Desember"],monthNamesShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agus","Sep","Okt","Nop","Des"],dayNames:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],dayNamesShort:["Min","Sen","Sel","Rab","kam","Jum","Sab"],dayNamesMin:["Mg","Sn","Sl","Rb","Km","jm","Sb"],weekHeader:"Mg",dateFormat:"dd/mm/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.id)}),jQuery(function(e){e.datepicker.regional.is={closeText:"Loka",prevText:"&#x3c; Fyrri",nextText:"N&aelig;sti &#x3e;",currentText:"&Iacute; dag",monthNames:["Jan&uacute;ar","Febr&uacute;ar","Mars","Apr&iacute;l","Ma&iacute","J&uacute;n&iacute;","J&uacute;l&iacute;","&Aacute;g&uacute;st","September","Okt&oacute;ber","N&oacute;vember","Desember"],monthNamesShort:["Jan","Feb","Mar","Apr","Ma&iacute;","J&uacute;n","J&uacute;l","&Aacute;g&uacute;","Sep","Okt","N&oacute;v","Des"],dayNames:["Sunnudagur","M&aacute;nudagur","&THORN;ri&eth;judagur","Mi&eth;vikudagur","Fimmtudagur","F&ouml;studagur","Laugardagur"],dayNamesShort:["Sun","M&aacute;n","&THORN;ri","Mi&eth;","Fim","F&ouml;s","Lau"],dayNamesMin:["Su","M&aacute;","&THORN;r","Mi","Fi","F&ouml;","La"],weekHeader:"Vika",dateFormat:"dd/mm/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.is)}),jQuery(function(e){e.datepicker.regional.it={closeText:"Chiudi",prevText:"&#x3c;Prec",nextText:"Succ&#x3e;",currentText:"Oggi",monthNames:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthNamesShort:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],dayNames:["Domenica","Luned&#236","Marted&#236","Mercoled&#236","Gioved&#236","Venerd&#236","Sabato"],dayNamesShort:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],dayNamesMin:["Do","Lu","Ma","Me","Gi","Ve","Sa"],weekHeader:"Sm",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.it)}),jQuery(function(e){e.datepicker.regional.ja={closeText:"閉じる",prevText:"&#x3c;前",nextText:"次&#x3e;",currentText:"今日",monthNames:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthNamesShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayNames:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],dayNamesShort:["日","月","火","水","木","金","土"],dayNamesMin:["日","月","火","水","木","金","土"],weekHeader:"週",dateFormat:"yy/mm/dd",firstDay:0,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"年"},e.datepicker.setDefaults(e.datepicker.regional.ja)}),jQuery(function(e){e.datepicker.regional.ko={closeText:"닫기",prevText:"이전달",nextText:"다음달",currentText:"오늘",monthNames:["1월(JAN)","2월(FEB)","3월(MAR)","4월(APR)","5월(MAY)","6월(JUN)","7월(JUL)","8월(AUG)","9월(SEP)","10월(OCT)","11월(NOV)","12월(DEC)"],monthNamesShort:["1월(JAN)","2월(FEB)","3월(MAR)","4월(APR)","5월(MAY)","6월(JUN)","7월(JUL)","8월(AUG)","9월(SEP)","10월(OCT)","11월(NOV)","12월(DEC)"],dayNames:["일","월","화","수","목","금","토"],dayNamesShort:["일","월","화","수","목","금","토"],dayNamesMin:["일","월","화","수","목","금","토"],weekHeader:"Wk",dateFormat:"yy-mm-dd",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:"년"},e.datepicker.setDefaults(e.datepicker.regional.ko)}),jQuery(function(e){e.datepicker.regional.lt={closeText:"Uždaryti",prevText:"&#x3c;Atgal",nextText:"Pirmyn&#x3e;",currentText:"Šiandien",monthNames:["Sausis","Vasaris","Kovas","Balandis","Gegužė","Birželis","Liepa","Rugpjūtis","Rugsėjis","Spalis","Lapkritis","Gruodis"],monthNamesShort:["Sau","Vas","Kov","Bal","Geg","Bir","Lie","Rugp","Rugs","Spa","Lap","Gru"],dayNames:["sekmadienis","pirmadienis","antradienis","trečiadienis","ketvirtadienis","penktadienis","šeštadienis"],dayNamesShort:["sek","pir","ant","tre","ket","pen","šeš"],dayNamesMin:["Se","Pr","An","Tr","Ke","Pe","Še"],weekHeader:"Wk",dateFormat:"yy-mm-dd",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.lt)}),jQuery(function(e){e.datepicker.regional.lv={closeText:"Aizvērt",prevText:"Iepr",nextText:"Nāka",currentText:"Šodien",monthNames:["Janvāris","Februāris","Marts","Aprīlis","Maijs","Jūnijs","Jūlijs","Augusts","Septembris","Oktobris","Novembris","Decembris"],monthNamesShort:["Jan","Feb","Mar","Apr","Mai","Jūn","Jūl","Aug","Sep","Okt","Nov","Dec"],dayNames:["svētdiena","pirmdiena","otrdiena","trešdiena","ceturtdiena","piektdiena","sestdiena"],dayNamesShort:["svt","prm","otr","tre","ctr","pkt","sst"],dayNamesMin:["Sv","Pr","Ot","Tr","Ct","Pk","Ss"],weekHeader:"Nav",dateFormat:"dd-mm-yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.lv)}),jQuery(function(e){e.datepicker.regional.ms={closeText:"Tutup",prevText:"&#x3c;Sebelum",nextText:"Selepas&#x3e;",currentText:"hari ini",monthNames:["Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"],monthNamesShort:["Jan","Feb","Mac","Apr","Mei","Jun","Jul","Ogo","Sep","Okt","Nov","Dis"],dayNames:["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu"],dayNamesShort:["Aha","Isn","Sel","Rab","kha","Jum","Sab"],dayNamesMin:["Ah","Is","Se","Ra","Kh","Ju","Sa"],weekHeader:"Mg",dateFormat:"dd/mm/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.ms)}),jQuery(function(e){e.datepicker.regional.nl={closeText:"Sluiten",prevText:"←",nextText:"→",currentText:"Vandaag",monthNames:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],monthNamesShort:["jan","feb","maa","apr","mei","jun","jul","aug","sep","okt","nov","dec"],dayNames:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],dayNamesShort:["zon","maa","din","woe","don","vri","zat"],dayNamesMin:["zo","ma","di","wo","do","vr","za"],weekHeader:"Wk",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.nl)}),jQuery(function(e){e.datepicker.regional.no={closeText:"Lukk",prevText:"&laquo;Forrige",nextText:"Neste&raquo;",currentText:"I dag",monthNames:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],monthNamesShort:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],dayNamesShort:["Søn","Man","Tir","Ons","Tor","Fre","Lør"],dayNames:["Søndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lørdag"],dayNamesMin:["Sø","Ma","Ti","On","To","Fr","Lø"],weekHeader:"Uke",dateFormat:"yy-mm-dd",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.no)}),jQuery(function(e){e.datepicker.regional.pl={closeText:"Zamknij",prevText:"&#x3c;Poprzedni",nextText:"Następny&#x3e;",currentText:"Dziś",monthNames:["Styczeń","Luty","Marzec","Kwiecień","Maj","Czerwiec","Lipiec","Sierpień","Wrzesień","Październik","Listopad","Grudzień"],monthNamesShort:["Sty","Lu","Mar","Kw","Maj","Cze","Lip","Sie","Wrz","Pa","Lis","Gru"],dayNames:["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota"],dayNamesShort:["Nie","Pn","Wt","Śr","Czw","Pt","So"],dayNamesMin:["N","Pn","Wt","Śr","Cz","Pt","So"],weekHeader:"Tydz",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.pl)}),jQuery(function(e){e.datepicker.regional["pt-BR"]={closeText:"Fechar",prevText:"&#x3c;Anterior",nextText:"Pr&oacute;ximo&#x3e;",currentText:"Hoje",monthNames:["Janeiro","Fevereiro","Mar&ccedil;o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],dayNames:["Domingo","Segunda-feira","Ter&ccedil;a-feira","Quarta-feira","Quinta-feira","Sexta-feira","S&aacute;bado"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","S&aacute;b"],dayNamesMin:["Dom","Seg","Ter","Qua","Qui","Sex","S&aacute;b"],weekHeader:"Sm",dateFormat:"dd/mm/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional["pt-BR"])}),jQuery(function(e){e.datepicker.regional.ro={closeText:"Închide",prevText:"&laquo; Luna precedentă",nextText:"Luna următoare &raquo;",currentText:"Azi",monthNames:["Ianuarie","Februarie","Martie","Aprilie","Mai","Iunie","Iulie","August","Septembrie","Octombrie","Noiembrie","Decembrie"],monthNamesShort:["Ian","Feb","Mar","Apr","Mai","Iun","Iul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Duminică","Luni","Marţi","Miercuri","Joi","Vineri","Sâmbătă"],dayNamesShort:["Dum","Lun","Mar","Mie","Joi","Vin","Sâm"],dayNamesMin:["Du","Lu","Ma","Mi","Jo","Vi","Sâ"],weekHeader:"Săpt",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.ro)}),jQuery(function(e){e.datepicker.regional.ru={closeText:"Закрыть",prevText:"&#x3c;Пред",nextText:"След&#x3e;",currentText:"Сегодня",monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],dayNames:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],dayNamesShort:["вск","пнд","втр","срд","чтв","птн","сбт"],dayNamesMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],weekHeader:"Не",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.ru)}),jQuery(function(e){e.datepicker.regional.sk={closeText:"Zavrieť",prevText:"&#x3c;Predchádzajúci",nextText:"Nasledujúci&#x3e;",currentText:"Dnes",monthNames:["Január","Február","Marec","Apríl","Máj","Jún","Júl","August","September","Október","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","Máj","Jún","Júl","Aug","Sep","Okt","Nov","Dec"],dayNames:["Nedel'a","Pondelok","Utorok","Streda","Štvrtok","Piatok","Sobota"],dayNamesShort:["Ned","Pon","Uto","Str","Štv","Pia","Sob"],dayNamesMin:["Ne","Po","Ut","St","Št","Pia","So"],weekHeader:"Ty",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.sk)}),jQuery(function(e){e.datepicker.regional.sl={closeText:"Zapri",prevText:"&lt;Prej&#x161;nji",nextText:"Naslednji&gt;",currentText:"Trenutni",monthNames:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Avg","Sep","Okt","Nov","Dec"],dayNames:["Nedelja","Ponedeljek","Torek","Sreda","&#x10C;etrtek","Petek","Sobota"],dayNamesShort:["Ned","Pon","Tor","Sre","&#x10C;et","Pet","Sob"],dayNamesMin:["Ne","Po","To","Sr","&#x10C;e","Pe","So"],weekHeader:"Teden",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.sl)}),jQuery(function(e){e.datepicker.regional.sq={closeText:"mbylle",prevText:"&#x3c;mbrapa",nextText:"Përpara&#x3e;",currentText:"sot",monthNames:["Janar","Shkurt","Mars","Prill","Maj","Qershor","Korrik","Gusht","Shtator","Tetor","Nëntor","Dhjetor"],monthNamesShort:["Jan","Shk","Mar","Pri","Maj","Qer","Kor","Gus","Sht","Tet","Nën","Dhj"],dayNames:["E Diel","E Hënë","E Martë","E Mërkurë","E Enjte","E Premte","E Shtune"],dayNamesShort:["Di","Hë","Ma","Më","En","Pr","Sh"],dayNamesMin:["Di","Hë","Ma","Më","En","Pr","Sh"],weekHeader:"Ja",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.sq)}),jQuery(function(e){e.datepicker.regional["sr-SR"]={closeText:"Zatvori",prevText:"&#x3c;",nextText:"&#x3e;",currentText:"Danas",monthNames:["Januar","Februar","Mart","April","Maj","Jun","Jul","Avgust","Septembar","Oktobar","Novembar","Decembar"],monthNamesShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Avg","Sep","Okt","Nov","Dec"],dayNames:["Nedelja","Ponedeljak","Utorak","Sreda","Četvrtak","Petak","Subota"],dayNamesShort:["Ned","Pon","Uto","Sre","Čet","Pet","Sub"],dayNamesMin:["Ne","Po","Ut","Sr","Če","Pe","Su"],weekHeader:"Sed",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional["sr-SR"])}),jQuery(function(e){e.datepicker.regional.sr={closeText:"Затвори",prevText:"&#x3c;",nextText:"&#x3e;",currentText:"Данас",monthNames:["Јануар","Фебруар","Март","Април","Мај","Јун","Јул","Август","Септембар","Октобар","Новембар","Децембар"],monthNamesShort:["Јан","Феб","Мар","Апр","Мај","Јун","Јул","Авг","Сеп","Окт","Нов","Дец"],dayNames:["Недеља","Понедељак","Уторак","Среда","Четвртак","Петак","Субота"],dayNamesShort:["Нед","Пон","Уто","Сре","Чет","Пет","Суб"],dayNamesMin:["Не","По","Ут","Ср","Че","Пе","Су"],weekHeader:"Сед",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.sr)}),jQuery(function(e){e.datepicker.regional.sv={closeText:"Stäng",prevText:"&laquo;Förra",nextText:"Nästa&raquo;",currentText:"Idag",monthNames:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],dayNamesShort:["Sön","Mån","Tis","Ons","Tor","Fre","Lör"],dayNames:["Söndag","Måndag","Tisdag","Onsdag","Torsdag","Fredag","Lördag"],dayNamesMin:["Sö","Må","Ti","On","To","Fr","Lö"],weekHeader:"Ve",dateFormat:"yy-mm-dd",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.sv)}),jQuery(function(e){e.datepicker.regional.ta={closeText:"மூடு",prevText:"முன்னையது",nextText:"அடுத்தது",currentText:"இன்று",monthNames:["தை","மாசி","பங்குனி","சித்திரை","வைகாசி","ஆனி","ஆடி","ஆவணி","புரட்டாசி","ஐப்பசி","கார்த்திகை","மார்கழி"],monthNamesShort:["தை","மாசி","பங்","சித்","வைகா","ஆனி","ஆடி","ஆவ","புர","ஐப்","கார்","மார்"],dayNames:["ஞாயிற்றுக்கிழமை","திங்கட்கிழமை","செவ்வாய்க்கிழமை","புதன்கிழமை","வியாழக்கிழமை","வெள்ளிக்கிழமை","சனிக்கிழமை"],dayNamesShort:["ஞாயிறு","திங்கள்","செவ்வாய்","புதன்","வியாழன்","வெள்ளி","சனி"],dayNamesMin:["ஞா","தி","செ","பு","வி","வெ","ச"],weekHeader:"Не",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.ta)}),jQuery(function(e){e.datepicker.regional.th={closeText:"ปิด",prevText:"&laquo;&nbsp;ย้อน",nextText:"ถัดไป&nbsp;&raquo;",currentText:"วันนี้",monthNames:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฏาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],monthNamesShort:["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],dayNames:["อาทิตย์","จันทร์","อังคาร","พุธ","พฤหัสบดี","ศุกร์","เสาร์"],dayNamesShort:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."],dayNamesMin:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."],weekHeader:"Wk",dateFormat:"dd/mm/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.th)}),jQuery(function(e){e.datepicker.regional.tr={closeText:"kapat",prevText:"&#x3c;geri",nextText:"ileri&#x3e",currentText:"bugün",monthNames:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],monthNamesShort:["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"],dayNames:["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"],dayNamesShort:["Pz","Pt","Sa","Ça","Pe","Cu","Ct"],dayNamesMin:["Pz","Pt","Sa","Ça","Pe","Cu","Ct"],weekHeader:"Hf",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.tr)}),jQuery(function(e){e.datepicker.regional.uk={closeText:"Закрити",prevText:"&#x3c;",nextText:"&#x3e;",currentText:"Сьогодні",monthNames:["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"],monthNamesShort:["Січ","Лют","Бер","Кві","Тра","Чер","Лип","Сер","Вер","Жов","Лис","Гру"],dayNames:["неділя","понеділок","вівторок","середа","четвер","п’ятниця","субота"],dayNamesShort:["нед","пнд","вів","срд","чтв","птн","сбт"],dayNamesMin:["Нд","Пн","Вт","Ср","Чт","Пт","Сб"],weekHeader:"Не",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.uk)}),jQuery(function(e){e.datepicker.regional.vi={closeText:"Đóng",prevText:"&#x3c;Trước",nextText:"Tiếp&#x3e;",currentText:"Hôm nay",monthNames:["Tháng Một","Tháng Hai","Tháng Ba","Tháng Tư","Tháng Năm","Tháng Sáu","Tháng Bảy","Tháng Tám","Tháng Chín","Tháng Mười","Tháng Mười Một","Tháng Mười Hai"],monthNamesShort:["Tháng 1","Tháng 2","Tháng 3","Tháng 4","Tháng 5","Tháng 6","Tháng 7","Tháng 8","Tháng 9","Tháng 10","Tháng 11","Tháng 12"],dayNames:["Chủ Nhật","Thứ Hai","Thứ Ba","Thứ Tư","Thứ Năm","Thứ Sáu","Thứ Bảy"],dayNamesShort:["CN","T2","T3","T4","T5","T6","T7"],dayNamesMin:["CN","T2","T3","T4","T5","T6","T7"],weekHeader:"Tu",dateFormat:"dd/mm/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.vi)}),jQuery(function(e){e.datepicker.regional["zh-CN"]={closeText:"关闭",prevText:"&#x3c;上月",nextText:"下月&#x3e;",currentText:"今天",monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一","二","三","四","五","六","七","八","九","十","十一","十二"],dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],dayNamesMin:["日","一","二","三","四","五","六"],weekHeader:"周",dateFormat:"yy-mm-dd",firstDay:1,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"年"},e.datepicker.setDefaults(e.datepicker.regional["zh-CN"])}),jQuery(function(e){e.datepicker.regional["zh-HK"]={closeText:"關閉",prevText:"&#x3c;上月",nextText:"下月&#x3e;",currentText:"今天",monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一","二","三","四","五","六","七","八","九","十","十一","十二"],dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],dayNamesMin:["日","一","二","三","四","五","六"],weekHeader:"周",dateFormat:"dd-mm-yy",firstDay:0,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"年"},e.datepicker.setDefaults(e.datepicker.regional["zh-HK"])}),jQuery(function(e){e.datepicker.regional["zh-TW"]={closeText:"關閉",prevText:"&#x3c;上月",nextText:"下月&#x3e;",currentText:"今天",monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一","二","三","四","五","六","七","八","九","十","十一","十二"],dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],dayNamesMin:["日","一","二","三","四","五","六"],weekHeader:"周",dateFormat:"yy/mm/dd",firstDay:1,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"年"},e.datepicker.setDefaults(e.datepicker.regional["zh-TW"])}),pen.define("cdf/jquery-ui-datepicker-i18n",function(){}),function(e){function n(t,n){return parseInt(e.css(t,n))||0}function r(e){var e=parseInt(e).toString(16);return e.length<2?"0"+e:e}function i(t){for(;t&&t.nodeName.toLowerCase()!="html";t=t.parentNode){var n=e.css(t,"backgroundColor");if(n=="rgba(0, 0, 0, 0)")continue;if(n.indexOf("rgb")>=0){var i=n.match(/\d+/g);return"#"+r(i[0])+r(i[1])+r(i[2])}if(n&&n!="transparent")return n}return"#ffffff"}function s(e,t,n){switch(e){case"round":return Math.round(n*(1-Math.cos(Math.asin(t/n))));case"cool":return Math.round(n*(1+Math.cos(Math.asin(t/n))));case"sharp":return Math.round(n*(1-Math.cos(Math.acos(t/n))));case"bite":return Math.round(n*Math.cos(Math.asin((n-t-1)/n)));case"slide":return Math.round(n*Math.atan2(t,n/t));case"jut":return Math.round(n*Math.atan2(n,n-t-1));case"curl":return Math.round(n*Math.atan(t));case"tear":return Math.round(n*Math.cos(t));case"wicked":return Math.round(n*Math.tan(t));case"long":return Math.round(n*Math.sqrt(t));case"sculpt":return Math.round(n*Math.log(n-t-1,n));case"dog":return t&1?t+1:n;case"dog2":return t&2?t+1:n;case"dog3":return t&3?t+1:n;case"fray":return t%2*n;case"notch":return n;case"bevel":return t+1}}var t=function(){if(!e.browser.msie)return!1;var t=document.createElement("div");try{t.style.setExpression("width","0+0")}catch(n){return!1}return!0}();e.fn.corner=function(r){if(this.length==0){if(!e.isReady&&this.selector){var o=this.selector,u=this.context;e(function(){e(o,u).corner(r)})}return this}r=(r||"").toLowerCase();var a=/keep/.test(r),f=(r.match(/cc:(#[0-9a-f]+)/)||[])[1],l=(r.match(/sc:(#[0-9a-f]+)/)||[])[1],c=parseInt((r.match(/(\d+)px/)||[])[1])||10,h=/round|bevel|notch|bite|cool|sharp|slide|jut|curl|tear|fray|wicked|sculpt|long|dog3|dog2|dog/,p=(r.match(h)||["round"])[0],d={T:0,B:1},v={TL:/top|tl/.test(r),TR:/top|tr/.test(r),BL:/bottom|bl/.test(r),BR:/bottom|br/.test(r)};!v.TL&&!v.TR&&!v.BL&&!v.BR&&(v={TL:1,TR:1,BL:1,BR:1});var m=document.createElement("div");return m.style.overflow="hidden",m.style.height="1px",m.style.backgroundColor=l||"transparent",m.style.borderStyle="solid",this.each(function(r){var o={T:parseInt(e.css(this,"paddingTop"))||0,R:parseInt(e.css(this,"paddingRight"))||0,B:parseInt(e.css(this,"paddingBottom"))||0,L:parseInt(e.css(this,"paddingLeft"))||0};typeof this.style.zoom!=undefined&&(this.style.zoom=1),a||(this.style.border="none"),m.style.borderColor=f||i(this.parentNode);var u=e.curCSS(this,"height");for(var l in d){var h=d[l];if(h&&(v.BL||v.BR)||!h&&(v.TL||v.TR)){m.style.borderStyle="none "+(v[l+"R"]?"solid":"none")+" none "+(v[l+"L"]?"solid":"none");var g=document.createElement("div");e(g).addClass("jquery-corner");var y=g.style;h?this.appendChild(g):this.insertBefore(g,this.firstChild);if(h&&u!="auto")e.css(this,"position")=="static"&&(this.style.position="relative"),y.position="absolute",y.bottom=y.left=y.padding=y.margin="0",t?y.setExpression("width","this.parentNode.offsetWidth"):y.width="100%";else if(!h&&e.browser.msie){e.css(this,"position")=="static"&&(this.style.position="relative"),y.position="absolute",y.top=y.left=y.right=y.padding=y.margin="0";if(t){var b=n(this,"borderLeftWidth")+n(this,"borderRightWidth");y.setExpression("width","this.parentNode.offsetWidth - "+b+'+ "px"')}else y.width="100%"}else y.margin=h?o.B-c+"px -"+o.R+"px -"+o.B+"px -"+o.L+"px":"-"+o.T+"px -"+o.R+"px "+(o.T-c)+"px -"+o.L+"px";for(var w=0;w<c;w++){var E=Math.max(0,s(p,w,c)),S=m.cloneNode(!1);S.style.borderWidth="0 "+(v[l+"R"]?E:0)+"px 0 "+(v[l+"L"]?E:0)+"px",h?g.appendChild(S):g.insertBefore(S,g.firstChild)}}}})},e.fn.uncorner=function(){return e("div.jquery-corner",this).remove(),this}}(jQuery),pen.define("cdf/jquery.corner",function(){}),function($){function loadAndParseFile(filename,language,mode){$.ajax({url:filename,async:!1,contentType:"application/x-www-form-urlencoded",dataType:"text",success:function(data,status){var parsed="",parameters=data.split(/\n/),regPlaceHolder=/(\{\d+\})/g,regRepPlaceHolder=/\{(\d+)\}/g,unicodeRE=/(\\u.{4})/ig;for(var i=0;i<parameters.length;i++){parameters[i]=parameters[i].replace(/^\s\s*/,"").replace(/\s\s*$/,"");if(parameters[i].length>0&&parameters[i].match("^#")!="#"){var pair=parameters[i].split("=");if(pair.length>0){var name=unescape(pair[0]).replace(/^\s\s*/,"").replace(/\s\s*$/,""),value=pair.length==1?"":pair[1];for(var s=2;s<pair.length;s++)value+="="+pair[s];value=value.replace(/"/g,'\\"'),value=value.replace(/^\s\s*/,"").replace(/\s\s*$/,"");if(mode=="map"||mode=="both"){var unicodeMatches=value.match(unicodeRE);if(unicodeMatches)for(var u=0;u<unicodeMatches.length;u++)value=value.replace(unicodeMatches[u],unescapeUnicode(unicodeMatches[u]));$.i18n.map[name]=value}if(mode=="vars"||mode=="both"){checkKeyNamespace(name);if(regPlaceHolder.test(value)){var parts=value.split(regPlaceHolder),first=!0,fnArgs="",usedArgs=[];for(var p=0;p<parts.length;p++)regPlaceHolder.test(parts[p])&&usedArgs.indexOf(parts[p])==-1&&(first||(fnArgs+=","),fnArgs+=parts[p].replace(regRepPlaceHolder,"v$1"),usedArgs.push(parts[p]),first=!1);parsed+=name+"=function("+fnArgs+"){";var fnExpr='"'+value.replace(regRepPlaceHolder,'"+v$1+"')+'"';parsed+="return "+fnExpr+";"+"};"}else parsed+=name+'="'+value+'";'}}}}eval(parsed)}})}function checkKeyNamespace(key){var regDot=/\./;if(regDot.test(key)){var fullname="",names=key.split(/\./);for(var i=0;i<names.length;i++)i>0&&(fullname+="."),fullname+=names[i],eval("typeof "+fullname+' == "undefined"')&&eval(fullname+"={};")}}function getFiles(e){return e&&e.constructor==Array?e:[e]}function normaliseLanguageCode(e){return e=e.toLowerCase(),e.length>3&&(e=e.substring(0,3)+e.substring(3).toUpperCase()),e}function unescapeUnicode(e){var t=[],n=parseInt(e.substr(2),16);n>=0&&n<Math.pow(2,16)&&t.push(n);var r="";for(var i=0;i<t.length;++i)r+=String.fromCharCode(t[i]);return r}$.i18n={},$.i18n.map={},$.i18n.properties=function(e){var t={name:"Messages",language:"",path:"",mode:"vars",callback:function(){}};e=$.extend(t,e);if(e.language===null||e.language=="")e.language=$.i18n.browserLang();e.language===null&&(e.language="");var n=getFiles(e.name);for(i=0;i<n.length;i++)loadAndParseFile(e.path+n[i]+".properties",e.language,e.mode),e.language.length>=2&&loadAndParseFile(e.path+n[i]+"_"+e.language.substring(0,2)+".properties",e.language,e.mode),e.language.length>=5&&loadAndParseFile(e.path+n[i]+"_"+e.language.substring(0,5)+".properties",e.language,e.mode);e.callback&&e.callback()},$.i18n.prop=function(e,t){var n=$.i18n.map[e];if(n==null)return"["+e+"]";if(!t)return n;for(var r=0;r<t.length;r++){var i=new RegExp("\\{("+r+")\\}","g");n=n.replace(i,t[r])}return n},$.i18n.browserLang=function(){return normaliseLanguageCode(navigator.language||navigator.userLanguage)}}(jQuery),pen.define("cdf/jquery.i18n.properties",function(){}),this.JSON||(this.JSON={}),function(){function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)r=rep[n],typeof r=="string"&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),pen.define("cdf/json",function(){}),pen.define("cdf/cdf-module",function(){}),Function.prototype.bind||(Function.prototype.bind=function(){var e=this,t=Array.prototype.slice.call(arguments),n=t.shift();return function(){return e.apply(n,t.concat(Array.prototype.slice.call(arguments)))}}),pen.define("common-ui/prompting/pentaho-prompting-bind",function(){}),pen.define("common-ui/prompting/pentaho-prompting-builders",["cdf/cdf-module","common-ui/prompting/pentaho-prompting-bind"],function(){pentaho=typeof pentaho=="undefined"?{}:pentaho,pentaho.common=pentaho.common||{},pentaho.common.prompting=pentaho.common.prompting||{},pentaho.common.prompting.builders=pentaho.common.prompting.builders||{},pentaho.common.prompting.builders.PromptPanelBuilder=Base.extend({build:function(e){var t="prompt"+e.guid,n={name:t,type:"ScrollingPromptPanelLayoutComponent",htmlObject:e.destinationId,promptPanel:e,components:e.buildPanelComponents(),postExecution:function(){e._ready()}};return n}}),pentaho.common.prompting.builders.WidgetBuilder={mapping:{"prompt-panel":"pentaho.common.prompting.builders.PromptPanelBuilder","group-panel":"pentaho.common.prompting.builders.ParameterGroupPanelBuilder","parameter-panel":"pentaho.common.prompting.builders.ParameterPanelBuilder","submit-panel":"pentaho.common.prompting.builders.SubmitPanelBuilder",submit:"pentaho.common.prompting.builders.SubmitComponentBuilder",label:"pentaho.common.prompting.builders.LabelBuilder","error-label":"pentaho.common.prompting.builders.ErrorLabelBuilder",dropdown:"pentaho.common.prompting.builders.DropDownBuilder",radio:"pentaho.common.prompting.builders.RadioBuilder",checkbox:"pentaho.common.prompting.builders.CheckBuilder",togglebutton:"pentaho.common.prompting.builders.MultiButtonBuilder",list:"pentaho.common.prompting.builders.ListBuilder",datepicker:"pentaho.common.prompting.builders.DateInputBuilder",filebrowser:"pentaho.common.prompting.builders.ExternalInputBuilder","external-input":"pentaho.common.prompting.builders.ExternalInputBuilder","multi-line":"pentaho.common.prompting.builders.TextAreaBuilder",gc:"pentaho.common.prompting.builders.GarbageCollectorBuilder","default":"pentaho.common.prompting.builders.PlainPromptBuilder"},cache:{},findBuilderFor:function(e,t){return t=t||(e.param&&e.param.attributes?e.param.attributes["parameter-render-type"]:null),this.createBuilder(this.mapping[t]||this.mapping["default"])},createBuilder:function(name){var builder=this.cache[name];if(!builder)try{builder=eval("new "+name+"()"),this.cache[name]=builder}catch(e){throw typeof console!="undefined"&&console.log&&console.log('Unable to create widget builder of type "'+name+'"'),e}return builder},build:function(e,t){var n=this.findBuilderFor(e,t).build(e);return n.parameter&&n.param&&(n.postChange=function(){e.promptPanel.parameterChanged(this.param,this.parameter,this.getValue())}.bind(n)),n}},pentaho.common.prompting.builders.SubmitPanelBuilder=Base.extend({build:function(e){var t=e.promptPanel.generateWidgetGUID();return{type:"FlowPromptLayoutComponent",promptType:"submit",name:t,htmlObject:t,executeAtStart:!0,components:[pentaho.common.prompting.builders.WidgetBuilder.build(e,"submit")]}}}),pentaho.common.prompting.builders.SubmitComponentBuilder=Base.extend({build:function(e){var t=e.promptPanel.generateWidgetGUID();return{promptType:"submit",type:"SubmitPromptComponent",name:t,htmlObject:t,label:e.promptPanel.getString("submitButtonLabel","Submit"),autoSubmitLabel:e.promptPanel.getString("autoSubmitLabel","Auto-Submit"),promptPanel:e.promptPanel,paramDefn:e.promptPanel.paramDefn,executeAtStart:!0}}}),pentaho.common.prompting.builders.ParameterWidgetBuilderBase=Base.extend({build:function(e){var t=e.promptPanel.generateWidgetGUID();return{promptType:"prompt",executeAtStart:!0,param:e.param,name:t,htmlObject:t,type:undefined,parameter:e.promptPanel.getParameterName(e.param),postExecution:function(){this.base();var e=this.param.attributes.tooltip;e&&$("#"+this.htmlObject).attr("title",e)}}}}),pentaho.common.prompting.builders.LabelBuilder=pentaho.common.prompting.builders.ParameterWidgetBuilderBase.extend({build:function(e){var t=this.base(e),n=t.name+"-label",r=Dashboards.escapeHtml(e.param.attributes.label||e.param.name);return $.extend(t,{promptType:"label",name:n,htmlObject:n,type:"TextComponent",expression:function(){return r}}),delete t.parameter,t}}),pentaho.common.prompting.builders.ErrorLabelBuilder=pentaho.common.prompting.builders.LabelBuilder.extend({build:function(e){var t=this.base(e),n=e.errorMessage;return t.isErrorIndicator=!0,t.expression=function(){return n},t}}),pentaho.common.prompting.builders.TextInputBuilder=pentaho.common.prompting.builders.ParameterWidgetBuilderBase.extend({build:function(e){var t=this.base(e);return $.extend(t,{type:"TextInputComponent"})}}),pentaho.common.prompting.builders.ValueBasedParameterWidgetBuilder=pentaho.common.prompting.builders.ParameterWidgetBuilderBase.extend({getCDFValuesArray:function(e){var t=[];return $.each(e.values,function(e,n){t.push([n.value,n.label])}),t},build:function(e){var t=this.base(e);return $.extend(t,{valueAsId:!1,valuesArray:this.getCDFValuesArray(e.param)})}}),pentaho.common.prompting.builders.DropDownBuilder=pentaho.common.prompting.builders.ValueBasedParameterWidgetBuilder.extend({build:function(e){var t=this.base(e);return e.promptPanel.paramDefn.ignoreBiServer5538&&!e.param.hasSelection()&&(t.valuesArray=[["",""]].concat(t.valuesArray)),$.extend(t,{type:"SelectComponent",preExecution:function(){this.defaultIfEmpty=!e.promptPanel.paramDefn.ignoreBiServer5538&&!e.param.hasSelection()}})}}),pentaho.common.prompting.builders.ListBuilder=pentaho.common.prompting.builders.ValueBasedParameterWidgetBuilder.extend({build:function(e){var t=this.base(e);return $.extend(t,{type:e.param.multiSelect?"SelectMultiComponent":"SelectComponent",size:e.param.attributes["parameter-visible-items"]||5,changeMode:e.param.multiSelect?"timeout-focus":"immediate",preExecution:function(){this.defaultIfEmpty=!1}})}}),pentaho.common.prompting.builders.MultiButtonBuilder=pentaho.common.prompting.builders.ValueBasedParameterWidgetBuilder.extend({build:function(e){var t=this.base(e);return $.extend(t,{type:"MultiButtonComponent",isMultiple:e.param.multiSelect,verticalOrientation:"vertical"===e.param.attributes["parameter-layout"],expression:function(){return Dashboards.getParameterValue(this.parameter)},postExecution:function(){$("#"+this.htmlObject).addClass("pentaho-toggle-button-container")}})}}),pentaho.common.prompting.builders.ToggleButtonBaseBuilder=pentaho.common.prompting.builders.ValueBasedParameterWidgetBuilder.extend({build:function(e){var t=this.base(e);return $.extend(t,{defaultIfEmpty:!1,verticalOrientation:"vertical"==e.param.attributes["parameter-layout"]})}}),pentaho.common.prompting.builders.CheckBuilder=pentaho.common.prompting.builders.ToggleButtonBaseBuilder.extend({build:function(e){var t=this.base(e);return t.type="CheckComponent",t}}),pentaho.common.prompting.builders.RadioBuilder=pentaho.common.prompting.builders.ToggleButtonBaseBuilder.extend({build:function(e){var t=this.base(e);return t.type="radio",t}}),pentaho.common.prompting.builders.ExternalInputBuilder=pentaho.common.prompting.builders.ValueBasedParameterWidgetBuilder.extend({build:function(e){var t=e.promptPanel.createFormatter(e.promptPanel.paramDefn,e.param);return $.extend(this.base(e),{type:"ExternalInputComponent",transportFormatter:e.promptPanel.createDataTransportFormatter(e.promptPanel.paramDefn,e.param,t),formatter:t,promptPanel:e.promptPanel,paramDefn:e.promptPanel.paramDefn})}}),pentaho.common.prompting.builders.DateInputBuilder=pentaho.common.prompting.builders.ValueBasedParameterWidgetBuilder.extend({build:function(e){var t=e.promptPanel.createFormatter(e.promptPanel.paramDefn,e.param);return $.extend(this.base(e),{type:"DojoDateTextBoxComponent",transportFormatter:e.promptPanel.createDataTransportFormatter(e.promptPanel.paramDefn,e.param,t),formatter:t})}}),pentaho.common.prompting.builders.ParameterGroupPanelBuilder=Base.extend({lookupPromptType:function(e){switch(e.layout){case"horizontal":return"HorizontalTableBasedPromptLayoutComponent";case"flow":return"FlowPromptLayoutComponent";default:return"VerticalTableBasedPromptLayoutComponent"}},build:function(e){var t=e.promptPanel.generateWidgetGUID(),n=undefined;return{type:this.lookupPromptType(e.promptPanel.paramDefn),name:e.paramGroup.name,htmlObject:t,promptPanel:e.promptPanel,label:n,components:e.components,cssClass:"parameter-wrapper"}}}),pentaho.common.prompting.builders.ParameterPanelBuilder=pentaho.common.prompting.builders.ParameterWidgetBuilderBase.extend({build:function(e){var t=this.base(e),n="panel-"+t.name;return{name:n,htmlObject:n,type:"ParameterPanelComponent",executeAtStart:!0,components:e.components,param:e.param}}}),pentaho.common.prompting.builders.PlainPromptBuilder=pentaho.common.prompting.builders.ValueBasedParameterWidgetBuilder.extend({build:function(e){var t=e.promptPanel.createFormatter(e.promptPanel.paramDefn,e.param),n=e.promptPanel.createDataTransportFormatter(e.promptPanel.paramDefn,e.param,t),r=function(e){return $.map(e,function(e){var r=t?t.format(n.parse(e[0])):e[0],i=(t?t.format(n.parse(e[1])):e[1])||r;return{value:r,label:i}})},i=this.base(e);return $.extend(i,{type:"StaticAutocompleteBoxComponent",valuesArray:r(i.valuesArray),transportFormatter:n,formatter:t})}}),pentaho.common.prompting.builders.TextAreaBuilder=pentaho.common.prompting.builders.ValueBasedParameterWidgetBuilder.extend({build:function(e){var t=e.promptPanel.createFormatter(e.promptPanel.paramDefn,e.param);return $.extend(this.base(e),{type:"TextAreaComponent",transportFormatter:e.promptPanel.createDataTransportFormatter(e.promptPanel.paramDefn,e.param,t),formatter:t})}}),pentaho.common.prompting.builders.GarbageCollectorBuilder=Base.extend({build:function(e){return{type:"BaseComponent",name:"gc"+e.promptPanel.generateWidgetGUID(),executeAtStart:!0,preExecution:function(){return $.each(e.components.reverse(),function(e,t){try{t.clear()}catch(n){Dashboards.log("Error clearing "+t.name+":","error"),Dashboards.log(n,"exception")}}),setTimeout(function(){pentaho.common.prompting.removeDashboardComponents([this])}.bind(this)),!1}}}})}),pen.define("dojo/has",["require","module"],function(e,t){var n=e.has||function(){};if(!n("dojo-has-api")){var r=typeof window!="undefined"&&typeof location!="undefined"&&typeof document!="undefined"&&window.location==location&&window.document==document,i=this,s=r&&document,o=s&&s.createElement("DiV"),u=t.config&&t.config()||{};n=function(e){return typeof u[e]=="function"?u[e]=u[e](i,s,o):u[e]},n.cache=u,n.add=function(e,t,r,i){return(typeof u[e]=="undefined"||i)&&(u[e]=t),r&&n(e)},n.add("host-browser",r),n.add("dom",r),n.add("dojo-dom-ready-api",1),n.add("dojo-sniff",1)}if(n("host-browser")){n.add("dom-addeventlistener",!!document.addEventListener),n.add("touch","ontouchstart"in document||window.navigator.msMaxTouchPoints>0),n.add("device-width",screen.availWidth||innerWidth);var a=document.createElement("form");n.add("dom-attributes-explicit",a.attributes.length==0),n.add("dom-attributes-specified-flag",a.attributes.length>0&&a.attributes.length<40)}return n.clearElement=function(e){return e.innerHTML="",e},n.normalize=function(e,t){var r=e.match(/[\?:]|[^:\?]*/g),i=0,s=function(e){var t=r[i++];return t==":"?0:r[i++]=="?"?!e&&n(t)?s():(s(!0),s(e)):t||0};return e=s(),e&&t(e)},n.load=function(e,t,n){e?t([e],n):n()},n}),pen.define("dojo/_base/config",["../has","require"],function(e,t){var n={};if(e("dojo-config-api")){var r=t.rawConfig,i;for(i in r)n[i]=r[i]}else{var s=function(t,n,r){for(i in t)i!="has"&&e.add(n+i,t[i],0,r)};n=e("dojo-loader")?t.rawConfig:this.dojoConfig||this.djConfig||{},s(n,"config",1),s(n.has,"",1)}return!n.locale&&typeof navigator!="undefined"&&(n.locale=(navigator.language||navigator.userLanguage).toLowerCase()),n}),pen.define("dojo/_base/kernel",["../has","./config","require","module"],function(e,t,n,r){var i,s,o={},u={},a={config:t,global:window,dijit:o,dojox:u},f={dojo:["dojo",a],dijit:["dijit",o],dojox:["dojox",u]},l=n.map&&n.map[r.id.match(/[^\/]+/)[0]],c;for(s in l)f[s]?f[s][0]=l[s]:f[s]=[l[s],{}];for(s in f)c=f[s],c[1]._scopeName=c[0],t.noGlobals||(this[c[0]]=c[1]);a.scopeMap=f,a.baseUrl=a.config.baseUrl=n.baseUrl,a.isAsync=!e("dojo-loader")||n.async,a.locale=t.locale;var h="$Rev: f774568 $".match(/[0-9a-f]{7,}/);a.version={major:1,minor:9,patch:2,flag:"",revision:h?h[0]:NaN,toString:function(){var e=a.version;return e.major+"."+e.minor+"."+e.patch+e.flag+" ("+e.revision+")"}},e.add("extend-dojo",1),Function("d","d.eval = function(){return d.global.eval ? d.global.eval(arguments[0]) : eval(arguments[0]);}")(a),e("host-rhino")?a.exit=function(e){quit(e)}:a.exit=function(){},e.add("dojo-guarantee-console",1);if(e("dojo-guarantee-console")){typeof console!="undefined"||(console={});var p=["assert","count","debug","dir","dirxml","error","group","groupEnd","info","profile","profileEnd","time","timeEnd","trace","warn","log"],d;i=0;while(d=p[i++])console[d]||function(){var e=d+"";console[e]="log"in console?function(){var t=Array.apply({},arguments);t.unshift(e+":"),console.log(t.join(" "))}:function(){},console[e]._fake=!0}()}e.add("dojo-debug-messages",!!t.isDebug),a.deprecated=a.experimental=function(){},e("dojo-debug-messages")&&(a.deprecated=function(e,t,n){var r="DEPRECATED: "+e;t&&(r+=" "+t),n&&(r+=" -- will be removed in version: "+n),console.warn(r)},a.experimental=function(e,t){var n="EXPERIMENTAL: "+e+" -- APIs subject to change without notice.";t&&(n+=" "+t),console.warn(n)}),e.add("dojo-modulePaths",1);if(e("dojo-modulePaths")&&t.modulePaths){a.deprecated("dojo.modulePaths","use paths configuration");var v={};for(s in t.modulePaths)v[s.replace(/\./g,"/")]=t.modulePaths[s];n({paths:v})}return e.add("dojo-moduleUrl",1),e("dojo-moduleUrl")&&(a.moduleUrl=function(e,t){a.deprecated("dojo.moduleUrl()","use require.toUrl","2.0");var r=null;return e&&(r=n.toUrl(e.replace(/\./g,"/")+(t?"/"+t:"")+"/*.*").replace(/\/\*\.\*/,"")+(t?"":"/")),r}),a._hasResource={},a}),pen.define("dojo/sniff",["./has"],function(e){if(e("host-browser")){var t=navigator,n=t.userAgent,r=t.appVersion,i=parseFloat(r);e.add("air",n.indexOf("AdobeAIR")>=0),e.add("msapp",parseFloat(n.split("MSAppHost/")[1])||undefined),e.add("khtml",r.indexOf("Konqueror")>=0?i:undefined),e.add("webkit",parseFloat(n.split("WebKit/")[1])||undefined),e.add("chrome",parseFloat(n.split("Chrome/")[1])||undefined),e.add("safari",r.indexOf("Safari")>=0&&!e("chrome")?parseFloat(r.split("Version/")[1]):undefined),e.add("mac",r.indexOf("Macintosh")>=0),e.add("quirks",document.compatMode=="BackCompat");if(n.match(/(iPhone|iPod|iPad)/)){var s=RegExp.$1.replace(/P/,"p"),o=n.match(/OS ([\d_]+)/)?RegExp.$1:"1",u=parseFloat(o.replace(/_/,".").replace(/_/g,""));e.add(s,u),e.add("ios",u)}e.add("android",parseFloat(n.split("Android ")[1])||undefined),e.add("bb",(n.indexOf("BlackBerry")>=0||n.indexOf("BB10")>=0)&&parseFloat(n.split("Version/")[1])||undefined),e.add("trident",parseFloat(r.split("Trident/")[1])||undefined),e.add("svg",typeof SVGAngle!="undefined");if(!e("webkit")){n.indexOf("Opera")>=0&&e.add("opera",i>=9.8?parseFloat(n.split("Version/")[1])||i:i),n.indexOf("Gecko")>=0&&!e("khtml")&&!e("webkit")&&!e("trident")&&e.add("mozilla",i),e("mozilla")&&e.add("ff",parseFloat(n.split("Firefox/")[1]||n.split("Minefield/")[1])||undefined);if(document.all&&!e("opera")){var a=parseFloat(r.split("MSIE ")[1])||undefined,f=document.documentMode;f&&f!=5&&Math.floor(a)!=f&&(a=f),e.add("ie",a)}e.add("wii",typeof opera!="undefined"&&opera.wiiremote)}}return e}),pen.define("dojo/_base/lang",["./kernel","../has","../sniff"],function(e,t){t.add("bug-for-in-skips-shadowed",function(){for(var e in{toString:1})return 0;return 1});var n=t("bug-for-in-skips-shadowed")?"hasOwnProperty.valueOf.isPrototypeOf.propertyIsEnumerable.toLocaleString.toString.constructor".split("."):[],r=n.length,i=function(t,n,r){var i,s=0,o=e.global;if(!r){if(!t.length)return o;i=t[s++];try{r=e.scopeMap[i]&&e.scopeMap[i][1]}catch(u){}r=r||(i in o?o[i]:n?o[i]={}:undefined)}while(r&&(i=t[s++]))r=i in r?r[i]:n?r[i]={}:undefined;return r},s=Object.prototype.toString,o=function(e,t,n){return(n||[]).concat(Array.prototype.slice.call(e,t||0))},u=/\{([^\}]+)\}/g,a={_extraNames:n,_mixin:function(e,i,s){var o,u,a,f={};for(o in i){u=i[o];if(!(o in e)||e[o]!==u&&(!(o in f)||f[o]!==u))e[o]=s?s(u):u}if(t("bug-for-in-skips-shadowed")&&i)for(a=0;a<r;++a){o=n[a],u=i[o];if(!(o in e)||e[o]!==u&&(!(o in f)||f[o]!==u))e[o]=s?s(u):u}return e},mixin:function(e,t){e||(e={});for(var n=1,r=arguments.length;n<r;n++)a._mixin(e,arguments[n]);return e},setObject:function(e,t,n){var r=e.split("."),s=r.pop(),o=i(r,!0,n);return o&&s?o[s]=t:undefined},getObject:function(e,t,n){return i(e.split("."),t,n)},exists:function(e,t){return a.getObject(e,!1,t)!==undefined},isString:function(e){return typeof e=="string"||e instanceof String},isArray:function(e){return e&&(e instanceof Array||typeof e=="array")},isFunction:function(e){return s.call(e)==="[object Function]"},isObject:function(e){return e!==undefined&&(e===null||typeof e=="object"||a.isArray(e)||a.isFunction(e))},isArrayLike:function(e){return e&&e!==undefined&&!a.isString(e)&&!a.isFunction(e)&&(!e.tagName||e.tagName.toLowerCase()!="form")&&(a.isArray(e)||isFinite(e.length))},isAlien:function(e){return e&&!a.isFunction(e)&&/\{\s*\[native code\]\s*\}/.test(String(e))},extend:function(e,t){for(var n=1,r=arguments.length;n<r;n++)a._mixin(e.prototype,arguments[n]);return e},_hitchArgs:function(t,n){var r=a._toArray(arguments,2),i=a.isString(n);return function(){var s=a._toArray(arguments),o=i?(t||e.global)[n]:n;return o&&o.apply(t||this,r.concat(s))}},hitch:function(t,n){if(arguments.length>2)return a._hitchArgs.apply(e,arguments);n||(n=t,t=null);if(a.isString(n)){t=t||e.global;if(!t[n])throw['lang.hitch: scope["',n,'"] is null (scope="',t,'")'].join("");return function(){return t[n].apply(t,arguments||[])}}return t?function(){return n.apply(t,arguments||[])}:n},delegate:function(){function e(){}return function(t,n){e.prototype=t;var r=new e;return e.prototype=null,n&&a._mixin(r,n),r}}(),_toArray:t("ie")?function(){function e(e,t,n){var r=n||[];for(var i=t||0;i<e.length;i++)r.push(e[i]);return r}return function(t){return(t.item?e:o).apply(this,arguments)}}():o,partial:function(t){var n=[null];return a.hitch.apply(e,n.concat(a._toArray(arguments)))},clone:function(e){if(!e||typeof e!="object"||a.isFunction(e))return e;if(e.nodeType&&"cloneNode"in e)return e.cloneNode(!0);if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e);var t,n,r;if(a.isArray(e)){t=[];for(n=0,r=e.length;n<r;++n)n in e&&t.push(a.clone(e[n]))}else t=e.constructor?new e.constructor:{};return a._mixin(t,e,a.clone)},trim:String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},replace:function(e,t,n){return e.replace(n||u,a.isFunction(t)?t:function(e,n){return a.getObject(n,!1,t)})}};return t("extend-dojo")&&a.mixin(e,a),a}),pen.define("dojo/_base/declare",["./kernel","../has","./lang"],function(e,t,n){function f(e,t){throw new Error("declare"+(t?" "+t:"")+": "+e)}function l(e,t){var n=[],r=[{cls:0,refs:[]}],i={},o=1,a=e.length,l=0,c,h,p,d,v,m,g,y;for(;l<a;++l){p=e[l],p?s.call(p)!="[object Function]"&&f("mixin #"+l+" is not a callable constructor.",t):f("mixin #"+l+" is unknown. Did you use dojo.require to pull it in?",t),h=p._meta?p._meta.bases:[p],d=0;for(c=h.length-1;c>=0;--c)v=h[c].prototype,v.hasOwnProperty("declaredClass")||(v.declaredClass="uniqName_"+u++),g=v.declaredClass,i.hasOwnProperty(g)||(i[g]={count:0,refs:[],cls:h[c]},++o),m=i[g],d&&d!==m&&(m.refs.push(d),++d.count),d=m;++d.count,r[0].refs.push(d)}while(r.length){d=r.pop(),n.push(d.cls),--o;while(y=d.refs,y.length==1){d=y[0];if(!d||--d.count){d=0;break}n.push(d.cls),--o}if(d)for(l=0,a=y.length;l<a;++l)d=y[l],--d.count||r.push(d)}return o&&f("can't build consistent linearization",t),p=e[0],n[0]=p?p._meta&&p===n[n.length-p._meta.bases.length]?p._meta.bases.length:1:0,n}function c(e,t,n){var r,s,o,u,l,c,h,p,d,v=this._inherited=this._inherited||{};typeof e=="string"&&(r=e,e=t,t=n),n=0,u=e.callee,r=r||u.nom,r||f("can't deduce a name to call inherited()",this.declaredClass),l=this.constructor._meta,o=l.bases,d=v.p;if(r!=a){if(v.c!==u){d=0,c=o[0],l=c._meta;if(l.hidden[r]!==u){s=l.chains,s&&typeof s[r]=="string"&&f("calling chained method with inherited: "+r,this.declaredClass);do{l=c._meta,h=c.prototype;if(l&&(h[r]===u&&h.hasOwnProperty(r)||l.hidden[r]===u))break}while(c=o[++d]);d=c?d:-1}}c=o[++d];if(c){h=c.prototype;if(c._meta&&h.hasOwnProperty(r))n=h[r];else{p=i[r];do{h=c.prototype,n=h[r];if(n&&(c._meta?h.hasOwnProperty(r):n!==p))break}while(c=o[++d])}}n=c&&n||i[r]}else{if(v.c!==u){d=0,l=o[0]._meta;if(l&&l.ctor!==u){s=l.chains,(!s||s.constructor!=="manual")&&f("calling chained constructor with inherited",this.declaredClass);while(c=o[++d]){l=c._meta;if(l&&l.ctor===u)break}d=c?d:-1}}while(c=o[++d]){l=c._meta,n=l?l.ctor:c;if(n)break}n=c&&n}v.c=n,v.p=d;if(n)return t===!0?n:n.apply(this,t||e)}function h(e,t){return typeof e=="string"?this.__inherited(e,t,!0):this.__inherited(e,!0)}function p(e,t,n){var r=this.getInherited(e,t);if(r)return r.apply(this,n||t||e)}function v(e){var t=this.constructor._meta.bases;for(var n=0,r=t.length;n<r;++n)if(t[n]===e)return!0;return this instanceof e}function m(e,r){for(var i in r)i!=a&&r.hasOwnProperty(i)&&(e[i]=r[i]);if(t("bug-for-in-skips-shadowed"))for(var s=n._extraNames,o=s.length;o;)i=s[--o],i!=a&&r.hasOwnProperty(i)&&(e[i]=r[i])}function g(e,r){var o,u;for(o in r)u=r[o],(u!==i[o]||!(o in i))&&o!=a&&(s.call(u)=="[object Function]"&&(u.nom=o),e[o]=u);if(t("bug-for-in-skips-shadowed"))for(var f=n._extraNames,l=f.length;l;)o=f[--l],u=r[o],(u!==i[o]||!(o in i))&&o!=a&&(s.call(u)=="[object Function]"&&(u.nom=o),e[o]=u);return e}function y(e){return C.safeMixin(this.prototype,e),this}function b(e,t){return C([this].concat(e),t||{})}function w(e,t){return function(){var n=arguments,r=n,i=n[0],s,o,u,a=e.length,f;if(!(this instanceof n.callee))return N(n);if(t&&(i&&i.preamble||this.preamble)){f=new Array(e.length),f[0]=n;for(o=0;;){i=n[0],i&&(s=i.preamble,s&&(n=s.apply(this,n)||n)),s=e[o].prototype,s=s.hasOwnProperty("preamble")&&s.preamble,s&&(n=s.apply(this,n)||n);if(++o==a)break;f[o]=n}}for(o=a-1;o>=0;--o)s=e[o],u=s._meta,s=u?u.ctor:s,s&&s.apply(this,f?f[o]:n);s=this.postscript,s&&s.apply(this,r)}}function E(e,t){return function(){var n=arguments,r=n,i=n[0],s;if(!(this instanceof n.callee))return N(n);t&&(i&&(s=i.preamble,s&&(r=s.apply(this,r)||r)),s=this.preamble,s&&s.apply(this,r)),e&&e.apply(this,n),s=this.postscript,s&&s.apply(this,n)}}function S(e){return function(){var t=arguments,n=0,r,i;if(!(this instanceof t.callee))return N(t);for(;r=e[n];++n){i=r._meta,r=i?i.ctor:r;if(r){r.apply(this,t);break}}r=this.postscript,r&&r.apply(this,t)}}function x(e,t,n){return function(){var r,i,s,o=0,u=1;n&&(o=t.length-1,u=-1);for(;r=t[o];o+=u)i=r._meta,s=(i?i.hidden:r.prototype)[e],s&&s.apply(this,arguments)}}function T(e){o.prototype=e.prototype;var t=new o;return o.prototype=null,t}function N(e){var t=e.callee,n=T(t);return t.apply(n,e),n}function C(e,t,o){typeof e!="string"&&(o=t,t=e,e=""),o=o||{};var u,p,g,N,k,L,A,O=1,M=t;s.call(t)=="[object Array]"?(L=l(t,e),g=L[0],O=L.length-g,t=L[O]):(L=[0],t?s.call(t)=="[object Function]"?(g=t._meta,L=L.concat(g?g.bases:t)):f("base class is not a callable constructor.",e):t!==null&&f("unknown base class. Did you use dojo.require to pull it in?",e));if(t)for(p=O-1;;--p){u=T(t);if(!p)break;g=L[p],(g._meta?m:r)(u,g.prototype),N=new Function,N.superclass=t,N.prototype=u,t=u.constructor=N}else u={};C.safeMixin(u,o),g=o.constructor,g!==i.constructor&&(g.nom=a,u.constructor=g);for(p=O-1;p;--p)g=L[p]._meta,g&&g.chains&&(A=r(A||{},g.chains));u["-chains-"]&&(A=r(A||{},u["-chains-"])),g=!A||!A.hasOwnProperty(a),L[0]=N=A&&A.constructor==="manual"?S(L):L.length==1?E(o.constructor,g):w(L,g),N._meta={bases:L,hidden:o,chains:A,parents:M,ctor:o.constructor},N.superclass=t&&t.prototype,N.extend=y,N.createSubclass=b,N.prototype=u,u.constructor=N,u.getInherited=h,u.isInstanceOf=v,u.inherited=d,u.__inherited=c,e&&(u.declaredClass=e,n.setObject(e,N));if(A)for(k in A)u[k]&&typeof A[k]=="string"&&k!=a&&(g=u[k]=x(k,L,A[k]==="after"),g.nom=k);return N}var r=n.mixin,i=Object.prototype,s=i.toString,o=new Function,u=0,a="constructor",d=e.config.isDebug?p:c;return e.safeMixin=C.safeMixin=g,e.declare=C,C}),pen.define("dojo/_base/array",["./kernel","../has","./lang"],function(e,t,n){function s(e){return r[e]=new Function("item","index","array",e)}function o(e){var t=!e;return function(n,i,o){var u=0,a=n&&n.length||0,f;a&&typeof n=="string"&&(n=n.split("")),typeof i=="string"&&(i=r[i]||s(i));if(o)for(;u<a;++u){f=!i.call(o,n[u],u,n);if(e^f)return!f}else for(;u<a;++u){f=!i(n[u],u,n);if(e^f)return!f}return t}}function u(e){var t=1,n=0,r=0;return e||(t=n=r=-1),function(s,o,u,f){if(f&&t>0)return a.lastIndexOf(s,o,u);var l=s&&s.length||0,c=e?l+r:n,h;u===i?h=e?n:l+r:u<0?(h=l+u,h<0&&(h=n)):h=u>=l?l+r:u,l&&typeof s=="string"&&(s=s.split(""));for(;h!=c;h+=t)if(s[h]==o)return h;return-1}}var r={},i,a={every:o(!1),some:o(!0),indexOf:u(!0),lastIndexOf:u(!1),forEach:function(e,t,n){var i=0,o=e&&e.length||0;o&&typeof e=="string"&&(e=e.split("")),typeof t=="string"&&(t=r[t]||s(t));if(n)for(;i<o;++i)t.call(n,e[i],i,e);else for(;i<o;++i)t(e[i],i,e)},map:function(e,t,n,i){var o=0,u=e&&e.length||0,a=new(i||Array)(u);u&&typeof e=="string"&&(e=e.split("")),typeof t=="string"&&(t=r[t]||s(t));if(n)for(;o<u;++o)a[o]=t.call(n,e[o],o,e);else for(;o<u;++o)a[o]=t(e[o],o,e);return a},filter:function(e,t,n){var i=0,o=e&&e.length||0,u=[],a;o&&typeof e=="string"&&(e=e.split("")),typeof t=="string"&&(t=r[t]||s(t));if(n)for(;i<o;++i)a=e[i],t.call(n,a,i,e)&&u.push(a);else for(;i<o;++i)a=e[i],t(a,i,e)&&u.push(a);return u},clearCache:function(){r={}}};return t("extend-dojo")&&n.mixin(e,a),a}),pen.define("dojo/aspect",[],function(){function n(e,n,r,i){var s=e[n],o=n=="around",u;if(o){var a=r(function(){return s.advice(this,arguments)});u={remove:function(){a&&(a=e=r=null)},advice:function(e,t){return a?a.apply(e,t):s.advice(e,t)}}}else u={remove:function(){if(u.advice){var t=u.previous,i=u.next;!i&&!t?delete e[n]:(t?t.next=i:e[n]=i,i&&(i.previous=t)),e=r=u.advice=null}},id:t++,advice:r,receiveArguments:i};if(s&&!o)if(n=="after"){while(s.next&&(s=s.next));s.next=u,u.previous=s}else n=="before"&&(e[n]=u,u.next=s,s.previous=u);else e[n]=u;return u}function r(r){return function(i,s,o,u){var a=i[s],f;if(!a||a.target!=i)i[s]=f=function(){var n=t,r=arguments,i=f.before;while(i)r=i.advice.apply(this,r)||r,i=i.next;if(f.around)var s=f.around.advice(this,r);var o=f.after;while(o&&o.id<n){if(o.receiveArguments){var u=o.advice.apply(this,r);s=u===e?s:u}else s=o.advice.call(this,s,r);o=o.next}return s},a&&(f.around={advice:function(e,t){return a.apply(e,t)}}),f.target=i;var l=n(f||a,r,o,u);return o=null,l}}var e,t=0,i=r("after"),s=r("before"),o=r("around");return{before:s,around:o,after:i}}),pen.define("dojo/on",["./has!dom-addeventlistener?:./aspect","./_base/kernel","./sniff"],function(e,t,n){function o(e,t,r,o,u){var a=t.match(/(.*):(.*)/);if(a)return t=a[2],a=a[1],i.selector(a,t).call(u,e,r);n("touch")&&(s.test(t)&&(r=x(r)),!n("event-orientationchange")&&t=="orientationchange"&&(t="resize",e=window,r=x(r))),p&&(r=p(r));if(e.addEventListener){var f=t in c,l=f?c[t]:t;return e.addEventListener(l,r,f),{remove:function(){e.removeEventListener(l,r,f)}}}t="on"+t;if(g&&e.attachEvent)return g(e,t,r);throw new Error("Target must be an event emitter")}function u(){this.cancelable=!1,this.defaultPrevented=!0}function a(){this.bubbles=!1}if(n("dom")){var r=window.ScriptEngineMajorVersion;n.add("jscript",r&&r()+ScriptEngineMinorVersion()/10),n.add("event-orientationchange",n("touch")&&!n("android")),n.add("event-stopimmediatepropagation",window.Event&&!!window.Event.prototype&&!!window.Event.prototype.stopImmediatePropagation),n.add("event-focusin",function(e,t,n){return"onfocusin"in n||n.addEventListener&&function(){function n(){e=!0}var e=!1;try{var r=t.createElement("input"),i=t.activeElement;r.style.position="fixed",r.addEventListener("focusin",n,!1),t.body.appendChild(r),r.focus(),t.body.removeChild(r),r.removeEventListener("focusin",n,!1),i.focus()}catch(s){}return e}()})}var i=function(e,t,n,r){return typeof e.on=="function"&&typeof t!="function"&&!e.nodeType?e.on(t,n):i.parse(e,t,n,o,r,this)};i.pausable=function(e,t,n,r){var s,o=i(e,t,function(){if(!s)return n.apply(this,arguments)},r);return o.pause=function(){s=!0},o.resume=function(){s=!1},o},i.once=function(e,t,n,r){var s=i(e,t,function(){return s.remove(),n.apply(this,arguments)});return s},i.parse=function(e,t,n,r,i,s){if(t.call)return t.call(s,e,n);if(t.indexOf(",")>-1){var o=t.split(/\s*,\s*/),u=[],a=0,f;while(f=o[a++])u.push(r(e,f,n,i,s));return u.remove=function(){for(var e=0;e<u.length;e++)u[e].remove()},u}return r(e,t,n,i,s)};var s=/^touch/;i.selector=function(e,n,r){return function(s,o){function f(n){u=u&&u.matches?u:t.query;while(!u.matches(n,e,s))if(n==s||r===!1||!(n=n.parentNode)||n.nodeType!=1)return;return n}var u=typeof e=="function"?{matches:e}:this,a=n.bubble;return a?i(s,a(f),o):i(s,n,function(e){var t=f(e.target);return t&&o.call(t,e)})}};var f=[].slice,l=i.emit=function(e,t,n){var r=f.call(arguments,2),i="on"+t;if("parentNode"in e){var s=r[0]={};for(var o in n)s[o]=n[o];s.preventDefault=u,s.stopPropagation=a,s.target=e,s.type=t,n=s}do e[i]&&e[i].apply(e,r);while(n&&n.bubbles&&(e=e.parentNode));return n&&n.cancelable&&n},c=n("event-focusin")?{}:{focusin:"focus",focusout:"blur"};if(!n("event-stopimmediatepropagation"))var h=function(){this.immediatelyStopped=!0,this.modified=!0},p=function(e){return function(t){if(!t.immediatelyStopped)return t.stopImmediatePropagation=h,e.apply(this,arguments)}};if(n("dom-addeventlistener"))i.emit=function(e,t,n){if(e.dispatchEvent&&document.createEvent){var r=e.ownerDocument.createEvent("HTMLEvents");r.initEvent(t,!!n.bubbles,!!n.cancelable);for(var s in n)s in r||(r[s]=n[s]);return e.dispatchEvent(r)&&r}return l.apply(i,arguments)};else{i._fixEvent=function(e,t){if(!e){var n=t&&(t.ownerDocument||t.document||t).parentWindow||window;e=n.event}if(!e)return e;try{d&&e.type==d.type&&e.srcElement==d.target&&(e=d)}catch(r){}if(!e.target){e.target=e.srcElement,e.currentTarget=t||e.srcElement,e.type=="mouseover"&&(e.relatedTarget=e.fromElement),e.type=="mouseout"&&(e.relatedTarget=e.toElement),e.stopPropagation||(e.stopPropagation=b,e.preventDefault=w);switch(e.type){case"keypress":var i="charCode"in e?e.charCode:e.keyCode;i==10?(i=0,e.keyCode=13):i==13||i==27?i=0:i==3&&(i=99),e.charCode=i,y(e)}}return e};var d,v=function(e){this.handle=e};v.prototype.remove=function(){delete _dojoIEListeners_[this.handle]};var m=function(e){return function(t){t=i._fixEvent(t,this);var n=e.call(this,t);return t.modified&&(d||setTimeout(function(){d=null}),d=t),n}},g=function(t,r,i){i=m(i);if(((t.ownerDocument?t.ownerDocument.parentWindow:t.parentWindow||t.window||window)!=top||n("jscript")<5.8)&&!n("config-_allow_leaks")){typeof _dojoIEListeners_=="undefined"&&(_dojoIEListeners_=[]);var s=t[r];if(!s||!s.listeners){var o=s;s=Function("event","var callee = arguments.callee; for(var i = 0; i<callee.listeners.length; i++){var listener = _dojoIEListeners_[callee.listeners[i]]; if(listener){listener.call(this,event);}}"),s.listeners=[],t[r]=s,s.global=this,o&&s.listeners.push(_dojoIEListeners_.push(o)-1)}var u;return s.listeners.push(u=s.global._dojoIEListeners_.push(i)-1),new v(u)}return e.after(t,r,i,!0)},y=function(e){e.keyChar=e.charCode?String.fromCharCode(e.charCode):"",e.charOrCode=e.keyChar||e.keyCode},b=function(){this.cancelBubble=!0},w=i._preventDefault=function(){this.bubbledKeyCode=this.keyCode;if(this.ctrlKey)try{this.keyCode=0}catch(e){}this.defaultPrevented=!0,this.returnValue=!1,this.modified=!0}}if(n("touch"))var E=function(){},S=window.orientation,x=function(e){return function(t){var r=t.corrected;if(!r){var i=t.type;try{delete t.type}catch(s){}if(t.type){if(n("mozilla")){var r={};for(var o in t)r[o]=t[o]}else{E.prototype=t;var r=new E}r.preventDefault=function(){t.preventDefault()},r.stopPropagation=function(){t.stopPropagation()}}else r=t,r.type=i;t.corrected=r;if(i=="resize")return S==window.orientation?null:(S=window.orientation,r.type="orientationchange",e.call(this,r));"rotation"in r||(r.rotation=0,r.scale=1);var u=r.changedTouches[0];for(var a in u)delete r[a],r[a]=u[a]}return e.call(this,r)}};return i}),pen.define("dojo/Evented",["./aspect","./on"],function(e,t){function r(){}var n=e.after;return r.prototype={on:function(e,r){return t.parse(this,e,r,function(e,t){return n(e,"on"+t,r,!0)})},emit:function(e,n){var r=[this];return r.push.apply(r,arguments),t.emit.apply(t,r)}},r}),pen.define("dojo/topic",["./Evented"],function(e){var t=new e;return{publish:function(e,n){return t.emit.apply(t,arguments)},subscribe:function(e,n){return t.on.apply(t,arguments)}}}),pen.define("dojo/_base/window",["./kernel","./lang","../sniff"],function(e,t,n){var r={global:e.global,doc:this.document||null,body:function(t){return t=t||e.doc,t.body||t.getElementsByTagName("body")[0]},setContext:function(t,n){e.global=r.global=t,e.doc=r.doc=n},withGlobal:function(t,n,i,s){var o=e.global;try{return e.global=r.global=t,r.withDoc.call(null,t.document,n,i,s)}finally{e.global=r.global=o}},withDoc:function(t,i,s,o){var u=r.doc,a=n("quirks"),f=n("ie"),l,c,h;try{return e.doc=r.doc=t,e.isQuirks=n.add("quirks",e.doc.compatMode=="BackCompat",!0,!0),n("ie")&&(h=t.parentWindow)&&h.navigator&&(l=parseFloat(h.navigator.appVersion.split("MSIE ")[1])||undefined,c=t.documentMode,c&&c!=5&&Math.floor(l)!=c&&(l=c),e.isIE=n.add("ie",l,!0,!0)),s&&typeof i=="string"&&(i=s[i]),i.apply(s,o||[])}finally{e.doc=r.doc=u,e.isQuirks=n.add("quirks",a,!0,!0),e.isIE=n.add("ie",f,!0,!0)}}};return n("extend-dojo")&&t.mixin(e,r),r}),pen.define("dojo/dom",["./sniff","./_base/window"],function(e,t){if(e("ie")<=7)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(n){}var r={};e("ie")?r.byId=function(e,n){if(typeof e!="string")return e;var r=n||t.doc,i=e&&r.getElementById(e);if(!(!i||i.attributes.id.value!=e&&i.id!=e))return i;var s=r.all[e];if(!s||s.nodeName)s=[s];var o=0;while(i=s[o++])if(i.attributes&&i.attributes.id&&i.attributes.id.value==e||i.id==e)return i}:r.byId=function(e,n){return(typeof e=="string"?(n||t.doc).getElementById(e):e)||null},r.isDescendant=function(e,t){try{e=r.byId(e),t=r.byId(t);while(e){if(e==t)return!0;e=e.parentNode}}catch(n){}return!1},e.add("css-user-select",function(e,t,n){if(!n)return!1;var r=n.style,i=["Khtml","O","ms","Moz","Webkit"],s=i.length,o="userSelect",u;do if(typeof r[o]!="undefined")return o;while(s--&&(o=i[s]+"UserSelect"));return!1});var i=e("css-user-select");return r.setSelectable=i?function(e,t){r.byId(e).style[i]=t?"":"none"}:function(e,t){e=r.byId(e);var n=e.getElementsByTagName("*"),i=n.length;if(t){e.removeAttribute("unselectable");while(i--)n[i].removeAttribute("unselectable")}else{e.setAttribute("unselectable","on");while(i--)n[i].setAttribute("unselectable","on")}},r}),pen.define("dojo/dom-style",["./sniff","./dom"],function(e,t){function c(t,n,r){n=n.toLowerCase();if(e("ie")){if(r=="auto"){if(n=="height")return t.offsetHeight;if(n=="width")return t.offsetWidth}if(n=="fontweight")switch(r){case 700:return"bold";case 400:default:return"normal"}}return n in f||(f[n]=l.test(n)),f[n]?i(t,r):r}var n,r={};e("webkit")?n=function(e){var t;if(e.nodeType==1){var n=e.ownerDocument.defaultView;t=n.getComputedStyle(e,null),!t&&e.style&&(e.style.display="",t=n.getComputedStyle(e,null))}return t||{}}:e("ie")&&(e("ie")<9||e("quirks"))?n=function(e){return e.nodeType==1&&e.currentStyle?e.currentStyle:{}}:n=function(e){return e.nodeType==1?e.ownerDocument.defaultView.getComputedStyle(e,null):{}},r.getComputedStyle=n;var i;e("ie")?i=function(e,t){if(!t)return 0;if(t=="medium")return 4;if(t.slice&&t.slice(-2)=="px")return parseFloat(t);var n=e.style,r=e.runtimeStyle,i=e.currentStyle,s=n.left,o=r.left;r.left=i.left;try{n.left=t,t=n.pixelLeft}catch(u){t=0}return n.left=s,r.left=o,t}:i=function(e,t){return parseFloat(t)||0},r.toPixelValue=i;var s="DXImageTransform.Microsoft.Alpha",o=function(e,t){try{return e.filters.item(s)}catch(n){return t?{}:null}},u=e("ie")<9||e("ie")<10&&e("quirks")?function(e){try{return o(e).Opacity/100}catch(t){return 1}}:function(e){return n(e).opacity},a=e("ie")<9||e("ie")<10&&e("quirks")?function(e,t){t===""&&(t=1);var n=t*100,r=t===1;r?(e.style.zoom="",o(e)&&(e.style.filter=e.style.filter.replace(new RegExp("\\s*progid:"+s+"\\([^\\)]+?\\)","i"),""))):(e.style.zoom=1,o(e)?o(e,1).Opacity=n:e.style.filter+=" progid:"+s+"(Opacity="+n+")",o(e,1).Enabled=!0);if(e.tagName.toLowerCase()=="tr")for(var i=e.firstChild;i;i=i.nextSibling)i.tagName.toLowerCase()=="td"&&a(i,t);return t}:function(e,t){return e.style.opacity=t},f={left:!0,top:!0},l=/margin|padding|width|height|max|min|offset/,h={cssFloat:1,styleFloat:1,"float":1};return r.get=function(n,i){var s=t.byId(n),o=arguments.length,a=i=="opacity";if(o==2&&a)return u(s);i=h[i]?"cssFloat"in s.style?"cssFloat":"styleFloat":i;var f=r.getComputedStyle(s);return o==1?f:c(s,i,f[i]||s.style[i])},r.set=function(n,i,s){var o=t.byId(n),u=arguments.length,f=i=="opacity";i=h[i]?"cssFloat"in o.style?"cssFloat":"styleFloat":i;if(u==3)return f?a(o,s):o.style[i]=s;for(var l in i)r.set(n,l,i[l]);return r.getComputedStyle(o)},r}),pen.define("dojo/dom-geometry",["./sniff","./_base/window","./dom","./dom-style"],function(e,t,n,r){function o(e,t,n,r,i,s){s=s||"px";var o=e.style;isNaN(t)||(o.left=t+s),isNaN(n)||(o.top=n+s),r>=0&&(o.width=r+s),i>=0&&(o.height=i+s)}function u(e){return e.tagName.toLowerCase()=="button"||e.tagName.toLowerCase()=="input"&&(e.getAttribute("type")||"").toLowerCase()=="button"}function a(e){return i.boxModel=="border-box"||e.tagName.toLowerCase()=="table"||u(e)}var i={};i.boxModel="content-box",e("ie")&&(i.boxModel=document.compatMode=="BackCompat"?"border-box":"content-box"),i.getPadExtents=function(t,i){t=n.byId(t);var s=i||r.getComputedStyle(t),o=r.toPixelValue,u=o(t,s.paddingLeft),a=o(t,s.paddingTop),f=o(t,s.paddingRight),l=o(t,s.paddingBottom);return{l:u,t:a,r:f,b:l,w:u+f,h:a+l}};var s="none";i.getBorderExtents=function(t,i){t=n.byId(t);var o=r.toPixelValue,u=i||r.getComputedStyle(t),a=u.borderLeftStyle!=s?o(t,u.borderLeftWidth):0,f=u.borderTopStyle!=s?o(t,u.borderTopWidth):0,l=u.borderRightStyle!=s?o(t,u.borderRightWidth):0,c=u.borderBottomStyle!=s?o(t,u.borderBottomWidth):0;return{l:a,t:f,r:l,b:c,w:a+l,h:f+c}},i.getPadBorderExtents=function(t,s){t=n.byId(t);var o=s||r.getComputedStyle(t),u=i.getPadExtents(t,o),a=i.getBorderExtents(t,o);return{l:u.l+a.l,t:u.t+a.t,r:u.r+a.r,b:u.b+a.b,w:u.w+a.w,h:u.h+a.h}},i.getMarginExtents=function(t,i){t=n.byId(t);var s=i||r.getComputedStyle(t),o=r.toPixelValue,u=o(t,s.marginLeft),a=o(t,s.marginTop),f=o(t,s.marginRight),l=o(t,s.marginBottom);return{l:u,t:a,r:f,b:l,w:u+f,h:a+l}},i.getMarginBox=function(o,u){o=n.byId(o);var a=u||r.getComputedStyle(o),f=i.getMarginExtents(o,a),l=o.offsetLeft-f.l,c=o.offsetTop-f.t,h=o.parentNode,p=r.toPixelValue,d;if(e("mozilla")){var v=parseFloat(a.left),m=parseFloat(a.top);!isNaN(v)&&!isNaN(m)?(l=v,c=m):h&&h.style&&(d=r.getComputedStyle(h),d.overflow!="visible"&&(l+=d.borderLeftStyle!=s?p(o,d.borderLeftWidth):0,c+=d.borderTopStyle!=s?p(o,d.borderTopWidth):0))}else(e("opera")||e("ie")==8&&!e("quirks"))&&h&&(d=r.getComputedStyle(h),l-=d.borderLeftStyle!=s?p(o,d.borderLeftWidth):0,c-=d.borderTopStyle!=s?p(o,d.borderTopWidth):0);return{l:l,t:c,w:o.offsetWidth+f.w,h:o.offsetHeight+f.h}},i.getContentBox=function(s,o){s=n.byId(s);var u=o||r.getComputedStyle(s),a=s.clientWidth,f,l=i.getPadExtents(s,u),c=i.getBorderExtents(s,u);return a?(f=s.clientHeight,c.w=c.h=0):(a=s.offsetWidth,f=s.offsetHeight),e("opera")&&(l.l+=c.l,l.t+=c.t),{l:l.l,t:l.t,w:a-l.w-c.w,h:f-l.h-c.h}},i.setContentSize=function(t,r,s){t=n.byId(t);var u=r.w,f=r.h;if(a(t)){var l=i.getPadBorderExtents(t,s);u>=0&&(u+=l.w),f>=0&&(f+=l.h)}o(t,NaN,NaN,u,f)};var f={l:0,t:0,w:0,h:0};return i.setMarginBox=function(s,l,c){s=n.byId(s);var h=c||r.getComputedStyle(s),p=l.w,d=l.h,v=a(s)?f:i.getPadBorderExtents(s,h),m=i.getMarginExtents(s,h);if(e("webkit")&&u(s)){var g=s.style;p>=0&&!g.width&&(g.width="4px"),d>=0&&!g.height&&(g.height="4px")}p>=0&&(p=Math.max(p-v.w-m.w,0)),d>=0&&(d=Math.max(d-v.h-m.h,0)),o(s,l.l,l.t,p,d)},i.isBodyLtr=function(n){return n=n||t.doc,(t.body(n).dir||n.documentElement.dir||"ltr").toLowerCase()=="ltr"},i.docScroll=function(r){r=r||t.doc;var s=t.doc.parentWindow||t.doc.defaultView;return"pageXOffset"in s?{x:s.pageXOffset,y:s.pageYOffset}:(s=e("quirks")?t.body(r):r.documentElement)&&{x:i.fixIeBiDiScrollLeft(s.scrollLeft||0,r),y:s.scrollTop||0}},e("ie")&&(i.getIeDocumentElementOffset=function(r){r=r||t.doc;var i=r.documentElement;if(e("ie")<8){var s=i.getBoundingClientRect(),o=s.left,u=s.top;return e("ie")<7&&(o+=i.clientLeft,u+=i.clientTop),{x:o<0?0:o,y:u<0?0:u}}return{x:0,y:0}}),i.fixIeBiDiScrollLeft=function(r,s){s=s||t.doc;var o=e("ie");if(o&&!i.isBodyLtr(s)){var u=e("quirks"),a=u?t.body(s):s.documentElement,f=t.global;return o==6&&!u&&f.frameElement&&a.scrollHeight>a.clientHeight&&(r+=a.clientLeft),o<8||u?r+a.clientWidth-a.scrollWidth:-r}return r},i.position=function(r,s){r=n.byId(r);var o=t.body(r.ownerDocument),u=r.getBoundingClientRect();u={x:u.left,y:u.top,w:u.right-u.left,h:u.bottom-u.top};if(e("ie")<9){var a=i.getIeDocumentElementOffset(r.ownerDocument);u.x-=a.x+(e("quirks")?o.clientLeft+o.offsetLeft:0),u.y-=a.y+(e("quirks")?o.clientTop+o.offsetTop:0)}if(s){var f=i.docScroll(r.ownerDocument);u.x+=f.x,u.y+=f.y}return u},i.getMarginSize=function(t,s){t=n.byId(t);var o=i.getMarginExtents(t,s||r.getComputedStyle(t)),u=t.getBoundingClientRect();return{w:u.right-u.left+o.w,h:u.bottom-u.top+o.h}},i.normalizeEvent=function(t){"layerX"in t||(t.layerX=t.offsetX,t.layerY=t.offsetY);if(!e("dom-addeventlistener")){var n=t.target,r=n&&n.ownerDocument||document,s=e("quirks")?r.body:r.documentElement,o=i.getIeDocumentElementOffset(r);t.pageX=t.clientX+i.fixIeBiDiScrollLeft(s.scrollLeft||0,r)-o.x,t.pageY=t.clientY+(s.scrollTop||0)-o.y}},i}),pen.define("dojo/_base/event",["./kernel","../on","../has","../dom-geometry"],function(e,t,n,r){if(t._fixEvent){var i=t._fixEvent;t._fixEvent=function(e,t){return e=i(e,t),e&&r.normalizeEvent(e),e}}var s={fix:function(e,n){return t._fixEvent?t._fixEvent(e,n):e},stop:function(e){n("dom-addeventlistener")||e&&e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e=e||window.event,e.cancelBubble=!0,t._preventDefault.call(e))}};return n("extend-dojo")&&(e.fixEvent=s.fix,e.stopEvent=s.stop),s}),pen.define("dojo/mouse",["./_base/kernel","./on","./has","./dom","./_base/window"],function(e,t,n,r,i){function o(e,n){var i=function(i,s){return t(i,e,function(e){if(n)return n(e,s);if(!r.isDescendant(e.relatedTarget,i))return s.call(this,e)})};return i.bubble=function(t){return o(e,function(e,n){var r=t(e.target),i=e.relatedTarget;if(r&&r!=(i&&i.nodeType==1&&t(i)))return n.call(r,e)})},i}n.add("dom-quirks",i.doc&&i.doc.compatMode=="BackCompat"),n.add("events-mouseenter",i.doc&&"onmouseenter"in i.doc.createElement("div")),n.add("events-mousewheel",i.doc&&"onmousewheel"in i.doc);var s;n("dom-quirks")&&n("ie")||!n("dom-addeventlistener")?s={LEFT:1,MIDDLE:4,RIGHT:2,isButton:function(e,t){return e.button&t},isLeft:function(e){return e.button&1},isMiddle:function(e){return e.button&4},isRight:function(e){return e.button&2}}:s={LEFT:0,MIDDLE:1,RIGHT:2,isButton:function(e,t){return e.button==t},isLeft:function(e){return e.button==0},isMiddle:function(e){return e.button==1},isRight:function(e){return e.button==2}},e.mouseButtons=s;var u;return n("events-mousewheel")?u="mousewheel":u=function(e,n){return t(e,"DOMMouseScroll",function(e){e.wheelDelta=-e.detail,n.call(this,e)})},{_eventHandler:o,enter:o("mouseover"),leave:o("mouseout"),wheel:u,isLeft:s.isLeft,isMiddle:s.isMiddle,isRight:s.isRight}}),pen.define("dojo/_base/sniff",["./kernel","./lang","../sniff"],function(e,t,n){return n("host-browser")?(e._name="browser",t.mixin(e,{isBrowser:!0,isFF:n("ff"),isIE:n("ie"),isKhtml:n("khtml"),isWebKit:n("webkit"),isMozilla:n("mozilla"),isMoz:n("mozilla"),isOpera:n("opera"),isSafari:n("safari"),isChrome:n("chrome"),isMac:n("mac"),isIos:n("ios"),isAndroid:n("android"),isWii:n("wii"),isQuirks:n("quirks"),isAir:n("air")}),n):n}),pen.define("dojo/keys",["./_base/kernel","./sniff"],function(e,t){return e.keys={BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,META:t("webkit")?91:224,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,HELP:47,LEFT_WINDOW:91,RIGHT_WINDOW:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_PLUS:107,NUMPAD_ENTER:108,NUMPAD_MINUS:109,NUMPAD_PERIOD:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,NUM_LOCK:144,SCROLL_LOCK:145,UP_DPAD:175,DOWN_DPAD:176,LEFT_DPAD:177,RIGHT_DPAD:178,copyKey:t("mac")&&!t("air")?t("safari")?91:224:17}}),pen.define("dojo/_base/connect",["./kernel","../on","../topic","../aspect","./event","../mouse","./sniff","./lang","../keys"],function(e,t,n,r,i,s,o,u){function a(n,i,o,a,f){a=u.hitch(o,a);if(!n||!n.addEventListener&&!n.attachEvent)return r.after(n||e.global,i,a,!0);typeof i=="string"&&i.substring(0,2)=="on"&&(i=i.substring(2)),n||(n=e.global);if(!f)switch(i){case"keypress":i=p;break;case"mouseenter":i=s.enter;break;case"mouseleave":i=s.leave}return t(n,i,a,f)}function h(e){e.keyChar=e.charCode?String.fromCharCode(e.charCode):"",e.charOrCode=e.keyChar||e.keyCode}o.add("events-keypress-typed",function(){var e={charCode:0};try{e=document.createEvent("KeyboardEvent"),(e.initKeyboardEvent||e.initKeyEvent).call(e,"keypress",!0,!0,null,!1,!1,!1,!1,9,3)}catch(t){}return e.charCode==0&&!o("opera")});var f={106:42,111:47,186:59,187:43,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39,229:113},l=o("mac")?"metaKey":"ctrlKey",c=function(e,t){var n=u.mixin({},e,t);return h(n),n.preventDefault=function(){e.preventDefault()},n.stopPropagation=function(){e.stopPropagation()},n},p;if(o("events-keypress-typed")){var d=function(e,t){try{return e.keyCode=t}catch(e){return 0}};p=function(e,n){var r=t(e,"keydown",function(e){var t=e.keyCode,r=t!=13&&t!=32&&(t!=27||!o("ie"))&&(t<48||t>90)&&(t<96||t>111)&&(t<186||t>192)&&(t<219||t>222)&&t!=229;if(r||e.ctrlKey){var i=r?0:t;if(e.ctrlKey){if(t==3||t==13)return n.call(e.currentTarget,e);i>95&&i<106?i-=48:!e.shiftKey&&i>=65&&i<=90?i+=32:i=f[i]||i}var s=c(e,{type:"keypress",faux:!0,charCode:i});n.call(e.currentTarget,s),o("ie")&&d(e,s.keyCode)}}),i=t(e,"keypress",function(e){var t=e.charCode;return t=t>=32?t:0,e=c(e,{charCode:t,faux:!0}),n.call(this,e)});return{remove:function(){r.remove(),i.remove()}}}}else o("opera")?p=function(e,n){return t(e,"keypress",function(e){var t=e.which;return t==3&&(t=99),t=t<32&&!e.shiftKey?0:t,e.ctrlKey&&!e.shiftKey&&t>=65&&t<=90&&(t+=32),n.call(this,c(e,{charCode:t}))})}:p=function(e,n){return t(e,"keypress",function(e){return h(e),n.call(this,e)})};var v={_keypress:p,connect:function(e,t,n,r,i){var s=arguments,o=[],u=0;o.push(typeof s[0]=="string"?null:s[u++],s[u++]);var f=s[u+1];o.push(typeof f=="string"||typeof f=="function"?s[u++]:null,s[u++]);for(var l=s.length;u<l;u++)o.push(s[u]);return a.apply(this,o)},disconnect:function(e){e&&e.remove()},subscribe:function(e,t,r){return n.subscribe(e,u.hitch(t,r))},publish:function(e,t){return n.publish.apply(n,[e].concat(t))},connectPublisher:function(e,t,n){var r=function(){v.publish(e,arguments)};return n?v.connect(t,n,r):v.connect(t,r)},isCopyKey:function(e){return e[l]}};return v.unsubscribe=v.disconnect,o("extend-dojo")&&u.mixin(e,v),v}),pen.define("dojo/dom-construct",["exports","./_base/kernel","./sniff","./_base/window","./dom","./dom-attr"],function(e,t,n,r,i,s){function d(e,t){var n=t.parentNode;n&&n.insertBefore(e,t)}function v(e,t){var n=t.parentNode;n&&(n.lastChild==t?n.appendChild(e):n.insertBefore(e,t.nextSibling))}function g(e){if(e.canHaveChildren)try{e.innerHTML="";return}catch(t){}for(var n;n=e.lastChild;)y(n,e)}function y(e,t){e.firstChild&&g(e),t&&(n("ie")&&t.canHaveChildren&&"removeNode"in e?e.removeNode(!1):t.removeChild(e))}var o={option:["select"],tbody:["table"],thead:["table"],tfoot:["table"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","thead","tr"],legend:["fieldset"],caption:["table"],colgroup:["table"],col:["table","colgroup"],li:["ul"]},u=/<\s*([\w\:]+)/,a={},f=0,l="__"+t._scopeName+"ToDomId";for(var c in o)if(o.hasOwnProperty(c)){var h=o[c];h.pre=c=="option"?'<select multiple="multiple">':"<"+h.join("><")+">",h.post="</"+h.reverse().join("></")+">"}var p;n("ie")<=8&&(p=function(e){e.__dojo_html5_tested="yes";var t=m("div",{innerHTML:"<nav>a</nav>",style:{visibility:"hidden"}},e.body);t.childNodes.length!==1&&"abbr article aside audio canvas details figcaption figure footer header hgroup mark meter nav output progress section summary time video".replace(/\b\w+\b/g,function(t){e.createElement(t)}),b(t)}),e.toDom=function(t,i){i=i||r.doc;var s=i[l];s||(i[l]=s=++f+"",a[s]=i.createElement("div")),n("ie")<=8&&!i.__dojo_html5_tested&&i.body&&p(i),t+="";var c=t.match(u),h=c?c[1].toLowerCase():"",d=a[s],v,m,g,y;if(c&&o[h]){v=o[h],d.innerHTML=v.pre+t+v.post;for(m=v.length;m;--m)d=d.firstChild}else d.innerHTML=t;if(d.childNodes.length==1)return d.removeChild(d.firstChild);y=i.createDocumentFragment();while(g=d.firstChild)y.appendChild(g);return y},e.place=function(n,r,s){r=i.byId(r),typeof n=="string"&&(n=/^\s*</.test(n)?e.toDom(n,r.ownerDocument):i.byId(n));if(typeof s=="number"){var o=r.childNodes;!o.length||o.length<=s?r.appendChild(n):d(n,o[s<0?0:s])}else switch(s){case"before":d(n,r);break;case"after":v(n,r);break;case"replace":r.parentNode.replaceChild(n,r);break;case"only":e.empty(r),r.appendChild(n);break;case"first":if(r.firstChild){d(n,r.firstChild);break};default:r.appendChild(n)}return n};var m=e.create=function(n,o,u,a){var f=r.doc;return u&&(u=i.byId(u),f=u.ownerDocument),typeof n=="string"&&(n=f.createElement(n)),o&&s.set(n,o),u&&e.place(n,u,a),n};e.empty=function(t){g(i.byId(t))};var b=e.destroy=function(t){t=i.byId(t);if(!t)return;y(t,t.parentNode)}}),pen.define("dojo/dom-prop",["exports","./_base/kernel","./sniff","./_base/lang","./dom","./dom-style","./dom-construct","./_base/connect"],function(e,t,n,r,i,s,o,u){var a={},f=0,l=t._scopeName+"attrid";e.names={"class":"className","for":"htmlFor",tabindex:"tabIndex",readonly:"readOnly",colspan:"colSpan",frameborder:"frameBorder",rowspan:"rowSpan",valuetype:"valueType"},e.get=function(n,r){n=i.byId(n);var s=r.toLowerCase(),o=e.names[s]||r;return n[o]},e.set=function(c,h,p){c=i.byId(c);var d=arguments.length;if(d==2&&typeof h!="string"){for(var v in h)e.set(c,v,h[v]);return c}var m=h.toLowerCase(),g=e.names[m]||h;if(g=="style"&&typeof p!="string")return s.set(c,p),c;if(g=="innerHTML")return n("ie")&&c.tagName.toLowerCase()in{col:1,colgroup:1,table:1,tbody:1,tfoot:1,thead:1,tr:1,title:1}?(o.empty(c),c.appendChild(o.toDom(p,c.ownerDocument))):c[g]=p,c;if(r.isFunction(p)){var y=c[l];y||(y=f++,c[l]=y),a[y]||(a[y]={});var b=a[y][g];if(b)u.disconnect(b);else try{delete c[g]}catch(w){}return p?a[y][g]=u.connect(c,g,p):c[g]=null,c}return c[g]=p,c}}),pen.define("dojo/dom-attr",["exports","./sniff","./_base/lang","./dom","./dom-style","./dom-prop"],function(e,t,n,r,i,s){function a(e,t){var n=e.getAttributeNode&&e.getAttributeNode(t);return n&&n.specified}var o={innerHTML:1,className:1,htmlFor:t("ie"),value:1},u={classname:"class",htmlfor:"for",tabindex:"tabIndex",readonly:"readOnly"};e.has=function(t,n){var i=n.toLowerCase();return o[s.names[i]||n]||a(r.byId(t),u[i]||n)},e.get=function(t,i){t=r.byId(t);var f=i.toLowerCase(),l=s.names[f]||i,c=o[l],h=t[l];if(c&&typeof h!="undefined")return h;if(l=="href"||typeof h!="boolean"&&!n.isFunction(h)){var p=u[f]||i;return a(t,p)?t.getAttribute(p):null}return h},e.set=function(a,f,l){a=r.byId(a);if(arguments.length==2){for(var c in f)e.set(a,c,f[c]);return a}var h=f.toLowerCase(),p=s.names[h]||f,d=o[p];return p=="style"&&typeof l!="string"?(i.set(a,l),a):d||typeof l=="boolean"||n.isFunction(l)?s.set(a,f,l):(a.setAttribute(u[h]||f,l),a)},e.remove=function(t,n){r.byId(t).removeAttribute(u[n.toLowerCase()]||n)},e.getNodeProp=function(t,n){t=r.byId(t);var i=n.toLowerCase(),o=s.names[i]||n;if(o in t&&o!="href")return t[o];var f=u[i]||n;return a(t,f)?t.getAttribute(f):null}}),pen.define("dojo/dom-class",["./_base/lang","./_base/array","./dom"],function(e,t,n){function u(e){if(typeof e=="string"||e instanceof String){if(e&&!s.test(e))return o[0]=e,o;var n=e.split(s);return n.length&&!n[0]&&n.shift(),n.length&&!n[n.length-1]&&n.pop(),n}return e?t.filter(e,function(e){return e}):[]}var r="className",i,s=/\s+/,o=[""],a={};return i={contains:function(t,i){return(" "+n.byId(t)[r]+" ").indexOf(" "+i+" ")>=0},add:function(t,i){t=n.byId(t),i=u(i);var s=t[r],o;s=s?" "+s+" ":" ",o=s.length;for(var a=0,f=i.length,l;a<f;++a)l=i[a],l&&s.indexOf(" "+l+" ")<0&&(s+=l+" ");o<s.length&&(t[r]=s.substr(1,s.length-2))},remove:function(i,s){i=n.byId(i);var o;if(s!==undefined){s=u(s),o=" "+i[r]+" ";for(var a=0,f=s.length;a<f;++a)o=o.replace(" "+s[a]+" "," ");o=e.trim(o)}else o="";i[r]!=o&&(i[r]=o)},replace:function(t,s,o){t=n.byId(t),a[r]=t[r],i.remove(a,o),i.add(a,s),t[r]!==a[r]&&(t[r]=a[r])},toggle:function(t,r,s){t=n.byId(t);if(s===undefined){r=u(r);for(var o=0,a=r.length,f;o<a;++o)f=r[o],i[i.contains(t,f)?"remove":"add"](t,f)}else i[s?"add":"remove"](t,r);return s}},i}),pen.define("dojo/ready",["./_base/kernel","./has","require","./has!host-browser?./domReady","./_base/lang"],function(e,t,n,r,i){var s=0,o=[],u=0,a=function(){s=1,e._postLoad=e.config.afterOnLoad=!0,f()},f=function(){if(u)return;u=1;while(s&&(!r||r._Q.length==0)&&(n.idle?n.idle():!0)&&o.length){var e=o.shift();try{e()}catch(t){t.info=t.message;if(!n.signal)throw t;n.signal("error",t)}}u=0};n.on&&n.on("idle",f),r&&(r._onQEmpty=f);var l=e.ready=e.addOnLoad=function(t,n,r){var s=i._toArray(arguments);typeof t!="number"?(r=n,n=t,t=1e3):s.shift(),r=r?i.hitch.apply(e,s):function(){n()},r.priority=t;for(var u=0;u<o.length&&t>=o[u].priority;u++);o.splice(u,0,r),f()};t.add("dojo-config-addOnLoad",1);if(t("dojo-config-addOnLoad")){var c=e.config.addOnLoad;c&&l[i.isArray(c)?"apply":"call"](e,c)}return t("dojo-sync-loader")&&e.config.parseOnLoad&&!e.isAsync&&l(99,function(){e.parser||(e.deprecated("Add explicit require(['dojo/parser']);","","2.0"),pen.require(["dojo/parser"]))}),r?r(a):a(),l}),pen.define("dojo/errors/create",["../_base/lang"],function(e){return function(t,n,r,i){r=r||Error;var s=function(e){if(r===Error){Error.captureStackTrace&&Error.captureStackTrace(this,s);var t=Error.call(this,e),i;for(i in t)t.hasOwnProperty(i)&&(this[i]=t[i]);this.message=e,this.stack=t.stack}else r.apply(this,arguments);n&&n.apply(this,arguments)};return s.prototype=e.delegate(r.prototype,i),s.prototype.name=t,s.prototype.constructor=s,s}}),pen.define("dojo/errors/CancelError",["./create"],function(e){return e("CancelError",null,null,{dojoType:"cancel"})}),pen.define("dojo/promise/Promise",["../_base/lang"],function(e){function t(){throw new TypeError("abstract")}return e.extend(function(){},{then:function(e,n,r){t()},cancel:function(e,n){t()},isResolved:function(){t()},isRejected:function(){t()},isFulfilled:function(){t()},isCanceled:function(){t()},always:function(e){return this.then(e,e)},otherwise:function(e){return this.then(null,e)},trace:function(){return this},traceRejected:function(){return this},toString:function(){return"[object Promise]"}})}),pen.define("dojo/Deferred",["./has","./_base/lang","./errors/CancelError","./promise/Promise","./has!config-deferredInstrumentation?./promise/instrumentation"],function(e,t,n,r,i){var s=0,o=1,u=2,a="This deferred has already been fulfilled.",f=Object.freeze||function(){},l=function(t,n,r,i,s){e("config-deferredInstrumentation")&&n===u&&d.instrumentRejected&&t.length===0&&d.instrumentRejected(r,!1,i,s);for(var o=0;o<t.length;o++)c(t[o],n,r,i)},c=function(t,n,r,i){var a=t[n],f=t.deferred;if(a)try{var l=a(r);if(n===s)typeof l!="undefined"&&p(f,n,l);else{if(l&&typeof l.then=="function"){t.cancel=l.cancel,l.then(h(f,o),h(f,u),h(f,s));return}p(f,o,l)}}catch(c){p(f,u,c)}else p(f,n,r);e("config-deferredInstrumentation")&&n===u&&d.instrumentRejected&&d.instrumentRejected(r,!!a,i,f.promise)},h=function(e,t){return function(n){p(e,t,n)}},p=function(e,t,n){if(!e.isCanceled())switch(t){case s:e.progress(n);break;case o:e.resolve(n);break;case u:e.reject(n)}},d=function(t){var i=this.promise=new r,h=this,p,v,m,g=!1,y=[];e("config-deferredInstrumentation")&&Error.captureStackTrace&&(Error.captureStackTrace(h,d),Error.captureStackTrace(i,d)),this.isResolved=i.isResolved=function(){return p===o},this.isRejected=i.isRejected=function(){return p===u},this.isFulfilled=i.isFulfilled=function(){return!!p},this.isCanceled=i.isCanceled=function(){return g},this.progress=function(e,t){if(!p)return l(y,s,e,null,h),i;if(t===!0)throw new Error(a);return i},this.resolve=function(e,t){if(!p)return l(y,p=o,v=e,null,h),y=null,i;if(t===!0)throw new Error(a);return i};var b=this.reject=function(t,n){if(!p)return e("config-deferredInstrumentation")&&Error.captureStackTrace&&Error.captureStackTrace(m={},b),l(y,p=u,v=t,m,h),y=null,i;if(n===!0)throw new Error(a);return i};this.then=i.then=function(e,t,n){var r=[n,e,t];return r.cancel=i.cancel,r.deferred=new d(function(e){return r.cancel&&r.cancel(e)}),p&&!y?c(r,p,v,m):y.push(r),r.deferred.promise},this.cancel=i.cancel=function(e,r){if(!p){if(t){var i=t(e);e=typeof i=="undefined"?e:i}g=!0;if(!p)return typeof e=="undefined"&&(e=new n),b(e),e;if(p===u&&v===e)return e}else if(r===!0)throw new Error(a)},f(i)};return d.prototype.toString=function(){return"[object Deferred]"},i&&i(d),d}),pen.define("dojo/when",["./Deferred","./promise/Promise"],function(e,t){return function(r,i,s,o){var u=r&&typeof r.then=="function",a=u&&r instanceof t;if(!u)return arguments.length>1?i?i(r):r:(new e).resolve(r);if(!a){var f=new e(r.cancel);r.then(f.resolve,f.reject,f.progress),r=f.promise}return i||s||o?r.then(i,s,o):r}}),pen.define("dojo/Stateful",["./_base/declare","./_base/lang","./_base/array","./when"],function(e,t,n,r){return e("dojo.Stateful",null,{_attrPairNames:{},_getAttrNames:function(e){var t=this._attrPairNames;return t[e]?t[e]:t[e]={s:"_"+e+"Setter",g:"_"+e+"Getter"}},postscript:function(e){e&&this.set(e)},_get:function(e,t){return typeof this[t.g]=="function"?this[t.g]():this[e]},get:function(e){return this._get(e,this._getAttrNames(e))},set:function(e,t){if(typeof e=="object"){for(var n in e)e.hasOwnProperty(n)&&n!="_watchCallbacks"&&this.set(n,e[n]);return this}var i=this._getAttrNames(e),s=this._get(e,i),o=this[i.s],u;typeof o=="function"?u=o.apply(this,Array.prototype.slice.call(arguments,1)):this[e]=t;if(this._watchCallbacks){var a=this;r(u,function(){a._watchCallbacks(e,s,t)})}return this},_changeAttrValue:function(e,t){var n=this.get(e);return this[e]=t,this._watchCallbacks&&this._watchCallbacks(e,n,t),this},watch:function(e,t){var r=this._watchCallbacks;if(!r){var i=this;r=this._watchCallbacks=function(e,t,n,s){var o=function(r){if(r){r=r.slice();for(var s=0,o=r.length;s<o;s++)r[s].call(i,e,t,n)}};o(r["_"+e]),s||o(r["*"])}}!t&&typeof e=="function"?(t=e,e="*"):e="_"+e;var s=r[e];typeof s!="object"&&(s=r[e]=[]),s.push(t);var o={};return o.unwatch=o.remove=function(){var e=n.indexOf(s,t);e>-1&&s.splice(e,1)},o}})}),pen.define("dijit/Destroyable",["dojo/_base/array","dojo/aspect","dojo/_base/declare"],function(e,t,n){return n("dijit.Destroyable",null,{destroy:function(e){this._destroyed=!0},own:function(){return e.forEach(arguments,function(e){var n="destroyRecursive"in e?"destroyRecursive":"destroy"in e?"destroy":"remove",r=t.before(this,"destroy",function(t){e[n](t)}),i=t.after(e,n,function(){r.remove(),i.remove()},!0)},this),arguments}})}),pen.define("dijit/main",["dojo/_base/kernel"],function(e){return e.dijit}),pen.define("dijit/registry",["dojo/_base/array","dojo/sniff","dojo/_base/window","./main"],function(e,t,n,r){var i={},s={},o={length:0,add:function(e){if(s[e.id])throw new Error("Tried to register widget with id=="+e.id+" but that id is already registered");s[e.id]=e,this.length++},remove:function(e){s[e]&&(delete s[e],this.length--)},byId:function(e){return typeof e=="string"?s[e]:e},byNode:function(e){return s[e.getAttribute("widgetId")]},toArray:function(){var e=[];for(var t in s)e.push(s[t]);return e},getUniqueId:function(e){var t;do t=e+"_"+(e in i?++i[e]:i[e]=0);while(s[t]);return r._scopeName=="dijit"?t:r._scopeName+"_"+t},findWidgets:function(e,t){function r(e){for(var i=e.firstChild;i;i=i.nextSibling)if(i.nodeType==1){var o=i.getAttribute("widgetId");if(o){var u=s[o];u&&n.push(u)}else i!==t&&r(i)}}var n=[];return r(e),n},_destroyAll:function(){r._curFocus=null,r._prevFocus=null,r._activeStack=[],e.forEach(o.findWidgets(n.body()),function(e){e._destroyed||(e.destroyRecursive?e.destroyRecursive():e.destroy&&e.destroy())})},getEnclosingWidget:function(e){while(e){var t=e.nodeType==1&&e.getAttribute("widgetId");if(t)return s[t];e=e.parentNode}return null},_hash:s};return r.registry=o,o}),pen.define("dijit/_WidgetBase",["require","dojo/_base/array","dojo/aspect","dojo/_base/config","dojo/_base/connect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/has","dojo/_base/kernel","dojo/_base/lang","dojo/on","dojo/ready","dojo/Stateful","dojo/topic","dojo/_base/window","./Destroyable","dojo/has!dojo-bidi?./_BidiMixin","./registry"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){function T(e){var t={};for(var n in e)t[n.toLowerCase()]=!0;return t}function N(e){return function(t){u[t?"set":"remove"](this.domNode,e,t),this._set(e,t)}}function C(e,t){return e===t||e!==e&&t!==t}h.add("dijit-legacy-requires",!p.isAsync),h.add("dojo-bidi",!1),h("dijit-legacy-requires")&&m(0,function(){var t=["dijit/_base/manager"];e(t)});var x={},k=s("dijit._WidgetBase",[g,w],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:N("lang"),dir:"",_setDirAttr:N("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},style:"",title:"",tooltip:"",baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(e){this._set("ownerDocument",e)},attributeMap:{},_blankGif:r.blankGif||e.toUrl("dojo/resources/blank.gif"),_introspect:function(){var e=this.constructor;if(!e._setterAttrs){var t=e.prototype,n=e._setterAttrs=[],r=e._onMap={};for(var i in t.attributeMap)n.push(i);for(i in t)/^on/.test(i)&&(r[i.substring(2).toLowerCase()]=i),/^_set[A-Z](.*)Attr$/.test(i)&&(i=i.charAt(4).toLowerCase()+i.substr(5,i.length-9),(!t.attributeMap||!(i in t.attributeMap))&&n.push(i))}},postscript:function(e,t){this.create(e,t)},create:function(e,t){this._introspect(),this.srcNodeRef=o.byId(t),this._connects=[],this._supportingWidgets=[],this.srcNodeRef&&typeof this.srcNodeRef.id=="string"&&(this.id=this.srcNodeRef.id),e&&(this.params=e,d.mixin(this,e)),this.postMixInProperties(),this.id||(this.id=S.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id),this.ownerDocument=this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:document),this.ownerDocumentBody=b.body(this.ownerDocument),S.add(this),this.buildRendering();var n;if(this.domNode){this._applyAttributes();var r=this.srcNodeRef;r&&r.parentNode&&this.domNode!==r&&(r.parentNode.replaceChild(this.domNode,r),n=!0),this.domNode.setAttribute("widgetId",this.id)}this.postCreate(),n&&delete this.srcNodeRef,this._created=!0},_applyAttributes:function(){var e={};for(var n in this.params||{})e[n]=this._get(n);t.forEach(this.constructor._setterAttrs,function(t){if(!(t in e)){var n=this._get(t);n&&this.set(t,n)}},this);for(n in e)this.set(n,e[n])},postMixInProperties:function(){},buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var e=this.baseClass.split(" ");this.isLeftToRight()||(e=e.concat(t.map(e,function(e){return e+"Rtl"}))),a.add(this.domNode,e)}},postCreate:function(){},startup:function(){if(this._started)return;this._started=!0,t.forEach(this.getChildren(),function(e){!e._started&&!e._destroyed&&d.isFunction(e.startup)&&(e.startup(),e._started=!0)})},destroyRecursive:function(e){this._beingDestroyed=!0,this.destroyDescendants(e),this.destroy(e)},destroy:function(e){function n(t){t.destroyRecursive?t.destroyRecursive(e):t.destroy&&t.destroy(e)}this._beingDestroyed=!0,this.uninitialize(),t.forEach(this._connects,d.hitch(this,"disconnect")),t.forEach(this._supportingWidgets,n),this.domNode&&t.forEach(S.findWidgets(this.domNode,this.containerNode),n),this.destroyRendering(e),S.remove(this.id),this._destroyed=!0},destroyRendering:function(e){this.bgIframe&&(this.bgIframe.destroy(e),delete this.bgIframe),this.domNode&&(e?u.remove(this.domNode,"widgetId"):f.destroy(this.domNode),delete this.domNode),this.srcNodeRef&&(e||f.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(e){t.forEach(this.getChildren(),function(t){t.destroyRecursive&&t.destroyRecursive(e)})},uninitialize:function(){return!1},_setStyleAttr:function(e){var t=this.domNode;d.isObject(e)?c.set(t,e):t.style.cssText?t.style.cssText+="; "+e:t.style.cssText=e,this._set("style",e)},_attrToDom:function(e,n,r){r=arguments.length>=3?r:this.attributeMap[e],t.forEach(d.isArray(r)?r:[r],function(t){var r=this[t.node||t||"domNode"],i=t.type||"attribute";switch(i){case"attribute":d.isFunction(n)&&(n=d.hitch(this,n));var s=t.attribute?t.attribute:/^on[A-Z][a-zA-Z]*$/.test(e)?e.toLowerCase():e;r.tagName?u.set(r,s,n):r.set(s,n);break;case"innerText":r.innerHTML="",r.appendChild(this.ownerDocument.createTextNode(n));break;case"innerHTML":r.innerHTML=n;break;case"class":a.replace(r,n,this[e])}},this)},get:function(e){var t=this._getAttrNames(e);return this[t.g]?this[t.g]():this._get(e)},set:function(e,t){if(typeof e=="object"){for(var n in e)this.set(n,e[n]);return this}var r=this._getAttrNames(e),i=this[r.s];if(d.isFunction(i))var s=i.apply(this,Array.prototype.slice.call(arguments,1));else{var o=this.focusNode&&!d.isFunction(this.focusNode)?"focusNode":"domNode",u=this[o]&&this[o].tagName,a=u&&(x[u]||(x[u]=T(this[o]))),f=e in this.attributeMap?this.attributeMap[e]:r.s in this?this[r.s]:a&&r.l in a&&typeof t!="function"||/^aria-|^data-|^role$/.test(e)?o:null;f!=null&&this._attrToDom(e,t,f),this._set(e,t)}return s||this},_attrPairNames:{},_getAttrNames:function(e){var t=this._attrPairNames;if(t[e])return t[e];var n=e.replace(/^[a-z]|-[a-zA-Z]/g,function(e){return e.charAt(e.length-1).toUpperCase()});return t[e]={n:e+"Node",s:"_set"+n+"Attr",g:"_get"+n+"Attr",l:n.toLowerCase()}},_set:function(e,t){var n=this[e];this[e]=t,this._created&&!C(n,t)&&(this._watchCallbacks&&this._watchCallbacks(e,n,t),this.emit("attrmodified-"+e,{detail:{prevValue:n,newValue:t}}))},_get:function(e){return this[e]},emit:function(e,t,n){t=t||{},t.bubbles===undefined&&(t.bubbles=!0),t.cancelable===undefined&&(t.cancelable=!0),t.detail||(t.detail={}),t.detail.widget=this;var r,i=this["on"+e];return i&&(r=i.apply(this,n?n:[t])),this._started&&!this._beingDestroyed&&v.emit(this.domNode,e.toLowerCase(),t),r},on:function(e,t){var r=this._onMap(e);return r?n.after(this,r,t,!0):this.own(v(this.domNode,e,t))[0]},_onMap:function(e){var t=this.constructor,n=t._onMap;if(!n){n=t._onMap={};for(var r in t.prototype)/^on/.test(r)&&(n[r.replace(/^on/,"").toLowerCase()]=r)}return n[typeof e=="string"&&e.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},getChildren:function(){return this.containerNode?S.findWidgets(this.containerNode):[]},getParent:function(){return S.getEnclosingWidget(this.domNode.parentNode)},connect:function(e,t,n){return this.own(i.connect(e,t,this,n))[0]},disconnect:function(e){e.remove()},subscribe:function(e,t){return this.own(y.subscribe(e,d.hitch(this,t)))[0]},unsubscribe:function(e){e.remove()},isLeftToRight:function(){return this.dir?this.dir=="ltr":l.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&c.get(this.domNode,"display")!="none"},placeAt:function(e,t){var n=!e.tagName&&S.byId(e);if(n&&n.addChild&&(!t||typeof t=="number"))n.addChild(this,t);else{var r=n?n.containerNode&&!/after|before|replace/.test(t||"")?n.containerNode:n.domNode:o.byId(e,this.ownerDocument);f.place(this.domNode,r,t),!this._started&&(this.getParent()||{})._started&&this.startup()}return this},defer:function(e,t){var n=setTimeout(d.hitch(this,function(){if(!n)return;n=null,this._destroyed||d.hitch(this,e)()}),t||0);return{remove:function(){return n&&(clearTimeout(n),n=null),null}}}});return h("dojo-bidi")&&k.extend(E),k}),pen.define("dojo/_base/url",["./kernel"],function(e){var t=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),n=new RegExp("^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$"),r=function(){var e=null,i=arguments,s=[i[0]];for(var o=1;o<i.length;o++){if(!i[o])continue;var u=new r(i[o]+""),a=new r(s[0]+"");if(u.path==""&&!u.scheme&&!u.authority&&!u.query)u.fragment!=e&&(a.fragment=u.fragment),u=a;else if(!u.scheme){u.scheme=a.scheme;if(!u.authority){u.authority=a.authority;if(u.path.charAt(0)!="/"){var f=a.path.substring(0,a.path.lastIndexOf("/")+1)+u.path,l=f.split("/");for(var c=0;c<l.length;c++)l[c]=="."?c==l.length-1?l[c]="":(l.splice(c,1),c--):c>0&&(c!=1||l[0]!="")&&l[c]==".."&&l[c-1]!=".."&&(c==l.length-1?(l.splice(c,1),l[c-1]=""):(l.splice(c-1,2),c-=2));u.path=l.join("/")}}}s=[],u.scheme&&s.push(u.scheme,":"),u.authority&&s.push("//",u.authority),s.push(u.path),u.query&&s.push("?",u.query),u.fragment&&s.push("#",u.fragment)}this.uri=s.join("");var h=this.uri.match(t);this.scheme=h[2]||(h[1]?"":e),this.authority=h[4]||(h[3]?"":e),this.path=h[5],this.query=h[7]||(h[6]?"":e),this.fragment=h[9]||(h[8]?"":e),this.authority!=e&&(h=this.authority.match(n),this.user=h[3]||e,this.password=h[4]||e,this.host=h[6]||h[7],this.port=h[9]||e)};return r.prototype.toString=function(){return this.uri},e._Url=r}),pen.define("dojo/promise/all",["../_base/array","../Deferred","../when"],function(e,t,n){var r=e.some;return function(i){var s,o;i instanceof Array?o=i:i&&typeof i=="object"&&(s=i);var u,a=[];if(s){o=[];for(var f in s)Object.hasOwnProperty.call(s,f)&&(a.push(f),o.push(s[f]));u={}}else o&&(u=[]);if(!o||!o.length)return(new t).resolve(u);var l=new t;l.promise.always(function(){u=a=null});var c=o.length;return r(o,function(e,t){return s||a.push(t),n(e,function(e){l.isFulfilled()||(u[a[t]]=e,--c===0&&l.resolve(u))},l.reject),l.isFulfilled()}),l.promise}}),pen.define("dojo/date/stamp",["../_base/lang","../_base/array"],function(e,t){var n={};return e.setObject("dojo.date.stamp",n),n.fromISOString=function(e,r){n._isoRegExp||(n._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var i=n._isoRegExp.exec(e),s=null;if(i){i.shift(),i[1]&&i[1]--,i[6]&&(i[6]*=1e3),r&&(r=new Date(r),t.forEach(t.map(["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],function(e){return r["get"+e]()}),function(e,t){i[t]=i[t]||e})),s=new Date(i[0]||1970,i[1]||0,i[2]||1,i[3]||0,i[4]||0,i[5]||0,i[6]||0),i[0]<100&&s.setFullYear(i[0]||1970);var o=0,u=i[7]&&i[7].charAt(0);u!="Z"&&(o=(i[8]||0)*60+(Number(i[9])||0),u!="-"&&(o*=-1)),u&&(o-=s.getTimezoneOffset()),o&&s.setTime(s.getTime()+o*6e4)}return s},n.toISOString=function(e,t){var n=function(e){return e<10?"0"+e:e};t=t||{};var r=[],i=t.zulu?"getUTC":"get",s="";if(t.selector!="time"){var o=e[i+"FullYear"]();s=["0000".substr((o+"").length)+o,n(e[i+"Month"]()+1),n(e[i+"Date"]())].join("-")}r.push(s);if(t.selector!="date"){var u=[n(e[i+"Hours"]()),n(e[i+"Minutes"]()),n(e[i+"Seconds"]())].join(":"),a=e[i+"Milliseconds"]();t.milliseconds&&(u+="."+(a<100?"0":"")+n(a));if(t.zulu)u+="Z";else if(t.selector!="time"){var f=e.getTimezoneOffset(),l=Math.abs(f);u+=(f>0?"-":"+")+n(Math.floor(l/60))+":"+n(l%60)}r.push(u)}return r.join("T")},n}),pen.define("dojo/parser",["require","./_base/kernel","./_base/lang","./_base/array","./_base/config","./dom","./_base/window","./_base/url","./aspect","./promise/all","./date/stamp","./Deferred","./has","./query","./on","./ready"],function(require,dojo,dlang,darray,config,dom,dwindow,_Url,aspect,all,dates,Deferred,has,query,don,ready){function myEval(text){return eval("("+text+")")}function getNameMap(e){var t=e._nameCaseMap,n=e.prototype;if(!t||t._extendCnt<extendCnt){t=e._nameCaseMap={};for(var r in n){if(r.charAt(0)==="_")continue;t[r.toLowerCase()]=r}t._extendCnt=extendCnt}return t}function getCtor(e,t){var n=e.join();if(!_ctorMap[n]){var r=[];for(var i=0,s=e.length;i<s;i++){var o=e[i];r[r.length]=_ctorMap[o]=_ctorMap[o]||dlang.getObject(o)||~o.indexOf("/")&&(t?t(o):require(o))}var u=r.shift();_ctorMap[n]=r.length?u.createSubclass?u.createSubclass(r):u.extend.apply(u,r):u}return _ctorMap[n]}new Date("X");var extendCnt=0;aspect.after(dlang,"extend",function(){extendCnt++},!0);var _ctorMap={},parser={_clearCache:function(){extendCnt++,_ctorMap={}},_functionFromScript:function(e,t){var n="",r="",i=e.getAttribute(t+"args")||e.getAttribute("args"),s=e.getAttribute("with"),o=(i||"").split(/\s*,\s*/);return s&&s.length&&darray.forEach(s.split(/\s*,\s*/),function(e){n+="with("+e+"){",r+="}"}),new Function(o,n+e.innerHTML+r)},instantiate:function(e,t,n){t=t||{},n=n||{};var r=(n.scope||dojo._scopeName)+"Type",i="data-"+(n.scope||dojo._scopeName)+"-",s=i+"type",o=i+"mixins",u=[];return darray.forEach(e,function(e){var n=r in t?t[r]:e.getAttribute(s)||e.getAttribute(r);if(n){var i=e.getAttribute(o),a=i?[n].concat(i.split(/\s*,\s*/)):[n];u.push({node:e,types:a})}}),this._instantiate(u,t,n)},_instantiate:function(e,t,n,r){function s(e){return!t._started&&!n.noStart&&darray.forEach(e,function(e){typeof e.startup=="function"&&!e._started&&e.startup()}),e}var i=darray.map(e,function(e){var r=e.ctor||getCtor(e.types,n.contextRequire);if(!r)throw new Error("Unable to resolve constructor for: '"+e.types.join()+"'");return this.construct(r,e.node,t,n,e.scripts,e.inherited)},this);return r?all(i).then(s):s(i)},construct:function(e,t,n,r,i,s){function q(e){g&&dlang.setObject(g,e);for(d=0;d<k.length;d++)aspect[k[d].advice||"after"](e,k[d].method,dlang.hitch(e,k[d].func),!0);for(d=0;d<L.length;d++)L[d].call(e);for(d=0;d<A.length;d++)e.watch(A[d].prop,A[d].func);for(d=0;d<O.length;d++)don(e,O[d].event,O[d].func);return e}var o=e&&e.prototype;r=r||{};var u={};r.defaults&&dlang.mixin(u,r.defaults),s&&dlang.mixin(u,s);var a;if(has("dom-attributes-explicit"))a=t.attributes;else if(has("dom-attributes-specified-flag"))a=darray.filter(t.attributes,function(e){return e.specified});else{var f=/^input$|^img$/i.test(t.nodeName)?t:t.cloneNode(!1),l=f.outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,"");a=darray.map(l.split(/\s+/),function(e){var n=e.toLowerCase();return{name:e,value:t.nodeName=="LI"&&e=="value"||n=="enctype"?t.getAttribute(n):t.getAttributeNode(n).value}})}var c=r.scope||dojo._scopeName,h="data-"+c+"-",p={};c!=="dojo"&&(p[h+"props"]="data-dojo-props",p[h+"type"]="data-dojo-type",p[h+"mixins"]="data-dojo-mixins",p[c+"type"]="dojoType",p[h+"id"]="data-dojo-id");var d=0,v,m=[],g,y;while(v=a[d++]){var b=v.name,w=b.toLowerCase(),E=v.value;switch(p[w]||w){case"data-dojo-type":case"dojotype":case"data-dojo-mixins":break;case"data-dojo-props":y=E;break;case"data-dojo-id":case"jsid":g=E;break;case"data-dojo-attach-point":case"dojoattachpoint":u.dojoAttachPoint=E;break;case"data-dojo-attach-event":case"dojoattachevent":u.dojoAttachEvent=E;break;case"class":u["class"]=t.className;break;case"style":u.style=t.style&&t.style.cssText;break;default:if(!(b in o)){var S=getNameMap(e);b=S[w]||b}if(b in o)switch(typeof o[b]){case"string":u[b]=E;break;case"number":u[b]=E.length?Number(E):NaN;break;case"boolean":u[b]=E.toLowerCase()!="false";break;case"function":E===""||E.search(/[^\w\.]+/i)!=-1?u[b]=new Function(E):u[b]=dlang.getObject(E,!1)||new Function(E),m.push(b);break;default:var x=o[b];u[b]=x&&"length"in x?E?E.split(/\s*,\s*/):[]:x instanceof Date?E==""?new Date(""):E=="now"?new Date:dates.fromISOString(E):x instanceof _Url?dojo.baseUrl+E:myEval(E)}else u[b]=E}}for(var T=0;T<m.length;T++){var N=m[T].toLowerCase();t.removeAttribute(N),t[N]=null}if(y)try{y=myEval.call(r.propsThis,"{"+y+"}"),dlang.mixin(u,y)}catch(C){throw new Error(C.toString()+" in data-dojo-props='"+y+"'")}dlang.mixin(u,n),i||(i=e&&(e._noScript||o._noScript)?[]:query("> script[type^='dojo/']",t));var k=[],L=[],A=[],O=[];if(i)for(d=0;d<i.length;d++){var M=i[d];t.removeChild(M);var _=M.getAttribute(h+"event")||M.getAttribute("event"),D=M.getAttribute(h+"prop"),P=M.getAttribute(h+"method"),H=M.getAttribute(h+"advice"),B=M.getAttribute("type"),j=this._functionFromScript(M,h);_?B=="dojo/connect"?k.push({method:_,func:j}):B=="dojo/on"?O.push({event:_,func:j}):u[_]=j:B=="dojo/aspect"?k.push({method:P,advice:H,func:j}):B=="dojo/watch"?A.push({prop:D,func:j}):L.push(j)}var F=e.markupFactory||o.markupFactory,I=F?F(u,t,e):new e(u,t);return I.then?I.then(q):q(I)},scan:function(e,t){function g(e){if(!e.inherited){e.inherited={};var t=e.node,n=g(e.parent),r={dir:t.getAttribute("dir")||n.dir,lang:t.getAttribute("lang")||n.lang,textDir:t.getAttribute(a)||n.textDir};for(var i in r)r[i]&&(e.inherited[i]=r[i])}return e.inherited}var n=[],r=[],i={},s=(t.scope||dojo._scopeName)+"Type",o="data-"+(t.scope||dojo._scopeName)+"-",u=o+"type",a=o+"textdir",f=o+"mixins",l=e.firstChild,c=t.inherited;if(!c){function h(e,t){return e.getAttribute&&e.getAttribute(t)||e.parentNode&&h(e.parentNode,t)}c={dir:h(e,"dir"),lang:h(e,"lang"),textDir:h(e,a)};for(var p in c)c[p]||delete c[p]}var d={inherited:c},v,m;for(;;){if(!l){if(!d||!d.node)break;l=d.node.nextSibling,m=!1,d=d.parent,v=d.scripts;continue}if(l.nodeType!=1){l=l.nextSibling;continue}if(v&&l.nodeName.toLowerCase()=="script"){y=l.getAttribute("type"),y&&/^dojo\/\w/i.test(y)&&v.push(l),l=l.nextSibling;continue}if(m){l=l.nextSibling;continue}var y=l.getAttribute(u)||l.getAttribute(s),b=l.firstChild;if(!y&&(!b||b.nodeType==3&&!b.nextSibling)){l=l.nextSibling;continue}var w,E=null;if(y){var S=l.getAttribute(f),x=S?[y].concat(S.split(/\s*,\s*/)):[y];try{E=getCtor(x,t.contextRequire)}catch(T){}E||darray.forEach(x,function(e){~e.indexOf("/")&&!i[e]&&(i[e]=!0,r[r.length]=e)});var N=E&&!E.prototype._noScript?[]:null;w={types:x,ctor:E,parent:d,node:l,scripts:N},w.inherited=g(w),n.push(w)}else w={node:l,scripts:v,parent:d};v=N,m=l.stopParser||E&&E.prototype.stopParser&&!t.template,d=w,l=b}var C=new Deferred;if(r.length){has("dojo-debug-messages")&&console.warn("WARNING: Modules being Auto-Required: "+r.join(", "));var k=t.contextRequire||require;k(r,function(){C.resolve(darray.filter(n,function(e){if(!e.ctor)try{e.ctor=getCtor(e.types,t.contextRequire)}catch(n){}var r=e.parent;while(r&&!r.types)r=r.parent;var i=e.ctor&&e.ctor.prototype;return e.instantiateChildren=!(i&&i.stopParser&&!t.template),e.instantiate=!r||r.instantiate&&r.instantiateChildren,e.instantiate}))})}else C.resolve(n);return C.promise},_require:function(e,t){var n=myEval("{"+e.innerHTML+"}"),r=[],i=[],s=new Deferred,o=t&&t.contextRequire||require;for(var u in n)r.push(u),i.push(n[u]);return o(i,function(){for(var e=0;e<r.length;e++)dlang.setObject(r[e],arguments[e]);s.resolve(arguments)}),s.promise},_scanAmd:function(e,t){var n=new Deferred,r=n.promise;n.resolve(!0);var i=this;return query("script[type='dojo/require']",e).forEach(function(e){r=r.then(function(){return i._require(e,t)}),e.parentNode.removeChild(e)}),r},parse:function(e,t){var n;!t&&e&&e.rootNode?(t=e,n=t.rootNode):!e||!dlang.isObject(e)||"nodeType"in e?n=e:t=e,n=n?dom.byId(n):dwindow.body(),t=t||{};var r=t.template?{template:!0}:{},i=[],s=this,o=this._scanAmd(n,t).then(function(){return s.scan(n,t)}).then(function(e){return s._instantiate(e,r,t,!0)}).then(function(e){return i=i.concat(e)}).otherwise(function(e){throw console.error("dojo/parser::parse() error",e),e});return dlang.mixin(i,o),i}};return has("extend-dojo")&&(dojo.parser=parser),config.parseOnLoad&&ready(100,parser,"parse"),parser}),pen.define("dijit/_WidgetsInTemplateMixin",["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(e,t,n,r,i){return n("dijit._WidgetsInTemplateMixin",null,{_earlyTemplatedStartup:!1,widgetsInTemplate:!0,contextRequire:null,_beforeFillContent:function(){if(this.widgetsInTemplate){var e=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0),i.parse(e,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(r.hitch(this,function(e){this._startupWidgets=e;for(var t=0;t<e.length;t++)this._processTemplateNode(e[t],function(e,t){return e[t]},function(e,t,n){return t in e?e.connect(e,t,n):e.on(t,n,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw new Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), "+"unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.")}},_processTemplateNode:function(e,t,n){return t(e,"dojoType")||t(e,"data-dojo-type")?!0:this.inherited(arguments)},startup:function(){e.forEach(this._startupWidgets,function(e){e&&!e._started&&e.startup&&e.startup()}),this._startupWidgets=null,this.inherited(arguments)}})}),pen.define("dojo/domReady",["./has"],function(e){function a(e){o.push(e),s&&f()}function f(){if(u)return;u=!0;while(o.length)try{o.shift()(n)}catch(e){console.log("Error on domReady callback: "+e)}u=!1,a._onQEmpty()}var t=this,n=document,r={loaded:1,complete:1},i=typeof n.readyState!="string",s=!!r[n.readyState],o=[],u;a.load=function(e,t,n){a(n)},a._Q=o,a._onQEmpty=function(){},i&&(n.readyState="loading");if(!s){var l=[],c=function(e){e=e||t.event;if(s||e.type=="readystatechange"&&!r[n.readyState])return;i&&(n.readyState="complete"),s=1,f()},h=function(e,t){e.addEventListener(t,c,!1),o.push(function(){e.removeEventListener(t,c,!1)})};if(!e("dom-addeventlistener")){h=function(e,t){t="on"+t,e.attachEvent(t,c),o.push(function(){e.detachEvent(t,c)})};var p=n.createElement("div");try{p.doScroll&&t.frameElement===null&&l.push(function(){try{return p.doScroll("left"),1}catch(e){}})}catch(d){}}h(n,"DOMContentLoaded"),h(t,"load"),"onreadystatechange"in n?h(n,"readystatechange"):i||l.push(function(){return r[n.readyState]});if(l.length){var v=function(){if(s)return;var e=l.length;while(e--)if(l[e]()){c("poller");return}setTimeout(v,30)};v()}}return a}),pen.define("dojo/touch",["./_base/kernel","./aspect","./dom","./dom-class","./_base/lang","./on","./has","./mouse","./domReady","./_base/window"],function(e,t,n,r,i,s,o,u,a,f){function x(e,t,n){return h&&n?function(e,t){return s(e,n,t)}:l?function(n,r){var i=s(n,t,r),o=s(n,e,function(e){(!S||(new Date).getTime()>S+1e3)&&r.call(this,e)});return{remove:function(){i.remove(),o.remove()}}}:function(t,n){return s(t,e,n)}}function T(e){do if(e.dojoClick!==undefined)return e.dojoClick;while(e=e.parentNode)}function N(e,t,i){v=!e.target.disabled&&T(e.target);if(v){m=e.target,g=e.touches?e.touches[0].pageX:e.clientX,y=e.touches?e.touches[0].pageY:e.clientY,b=(typeof v=="object"?v.x:typeof v=="number"?v:0)||4,w=(typeof v=="object"?v.y:typeof v=="number"?v:0)||4;if(!d){d=!0,f.doc.addEventListener(t,function(e){v=v&&e.target==m&&Math.abs((e.touches?e.touches[0].pageX:e.clientX)-g)<=b&&Math.abs((e.touches?e.touches[0].pageY:e.clientY)-y)<=w},!0),f.doc.addEventListener(i,function(e){if(v){E=(new Date).getTime();var t=e.target;t.tagName==="LABEL"&&(t=n.byId(t.getAttribute("for"))||t),setTimeout(function(){s.emit(t,"click",{bubbles:!0,cancelable:!0,_dojo_click:!0})})}},!0);function o(e){f.doc.addEventListener(e,function(t){!t._dojo_click&&(new Date).getTime()<=E+1e3&&(t.target.tagName!="INPUT"||!r.contains(t.target,"dijitOffScreen"))&&(t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),e=="click"&&(t.target.tagName!="INPUT"||t.target.type=="radio"||t.target.type=="checkbox")&&t.target.tagName!="TEXTAREA"&&t.target.tagName!="AUDIO"&&t.target.tagName!="VIDEO"&&t.preventDefault())},!0)}o("click"),o("mousedown"),o("mouseup")}}}var l=o("touch"),c=o("ios")<5,h=navigator.pointerEnabled||navigator.msPointerEnabled,p=function(){var e={};for(var t in{down:1,move:1,up:1,cancel:1,over:1,out:1})e[t]=navigator.pointerEnabled?"pointer"+t:"MSPointer"+t.charAt(0).toUpperCase()+t.slice(1);return e}(),d,v,m,g,y,b,w,E,S,C;l&&(h?a(function(){f.doc.addEventListener(p.down,function(e){N(e,p.move,p.up)},!0)}):a(function(){function e(e){var t=i.delegate(e,{bubbles:!0});return o("ios")>=6&&(t.touches=e.touches,t.altKey=e.altKey,t.changedTouches=e.changedTouches,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.targetTouches=e.targetTouches),t}C=f.body(),f.doc.addEventListener("touchstart",function(e){S=(new Date).getTime();var t=C;C=e.target,s.emit(t,"dojotouchout",{relatedTarget:C,bubbles:!0}),s.emit(C,"dojotouchover",{relatedTarget:t,bubbles:!0}),N(e,"touchmove","touchend")},!0),s(f.doc,"touchmove",function(t){S=(new Date).getTime();var n=f.doc.elementFromPoint(t.pageX-(c?0:f.global.pageXOffset),t.pageY-(c?0:f.global.pageYOffset));n&&(C!==n&&(s.emit(C,"dojotouchout",{relatedTarget:n,bubbles:!0}),s.emit(n,"dojotouchover",{relatedTarget:C,bubbles:!0}),C=n),s.emit(n,"dojotouchmove",e(t))||t.preventDefault())}),s(f.doc,"touchend",function(t){S=(new Date).getTime();var n=f.doc.elementFromPoint(t.pageX-(c?0:f.global.pageXOffset),t.pageY-(c?0:f.global.pageYOffset))||f.body();s.emit(n,"dojotouchend",e(t))})}));var k={press:x("mousedown","touchstart",p.down),move:x("mousemove","dojotouchmove",p.move),release:x("mouseup","dojotouchend",p.up),cancel:x(u.leave,"touchcancel",l?p.cancel:null),over:x("mouseover","dojotouchover",p.over),out:x("mouseout","dojotouchout",p.out),enter:u._eventHandler(x("mouseover","dojotouchover",p.over)),leave:u._eventHandler(x("mouseout","dojotouchout",p.out))};return o("extend-dojo")&&(e.touch=k),k}),pen.define("dijit/a11yclick",["dojo/keys","dojo/mouse","dojo/on","dojo/touch"],function(e,t,n,r){function i(t){if((t.keyCode===e.ENTER||t.keyCode===e.SPACE)&&!/input|button|textarea/i.test(t.target.nodeName))for(var n=t.target;n;n=n.parentNode)if(n.dojoClick)return!0}var s;n(document,"keydown",function(e){i(e)?(s=e.target,e.preventDefault()):s=null}),n(document,"keyup",function(e){i(e)&&e.target==s&&(s=null,n.emit(e.target,"click",{cancelable:!0,bubbles:!0,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,altKey:e.altKey,_origType:e.type}))});var o=function(e,t){return e.dojoClick=!0,n(e,"click",t)};return o.click=o,o.press=function(i,s){var o=n(i,r.press,function(e){if(e.type=="mousedown"&&!t.isLeft(e))return;s(e)}),u=n(i,"keydown",function(t){(t.keyCode===e.ENTER||t.keyCode===e.SPACE)&&s(t)});return{remove:function(){o.remove(),u.remove()}}},o.release=function(i,s){var o=n(i,r.release,function(e){if(e.type=="mouseup"&&!t.isLeft(e))return;s(e)}),u=n(i,"keyup",function(t){(t.keyCode===e.ENTER||t.keyCode===e.SPACE)&&s(t)});return{remove:function(){o.remove(),u.remove()}}},o.move=r.move,o}),pen.define("dijit/_OnDijitClickMixin",["dojo/on","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/has","./a11yclick"],function(e,t,n,r,i,s){var o=r("dijit._OnDijitClickMixin",null,{connect:function(e,t,n){return this.inherited(arguments,[e,t=="ondijitclick"?s:t,n])}});return o.a11yclick=s,o}),pen.define("dojo/window",["./_base/lang","./sniff","./_base/window","./dom","./dom-geometry","./dom-style","./dom-construct"],function(e,t,n,r,i,s,o){t.add("rtl-adjust-position-for-verticalScrollBar",function(e,t){var r=n.body(t),s=o.create("div",{style:{overflow:"scroll",overflowX:"visible",direction:"rtl",visibility:"hidden",position:"absolute",left:"0",top:"0",width:"64px",height:"64px"}},r,"last"),u=o.create("div",{style:{overflow:"hidden",direction:"ltr"}},s,"last"),a=i.position(u).x!=0;return s.removeChild(u),r.removeChild(s),a}),t.add("position-fixed-support",function(e,t){var r=n.body(t),s=o.create("span",{style:{visibility:"hidden",position:"fixed",left:"1px",top:"1px"}},r,"last"),u=o.create("span",{style:{position:"fixed",left:"0",top:"0"}},s,"last"),a=i.position(u).x!=i.position(s).x;return s.removeChild(u),r.removeChild(s),a});var u={getBox:function(e){e=e||n.doc;var r=e.compatMode=="BackCompat"?n.body(e):e.documentElement,s=i.docScroll(e),o,a;if(t("touch")){var f=u.get(e);o=f.innerWidth||r.clientWidth,a=f.innerHeight||r.clientHeight}else o=r.clientWidth,a=r.clientHeight;return{l:s.x,t:s.y,w:o,h:a}},get:function(e){if(t("ie")&&u!==document.parentWindow){e.parentWindow.execScript("document._parentWindow = window;","Javascript");var n=e._parentWindow;return e._parentWindow=null,n}return e.parentWindow||e.defaultView},scrollIntoView:function(e,o){try{e=r.byId(e);var u=e.ownerDocument||n.doc,a=n.body(u),f=u.documentElement||a.parentNode,l=t("ie"),c=t("webkit");if(e==a||e==f)return;if(!(t("mozilla")||l||c||t("opera")||t("trident"))&&"scrollIntoView"in e){e.scrollIntoView(!1);return}var h=u.compatMode=="BackCompat",p=Math.min(a.clientWidth||f.clientWidth,f.clientWidth||a.clientWidth),d=Math.min(a.clientHeight||f.clientHeight,f.clientHeight||a.clientHeight),v=c||h?a:f,m=o||i.position(e),g=e.parentNode,y=function(e){return l<=6||l==7&&h?!1:t("position-fixed-support")&&s.get(e,"position").toLowerCase()=="fixed"};if(y(e))return;while(g){g==a&&(g=v);var b=i.position(g),w=y(g),E=s.getComputedStyle(g).direction.toLowerCase()=="rtl";if(g==v){b.w=p,b.h=d,v==f&&l&&E&&(b.x+=v.offsetWidth-b.w);if(b.x<0||!l||l>=9)b.x=0;if(b.y<0||!l||l>=9)b.y=0}else{var S=i.getPadBorderExtents(g);b.w-=S.w,b.h-=S.h,b.x+=S.l,b.y+=S.t;var x=g.clientWidth,T=b.w-x;x>0&&T>0&&(E&&t("rtl-adjust-position-for-verticalScrollBar")&&(b.x+=T),b.w=x),x=g.clientHeight,T=b.h-x,x>0&&T>0&&(b.h=x)}w&&(b.y<0&&(b.h+=b.y,b.y=0),b.x<0&&(b.w+=b.x,b.x=0),b.y+b.h>d&&(b.h=d-b.y),b.x+b.w>p&&(b.w=p-b.x));var N=m.x-b.x,C=m.y-b.y,k=N+m.w-b.w,L=C+m.h-b.h,A,O;k*N>0&&(!!g.scrollLeft||g==v||g.scrollWidth>g.offsetHeight)&&(A=Math[N<0?"max":"min"](N,k),E&&(l==8&&!h||l>=9)&&(A=-A),O=g.scrollLeft,g.scrollLeft+=A,A=g.scrollLeft-O,m.x-=A),L*C>0&&(!!g.scrollTop||g==v||g.scrollHeight>g.offsetHeight)&&(A=Math.ceil(Math[C<0?"max":"min"](C,L)),O=g.scrollTop,g.scrollTop+=A,A=g.scrollTop-O,m.y-=A),g=g!=v&&!w&&g.parentNode}}catch(M){console.error("scrollIntoView: "+M),e.scrollIntoView(!1)}}};return t("extend-dojo")&&e.setObject("dojo.window",u),u}),pen.define("dijit/a11y",["dojo/_base/array","dojo/dom","dojo/dom-attr","dojo/dom-style","dojo/_base/lang","dojo/sniff","./main"],function(e,t,n,r,i,s,o){var u,a={_isElementShown:function(e){var t=r.get(e);return t.visibility!="hidden"&&t.visibility!="collapsed"&&t.display!="none"&&n.get(e,"type")!="hidden"},hasDefaultTabStop:function(e){switch(e.nodeName.toLowerCase()){case"a":return n.has(e,"href");case"area":case"button":case"input":case"object":case"select":case"textarea":return!0;case"iframe":var t;try{var r=e.contentDocument;if("designMode"in r&&r.designMode=="on")return!0;t=r.body}catch(i){try{t=e.contentWindow.document.body}catch(s){return!1}}return t&&(t.contentEditable=="true"||t.firstChild&&t.firstChild.contentEditable=="true");default:return e.contentEditable=="true"}},effectiveTabIndex:function(e){return n.get(e,"disabled")?u:n.has(e,"tabIndex")?+n.get(e,"tabIndex"):a.hasDefaultTabStop(e)?0:u},isTabNavigable:function(e){return a.effectiveTabIndex(e)>=0},isFocusable:function(e){return a.effectiveTabIndex(e)>=-1},_getTabNavigable:function(e){function c(e){return e&&e.tagName.toLowerCase()=="input"&&e.type&&e.type.toLowerCase()=="radio"&&e.name&&e.name.toLowerCase()}function v(e){return l[c(e)]||e}var t,r,i,o,u,f,l={},h=a._isElementShown,p=a.effectiveTabIndex,d=function(e){for(var a=e.firstChild;a;a=a.nextSibling){if(a.nodeType!=1||s("ie")<=9&&a.scopeName!=="HTML"||!h(a))continue;var v=p(a);if(v>=0){if(v==0)t||(t=a),r=a;else if(v>0){if(!i||v<o)o=v,i=a;if(!u||v>=f)f=v,u=a}var m=c(a);n.get(a,"checked")&&m&&(l[m]=a)}a.nodeName.toUpperCase()!="SELECT"&&d(a)}};return h(e)&&d(e),{first:v(t),last:v(r),lowest:v(i),highest:v(u)}},getFirstInTabbingOrder:function(e,n){var r=a._getTabNavigable(t.byId(e,n));return r.lowest?r.lowest:r.first},getLastInTabbingOrder:function(e,n){var r=a._getTabNavigable(t.byId(e,n));return r.last?r.last:r.highest}};return s("extend-dojo")&&i.mixin(o,a),a}),pen.define("dijit/focus",["dojo/aspect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/Evented","dojo/_base/lang","dojo/on","dojo/domReady","dojo/sniff","dojo/Stateful","dojo/_base/window","dojo/window","./a11y","./registry","./main"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g,y=t([c,o],{curNode:null,activeStack:[],constructor:function(){var t=u.hitch(this,function(e){n.isDescendant(this.curNode,e)&&this.set("curNode",null),n.isDescendant(this.prevNode,e)&&this.set("prevNode",null)});e.before(s,"empty",t),e.before(s,"destroy",t)},registerIframe:function(e){return this.registerWin(e.contentWindow,e)},registerWin:function(e,t){var n=this,r=e.document&&e.document.body;if(r){var i=a(e.document,"mousedown, touchstart",function(e){n._justMouseDowned=!0,setTimeout(function(){n._justMouseDowned=!1},0);if(e&&e.target&&e.target.parentNode==null)return;n._onTouchNode(t||e.target,"mouse")}),s=a(r,"focusin",function(e){g=(new Date).getTime();if(!e.target.tagName)return;var r=e.target.tagName.toLowerCase();if(r=="#document"||r=="body")return;d.isFocusable(e.target)?n._onFocusNode(t||e.target):n._onTouchNode(t||e.target)}),o=a(r,"focusout",function(e){if((new Date).getTime()<g+100)return;n._onBlurNode(t||e.target)});return{remove:function(){i.remove(),s.remove(),o.remove(),i=s=o=null,r=null}}}},_onBlurNode:function(e){this._clearFocusTimer&&clearTimeout(this._clearFocusTimer),this._clearFocusTimer=setTimeout(u.hitch(this,function(){this.set("prevNode",this.curNode),this.set("curNode",null)}),0);if(this._justMouseDowned)return;this._clearActiveWidgetsTimer&&clearTimeout(this._clearActiveWidgetsTimer),this._clearActiveWidgetsTimer=setTimeout(u.hitch(this,function(){delete this._clearActiveWidgetsTimer,this._setStack([])}),0)},_onTouchNode:function(e,t){this._clearActiveWidgetsTimer&&(clearTimeout(this._clearActiveWidgetsTimer),delete this._clearActiveWidgetsTimer),i.contains(e,"dijitPopup")&&(e=e.firstChild);var n=[];try{while(e){var s=r.get(e,"dijitPopupParent");if(s)e=v.byId(s).domNode;else if(e.tagName&&e.tagName.toLowerCase()=="body"){if(e===h.body())break;e=p.get(e.ownerDocument).frameElement}else{var o=e.getAttribute&&e.getAttribute("widgetId"),u=o&&v.byId(o);u&&(t!="mouse"||!u.get("disabled"))&&n.unshift(o),e=e.parentNode}}}catch(a){}this._setStack(n,t)},_onFocusNode:function(e){if(!e)return;if(e.nodeType==9)return;this._clearFocusTimer&&(clearTimeout(this._clearFocusTimer),delete this._clearFocusTimer),this._onTouchNode(e);if(e==this.curNode)return;this.set("prevNode",this.curNode),this.set("curNode",e)},_setStack:function(e,t){var n=this.activeStack,r=n.length-1,i=e.length-1;if(e[i]==n[r])return;this.set("activeStack",e);var s,o;for(o=r;o>=0&&n[o]!=e[o];o--)s=v.byId(n[o]),s&&(s._hasBeenBlurred=!0,s.set("focused",!1),s._focusManager==this&&s._onBlur(t),this.emit("widget-blur",s,t));for(o++;o<=i;o++)s=v.byId(e[o]),s&&(s.set("focused",!0),s._focusManager==this&&s._onFocus(t),this.emit("widget-focus",s,t))},focus:function(e){if(e)try{e.focus()}catch(t){}}}),b=new y;f(function(){var e=b.registerWin(p.get(document));l("ie")&&a(window,"unload",function(){e&&(e.remove(),e=null)})}),m.focus=function(e){b.focus(e)};for(var w in b)/^_/.test(w)||(m.focus[w]=typeof b[w]=="function"?u.hitch(b,w):b[w]);return b.watch(function(e,t,n){m.focus[e]=n}),b}),pen.define("dijit/_FocusMixin",["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],function(e,t,n,r){return r.extend(t,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}}),n("dijit._FocusMixin",null,{_focusManager:e})}),pen.define("dojo/uacss",["./dom-geometry","./_base/lang","./domReady","./sniff","./_base/window"],function(e,t,n,r,i){var s=i.doc.documentElement,o=r("ie"),u=r("opera"),a=Math.floor,f=r("ff"),l=e.boxModel.replace(/-/,""),c={dj_quirks:r("quirks"),dj_opera:u,dj_khtml:r("khtml"),dj_webkit:r("webkit"),dj_safari:r("safari"),dj_chrome:r("chrome"),dj_gecko:r("mozilla"),dj_ios:r("ios"),dj_android:r("android")};o&&(c.dj_ie=!0,c["dj_ie"+a(o)]=!0,c.dj_iequirks=r("quirks")),f&&(c["dj_ff"+a(f)]=!0),c["dj_"+l]=!0;var h="";for(var p in c)c[p]&&(h+=p+" ");return s.className=t.trim(s.className+" "+h),n(function(){if(!e.isBodyLtr()){var n="dj_rtl dijitRtl "+h.replace(/ /g,"-rtl ");s.className=t.trim(s.className+" "+n+"dj_rtl dijitRtl "+h.replace(/ /g,"-rtl "))}}),r}),pen.define("dojo/hccss",["require","./_base/config","./dom-class","./dom-style","./has","./domReady","./_base/window"],function(e,t,n,r,i,s,o){return i.add("highcontrast",function(){var n=o.doc.createElement("div");n.style.cssText="border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("+(t.blankGif||e.toUrl("./resources/blank.gif"))+");",o.body().appendChild(n);var s=r.getComputedStyle(n),u=s.backgroundImage,a=s.borderTopColor==s.borderRightColor||u&&(u=="none"||u=="url(invalid-url:)");return i("ie")<=8?n.outerHTML="":o.body().removeChild(n),a}),s(function(){i("highcontrast")&&n.add(o.body(),"dj_a11y")}),i}),pen.define("dijit/hccss",["dojo/dom-class","dojo/hccss","dojo/domReady","dojo/_base/window"],function(e,t,n,r){return n(function(){t("highcontrast")&&e.add(r.body(),"dijit_a11y")}),t}),pen.define("dijit/_Widget",["dojo/aspect","dojo/_base/config","dojo/_base/connect","dojo/_base/declare","dojo/has","dojo/_base/kernel","dojo/_base/lang","dojo/query","dojo/ready","./registry","./_WidgetBase","./_OnDijitClickMixin","./_FocusMixin","dojo/uacss","./hccss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){function p(){}function d(e){return function(t,r,i,s){return t&&typeof r=="string"&&t[r]==p?t.on(r.substring(2).toLowerCase(),o.hitch(i,s)):e.apply(n,arguments)}}e.around(n,"connect",d),s.connect&&e.around(s,"connect",d);var v=r("dijit._Widget",[l,c,h],{onClick:p,onDblClick:p,onKeyDown:p,onKeyPress:p,onKeyUp:p,onMouseDown:p,onMouseMove:p,onMouseOut:p,onMouseOver:p,onMouseLeave:p,onMouseEnter:p,onMouseUp:p,constructor:function(e){this._toConnect={};for(var t in e)this[t]===p&&(this._toConnect[t.replace(/^on/,"").toLowerCase()]=e[t],delete e[t])},postCreate:function(){this.inherited(arguments);for(var e in this._toConnect)this.on(e,this._toConnect[e]);delete this._toConnect},on:function(e,t){return this[this._onMap(e)]===p?n.connect(this.domNode,e.toLowerCase(),this,t):this.inherited(arguments)},_setFocusedAttr:function(e){this._focused=e,this._set("focused",e)},setAttribute:function(e,t){s.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0"),this.set(e,t)},attr:function(e,t){var n=arguments.length;return n>=2||typeof e=="object"?this.set.apply(this,arguments):this.get(e)},getDescendants:function(){return s.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0"),this.containerNode?u("[widgetId]",this.containerNode).map(f.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});return i("dijit-legacy-requires")&&a(0,function(){var e=["dijit/_base"];require(e)}),v}),pen.define("dijit/_CssStateMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-class","dojo/has","dojo/_base/lang","dojo/on","dojo/domReady","dojo/touch","dojo/_base/window","./a11yclick","./registry"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=t("dijit._CssStateMixin",[],{hovering:!1,active:!1,_applyAttributes:function(){this.inherited(arguments),e.forEach(["disabled","readOnly","checked","selected","focused","state","hovering","active","_opened"],function(e){this.watch(e,s.hitch(this,"_setStateClass"))},this);for(var t in this.cssStateNodes||{})this._trackMouseState(this[t],this.cssStateNodes[t]);this._trackMouseState(this.domNode,this.baseClass),this._setStateClass()},_cssMouseEvent:function(e){if(!this.disabled)switch(e.type){case"mouseover":case"MSPointerOver":case"pointerover":this._set("hovering",!0),this._set("active",this._mouseDown);break;case"mouseout":case"MSPointerOut":case"pointerout":this._set("hovering",!1),this._set("active",!1);break;case"mousedown":case"touchstart":case"MSPointerDown":case"pointerdown":case"keydown":this._set("active",!0);break;case"mouseup":case"dojotouchend":case"MSPointerUp":case"pointerup":case"keyup":this._set("active",!1)}},_setStateClass:function(){function n(n){t=t.concat(e.map(t,function(e){return e+n}),"dijit"+n)}var t=this.baseClass.split(" ");this.isLeftToRight()||n("Rtl");var r=this.checked=="mixed"?"Mixed":this.checked?"Checked":"";this.checked&&n(r),this.state&&n(this.state),this.selected&&n("Selected"),this._opened&&n("Opened"),this.disabled?n("Disabled"):this.readOnly?n("ReadOnly"):this.active?n("Active"):this.hovering&&n("Hover"),this.focused&&n("Focused");var i=this.stateNode||this.domNode,s={};e.forEach(i.className.split(" "),function(e){s[e]=!0}),"_stateClasses"in this&&e.forEach(this._stateClasses,function(e){delete s[e]}),e.forEach(t,function(e){s[e]=!0});var o=[];for(var u in s)o.push(u);i.className=o.join(" "),this._stateClasses=t},_subnodeCssMouseEvent:function(e,t,n){function i(n){r.toggle(e,t+"Hover",n)}function s(n){r.toggle(e,t+"Active",n)}function o(n){r.toggle(e,t+"Focused",n)}if(this.disabled||this.readOnly)return;switch(n.type){case"mouseover":case"MSPointerOver":case"pointerover":i(!0);break;case"mouseout":case"MSPointerOut":case"pointerout":i(!1),s(!1);break;case"mousedown":case"touchstart":case"MSPointerDown":case"pointerdown":case"keydown":s(!0);break;case"mouseup":case"MSPointerUp":case"pointerup":case"dojotouchend":case"keyup":s(!1);break;case"focus":case"focusin":o(!0);break;case"blur":case"focusout":o(!1)}},_trackMouseState:function(e,t){e._cssState=t}});return u(function(){function e(e,t,r){if(r&&n.isDescendant(r,t))return;for(var i=t;i&&i!=r;i=i.parentNode)if(i._cssState){var s=c.getEnclosingWidget(i);s&&(i==s.domNode?s._cssMouseEvent(e):s._subnodeCssMouseEvent(i,i._cssState,e))}}var t=f.body(),r;o(t,a.over,function(t){e(t,t.target,t.relatedTarget)}),o(t,a.out,function(t){e(t,t.target,t.relatedTarget)}),o(t,l.press,function(t){r=t.target,e(t,r)}),o(t,l.release,function(t){e(t,r),r=null}),o(t,"focusin, focusout",function(e){var t=e.target;if(t._cssState&&!t.getAttribute("widgetId")){var n=c.getEnclosingWidget(t);n&&n._subnodeCssMouseEvent(t,t._cssState,e)}})}),h}),pen.define("dijit/form/_FormWidgetMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/dom-style","dojo/_base/lang","dojo/mouse","dojo/on","dojo/sniff","dojo/window","../a11y"],function(e,t,n,r,i,s,o,u,a,f){return t("dijit.form._FormWidgetMixin",null,{name:"",alt:"",value:"",type:"text","aria-label":"focusNode",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:!1,intermediateChanges:!1,scrollOnFocus:!0,_setIdAttr:"focusNode",_setDisabledAttr:function(t){this._set("disabled",t),n.set(this.focusNode,"disabled",t),this.valueNode&&n.set(this.valueNode,"disabled",t),this.focusNode.setAttribute("aria-disabled",t?"true":"false");if(t){this._set("hovering",!1),this._set("active",!1);var r="tabIndex"in this.attributeMap?this.attributeMap.tabIndex:"_setTabIndexAttr"in this?this._setTabIndexAttr:"focusNode";e.forEach(i.isArray(r)?r:[r],function(e){var t=this[e];u("webkit")||f.hasDefaultTabStop(t)?t.setAttribute("tabIndex","-1"):t.removeAttribute("tabIndex")},this)}else this.tabIndex!=""&&this.set("tabIndex",this.tabIndex)},_onFocus:function(e){if(e=="mouse"&&this.isFocusable())var t=this.own(o(this.focusNode,"focus",function(){n.remove(),t.remove()}))[0],n=this.own(o(this.ownerDocumentBody,"mouseup, touchend",i.hitch(this,function(e){n.remove(),t.remove(),this.focused&&(e.type=="touchend"?this.defer("focus"):this.focus())})))[0];this.scrollOnFocus&&this.defer(function(){a.scrollIntoView(this.domNode)}),this.inherited(arguments)},isFocusable:function(){return!this.disabled&&this.focusNode&&r.get(this.domNode,"display")!="none"},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(e){}},compare:function(e,t){return typeof e=="number"&&typeof t=="number"?isNaN(e)&&isNaN(t)?0:e-t:e>t?1:e<t?-1:0},onChange:function(){},_onChangeActive:!1,_handleOnChange:function(e,t){this._lastValueReported==undefined&&(t===null||!this._onChangeActive)&&(this._resetValue=this._lastValueReported=e),this._pendingOnChange=this._pendingOnChange||typeof e!=typeof this._lastValueReported||this.compare(e,this._lastValueReported)!=0,(this.intermediateChanges||t||t===undefined)&&this._pendingOnChange&&(this._lastValueReported=e,this._pendingOnChange=!1,this._onChangeActive&&(this._onChangeHandle&&this._onChangeHandle.remove(),this._onChangeHandle=this.defer(function(){this._onChangeHandle=null,this.onChange(e)})))},create:function(){this.inherited(arguments),this._onChangeActive=!0},destroy:function(){this._onChangeHandle&&(this._onChangeHandle.remove(),this.onChange(this._lastValueReported)),this.inherited(arguments)}})}),pen.define("dijit/form/_FormWidget",["dojo/_base/declare","dojo/sniff","dojo/_base/kernel","dojo/ready","../_Widget","../_CssStateMixin","../_TemplatedMixin","./_FormWidgetMixin"],function(e,t,n,r,i,s,o,u){return t("dijit-legacy-requires")&&r(0,function(){var e=["dijit/form/_FormValueWidget"];require(e)}),e("dijit.form._FormWidget",[i,o,s,u],{setDisabled:function(e){n.deprecated("setDisabled("+e+") is deprecated. Use set('disabled',"+e+") instead.","","2.0"),this.set("disabled",e)},setValue:function(e){n.deprecated("dijit.form._FormWidget:setValue("+e+") is deprecated.  Use set('value',"+e+") instead.","","2.0"),this.set("value",e)},getValue:function(){return n.deprecated(this.declaredClass+"::getValue() is deprecated. Use get('value') instead.","","2.0"),this.get("value")},postMixInProperties:function(){this.nameAttrSetting=this.name&&!t("msapp")?'name="'+this.name.replace(/"/g,"&quot;")+'"':"",this.inherited(arguments)},_setTypeAttr:null})}),pen.define("dijit/form/_FormValueMixin",["dojo/_base/declare","dojo/dom-attr","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","./_FormWidgetMixin"],function(e,t,n,r,i,s,o){return e("dijit.form._FormValueMixin",o,{readOnly:!1,_setReadOnlyAttr:function(e){t.set(this.focusNode,"readOnly",e),this._set("readOnly",e)},postCreate:function(){this.inherited(arguments),this._resetValue===undefined&&(this._lastValueReported=this._resetValue=this.value)},_setValueAttr:function(e,t){this._handleOnChange(e,t)},_handleOnChange:function(e,t){this._set("value",e),this.inherited(arguments)},undo:function(){this._setValueAttr(this._lastValueReported,!1)},reset:function(){this._hasBeenBlurred=!1,this._setValueAttr(this._resetValue,!0)}})}),pen.define("dijit/form/_FormValueWidget",["dojo/_base/declare","dojo/sniff","./_FormWidget","./_FormValueMixin"],function(e,t,n,r){return e("dijit.form._FormValueWidget",[n,r],{_layoutHackIE7:function(){if(t("ie")==7){var e=this.domNode,n=e.parentNode,r=e.firstChild||e,i=r.style.filter,s=this;while(n&&n.clientHeight==0)(function(){var t=s.connect(n,"onscroll",function(){s.disconnect(t),r.style.filter=(new Date).getMilliseconds(),s.defer(function(){r.style.filter=i})})})(),n=n.parentNode}}})}),pen.define("dijit/form/_TextBoxMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/has","dojo/keys","dojo/_base/lang","dojo/on","../main"],function(e,t,n,r,i,s,o,u){var a=t("dijit.form._TextBoxMixin"+(r("dojo-bidi")?"_NoBidi":""),null,{trim:!1,uppercase:!1,lowercase:!1,propercase:!1,maxLength:"",selectOnClick:!1,placeHolder:"",_getValueAttr:function(){return this.parse(this.get("displayedValue"),this.constraints)},_setValueAttr:function(e,t,n){var r;e!==undefined&&(r=this.filter(e),typeof n!="string"&&(r===null||typeof r=="number"&&!!isNaN(r)?n="":n=this.filter(this.format(r,this.constraints)))),n!=null&&(typeof n!="number"||!isNaN(n))&&this.textbox.value!=n&&(this.textbox.value=n,this._set("displayedValue",this.get("displayedValue"))),this.inherited(arguments,[r,t])},displayedValue:"",_getDisplayedValueAttr:function(){return this.filter(this.textbox.value)},_setDisplayedValueAttr:function(e){e==null?e="":typeof e!="string"&&(e=String(e)),this.textbox.value=e,this._setValueAttr(this.get("value"),undefined),this._set("displayedValue",this.get("displayedValue"))},format:function(e){return e==null?"":e.toString?e.toString():e},parse:function(e){return e},_refreshState:function(){},onInput:function(){},__skipInputEvent:!1,_onInput:function(e){this._processInput(e),this.intermediateChanges&&this.defer(function(){this._handleOnChange(this.get("value"),!1)})},_processInput:function(e){this._refreshState(),this._set("displayedValue",this.get("displayedValue"))},postCreate:function(){this.textbox.setAttribute("value",this.textbox.value),this.inherited(arguments);var e=function(e){var t;if(e.type=="keydown"){t=e.keyCode;switch(t){case i.SHIFT:case i.ALT:case i.CTRL:case i.META:case i.CAPS_LOCK:case i.NUM_LOCK:case i.SCROLL_LOCK:return}if(!e.ctrlKey&&!e.metaKey&&!e.altKey){switch(t){case i.NUMPAD_0:case i.NUMPAD_1:case i.NUMPAD_2:case i.NUMPAD_3:case i.NUMPAD_4:case i.NUMPAD_5:case i.NUMPAD_6:case i.NUMPAD_7:case i.NUMPAD_8:case i.NUMPAD_9:case i.NUMPAD_MULTIPLY:case i.NUMPAD_PLUS:case i.NUMPAD_ENTER:case i.NUMPAD_MINUS:case i.NUMPAD_PERIOD:case i.NUMPAD_DIVIDE:return}if(t>=65&&t<=90||t>=48&&t<=57||t==i.SPACE)return;var n=!1;for(var r in i)if(i[r]===e.keyCode){n=!0;break}if(!n)return}}t=e.charCode>=32?String.fromCharCode(e.charCode):e.charCode,t||(t=e.keyCode>=65&&e.keyCode<=90||e.keyCode>=48&&e.keyCode<=57||e.keyCode==i.SPACE?String.fromCharCode(e.keyCode):e.keyCode),t||(t=229);if(e.type=="keypress"){if(typeof t!="string")return;if(t>="a"&&t<="z"||t>="A"&&t<="Z"||t>="0"&&t<="9"||t===" ")if(e.ctrlKey||e.metaKey||e.altKey)return}if(e.type=="input"){if(this.__skipInputEvent){this.__skipInputEvent=!1;return}}else this.__skipInputEvent=!0;var o={faux:!0},u;for(u in e)if(u!="layerX"&&u!="layerY"){var a=e[u];typeof a!="function"&&typeof a!="undefined"&&(o[u]=a)}s.mixin(o,{charOrCode:t,_wasConsumed:!1,preventDefault:function(){o._wasConsumed=!0,e.preventDefault()},stopPropagation:function(){e.stopPropagation()}}),this.onInput(o)===!1&&(o.preventDefault(),o.stopPropagation());if(o._wasConsumed)return;this.defer(function(){this._onInput(o)}),e.type=="keypress"&&e.stopPropagation()};this.own(o(this.textbox,"keydown, keypress, paste, cut, input, compositionend",s.hitch(this,e)))},_blankValue:"",filter:function(e){return e===null?this._blankValue:typeof e!="string"?e:(this.trim&&(e=s.trim(e)),this.uppercase&&(e=e.toUpperCase()),this.lowercase&&(e=e.toLowerCase()),this.propercase&&(e=e.replace(/[^\s]+/g,function(e){return e.substring(0,1).toUpperCase()+e.substring(1)})),e)},_setBlurValue:function(){this._setValueAttr(this.get("value"),!0)},_onBlur:function(e){if(this.disabled)return;this._setBlurValue(),this.inherited(arguments)},_isTextSelected:function(){return this.textbox.selectionStart!=this.textbox.selectionEnd},_onFocus:function(e){if(this.disabled||this.readOnly)return;this.selectOnClick&&e=="mouse"&&(this._selectOnClickHandle=o.once(this.domNode,"mouseup, touchend",s.hitch(this,function(e){this._isTextSelected()||a.selectInputText(this.textbox)})),this.own(this._selectOnClickHandle),this.defer(function(){this._selectOnClickHandle&&(this._selectOnClickHandle.remove(),this._selectOnClickHandle=null)},500)),this.inherited(arguments),this._refreshState()},reset:function(){this.textbox.value="",this.inherited(arguments)}});return r("dojo-bidi")&&(a=t("dijit.form._TextBoxMixin",a,{_setValueAttr:function(){this.inherited(arguments),this.applyTextDir(this.focusNode)},_setDisplayedValueAttr:function(){this.inherited(arguments),this.applyTextDir(this.focusNode)},_onInput:function(){this.applyTextDir(this.focusNode),this.inherited(arguments)}})),a._setSelectionRange=u._setSelectionRange=function(e,t,n){e.setSelectionRange&&e.setSelectionRange(t,n)},a.selectInputText=u.selectInputText=function(e,t,r){e=n.byId(e),isNaN(t)&&(t=0),isNaN(r)&&(r=e.value?e.value.length:0);try{e.focus(),a._setSelectionRange(e,t,r)}catch(i){}},a}),pen.define("dojo/text",["module"],function(e){var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.10",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}d.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("﻿")===0&&(i=i.substring(1)),t(i)}catch(s){r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),pen.define("dojo/text!dijit/form/templates/TextBox.html",[],function(){return'<div class="dijit dijitReset dijitInline dijitLeft" id="widget_${id}" role="presentation"\n	><div class="dijitReset dijitInputField dijitInputContainer"\n		><input class="dijitReset dijitInputInner" data-dojo-attach-point=\'textbox,focusNode\' autocomplete="off"\n			${!nameAttrSetting} type=\'${type}\'\n	/></div\n></div>\n'}),pen.define("dijit/form/TextBox",["dojo/_base/declare","dojo/dom-construct","dojo/dom-style","dojo/_base/kernel","dojo/_base/lang","dojo/on","dojo/sniff","./_FormValueWidget","./_TextBoxMixin","dojo/text!./templates/TextBox.html","../main"],function(e,t,n,r,i,s,o,u,a,f,l){var c=e("dijit.form.TextBox"+(o("dojo-bidi")?"_NoBidi":""),[u,a],{templateString:f,_singleNodeTemplate:'<input class="dijit dijitReset dijitLeft dijitInputField" data-dojo-attach-point="textbox,focusNode" autocomplete="off" type="${type}" ${!nameAttrSetting} />',_buttonInputDisabled:o("ie")?"disabled":"",baseClass:"dijitTextBox",postMixInProperties:function(){var e=this.type.toLowerCase();if(this.templateString&&this.templateString.toLowerCase()=="input"||(e=="hidden"||e=="file")&&this.templateString==this.constructor.prototype.templateString)this.templateString=this._singleNodeTemplate;this.inherited(arguments)},postCreate:function(){this.inherited(arguments),o("ie")<9&&this.defer(function(){try{var e=n.getComputedStyle(this.domNode);if(e){var t=e.fontFamily;if(t){var r=this.domNode.getElementsByTagName("INPUT");if(r)for(var i=0;i<r.length;i++)r[i].style.fontFamily=t}}}catch(s){}})},_setPlaceHolderAttr:function(e){this._set("placeHolder",e),this._phspan||(this._attachPoints.push("_phspan"),this._phspan=t.create("span",{onmousedown:function(e){e.preventDefault()},className:"dijitPlaceHolder dijitInputField"},this.textbox,"after"),this.own(s(this._phspan,"touchend, pointerup, MSPointerUp",i.hitch(this,function(){this.focus()})))),this._phspan.innerHTML="",this._phspan.appendChild(this._phspan.ownerDocument.createTextNode(e)),this._updatePlaceHolder()},_onInput:function(e){this.inherited(arguments),this._updatePlaceHolder()},_updatePlaceHolder:function(){this._phspan&&(this._phspan.style.display=this.placeHolder&&!this.textbox.value?"":"none")},_setValueAttr:function(e,t,n){this.inherited(arguments),this._updatePlaceHolder()},getDisplayedValue:function(){return r.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use get('displayedValue') instead.","","2.0"),this.get("displayedValue")},setDisplayedValue:function(e){r.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0"),this.set("displayedValue",e)},_onBlur:function(e){if(this.disabled)return;this.inherited(arguments),this._updatePlaceHolder(),o("mozilla")&&this.selectOnClick&&(this.textbox.selectionStart=this.textbox.selectionEnd=undefined)},_onFocus:function(e){if(this.disabled||this.readOnly)return;this.inherited(arguments),this._updatePlaceHolder()}});return o("ie")<9&&(c.prototype._isTextSelected=function(){var e=this.ownerDocument.selection.createRange(),t=e.parentElement();return t==this.textbox&&e.text.length>0},l._setSelectionRange=a._setSelectionRange=function(e,t,n){if(e.createTextRange){var r=e.createTextRange();r.collapse(!0),r.moveStart("character",-99999),r.moveStart("character",t),r.moveEnd("character",n-t),r.select()}}),o("dojo-bidi")&&(c=e("dijit.form.TextBox",c,{_setPlaceHolderAttr:function(e){this.inherited(arguments),this.applyTextDir(this._phspan)}})),c}),pen.define("dijit/form/_ButtonMixin",["dojo/_base/declare","dojo/dom","dojo/has","../registry"],function(e,t,n,r){var i=e("dijit.form._ButtonMixin"+(n("dojo-bidi")?"_NoBidi":""),null,{label:"",type:"button",__onClick:function(e){return e.stopPropagation(),e.preventDefault(),this.disabled||this.valueNode.click(e),!1},_onClick:function(e){if(this.disabled)return e.stopPropagation(),e.preventDefault(),!1;this.onClick(e)===!1&&e.preventDefault();var t=e.defaultPrevented;if(!t&&this.type=="submit"&&!(this.valueNode||this.focusNode).form)for(var n=this.domNode;n.parentNode;n=n.parentNode){var i=r.byNode(n);if(i&&typeof i._onSubmit=="function"){i._onSubmit(e),e.preventDefault(),t=!0;break}}return!t},postCreate:function(){this.inherited(arguments),t.setSelectable(this.focusNode,!1)},onClick:function(){return!0},_setLabelAttr:function(e){this._set("label",e);var t=this.containerNode||this.focusNode;t.innerHTML=e}});return n("dojo-bidi")&&(i=e("dijit.form._ButtonMixin",i,{_setLabelAttr:function(){this.inherited(arguments);var e=this.containerNode||this.focusNode;this.applyTextDir(e)}})),i}),pen.define("dojo/text!dijit/form/templates/Button.html",[],function(){return'<span class="dijit dijitReset dijitInline" role="presentation"\n	><span class="dijitReset dijitInline dijitButtonNode pentaho-button"\n		data-dojo-attach-event="ondijitclick:__onClick" role="presentation"\n		><span class="dijitReset dijitStretch dijitButtonContents"\n			data-dojo-attach-point="titleNode,focusNode"\n			role="button" aria-labelledby="${id}_label"\n			><span class="dijitReset dijitInline dijitIcon" data-dojo-attach-point="iconNode"></span\n			><span class="dijitReset dijitToggleButtonIconChar">&#x25CF;</span\n			><span class="dijitReset dijitInline dijitButtonText"\n				id="${id}_label"\n				data-dojo-attach-point="containerNode"\n			></span\n		></span\n	></span\n	><input ${!nameAttrSetting} type="${type}" value="${value}" class="dijitOffScreen"\n		data-dojo-attach-event="onclick:_onClick"\n		tabIndex="-1" role="presentation" data-dojo-attach-point="valueNode"\n/></span>\n'}),pen.define("dijit/form/Button",["require","dojo/_base/declare","dojo/dom-class","dojo/has","dojo/_base/kernel","dojo/_base/lang","dojo/ready","./_FormWidget","./_ButtonMixin","dojo/text!./templates/Button.html"],function(e,t,n,r,i,s,o,u,a,f){r("dijit-legacy-requires")&&o(0,function(){var t=["dijit/form/DropDownButton","dijit/form/ComboButton","dijit/form/ToggleButton"];e(t)});var l=t("dijit.form.Button"+(r("dojo-bidi")?"_NoBidi":""),[u,a],{showLabel:!0,iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},baseClass:"dijitButton",templateString:f,_setValueAttr:"valueNode",_setNameAttr:function(e){this.valueNode&&this.valueNode.setAttribute("name",e)},_fillContent:function(e){if(e&&(!this.params||!("label"in this.params))){var t=s.trim(e.innerHTML);t&&(this.label=t)}},_setShowLabelAttr:function(e){this.containerNode&&n.toggle(this.containerNode,"dijitDisplayNone",!e),this._set("showLabel",e)},setLabel:function(e){i.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0"),this.set("label",e)},_setLabelAttr:function(e){this.inherited(arguments),!this.showLabel&&!("title"in this.params)&&(this.titleNode.title=s.trim(this.containerNode.innerText||this.containerNode.textContent||""))}});return r("dojo-bidi")&&(l=t("dijit.form.Button",l,{_setLabelAttr:function(e){this.inherited(arguments),this.titleNode.title&&this.applyTextDir(this.titleNode,this.titleNode.title)},_setTextDirAttr:function(e){this._created&&this.textDir!=e&&(this._set("textDir",e),this._setLabelAttr(this.label))}})),l}),pen.define("dojo/text!pentaho/common/TextButtonCombo.html",[],function(){return'<div data-dojo-attach-point="textButtonCombo">\n	<input data-dojo-attach-point="textInput" data-dojo-type="dijit.form.TextBox" \n		data-dojo-attach-event="onChange:_onTextInputChange"/>\n	<button type="button" class="pentaho-button"\n		data-dojo-attach-point="submitButton" data-dojo-type="dijit.form.Button"\n		data-dojo-attach-event="onClick:_onSubmitButtonClick"/>\n</div>'}),pen.define("pentaho/common/TextButtonCombo",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dojo/on","dojo/query","dijit/form/TextBox","dijit/form/Button","dojo/text!pentaho/common/TextButtonCombo.html"],function(e,t,n,r,i,s,o,u,a){return e("pentaho.common.TextButtonCombo",[t,n,n,r],{templateString:a,buttonLabel:"Submit",textPlaceHolder:"Enter Text",set:function(e,t){e=="buttonLabel"?this.submitButton.set("label",t):e=="text"||e=="value"?this.textInput.set("value",t):e=="textPlaceHolder"&&this.textInput.set("placeHolder",t)},get:function(e){return e=="text"||e=="value"?this.textInput.get("value"):null},postCreate:function(){this.set("buttonLabel",this.buttonLabel),this.set("textPlaceHolder",this.textPlaceHolder)},_onSubmitButtonClick:function(){this.onClickCallback(this.textInput.get("value"))},onClickCallback:function(e){console.log("onClickCallback...")},_onTextInputChange:function(){this.onChangeCallback(this.textInput.get("value"))},onChangeCallback:function(e){console.log("onChangeCallback...")}})}),pen.define("dojo/date",["./has","./_base/lang"],function(e,t){var n={};return n.getDaysInMonth=function(e){var t=e.getMonth(),r=[31,28,31,30,31,30,31,31,30,31,30,31];return t==1&&n.isLeapYear(e)?29:r[t]},n.isLeapYear=function(e){var t=e.getFullYear();return!(t%400)||!(t%4)&&!!(t%100)},n.getTimezoneName=function(e){var t=e.toString(),n="",r,i=t.indexOf("(");if(i>-1)n=t.substring(++i,t.indexOf(")"));else{var s=/([A-Z\/]+) \d{4}$/;if(r=t.match(s))n=r[1];else{t=e.toLocaleString(),s=/ ([A-Z\/]+)$/;if(r=t.match(s))n=r[1]}}return n=="AM"||n=="PM"?"":n},n.compare=function(e,t,n){return e=new Date(+e),t=new Date(+(t||new Date)),n=="date"?(e.setHours(0,0,0,0),t.setHours(0,0,0,0)):n=="time"&&(e.setFullYear(0,0,0),t.setFullYear(0,0,0)),e>t?1:e<t?-1:0},n.add=function(e,t,n){var r=new Date(+e),i=!1,s="Date";switch(t){case"day":break;case"weekday":var o,u,a=n%5;a?(o=a,u=parseInt(n/5)):(o=n>0?5:-5,u=n>0?(n-5)/5:(n+5)/5);var f=e.getDay(),l=0;f==6&&n>0?l=1:f==0&&n<0&&(l=-1);var c=f+o;if(c==0||c==6)l=n>0?2:-2;n=7*u+o+l;break;case"year":s="FullYear",i=!0;break;case"week":n*=7;break;case"quarter":n*=3;case"month":i=!0,s="Month";break;default:s="UTC"+t.charAt(0).toUpperCase()+t.substring(1)+"s"}return s&&r["set"+s](r["get"+s]()+n),i&&r.getDate()<e.getDate()&&r.setDate(0),r},n.difference=function(e,t,r){t=t||new Date,r=r||"day";var i=t.getFullYear()-e.getFullYear(),s=1;switch(r){case"quarter":var o=e.getMonth(),u=t.getMonth(),a=Math.floor(o/3)+1,f=Math.floor(u/3)+1;f+=i*4,s=f-a;break;case"weekday":var l=Math.round(n.difference(e,t,"day")),c=parseInt(n.difference(e,t,"week")),h=l%7;if(h==0)l=c*5;else{var p=0,d=e.getDay(),v=t.getDay();c=parseInt(l/7),h=l%7;var m=new Date(e);m.setDate(m.getDate()+c*7);var g=m.getDay();if(l>0)switch(!0){case d==6:p=-1;break;case d==0:p=0;break;case v==6:p=-1;break;case v==0:p=-2;break;case g+h>5:p=-2}else if(l<0)switch(!0){case d==6:p=0;break;case d==0:p=1;break;case v==6:p=2;break;case v==0:p=1;break;case g+h<0:p=2}l+=p,l-=c*2}s=l;break;case"year":s=i;break;case"month":s=t.getMonth()-e.getMonth()+i*12;break;case"week":s=parseInt(n.difference(e,t,"day")/7);break;case"day":s/=24;case"hour":s/=60;case"minute":s/=60;case"second":s/=1e3;case"millisecond":s*=t.getTime()-e.getTime()}return Math.round(s)},e("extend-dojo")&&t.mixin(t.getObject("dojo.date",!0),n),n}),pen.define("dojo/json",["./has"],function(has){var hasJSON=typeof JSON!="undefined";has.add("json-parse",hasJSON),has.add("json-stringify",hasJSON&&JSON.stringify({a:0},function(e,t){return t||1})=='{"a":1}');if(has("json-stringify"))return JSON;var escapeString=function(e){return('"'+e.replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")};return{parse:has("json-parse")?JSON.parse:function(str,strict){if(strict&&!/^([\s\[\{]*(?:"(?:\\.|[^"])*"|-?\d[\d\.]*(?:[Ee][+-]?\d+)?|null|true|false|)[\s\]\}]*(?:,|:|$))+$/.test(str))throw new SyntaxError("Invalid characters in JSON");return eval("("+str+")")},stringify:function(e,t,n){function i(e,s,o){t&&(e=t(o,e));var u,a=typeof e;if(a=="number")return isFinite(e)?e+"":"null";if(a=="boolean")return e+"";if(e===null)return"null";if(typeof e=="string")return escapeString(e);if(a=="function"||a=="undefined")return r;if(typeof e.toJSON=="function")return i(e.toJSON(o),s,o);if(e instanceof Date)return'"{FullYear}-{Month+}-{Date}T{Hours}:{Minutes}:{Seconds}Z"'.replace(/\{(\w+)(\+)?\}/g,function(t,n,r){var i=e["getUTC"+n]()+(r?1:0);return i<10?"0"+i:i});if(e.valueOf()!==e)return i(e.valueOf(),s,o);var f=n?s+n:"",l=n?" ":"",c=n?"\n":"";if(e instanceof Array){var h=e.length,p=[];for(o=0;o<h;o++){var d=e[o];u=i(d,f,o),typeof u!="string"&&(u="null"),p.push(c+f+u)}return"["+p.join(",")+c+s+"]"}var v=[];for(o in e){var m;if(e.hasOwnProperty(o)){if(typeof o=="number")m='"'+o+'"';else{if(typeof o!="string")continue;m=escapeString(o)}u=i(e[o],f,o);if(typeof u!="string")continue;v.push(c+f+m+":"+l+u)}}return"{"+v.join(",")+c+s+"}"}var r;return typeof t=="string"&&(n=t,t=null),i(e,"","")}}}),pen.define("dojo/i18n",["./_base/kernel","require","./has","./_base/array","./_base/config","./_base/lang","./has!host-browser?./_base/xhr","./json","module"],function(e,t,n,r,i,s,o,u,a){n.add("dojo-preload-i18n-Api",1),n.add("dojo-v1x-i18n-Api",1);var f=e.i18n={},l=/(^.*(^|\/)nls)(\/|$)([^\/]*)\/?([^\/]*)/,c=function(e,t,n,r){for(var i=[n+r],s=t.split("-"),o="",u=0;u<s.length;u++){o+=(o?"-":"")+s[u];if(!e||e[o])i.push(n+o+"/"+r),i.specificity=o}return i},h={},p=function(t,n,r){return r=r?r.toLowerCase():e.locale,t=t.replace(/\./g,"/"),n=n.replace(/\./g,"/"),/root/i.test(r)?t+"/nls/"+n:t+"/nls/"+r+"/"+n},d=e.getL10nName=function(e,t,n){return e=a.id+"!"+p(e,t,n)},v=function(e,t,n,r,i,o){e([t],function(u){var a=s.clone(u.root||u.ROOT),f=c(!u._v1x&&u,i,n,r);e(f,function(){for(var e=1;e<f.length;e++)a=s.mixin(s.clone(a),arguments[e]);var n=t+"/"+i;h[n]=a,a.$locale=f.specificity,o()})})},m=function(e,t){return/^\./.test(e)?t(e):e},g=function(e){var t=i.extraLocale||[];return t=s.isArray(t)?t:[t],t.push(e),t},y=function(t,i,o){if(n("dojo-preload-i18n-Api")){var a=t.split("*"),f=a[1]=="preload";f&&(h[t]||(h[t]=1,T(a[2],u.parse(a[3]),1,i)),o(1));if(f||N(t,i,o))return}var c=l.exec(t),p=c[1]+"/",d=c[5]||c[4],m=p+d,y=c[5]&&c[4],b=y||e.locale||"",w=m+"/"+b,E=y?[b]:g(b),S=E.length,x=function(){--S||o(s.delegate(h[w]))};r.forEach(E,function(e){var t=m+"/"+e;n("dojo-preload-i18n-Api")&&C(t),h[t]?x():v(i,m,p,d,e,x)})};if(n("dojo-unit-tests"))var b=f.unitTests=[];if(n("dojo-preload-i18n-Api")||n("dojo-v1x-i18n-Api"))var w=f.normalizeLocale=function(t){var n=t?t.toLowerCase():e.locale;return n=="root"?"ROOT":n},E=function(e,r){return n("dojo-sync-loader")&&n("dojo-v1x-i18n-Api")?r.isXdUrl(t.toUrl(e+".js")):!0},S=0,x=[],T=f._preloadLocalizations=function(n,i,s,o){function u(e,t){E(e,o)||s?o([e],t):A([e],t,o)}function a(e,t){var n=e.split("-");while(n.length){if(t(n.join("-")))return;n.pop()}t("ROOT")}function f(e){e=w(e),a(e,function(e){if(r.indexOf(i,e)>=0){var s=n.replace(/\./g,"/")+"_"+e;return S++,u(s,function(n){for(var r in n)h[t.toAbsMid(r)+"/"+e]=n[r];--S;while(!S&&x.length)y.apply(null,x.shift())}),!0}return!1})}o=o||t,f(),r.forEach(e.config.extraLocale,f)},N=function(e,t,n){return S&&x.push([e,t,n]),S},C=function(){};if(n("dojo-v1x-i18n-Api")){var k={},L=new Function("__bundle","__checkForLegacyModules","__mid","__amdValue","var define = function(mid, factory){define.called = 1; __amdValue.result = factory || mid;},	   require = function(){define.called = 1;};try{define.called = 0;eval(__bundle);if(define.called==1)return __amdValue;if((__checkForLegacyModules = __checkForLegacyModules(__mid)))return __checkForLegacyModules;}catch(e){}try{return eval('('+__bundle+')');}catch(e){return e;}"),A=function(e,t,n){var i=[];r.forEach(e,function(e){function r(n){var r=L(n,C,e,k);r===k?i.push(h[t]=k.result):(r instanceof Error&&(console.error("failed to evaluate i18n bundle; url="+t,r),r={}),i.push(h[t]=/nls\/[^\/]+\/[^\/]+$/.test(t)?r:{root:r,_v1x:1}))}var t=n.toUrl(e+".js");if(h[t])i.push(h[t]);else{var s=n.syncLoadNls(e);if(s)i.push(s);else if(!o)try{n.getText(t,!0,r)}catch(u){i.push(h[t]={})}else o.get({url:t,sync:!0,load:r,error:function(){i.push(h[t]={})}})}}),t&&t.apply(null,i)};C=function(t){for(var n,r=t.split("/"),i=e.global[r[0]],s=1;i&&s<r.length-1;i=i[r[s++]]);return i&&(n=i[r[s]],n||(n=i[r[s].replace(/-/g,"_")]),n&&(h[t]=n)),n},f.getLocalization=function(e,n,r){var i,s=p(e,n,r);return y(s,E(s,t)?t:function(e,n){A(e,n,t)},function(e){i=e}),i},n("dojo-unit-tests")&&b.push(function(e){e.register("tests.i18n.unit",function(e){var t;t=L("{prop:1}",C,"nonsense",k),e.is({prop:1},t),e.is(undefined,t[1]),t=L("({prop:1})",C,"nonsense",k),e.is({prop:1},t),e.is(undefined,t[1]),t=L("{'prop-x':1}",C,"nonsense",k),e.is({"prop-x":1},t),e.is(undefined,t[1]),t=L("({'prop-x':1})",C,"nonsense",k),e.is({"prop-x":1},t),e.is(undefined,t[1]),t=L("define({'prop-x':1})",C,"nonsense",k),e.is(k,t),e.is({"prop-x":1},k.result),t=L("define('some/module', {'prop-x':1})",C,"nonsense",k),e.is(k,t),e.is({"prop-x":1},k.result),t=L("this is total nonsense and should throw an error",C,"nonsense",k),e.is(t instanceof Error,!0)})})}return s.mixin(f,{dynamic:!0,normalize:m,load:y,cache:h,getL10nName:d})}),pen.define("dojo/cldr/supplemental",["../_base/lang","../i18n"],function(e,t){var n={};return e.setObject("dojo.cldr.supplemental",n),n.getFirstDayOfWeek=function(e){var t={bd:5,mv:5,ae:6,af:6,bh:6,dj:6,dz:6,eg:6,iq:6,ir:6,jo:6,kw:6,ly:6,ma:6,om:6,qa:6,sa:6,sd:6,sy:6,ye:6,ag:0,ar:0,as:0,au:0,br:0,bs:0,bt:0,bw:0,by:0,bz:0,ca:0,cn:0,co:0,dm:0,"do":0,et:0,gt:0,gu:0,hk:0,hn:0,id:0,ie:0,il:0,"in":0,jm:0,jp:0,ke:0,kh:0,kr:0,la:0,mh:0,mm:0,mo:0,mt:0,mx:0,mz:0,ni:0,np:0,nz:0,pa:0,pe:0,ph:0,pk:0,pr:0,py:0,sg:0,sv:0,th:0,tn:0,tt:0,tw:0,um:0,us:0,ve:0,vi:0,ws:0,za:0,zw:0},r=n._region(e),i=t[r];return i===undefined?1:i},n._region=function(e){e=t.normalizeLocale(e);var n=e.split("-"),r=n[1];return r?r.length==4&&(r=n[2]):r={aa:"et",ab:"ge",af:"za",ak:"gh",am:"et",ar:"eg",as:"in",av:"ru",ay:"bo",az:"az",ba:"ru",be:"by",bg:"bg",bi:"vu",bm:"ml",bn:"bd",bo:"cn",br:"fr",bs:"ba",ca:"es",ce:"ru",ch:"gu",co:"fr",cr:"ca",cs:"cz",cv:"ru",cy:"gb",da:"dk",de:"de",dv:"mv",dz:"bt",ee:"gh",el:"gr",en:"us",es:"es",et:"ee",eu:"es",fa:"ir",ff:"sn",fi:"fi",fj:"fj",fo:"fo",fr:"fr",fy:"nl",ga:"ie",gd:"gb",gl:"es",gn:"py",gu:"in",gv:"gb",ha:"ng",he:"il",hi:"in",ho:"pg",hr:"hr",ht:"ht",hu:"hu",hy:"am",ia:"fr",id:"id",ig:"ng",ii:"cn",ik:"us","in":"id",is:"is",it:"it",iu:"ca",iw:"il",ja:"jp",ji:"ua",jv:"id",jw:"id",ka:"ge",kg:"cd",ki:"ke",kj:"na",kk:"kz",kl:"gl",km:"kh",kn:"in",ko:"kr",ks:"in",ku:"tr",kv:"ru",kw:"gb",ky:"kg",la:"va",lb:"lu",lg:"ug",li:"nl",ln:"cd",lo:"la",lt:"lt",lu:"cd",lv:"lv",mg:"mg",mh:"mh",mi:"nz",mk:"mk",ml:"in",mn:"mn",mo:"ro",mr:"in",ms:"my",mt:"mt",my:"mm",na:"nr",nb:"no",nd:"zw",ne:"np",ng:"na",nl:"nl",nn:"no",no:"no",nr:"za",nv:"us",ny:"mw",oc:"fr",om:"et",or:"in",os:"ge",pa:"in",pl:"pl",ps:"af",pt:"br",qu:"pe",rm:"ch",rn:"bi",ro:"ro",ru:"ru",rw:"rw",sa:"in",sd:"in",se:"no",sg:"cf",si:"lk",sk:"sk",sl:"si",sm:"ws",sn:"zw",so:"so",sq:"al",sr:"rs",ss:"za",st:"za",su:"id",sv:"se",sw:"tz",ta:"in",te:"in",tg:"tj",th:"th",ti:"et",tk:"tm",tl:"ph",tn:"za",to:"to",tr:"tr",ts:"za",tt:"ru",ty:"pf",ug:"cn",uk:"ua",ur:"pk",uz:"uz",ve:"za",vi:"vn",wa:"be",wo:"sn",xh:"za",yi:"il",yo:"ng",za:"cn",zh:"cn",zu:"za",ace:"id",ady:"ru",agq:"cm",alt:"ru",amo:"ng",asa:"tz",ast:"es",awa:"in",bal:"pk",ban:"id",bas:"cm",bax:"cm",bbc:"id",bem:"zm",bez:"tz",bfq:"in",bft:"pk",bfy:"in",bhb:"in",bho:"in",bik:"ph",bin:"ng",bjj:"in",bku:"ph",bqv:"ci",bra:"in",brx:"in",bss:"cm",btv:"pk",bua:"ru",buc:"yt",bug:"id",bya:"id",byn:"er",cch:"ng",ccp:"in",ceb:"ph",cgg:"ug",chk:"fm",chm:"ru",chp:"ca",chr:"us",cja:"kh",cjm:"vn",ckb:"iq",crk:"ca",csb:"pl",dar:"ru",dav:"ke",den:"ca",dgr:"ca",dje:"ne",doi:"in",dsb:"de",dua:"cm",dyo:"sn",dyu:"bf",ebu:"ke",efi:"ng",ewo:"cm",fan:"gq",fil:"ph",fon:"bj",fur:"it",gaa:"gh",gag:"md",gbm:"in",gcr:"gf",gez:"et",gil:"ki",gon:"in",gor:"id",grt:"in",gsw:"ch",guz:"ke",gwi:"ca",haw:"us",hil:"ph",hne:"in",hnn:"ph",hoc:"in",hoj:"in",ibb:"ng",ilo:"ph",inh:"ru",jgo:"cm",jmc:"tz",kaa:"uz",kab:"dz",kaj:"ng",kam:"ke",kbd:"ru",kcg:"ng",kde:"tz",kdt:"th",kea:"cv",ken:"cm",kfo:"ci",kfr:"in",kha:"in",khb:"cn",khq:"ml",kht:"in",kkj:"cm",kln:"ke",kmb:"ao",koi:"ru",kok:"in",kos:"fm",kpe:"lr",krc:"ru",kri:"sl",krl:"ru",kru:"in",ksb:"tz",ksf:"cm",ksh:"de",kum:"ru",lag:"tz",lah:"pk",lbe:"ru",lcp:"cn",lep:"in",lez:"ru",lif:"np",lis:"cn",lki:"ir",lmn:"in",lol:"cd",lua:"cd",luo:"ke",luy:"ke",lwl:"th",mad:"id",mag:"in",mai:"in",mak:"id",man:"gn",mas:"ke",mdf:"ru",mdh:"ph",mdr:"id",men:"sl",mer:"ke",mfe:"mu",mgh:"mz",mgo:"cm",min:"id",mni:"in",mnk:"gm",mnw:"mm",mos:"bf",mua:"cm",mwr:"in",myv:"ru",nap:"it",naq:"na",nds:"de","new":"np",niu:"nu",nmg:"cm",nnh:"cm",nod:"th",nso:"za",nus:"sd",nym:"tz",nyn:"ug",pag:"ph",pam:"ph",pap:"bq",pau:"pw",pon:"fm",prd:"ir",raj:"in",rcf:"re",rej:"id",rjs:"np",rkt:"in",rof:"tz",rwk:"tz",saf:"gh",sah:"ru",saq:"ke",sas:"id",sat:"in",saz:"in",sbp:"tz",scn:"it",sco:"gb",sdh:"ir",seh:"mz",ses:"ml",shi:"ma",shn:"mm",sid:"et",sma:"se",smj:"se",smn:"fi",sms:"fi",snk:"ml",srn:"sr",srr:"sn",ssy:"er",suk:"tz",sus:"gn",swb:"yt",swc:"cd",syl:"bd",syr:"sy",tbw:"ph",tcy:"in",tdd:"cn",tem:"sl",teo:"ug",tet:"tl",tig:"er",tiv:"ng",tkl:"tk",tmh:"ne",tpi:"pg",trv:"tw",tsg:"ph",tts:"th",tum:"mw",tvl:"tv",twq:"ne",tyv:"ru",tzm:"ma",udm:"ru",uli:"fm",umb:"ao",unr:"in",unx:"in",vai:"lr",vun:"tz",wae:"ch",wal:"et",war:"ph",xog:"ug",xsr:"np",yao:"mz",yap:"fm",yav:"cm",zza:"tr"}[n[0]],r},n.getWeekend=function(e){var t={"in":0,af:4,dz:4,ir:4,om:4,sa:4,ye:4,ae:5,bh:5,eg:5,il:5,iq:5,jo:5,kw:5,ly:5,ma:5,qa:5,sd:5,sy:5,tn:5},r={af:5,dz:5,ir:5,om:5,sa:5,ye:5,ae:6,bh:5,eg:6,il:6,iq:6,jo:6,kw:6,ly:6,ma:6,qa:6,sd:6,sy:6,tn:6},i=n._region(e),s=t[i],o=r[i];return s===undefined&&(s=6),o===undefined&&(o=0),{start:s,end:o}},n}),pen.define("dojo/string",["./_base/kernel","./_base/lang"],function(e,t){var n={};return t.setObject("dojo.string",n),n.rep=function(e,t){if(t<=0||!e)return"";var n=[];for(;;){t&1&&n.push(e);if(!(t>>=1))break;e+=e}return n.join("")},n.pad=function(e,t,r,i){r||(r="0");var s=String(e),o=n.rep(r,Math.ceil((t-s.length)/r.length));return i?s+o:o+s},n.substitute=function(n,r,i,s){return s=s||e.global,i=i?t.hitch(s,i):function(e){return e},n.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(e,n,o){var u=t.getObject(n,!1,r);return o&&(u=t.getObject(o,!1,s).call(s,u,n)),i(u,n).toString()})},n.trim=String.prototype.trim?t.trim:function(e){e=e.replace(/^\s+/,"");for(var t=e.length-1;t>=0;t--)if(/\S/.test(e.charAt(t))){e=e.substring(0,t+1);break}return e},n}),pen.define("dojo/text!dijit/templates/Calendar.html",[],function(){return'<table cellspacing="0" cellpadding="0" class="dijitCalendarContainer" role="grid" aria-labelledby="${id}_mddb ${id}_year" data-dojo-attach-point="gridNode">\n	<thead>\n		<tr class="dijitReset dijitCalendarMonthContainer" valign="top">\n			<th class=\'dijitReset dijitCalendarArrow\' data-dojo-attach-point="decrementMonth" scope="col">\n				<span class="dijitInline dijitCalendarIncrementControl dijitCalendarDecrease" role="presentation"></span>\n				<span data-dojo-attach-point="decreaseArrowNode" class="dijitA11ySideArrow">-</span>\n			</th>\n			<th class=\'dijitReset\' colspan="5" scope="col">\n				<div data-dojo-attach-point="monthNode">\n				</div>\n			</th>\n			<th class=\'dijitReset dijitCalendarArrow\' scope="col" data-dojo-attach-point="incrementMonth">\n				<span class="dijitInline dijitCalendarIncrementControl dijitCalendarIncrease" role="presentation"></span>\n				<span data-dojo-attach-point="increaseArrowNode" class="dijitA11ySideArrow">+</span>\n			</th>\n		</tr>\n		<tr role="row">\n			${!dayCellsHtml}\n		</tr>\n	</thead>\n	<tbody data-dojo-attach-point="dateRowsNode" data-dojo-attach-event="ondijitclick: _onDayClick" class="dijitReset dijitCalendarBodyContainer">\n			${!dateRowsHtml}\n	</tbody>\n	<tfoot class="dijitReset dijitCalendarYearContainer">\n		<tr>\n			<td class=\'dijitReset\' valign="top" colspan="7" role="presentation">\n				<div class="dijitCalendarYearLabel">\n					<span data-dojo-attach-point="previousYearLabelNode" class="dijitInline dijitCalendarPreviousYear" role="button"></span>\n					<span data-dojo-attach-point="currentYearLabelNode" class="dijitInline dijitCalendarSelectedYear" role="button" id="${id}_year"></span>\n					<span data-dojo-attach-point="nextYearLabelNode" class="dijitInline dijitCalendarNextYear" role="button"></span>\n				</div>\n			</td>\n		</tr>\n	</tfoot>\n</table>\n'}),pen.define("dijit/CalendarLite",["dojo/_base/array","dojo/_base/declare","dojo/cldr/supplemental","dojo/date","dojo/date/locale","dojo/date/stamp","dojo/dom","dojo/dom-class","dojo/_base/lang","dojo/on","dojo/sniff","dojo/string","./_WidgetBase","./_TemplatedMixin","dojo/text!./templates/Calendar.html","./a11yclick","./hccss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v=t("dijit.CalendarLite",[h,p],{templateString:d,dowTemplateString:'<th class="dijitReset dijitCalendarDayLabelTemplate" role="columnheader" scope="col"><span class="dijitCalendarDayLabel">${d}</span></th>',dateTemplateString:'<td class="dijitReset" role="gridcell" data-dojo-attach-point="dateCells"><span class="dijitCalendarDateLabel" data-dojo-attach-point="dateLabels"></span></td>',weekTemplateString:'<tr class="dijitReset dijitCalendarWeekTemplate" role="row">${d}${d}${d}${d}${d}${d}${d}</tr>',value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar",_isValidDate:function(e){return e&&!isNaN(e)&&typeof e=="object"&&e.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var e=this._get("value");if(e&&!isNaN(e)){var t=new this.dateClassObj(e);return t.setHours(0,0,0,0),t.getDate()<e.getDate()&&(t=this.dateModule.add(t,"hour",1)),t}return null},_setValueAttr:function(e,t){typeof e=="string"&&(e=s.fromISOString(e)),e=this._patchDate(e),this._isValidDate(e)&&!this.isDisabledDate(e,this.lang)?(this._set("value",e),this.set("currentFocus",e),this._markSelectedDates([e]),this._created&&(t||typeof t=="undefined")&&this.onChange(this.get("value"))):(this._set("value",null),this._markSelectedDates([]))},_patchDate:function(e){return e&&(e=new this.dateClassObj(e),e.setHours(1,0,0,0)),e},_setText:function(e,t){while(e.firstChild)e.removeChild(e.firstChild);e.appendChild(e.ownerDocument.createTextNode(t))},_populateGrid:function(){var t=new this.dateClassObj(this.currentFocus);t.setDate(1);var r=t.getDay(),i=this.dateModule.getDaysInMonth(t),s=this.dateModule.getDaysInMonth(this.dateModule.add(t,"month",-1)),o=new this.dateClassObj,u=n.getFirstDayOfWeek(this.lang);u>r&&(u-=7);if(!this.summary){var a=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,t);this.gridNode.setAttribute("summary",a[t.getMonth()])}this._date2cell={},e.forEach(this.dateCells,function(e,n){var a=n+u,f=new this.dateClassObj(t),l,c="dijitCalendar",h=0;a<r?(l=s-r+a+1,h=-1,c+="Previous"):a>=r+i?(l=a-r-i+1,h=1,c+="Next"):(l=a-r+1,c+="Current"),h&&(f=this.dateModule.add(f,"month",h)),f.setDate(l),this.dateModule.compare(f,o,"date")||(c="dijitCalendarCurrentDate "+c),this.isDisabledDate(f,this.lang)?(c="dijitCalendarDisabledDate "+c,e.setAttribute("aria-disabled","true")):(c="dijitCalendarEnabledDate "+c,e.removeAttribute("aria-disabled"),e.setAttribute("aria-selected","false"));var p=this.getClassForDate(f,this.lang);p&&(c=p+" "+c),e.className=c+"Month dijitCalendarDateTemplate";var d=f.valueOf();this._date2cell[d]=e,e.dijitDateValue=d,this._setText(this.dateLabels[n],f.getDateLocalized?f.getDateLocalized(this.lang):f.getDate())},this)},_populateControls:function(){var t=new this.dateClassObj(this.currentFocus);t.setDate(1),this.monthWidget.set("month",t);var n=t.getFullYear()-1,r=new this.dateClassObj;e.forEach(["previous","current","next"],function(e){r.setFullYear(n++),this._setText(this[e+"YearLabelNode"],this.dateLocaleModule.format(r,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(e){this.dateModule=e.datePackage?a.getObject(e.datePackage,!1):r,this.dateClassObj=this.dateModule.Date||Date,this.dateLocaleModule=e.datePackage?a.getObject(e.datePackage+".locale",!1):i},_createMonthWidget:function(){return v._MonthWidget({id:this.id+"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var e=this.dowTemplateString,t=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),r=n.getFirstDayOfWeek(this.lang);this.dayCellsHtml=c.substitute([e,e,e,e,e,e,e].join(""),{d:""},function(){return t[r++%7]});var i=c.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[i,i,i,i,i,i].join(""),this.dateCells=[],this.dateLabels=[],this.inherited(arguments),o.setSelectable(this.domNode,!1);var s=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget(),this.set("currentFocus",s,!1)},postCreate:function(){this.inherited(arguments),this._connectControls()},_connectControls:function(){var e=a.hitch(this,function(e,t,n){return f(this[e],"click",a.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,t,n))}))});this.own(e("incrementMonth","month",1),e("decrementMonth","month",-1),e("nextYearLabelNode","year",1),e("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(e,t){var n=this.currentFocus,r=this._getNodeByDate(n);e=this._patchDate(e),this._set("currentFocus",e);if(!this._date2cell||this.dateModule.difference(n,e,"month")!=0)this._populateGrid(),this._populateControls(),this._markSelectedDates([this.value]);var i=this._getNodeByDate(e);i.setAttribute("tabIndex",this.tabIndex),(this.focused||t)&&i.focus(),r&&r!=i&&(l("webkit")?r.setAttribute("tabIndex","-1"):r.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(e){e.stopPropagation(),e.preventDefault();for(var t=e.target;t&&!t.dijitDateValue;t=t.parentNode);t&&!u.contains(t,"dijitCalendarDisabledDate")&&this.set("value",t.dijitDateValue)},_getNodeByDate:function(e){return e=this._patchDate(e),e&&this._date2cell?this._date2cell[e.valueOf()]:null},_markSelectedDates:function(t){function n(e,t){u.toggle(t,"dijitCalendarSelectedDate",e),t.setAttribute("aria-selected",e?"true":"false")}e.forEach(this._selectedCells||[],a.partial(n,!1)),this._selectedCells=e.filter(e.map(t,this._getNodeByDate,this),function(e){return e}),e.forEach(this._selectedCells,a.partial(n,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});return v._MonthWidget=t("dijit.CalendarLite._MonthWidget",h,{_setMonthAttr:function(t){var n=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,t),r=l("ie")==6?"":"<div class='dijitSpacer'>"+e.map(n,function(e){return"<div>"+e+"</div>"}).join("")+"</div>";this.domNode.innerHTML=r+"<div class='dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'>"+n[t.getMonth()]+"</div>"}}),v}),pen.define("dijit/Viewport",["dojo/Evented","dojo/on","dojo/domReady","dojo/sniff","dojo/window"],function(e,t,n,r,i){var s=new e,o;return n(function(){var e=i.getBox();s._rlh=t(window,"resize",function(){var t=i.getBox();if(e.h==t.h&&e.w==t.w)return;e=t,s.emit("resize")});if(r("ie")==8){var n=screen.deviceXDPI;setInterval(function(){screen.deviceXDPI!=n&&(n=screen.deviceXDPI,s.emit("resize"))},500)}r("ios")&&(t(document,"focusin",function(e){o=e.target}),t(document,"focusout",function(e){o=null}))}),s.getEffectiveBox=function(e){var t=i.getBox(e),n=o&&o.tagName&&o.tagName.toLowerCase();if(r("ios")&&o&&!o.readOnly&&(n=="textarea"||n=="input"&&/^(color|email|number|password|search|tel|text|url)$/.test(o.type))){t.h*=orientation==0||orientation==180?.66:.4;var s=o.getBoundingClientRect();t.h=Math.max(t.h,s.top+s.height)}return t},s}),pen.define("dijit/place",["dojo/_base/array","dojo/dom-geometry","dojo/dom-style","dojo/_base/kernel","dojo/_base/window","./Viewport","./main"],function(e,t,n,r,i,s,o){function u(r,o,u,a){var f=s.getEffectiveBox(r.ownerDocument);(!r.parentNode||String(r.parentNode.tagName).toLowerCase()!="body")&&i.body(r.ownerDocument).appendChild(r);var l=null;e.some(o,function(e){var n=e.corner,i=e.pos,s=0,o={w:{L:f.l+f.w-i.x,R:i.x-f.l,M:f.w}[n.charAt(1)],h:{T:f.t+f.h-i.y,B:i.y-f.t,M:f.h}[n.charAt(0)]},c=r.style;c.left=c.right="auto";if(u){var h=u(r,e.aroundCorner,n,o,a);s=typeof h=="undefined"?0:h}var p=r.style,d=p.display,v=p.visibility;p.display=="none"&&(p.visibility="hidden",p.display="");var m=t.position(r);p.display=d,p.visibility=v;var g={L:i.x,R:i.x-m.w,M:Math.max(f.l,Math.min(f.l+f.w,i.x+(m.w>>1))-m.w)}[n.charAt(1)],y={T:i.y,B:i.y-m.h,M:Math.max(f.t,Math.min(f.t+f.h,i.y+(m.h>>1))-m.h)}[n.charAt(0)],b=Math.max(f.l,g),w=Math.max(f.t,y),E=Math.min(f.l+f.w,g+m.w),S=Math.min(f.t+f.h,y+m.h),x=E-b,T=S-w;s+=m.w-x+(m.h-T);if(l==null||s<l.overflow)l={corner:n,aroundCorner:e.aroundCorner,x:b,y:w,w:x,h:T,overflow:s,spaceAvailable:o};return!s}),l.overflow&&u&&u(r,l.aroundCorner,l.corner,l.spaceAvailable,a);var c=t.isBodyLtr(r.ownerDocument),h=l.y,p=c?l.x:f.w-l.x-l.w;/relative|absolute/.test(n.get(i.body(r.ownerDocument),"position"))&&(h-=n.get(i.body(r.ownerDocument),"marginTop"),p-=(c?1:-1)*n.get(i.body(r.ownerDocument),c?"marginLeft":"marginRight"));var d=r.style;return d.top=h+"px",d[c?"left":"right"]=p+"px",d[c?"right":"left"]="auto",l}var a={TL:"BR",TR:"BL",BL:"TR",BR:"TL"},f={at:function(t,n,r,i,s){var o=e.map(r,function(e){var t={corner:e,aroundCorner:a[e],pos:{x:n.x,y:n.y}};return i&&(t.pos.x+=e.charAt(1)=="L"?i.x:-i.x,t.pos.y+=e.charAt(0)=="T"?i.y:-i.y),t});return u(t,o,s)},around:function(i,s,o,a,f){function C(e,t){N.push({aroundCorner:e,corner:t,pos:{x:{L:E,R:E+x,M:E+(x>>1)}[e.charAt(1)],y:{T:S,B:S+T,M:S+(T>>1)}[e.charAt(0)]}})}var l;if(typeof s=="string"||"offsetWidth"in s){l=t.position(s,!0);if(/^(above|below)/.test(o[0])){var c=t.getBorderExtents(s),h=s.firstChild?t.getBorderExtents(s.firstChild):{t:0,l:0,b:0,r:0},p=t.getBorderExtents(i),d=i.firstChild?t.getBorderExtents(i.firstChild):{t:0,l:0,b:0,r:0};l.y+=Math.min(c.t+h.t,p.t+d.t),l.h-=Math.min(c.t+h.t,p.t+d.t)+Math.min(c.b+h.b,p.b+d.b)}}else l=s;if(s.parentNode){var v=n.getComputedStyle(s).position=="absolute",m=s.parentNode;while(m&&m.nodeType==1&&m.nodeName!="BODY"){var g=t.position(m,!0),y=n.getComputedStyle(m);/relative|absolute/.test(y.position)&&(v=!1);if(!v&&/hidden|auto|scroll/.test(y.overflow)){var b=Math.min(l.y+l.h,g.y+g.h),w=Math.min(l.x+l.w,g.x+g.w);l.x=Math.max(l.x,g.x),l.y=Math.max(l.y,g.y),l.h=b-l.y,l.w=w-l.x}y.position=="absolute"&&(v=!0),m=m.parentNode}}var E=l.x,S=l.y,x="w"in l?l.w:l.w=l.width,T="h"in l?l.h:(r.deprecated("place.around: dijit/place.__Rectangle: { x:"+E+", y:"+S+", height:"+l.height+", width:"+x+" } has been deprecated.  Please use { x:"+E+", y:"+S+", h:"+l.height+", w:"+x+" }","","2.0"),l.h=l.height),N=[];e.forEach(o,function(e){var t=a;switch(e){case"above-centered":C("TM","BM");break;case"below-centered":C("BM","TM");break;case"after-centered":t=!t;case"before-centered":C(t?"ML":"MR",t?"MR":"ML");break;case"after":t=!t;case"before":C(t?"TL":"TR",t?"TR":"TL"),C(t?"BL":"BR",t?"BR":"BL");break;case"below-alt":t=!t;case"below":C(t?"BL":"BR",t?"TL":"TR"),C(t?"BR":"BL",t?"TR":"TL");break;case"above-alt":t=!t;case"above":C(t?"TL":"TR",t?"BL":"BR"),C(t?"TR":"TL",t?"BR":"BL");break;default:C(e.aroundCorner,e.corner)}});var k=u(i,N,f,{w:x,h:T});return k.aroundNodePos=l,k}};return o.place=f}),pen.define("dijit/BackgroundIframe",["require","./main","dojo/_base/config","dojo/dom-construct","dojo/dom-style","dojo/_base/lang","dojo/on","dojo/sniff"],function(e,t,n,r,i,s,o,u){u.add("config-bgIframe",!u("touch"));var a=new function(){var t=[];this.pop=function(){var s;if(t.length)s=t.pop(),s.style.display="";else{if(u("ie")<9){var o=n.dojoBlankHtmlUrl||e.toUrl("dojo/resources/blank.html")||'javascript:""',a="<iframe src='"+o+"' role='presentation'"+" style='position: absolute; left: 0px; top: 0px;"+'z-index: -1; filter:Alpha(Opacity="0");\'>';s=document.createElement(a)}else s=r.create("iframe"),s.src='javascript:""',s.className="dijitBackgroundIframe",s.setAttribute("role","presentation"),i.set(s,"opacity",.1);s.tabIndex=-1}return s},this.push=function(e){e.style.display="none",t.push(e)}};return t.BackgroundIframe=function(e){if(!e.id)throw new Error("no id");if(u("config-bgIframe")){var t=this.iframe=a.pop();e.appendChild(t),u("ie")<7||u("quirks")?(this.resize(e),this._conn=o(e,"resize",s.hitch(this,"resize",e))):i.set(t,{width:"100%",height:"100%"})}},s.extend(t.BackgroundIframe,{resize:function(e){this.iframe&&i.set(this.iframe,{width:e.offsetWidth+"px",height:e.offsetHeight+"px"})},destroy:function(){this._conn&&(this._conn.remove(),this._conn=null),this.iframe&&(a.push(this.iframe),delete this.iframe)}}),t.BackgroundIframe}),pen.define("dijit/popup",["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/has","dojo/keys","dojo/_base/lang","dojo/on","./place","./BackgroundIframe","./Viewport","./main"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){function m(){this._popupWrapper&&(s.destroy(this._popupWrapper),delete this._popupWrapper)}var g=n(null,{_stack:[],_beginZIndex:1e3,_idGen:1,_repositionAll:function(){if(this._firstAroundNode){var e=this._firstAroundPosition,t=o.position(this._firstAroundNode,!0),n=t.x-e.x,r=t.y-e.y;if(n||r){this._firstAroundPosition=t;for(var i=0;i<this._stack.length;i++){var s=this._stack[i].wrapper.style;s.top=parseInt(s.top,10)+r+"px",s.right=="auto"?s.left=parseInt(s.left,10)+n+"px":s.right=parseInt(s.right,10)-n+"px"}}this._aroundMoveListener=setTimeout(l.hitch(this,"_repositionAll"),n||r?10:50)}},_createWrapper:function(e){var n=e._popupWrapper,r=e.domNode;if(!n){n=s.create("div",{"class":"dijitPopup",style:{display:"none"},role:"region","aria-label":e["aria-label"]||e.label||e.name||e.id},e.ownerDocumentBody),n.appendChild(r);var i=r.style;i.display="",i.visibility="",i.position="",i.top="0px",e._popupWrapper=n,t.after(e,"destroy",m,!0)}return n},moveOffScreen:function(e){var t=this._createWrapper(e),n=o.isBodyLtr(e.ownerDocument),r={visibility:"hidden",top:"-9999px",display:""};return r[n?"left":"right"]="-9999px",r[n?"right":"left"]="auto",u.set(t,r),t},hide:function(e){var t=this._createWrapper(e);u.set(t,{display:"none",height:"auto",overflow:"visible",border:""});var n=e.domNode;"_originalStyle"in n&&(n.style.cssText=n._originalStyle)},getTopPopup:function(){var e=this._stack;for(var t=e.length-1;t>0&&e[t].parent===e[t-1].widget;t--);return e[t]},open:function(e){var t=this._stack,n=e.popup,s=n.domNode,v=e.orient||["below","below-alt","above","above-alt"],m=e.parent?e.parent.isLeftToRight():o.isBodyLtr(n.ownerDocument),g=e.around,y=e.around&&e.around.id?e.around.id+"_dropdown":"popup_"+this._idGen++;while(t.length&&(!e.parent||!r.isDescendant(e.parent.domNode,t[t.length-1].widget.domNode)))this.close(t[t.length-1].widget);var b=this.moveOffScreen(n);n.startup&&!n._started&&n.startup();var w,E=o.position(s);if("maxHeight"in e&&e.maxHeight!=-1)w=e.maxHeight||Infinity;else{var S=d.getEffectiveBox(this.ownerDocument),x=g?o.position(g,!1):{y:e.y-(e.padding||0),h:(e.padding||0)*2};w=Math.floor(Math.max(x.y,S.h-(x.y+x.h)))}if(E.h>w){var T=u.getComputedStyle(s),N=T.borderLeftWidth+" "+T.borderLeftStyle+" "+T.borderLeftColor;u.set(b,{overflowY:"scroll",height:w+"px",border:N}),s._originalStyle=s.style.cssText,s.style.border="none"}i.set(b,{id:y,style:{zIndex:this._beginZIndex+t.length},"class":"dijitPopup "+(n.baseClass||n["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:e.parent?e.parent.id:""}),t.length==0&&g&&(this._firstAroundNode=g,this._firstAroundPosition=o.position(g,!0),this._aroundMoveListener=setTimeout(l.hitch(this,"_repositionAll"),50)),a("config-bgIframe")&&!n.bgIframe&&(n.bgIframe=new p(b));var C=n.orient?l.hitch(n,"orient"):null,k=g?h.around(b,g,v,m,C):h.at(b,e,v=="R"?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],e.padding,C);b.style.visibility="visible",s.style.visibility="visible";var L=[];return L.push(c(b,"keydown",l.hitch(this,function(t){if(t.keyCode==f.ESCAPE&&e.onCancel)t.stopPropagation(),t.preventDefault(),e.onCancel();else if(t.keyCode==f.TAB){t.stopPropagation(),t.preventDefault();var n=this.getTopPopup();n&&n.onCancel&&n.onCancel()}}))),n.onCancel&&e.onCancel&&L.push(n.on("cancel",e.onCancel)),L.push(n.on(n.onExecute?"execute":"change",l.hitch(this,function(){var e=this.getTopPopup();e&&e.onExecute&&e.onExecute()}))),t.push({widget:n,wrapper:b,parent:e.parent,onExecute:e.onExecute,onCancel:e.onCancel,onClose:e.onClose,handlers:L}),n.onOpen&&n.onOpen(k),k},close:function(t){var n=this._stack;while(t&&e.some(n,function(e){return e.widget==t})||!t&&n.length){var r=n.pop(),i=r.widget,s=r.onClose;i.onClose&&i.onClose();var o;while(o=r.handlers.pop())o.remove();i&&i.domNode&&this.hide(i),s&&s()}n.length==0&&this._aroundMoveListener&&(clearTimeout(this._aroundMoveListener),this._firstAroundNode=this._firstAroundPosition=this._aroundMoveListener=null)}});return v.popup=new g}),pen.define("dijit/_Container",["dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/_base/kernel"],function(e,t,n,r){return t("dijit._Container",null,{buildRendering:function(){this.inherited(arguments),this.containerNode||(this.containerNode=this.domNode)},addChild:function(e,t){var r=this.containerNode;if(t>0){r=r.firstChild;while(t>0)r.nodeType==1&&t--,r=r.nextSibling;r?t="before":(r=this.containerNode,t="last")}n.place(e.domNode,r,t),this._started&&!e._started&&e.startup()},removeChild:function(e){typeof e=="number"&&(e=this.getChildren()[e]);if(e){var t=e.domNode;t&&t.parentNode&&t.parentNode.removeChild(t)}},hasChildren:function(){return this.getChildren().length>0},_getSiblingOfChild:function(t,n){r.deprecated(this.declaredClass+"::_getSiblingOfChild() is deprecated. Use _KeyNavMixin::_getNext() instead.","","2.0");var i=this.getChildren(),s=e.indexOf(i,t);return i[s+n]},getIndexOfChild:function(t){return e.indexOf(this.getChildren(),t)}})}),pen.define("dojo/_base/Deferred",["./kernel","../Deferred","../promise/Promise","../errors/CancelError","../has","./lang","../when"],function(e,t,n,r,i,s,o){var u=function(){},a=Object.freeze||function(){},f=e.Deferred=function(e){function g(e){if(l)throw new Error("This deferred has already been resolved");o=e,l=!0,y()}function y(){var e;while(!e&&v){var n=v;v=v.next;if(e=n.progress==u)l=!1;var r=p?n.error:n.resolved;i("config-useDeferredInstrumentation")&&p&&t.instrumentRejected&&t.instrumentRejected(o,!!r);if(r)try{var a=r(o);if(a&&typeof a.then=="function"){a.then(s.hitch(n.deferred,"resolve"),s.hitch(n.deferred,"reject"),s.hitch(n.deferred,"progress"));continue}var f=e&&a===undefined;e&&!f&&(p=a instanceof Error),n.deferred[f&&p?"reject":"resolve"](f?o:a)}catch(c){n.deferred.reject(c)}else p?n.deferred.reject(o):n.deferred.resolve(o)}}var o,l,c,h,p,d,v,m=this.promise=new n;this.isResolved=m.isResolved=function(){return h==0},this.isRejected=m.isRejected=function(){return h==1},this.isFulfilled=m.isFulfilled=function(){return h>=0},this.isCanceled=m.isCanceled=function(){return c},this.resolve=this.callback=function(e){this.fired=h=0,this.results=[e,null],g(e)},this.reject=this.errback=function(e){p=!0,this.fired=h=1,i("config-useDeferredInstrumentation")&&t.instrumentRejected&&t.instrumentRejected(e,!!v),g(e),this.results=[null,e]},this.progress=function(e){var t=v;while(t){var n=t.progress;n&&n(e),t=t.next}},this.addCallbacks=function(e,t){return this.then(e,t,u),this},m.then=this.then=function(e,t,n){var r=n==u?this:new f(m.cancel),i={resolved:e,error:t,progress:n,deferred:r};return v?d=d.next=i:v=d=i,l&&y(),r.promise};var b=this;m.cancel=this.cancel=function(){if(!l){var t=e&&e(b);l||(t instanceof Error||(t=new r(t)),t.log=!1,b.reject(t))}c=!0},a(m)};return s.extend(f,{addCallback:function(t){return this.addCallbacks(s.hitch.apply(e,arguments))},addErrback:function(t){return this.addCallbacks(null,s.hitch.apply(e,arguments))},addBoth:function(t){var n=s.hitch.apply(e,arguments);return this.addCallbacks(n,n)},fired:-1}),f.when=e.when=o,f}),pen.define("dijit/_HasDropDown",["dojo/_base/declare","dojo/_base/Deferred","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/has","dojo/keys","dojo/_base/lang","dojo/on","dojo/touch","./registry","./focus","./popup","./_FocusMixin"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){return e("dijit._HasDropDown",v,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:!0,forceWidth:!1,maxHeight:-1,dropDownPosition:["below","above"],_stopClickEvents:!0,_onDropDownMouseDown:function(e){if(this.disabled||this.readOnly)return;e.type!="MSPointerDown"&&e.type!="pointerdown"&&e.preventDefault(),this._docHandler=this.own(l(this.ownerDocument,c.release,f.hitch(this,"_onDropDownMouseUp")))[0],this.toggleDropDown()},_onDropDownMouseUp:function(e){e&&this._docHandler&&(this._docHandler.remove(),this._docHandler=null);var t=this.dropDown,n=!1;if(e&&this._opened){var r=s.position(this._buttonNode,!0);if(!(e.pageX>=r.x&&e.pageX<=r.x+r.w)||!(e.pageY>=r.y&&e.pageY<=r.y+r.h)){var o=e.target;while(o&&!n)i.contains(o,"dijitPopup")?n=!0:o=o.parentNode;if(n){o=e.target;if(t.onItemClick){var u;while(o&&!(u=h.byNode(o)))o=o.parentNode;u&&u.onClick&&u.getParent&&u.getParent().onItemClick(u,e)}return}}}this._opened?t.focus&&(t.autoFocus!==!1||e.type=="mouseup"&&!this.hovering)&&(this._focusDropDownTimer=this.defer(function(){t.focus(),delete this._focusDropDownTimer})):this.focus&&this.defer("focus")},_onDropDownClick:function(e){this._stopClickEvents&&(e.stopPropagation(),e.preventDefault())},buildRendering:function(){this.inherited(arguments),this._buttonNode=this._buttonNode||this.focusNode||this.domNode,this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;var e={after:this.isLeftToRight()?"Right":"Left",before:this.isLeftToRight()?"Left":"Right",above:"Up",below:"Down",left:"Left",right:"Right"}[this.dropDownPosition[0]]||this.dropDownPosition[0]||"Down";i.add(this._arrowWrapperNode||this._buttonNode,"dijit"+e+"ArrowButton")},postCreate:function(){this.inherited(arguments);var e=this.focusNode||this.domNode;this.own(l(this._buttonNode,c.press,f.hitch(this,"_onDropDownMouseDown")),l(this._buttonNode,"click",f.hitch(this,"_onDropDownClick")),l(e,"keydown",f.hitch(this,"_onKey")),l(e,"keyup",f.hitch(this,"_onKeyUp")))},destroy:function(){this.dropDown&&(this.dropDown._destroyed||this.dropDown.destroyRecursive(),delete this.dropDown),this.inherited(arguments)},_onKey:function(e){if(this.disabled||this.readOnly)return;var t=this.dropDown,n=e.target;if(t&&this._opened&&t.handleKey&&t.handleKey(e)===!1){e.stopPropagation(),e.preventDefault();return}t&&this._opened&&e.keyCode==a.ESCAPE?(this.closeDropDown(),e.stopPropagation(),e.preventDefault()):!this._opened&&(e.keyCode==a.DOWN_ARROW||(e.keyCode==a.ENTER||e.keyCode==a.SPACE&&(!this._searchTimer||e.ctrlKey||e.altKey||e.metaKey))&&((n.tagName||"").toLowerCase()!=="input"||n.type&&n.type.toLowerCase()!=="text"))&&(this._toggleOnKeyUp=!0,e.stopPropagation(),e.preventDefault())},_onKeyUp:function(){if(this._toggleOnKeyUp){delete this._toggleOnKeyUp,this.toggleDropDown();var e=this.dropDown;e&&e.focus&&this.defer(f.hitch(e,"focus"),1)}},_onBlur:function(){this.closeDropDown(!1),this.inherited(arguments)},isLoaded:function(){return!0},loadDropDown:function(e){e()},loadAndOpenDropDown:function(){var e=new t,n=f.hitch(this,function(){this.openDropDown(),e.resolve(this.dropDown)});return this.isLoaded()?n():this.loadDropDown(n),e},toggleDropDown:function(){if(this.disabled||this.readOnly)return;this._opened?this.closeDropDown(!0):this.loadAndOpenDropDown()},openDropDown:function(){var e=this.dropDown,t=e.domNode,n=this._aroundNode||this.domNode,o=this,u=d.open({parent:this,popup:e,around:n,orient:this.dropDownPosition,maxHeight:this.maxHeight,onExecute:function(){o.closeDropDown(!0)},onCancel:function(){o.closeDropDown(!0)},onClose:function(){r.set(o._popupStateNode,"popupActive",!1),i.remove(o._popupStateNode,"dijitHasDropDownOpen"),o._set("_opened",!1)}});if(this.forceWidth||this.autoWidth&&n.offsetWidth>e._popupWrapper.offsetWidth){var a={w:n.offsetWidth-(e._popupWrapper.offsetWidth-e.domNode.offsetWidth)};f.isFunction(e.resize)?e.resize(a):s.setMarginBox(t,a)}return r.set(this._popupStateNode,"popupActive","true"),i.add(this._popupStateNode,"dijitHasDropDownOpen"),this._set("_opened",!0),this._popupStateNode.setAttribute("aria-expanded","true"),this._popupStateNode.setAttribute("aria-owns",e.id),t.getAttribute("role")!=="presentation"&&!t.getAttribute("aria-labelledby")&&t.setAttribute("aria-labelledby",this.id),u},closeDropDown:function(e){this._focusDropDownTimer&&(this._focusDropDownTimer.remove(),delete this._focusDropDownTimer),this._opened&&(this._popupStateNode.setAttribute("aria-expanded","false"),e&&this.focus(),d.close(this.dropDown),this._opened=!1)}})}),pen.define("dojo/text!dijit/form/templates/DropDownButton.html",[],function(){return'<span class="dijit dijitReset dijitInline"\n	><span class=\'dijitReset dijitInline dijitButtonNode\'\n		data-dojo-attach-event="ondijitclick:__onClick" data-dojo-attach-point="_buttonNode"\n		><span class="dijitReset dijitStretch dijitButtonContents"\n			data-dojo-attach-point="focusNode,titleNode,_arrowWrapperNode,_popupStateNode"\n			role="button" aria-haspopup="true" aria-labelledby="${id}_label"\n			><span class="dijitReset dijitInline dijitIcon"\n				data-dojo-attach-point="iconNode"\n			></span\n			><span class="dijitReset dijitInline dijitButtonText"\n				data-dojo-attach-point="containerNode"\n				id="${id}_label"\n			></span\n			><span class="dijitReset dijitInline dijitArrowButtonInner"></span\n			><span class="dijitReset dijitInline dijitArrowButtonChar">&#9660;</span\n		></span\n	></span\n	><input ${!nameAttrSetting} type="${type}" value="${value}" class="dijitOffScreen" tabIndex="-1"\n		data-dojo-attach-event="onclick:_onClick"\n		data-dojo-attach-point="valueNode" role="presentation"\n/></span>\n'}),pen.define("dijit/form/DropDownButton",["dojo/_base/declare","dojo/_base/lang","dojo/query","../registry","../popup","./Button","../_Container","../_HasDropDown","dojo/text!./templates/DropDownButton.html"],function(e,t,n,r,i,s,o,u,a){return e("dijit.form.DropDownButton",[s,o,u],{baseClass:"dijitDropDownButton",templateString:a,_fillContent:function(){if(this.srcNodeRef){var e=n("*",this.srcNodeRef);this.inherited(arguments,[e[0]]),this.dropDownContainer=this.srcNodeRef}},startup:function(){if(this._started)return;if(!this.dropDown&&this.dropDownContainer){var e=n("[widgetId]",this.dropDownContainer)[0];e&&(this.dropDown=r.byNode(e)),delete this.dropDownContainer}this.dropDown&&i.hide(this.dropDown),this.inherited(arguments)},isLoaded:function(){var e=this.dropDown;return!!e&&(!e.href||e.isLoaded)},loadDropDown:function(e){var n=this.dropDown,r=n.on("load",t.hitch(this,function(){r.remove(),e()}));n.refresh()},isFocusable:function(){return this.inherited(arguments)&&!this._mouseDown}})}),pen.define("dijit/Calendar",["dojo/_base/array","dojo/date","dojo/date/locale","dojo/_base/declare","dojo/dom-attr","dojo/dom-class","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","./CalendarLite","./_Widget","./_CssStateMixin","./_TemplatedMixin","./form/DropDownButton"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m=r("dijit.Calendar",[c,h,p],{cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(e){o.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0"),this.set("value",e)},_createMonthWidget:function(){return new m._MonthDropDownButton({id:this.id+"_mddb",tabIndex:-1,onMonthSelect:a.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments),this.own(f(this.domNode,"keydown",a.hitch(this,"_onKeyDown")),f(this.dateRowsNode,"mouseover",a.hitch(this,"_onDayMouseOver")),f(this.dateRowsNode,"mouseout",a.hitch(this,"_onDayMouseOut")),f(this.dateRowsNode,"mousedown",a.hitch(this,"_onDayMouseDown")),f(this.dateRowsNode,"mouseup",a.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(e){var t=new this.dateClassObj(this.currentFocus);t.setDate(1),t.setMonth(e);var n=this.dateModule.getDaysInMonth(t),r=this.currentFocus.getDate();t.setDate(Math.min(r,n)),this._setCurrentFocusAttr(t)},_onDayMouseOver:function(e){var t=s.contains(e.target,"dijitCalendarDateLabel")?e.target.parentNode:e.target;t&&(t.dijitDateValue&&!s.contains(t,"dijitCalendarDisabledDate")||t==this.previousYearLabelNode||t==this.nextYearLabelNode)&&(s.add(t,"dijitCalendarHoveredDate"),this._currentNode=t)},_onDayMouseOut:function(e){if(!this._currentNode)return;if(e.relatedTarget&&e.relatedTarget.parentNode==this._currentNode)return;var t="dijitCalendarHoveredDate";s.contains(this._currentNode,"dijitCalendarActiveDate")&&(t+=" dijitCalendarActiveDate"),s.remove(this._currentNode,t),this._currentNode=null},_onDayMouseDown:function(e){var t=e.target.parentNode;t&&t.dijitDateValue&&!s.contains(t,"dijitCalendarDisabledDate")&&(s.add(t,"dijitCalendarActiveDate"),this._currentNode=t)},_onDayMouseUp:function(e){var t=e.target.parentNode;t&&t.dijitDateValue&&s.remove(t,"dijitCalendarActiveDate")},handleKey:function(e){var t=-1,n,r=this.currentFocus;switch(e.keyCode){case u.RIGHT_ARROW:t=1;case u.LEFT_ARROW:n="day",this.isLeftToRight()||(t*=-1);break;case u.DOWN_ARROW:t=1;case u.UP_ARROW:n="week";break;case u.PAGE_DOWN:t=1;case u.PAGE_UP:n=e.ctrlKey||e.altKey?"year":"month";break;case u.END:r=this.dateModule.add(r,"month",1),n="day";case u.HOME:r=new this.dateClassObj(r),r.setDate(1);break;default:return!0}return n&&(r=this.dateModule.add(r,n,t)),this._setCurrentFocusAttr(r),!1},_onKeyDown:function(e){this.handleKey(e)||(e.stopPropagation(),e.preventDefault())},onValueSelected:function(){},onChange:function(e){this.onValueSelected(e)},getClassForDate:function(){}});return m._MonthDropDownButton=r("dijit.Calendar._MonthDropDownButton",v,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments),this.dropDown=new m._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(e){var t=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,e);this.dropDown.set("months",t),this.containerNode.innerHTML=(l("ie")==6?"":"<div class='dijitSpacer'>"+this.dropDown.domNode.innerHTML+"</div>")+"<div class='dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'>"+t[e.getMonth()]+"</div>"}}),m._MonthDropDown=r("dijit.Calendar._MonthDropDown",[h,d],{months:[],templateString:"<div class='dijitCalendarMonthMenu dijitMenu' data-dojo-attach-event='onclick:_onClick,onmouseover:_onMenuHover,onmouseout:_onMenuHover'></div>",_setMonthsAttr:function(t){this.domNode.innerHTML=e.map(t,function(e,t){return e?"<div class='dijitCalendarMonthLabel' month='"+t+"'>"+e+"</div>":""}).join("")},_onClick:function(e){this.onChange(i.get(e.target,"month"))},onChange:function(){},_onMenuHover:function(e){s.toggle(e.target,"dijitCalendarMonthLabelHover",e.type=="mouseover")}}),m}),pen.define("dojo/text!pentaho/common/Calendar.html",[],function(){return'<div class="pentaho-rounded-panel pentaho-tooltip-background pentaho-padding-sm pentaho-shadow" style="width:178px;text-align:center">\n  <div class="panel-content" style="width:100%">\n    <div class="pentaho-padding-sm">\n      <center>\n\n\n        <table cellspacing="0" cellpadding="0" class="dijitCalendarContainer" role="grid" aria-labelledby="${id}_mddb ${id}_year" data-dojo-attach-point="gridNode">\n          <thead>\n          <tr class="dijitReset dijitCalendarMonthContainer" valign="top">\n            <th class=\'dijitReset dijitCalendarArrow\' data-dojo-attach-point="decrementMonth" scope="col">\n              <span class="dijitInline dijitCalendarIncrementControl dijitCalendarDecrease" role="presentation"></span>\n              <span data-dojo-attach-point="decreaseArrowNode" class="dijitA11ySideArrow" baseClass="pentaho-pagebackbutton">-</span>\n            </th>\n            <th class=\'dijitReset\' colspan="5" scope="col">\n              <div data-dojo-attach-point="monthNode">\n              </div>\n            </th>\n            <th class=\'dijitReset dijitCalendarArrow\' scope="col" data-dojo-attach-point="incrementMonth">\n              <span class="dijitInline dijitCalendarIncrementControl dijitCalendarIncrease" role="presentation" baseClass="pentaho-pagenextbutton"></span>\n              <span data-dojo-attach-point="increaseArrowNode" class="dijitA11ySideArrow">+</span>\n            </th>\n          </tr>\n          <tr role="row">\n            ${!dayCellsHtml}\n          </tr>\n          </thead>\n          <tbody data-dojo-attach-point="dateRowsNode" data-dojo-attach-event="ondijitclick: _onDayClick" class="dijitReset dijitCalendarBodyContainer">\n          ${!dateRowsHtml}\n          </tbody>\n          <tfoot class="dijitReset dijitCalendarYearContainer">\n          <tr>\n            <td class=\'dijitReset\' valign="top" colspan="7" role="presentation">\n              <div class="dijitCalendarYearLabel">\n                <span data-dojo-attach-point="previousYearLabelNode" class="dijitInline dijitCalendarPreviousYear" role="button" baseClass="pentaho-pagebackbutton"></span>\n                <span data-dojo-attach-point="currentYearLabelNode" class="dijitInline dijitCalendarSelectedYear" role="button" id="${id}_year"></span>\n                <span data-dojo-attach-point="nextYearLabelNode" class="dijitInline dijitCalendarNextYear" role="button" baseClass="pentaho-pagenextbutton"></span>\n              </div>\n            </td>\n          </tr>\n          </tfoot>\n        </table>\n\n\n\n\n      </center>\n    </div>\n  </div>\n</div>\n\n'}),pen.define("dojo/text!pentaho/common/SmallImageButton.html",[],function(){return'<img data-dojo-attach-point="buttonImg" src="${_imageSrc}" title="" class="pentaho-addbutton"/>\n'}),pen.define("pentaho/common/SmallImageButton",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dojo/on","dojo/query","dojo/text!pentaho/common/SmallImageButton.html","dojo/dom-class","dojo/_base/lang"],function(e,t,n,r,i,s,o,u,a){return e("pentaho.common.SmallImageButton",[t,n,r],{title:"",baseClass:"",_imageSrc:require.toUrl("pentaho/common/images/spacer.gif"),callback:function(){},disabled:!1,onClick:function(e){this.callback&&!this.get("disabled")&&this.callback(e)},templateString:o,mouseOver:function(){this.disabled||u.add(this.buttonImg,"pentaho-imagebutton-hover")},mouseOut:function(){this.disabled||u.remove(this.buttonImg,"pentaho-imagebutton-hover")},set:function(e,t){this.inherited(arguments),e=="disabled"&&(this.disabled=t,u.toggle(this.buttonImg,"pentaho-imagebutton-disabled",this.disabled),this.disabled?this.buttonImg.title="":this.buttonImg.title=this.title)},postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments),this.buttonImg.className=this.baseClass,u.toggle(this.buttonImg,"pentaho-imagebutton-disabled",this.disabled),i(this.buttonImg,"click",a.hitch(this,this.onClick)),i(this.buttonImg,"mouseover",a.hitch(this,this.mouseOver)),i(this.buttonImg,"mouseout",a.hitch(this,this.mouseOut))}})}),pen.define("dojo/text!pentaho/common/DropDownButton.html",[],function(){return'<span class="dijit dijitReset dijitInline">\n  <span class=\'dijitReset dijitInline dijitButtonNode\'\n    data-dojo-attach-event="ondijitclick:__onClick" data-dojo-attach-point="_buttonNode">\n    <span class="dijitReset dijitStretch dijitButtonContents pentaho-listbox"\n    data-dojo-attach-point="focusNode,titleNode,_arrowWrapperNode,_popupStateNode"\n    role="button" aria-haspopup="true" aria-labelledby="${id}_label"><span class="dijitReset dijitInline dijitIcon"\n    data-dojo-attach-point="iconNode">\n\n    </span>\n      <span class="dijitReset dijitInline dijitButtonText"\n    data-dojo-attach-point="containerNode"\n    id="${id}_label">\n\n    </span>\n                        <div class="pentaho-dropdownbutton-outer">\n                          <div class="pentaho-dropdownbutton-inner">\n                          </div>\n                        </div>\n  <span class="dijitReset dijitInline dijitArrowButtonInner"></span>\n      <span class="dijitReset dijitInline dijitArrowButtonChar">&#9660;</span>\n    </span></span>\n    <input ${!nameAttrSetting} type="${type}" value="${value}" class="dijitOffScreen" tabIndex="-1"\n		data-dojo-attach-event="onclick:_onClick"\n		data-dojo-attach-point="valueNode" role="presentation" />\n</span>\n'}),pen.define("pentaho/common/DropDownButton",["dojo/_base/declare","dijit/form/DropDownButton","dojo/text!pentaho/common/DropDownButton.html"],function(e,t,n){return e("pentaho.common.DropDownButton",[t],{baseClass:"dijitDropDownButton",templateString:n})}),pen.define("pentaho/common/Calendar",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/query","dijit/Calendar","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dojo/text!pentaho/common/Calendar.html","pentaho/common/SmallImageButton","pentaho/common/DropDownButton","dojo/_base/event","dojo/on"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){return e("PentahoCalendar._MonthDropDown",[s,o,u],{months:[],templateString:"<div class='pentaho-listbox' dojoAttachEvent='onclick:_onClick,onmouseover:_onMenuHover,onmouseout:_onMenuHover'></div>",_setMonthsAttr:function(e){this.domNode.innerHTML=array.map(e,function(e,t){return e?"<div class='pentaho-listitem' month='"+t+"'>"+e+"</div>":""}).join("")},_onClick:function(e){this.onChange(e.target.getAttribute("month"))},onChange:function(e){},_onMenuHover:function(e){n.toggle(e.target,"pentaho-listitem-hover",e.type=="mouseover")}}),e("pentaho.common.Calendar",[i,s,o,u],{templateString:a,buildRendering:function(){this.inherited(arguments),h(this.previousYearLabelNode,"click",t.hitch(this,this._prevYearClick)),h(this.nextYearLabelNode,"click",t.hitch(this,this._nextYearClick))},_populateGrid:function(){this.inherited(arguments),r(".dijitCalendarDateLabel",this.domNode).forEach(function(e){n.add(e,"label")},this),r(".dijitCalendarPreviousMonth",this.domNode).forEach(function(e){n.add(e,"pentaho-light-text")},this),r(".dijitCalendarNextMonth",this.domNode).forEach(function(e){n.add(e,"pentaho-light-text")},this),r(".dijitCalendarCurrentMonth",this.domNode).forEach(function(e){n.add(e,"pentaho-listitem")},this),r(".dijitCalendarCurrentDate",this.domNode).forEach(function(e){n.remove(e,"pentaho-listitem"),n.add(e,"panel-content")},this),r(".dijitCalendarSelectedDate",this.domNode).forEach(function(e){n.add(e,"pentaho-listitem-selected")},this)},_onDayMouseOver:function(e){var t=n.contains(e.target,"dijitCalendarDateLabel")?e.target.parentNode:e.target;t&&(t.dijitDateValue||t==this.previousYearLabelNode||t==this.nextYearLabelNode)&&(n.add(t,"pentaho-listitem-hover"),this._currentNode=t)},_onDayMouseOut:function(e){if(!this._currentNode)return;if(e.relatedTarget&&e.relatedTarget.parentNode==this._currentNode)return;var t="pentaho-listitem-hover";n.contains(this._currentNode,"dijitCalendarActiveDate")&&(t+=" pentaho-listitem-hover"),n.remove(this._currentNode,t),this._currentNode=null},_onDayMouseUp:function(e){this.inherited(arguments);var t=e.target.parentNode;t&&t.dijitDateValue&&n.add(t,"pentaho-listitem-selected")},_onDayClick:function(e){this.inherited(arguments),c.stop(e);for(var t=e.target;t&&!t.dijitDateValue;t=t.parentNode);t&&!n.contains(t,"dijitCalendarDisabledDate")&&n.add(t,"pentaho-listitem-selected")}})}),pen.define("dijit/form/MappedTextBox",["dojo/_base/declare","dojo/sniff","dojo/dom-construct","./ValidationTextBox"],function(e,t,n,r){return e("dijit.form.MappedTextBox",r,{postMixInProperties:function(){this.inherited(arguments),this.nameAttrSetting=""},_setNameAttr:"valueNode",serialize:function(e){return e.toString?e.toString():""},toString:function(){var e=this.filter(this.get("value"));return e!=null?typeof e=="string"?e:this.serialize(e,this.constraints):""},validate:function(){return this.valueNode.value=this.toString(),this.inherited(arguments)},buildRendering:function(){this.inherited(arguments),this.valueNode=n.place("<input type='hidden'"+(this.name&&!t("msapp")?' name="'+this.name.replace(/"/g,"&quot;")+'"':"")+"/>",this.textbox,"after")},reset:function(){this.valueNode.value="",this.inherited(arguments)}})}),pen.define("dijit/form/RangeBoundTextBox",["dojo/_base/declare","dojo/i18n","./MappedTextBox"],function(e,t,n){var r=e("dijit.form.RangeBoundTextBox",n,{rangeMessage:"",rangeCheck:function(e,t){return("min"in t?this.compare(e,t.min)>=0:!0)&&("max"in t?this.compare(e,t.max)<=0:!0)},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints)},_isDefinitelyOutOfRange:function(){var e=this.get("value");if(e==null)return!1;var t=!1;if("min"in this.constraints){var n=this.constraints.min;t=this.compare(e,typeof n=="number"&&n>=0&&e!=0?0:n)<0}if(!t&&"max"in this.constraints){var r=this.constraints.max;t=this.compare(e,typeof r!="number"||r>0?r:0)>0}return t},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange()},isValid:function(e){return this.inherited(arguments)&&(this._isEmpty(this.textbox.value)&&!this.required||this.isInRange(e))},getErrorMessage:function(e){var t=this.get("value");return t!=null&&t!==""&&(typeof t!="number"||!isNaN(t))&&!this.isInRange(e)?this.rangeMessage:this.inherited(arguments)},postMixInProperties:function(){this.inherited(arguments),this.rangeMessage||(this.messages=t.getLocalization("dijit.form","validate",this.lang),this.rangeMessage=this.messages.rangeMessage)}});return r}),pen.define("dojo/text!dijit/form/templates/DropDownBox.html",[],function(){return'<div class="dijit dijitReset dijitInline dijitLeft"\n	id="widget_${id}"\n	role="combobox"\n	aria-haspopup="true"\n	data-dojo-attach-point="_popupStateNode"\n	><div class=\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\n		data-dojo-attach-point="_buttonNode" role="presentation"\n		><input class="dijitReset dijitInputField dijitArrowButtonInner" value="&#9660; " type="text" tabIndex="-1" readonly="readonly" role="button presentation" aria-hidden="true"\n			${_buttonInputDisabled}\n	/></div\n	><div class=\'dijitReset dijitValidationContainer\'\n		><input class="dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value="&#935; " type="text" tabIndex="-1" readonly="readonly" role="presentation"\n	/></div\n	><div class="dijitReset dijitInputField dijitInputContainer"\n		><input class=\'dijitReset dijitInputInner\' ${!nameAttrSetting} type="text" autocomplete="off"\n			data-dojo-attach-point="textbox,focusNode" role="textbox"\n	/></div\n></div>\n'}),pen.define("dijit/form/_DateTimeTextBox",["dojo/date","dojo/date/locale","dojo/date/stamp","dojo/_base/declare","dojo/_base/lang","./RangeBoundTextBox","../_HasDropDown","dojo/text!./templates/DropDownBox.html"],function(e,t,n,r,i,s,o,u){new Date("X");var a=r("dijit.form._DateTimeTextBox",[s,o],{templateString:u,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},pattern:t.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments),this._set("type","text")},compare:function(t,n){var r=this._isInvalidDate(t),i=this._isInvalidDate(n);return r?i?0:-1:i?1:e.compare(t,n,this._selector)},autoWidth:!0,format:function(e,t){return e?this.dateLocaleModule.format(e,t):""},parse:function(e,t){return this.dateLocaleModule.parse(e,t)||(this._isEmpty(e)?null:undefined)},serialize:function(e,t){return e.toGregorian&&(e=e.toGregorian()),n.toISOString(e,t)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(n){this.dateModule=n.datePackage?i.getObject(n.datePackage,!1):e,this.dateClassObj=this.dateModule.Date||Date,this.dateLocaleModule=n.datePackage?i.getObject(n.datePackage+".locale",!1):t,this._set("pattern",this.dateLocaleModule.regexp),this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments),this.hasDownArrow||(this._buttonNode.style.display="none"),this.hasDownArrow||(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},_setConstraintsAttr:function(e){e.selector=this._selector,e.fullYear=!0;var t=n.fromISOString;typeof e.min=="string"&&(e.min=t(e.min)),typeof e.max=="string"&&(e.max=t(e.max)),this.inherited(arguments)},_isInvalidDate:function(e){return!e||isNaN(e)||typeof e!="object"||e.toString()==this._invalidDate},_setValueAttr:function(e,t,r){e!==undefined&&(typeof e=="string"&&(e=n.fromISOString(e)),this._isInvalidDate(e)&&(e=null),e instanceof Date&&!(this.dateClassObj instanceof Date)&&(e=new this.dateClassObj(e))),this.inherited(arguments),this.value instanceof Date&&(this.filterString=""),this.dropDown&&this.dropDown.set("value",e,!1)},_set:function(e,t){var n=this._get("value");if(e=="value"&&n instanceof Date&&this.compare(t,n)==0)return;this.inherited(arguments)},_setDropDownDefaultValueAttr:function(e){this._isInvalidDate(e)&&(e=new this.dateClassObj),this._set("dropDownDefaultValue",e)},openDropDown:function(e){this.dropDown&&this.dropDown.destroy();var t=i.isString(this.popupClass)?i.getObject(this.popupClass,!1):this.popupClass,n=this,r=this.get("value");this.dropDown=new t({onChange:function(e){n.set("value",e,!0)},id:this.id+"_popup",dir:n.dir,lang:n.lang,value:r,textDir:n.textDir,currentFocus:this._isInvalidDate(r)?this.dropDownDefaultValue:r,constraints:n.constraints,filterString:n.filterString,datePackage:n.params.datePackage,isDisabledDate:function(e){return!n.rangeCheck(e,n.constraints)}}),this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(e,t){this._setValueAttr(this.parse(e,this.constraints),t,e)}});return a}),pen.define("dijit/form/DateTextBox",["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(e,t,n){return e("dijit.form.DateTextBox",n,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:t,_selector:"date",maxHeight:Infinity,value:new Date("")})}),pen.define("dojo/text!pentaho/common/DropDownBox.html",[],function(){return'<div class="dijit dijitReset dijitInlineTable dijitLeft pentaho-listbox"\n	id="widget_${id}"\n	role="combobox">\n    <div class=\'dijitReset dijitRight dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\n		data-dojo-attach-point="_buttonNode, _popupStateNode" role="presentation">\n                        <div class="pentaho-dropdownbutton-outer">\n                            <div class="pentaho-dropdownbutton-inner">\n                            </div>\n                        </div>\n\n        <input class="dijitReset dijitInputField dijitArrowButtonInner" style="display:none" value="&#9660; " type="text" tabIndex="-1" readonly="readonly" role="presentation"	${_buttonInputDisabled} />\n    </div>\n    <div class=\'dijitReset dijitValidationContainer\'>\n        <input class="dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value="&#935;" type="text" tabIndex="-1" readonly="readonly" role="presentation"/>\n    </div>\n    <div class="dijitReset dijitInputField dijitInputContainer">\n        <input class=\'dijitReset dijitInputInner\' ${!nameAttrSetting} type="text" autocomplete="off"\n			data-dojo-attach-point="textbox,focusNode" role="textbox" aria-haspopup="true"/>\n    </div>\n\n</div>'}),pen.define("pentaho/common/DateTextBox",["dojo/_base/declare","dijit/form/DateTextBox","dijit/Calendar","dojo/text!pentaho/common/DropDownBox.html","pentaho/common/Calendar"],function(e,t,n,r,i){return e("pentaho.common.DateTextBox",[t],{templateString:r,popupClass:i})}),pen.define("common-ui/prompting/pentaho-prompting-components",["common-ui/prompting/pentaho-prompting-bind","common-ui/prompting/pentaho-prompting-builders","cdf/cdf-module","pentaho/common/TextButtonCombo","dijit/registry","dojo/on","dojo/_base/lang","pentaho/common/Calendar","pentaho/common/DateTextBox"],function(e,t,n,r,i,s,o,u,a){window.ScopedPentahoButtonComponent=BaseComponent.extend({viewReportButtonRegistered:!1,update:function(){this.registerSubmitClickEvent()},registerSubmitClickEvent:function(){if(!this.viewReportButtonRegistered){var e=$("#"+this.htmlObject).empty();$("<button type='button' class='pentaho-button'/>").text(this.label).bind("mousedown",this.expressionStart.bind(this)).bind("click",function(){this.expression(!1)}.bind(this)).button().appendTo(e),this.viewReportButtonRegistered=!0}},expressionStart:function(){}}),window.SubmitPromptComponent=ScopedPentahoButtonComponent.extend({update:function(){this.base();var e=this.promptPanel;if(this.paramDefn.autoSubmit==undefined){var t='<label class="auto-complete-checkbox"><input type="checkbox"'+(e.autoSubmit?' checked="checked"':"")+" />"+this.autoSubmitLabel+"</label>";$(t).appendTo($("#"+this.htmlObject)).bind("click",function(t){e.autoSubmit=t.target.checked})}(e.forceAutoSubmit||e.autoSubmit)&&this.expression(!0)},expression:function(e){this.promptPanel._submit({isInit:e})},expressionStart:function(){this.promptPanel._submitStart()}}),window.CompositeComponent=BaseComponent.extend({components:undefined,executeAtStart:!0,getComponents:function(){return this.components},clear:function(){this.components&&$.each(this.components,function(e,t){t.clear()}),this.base()},getClassFor:function(e){return e.cssClass},getMarkupFor:function(e){var t=this.getClassFor(e),n='<div id="'+e.htmlObject+'"';return t&&(n+=' class="'+t+'"'),n+="></div>",n},update:function(){var e="";this.label!==undefined&&(e+="<fieldset>",this.label.length>0&&(e+="<legend>"+Dashboards.escapeHtml(this.label)+"</legend>"),e+="<div>"),this.components&&this.components.length>0&&(e+=this.updateInternal()),this.label!==undefined&&(e+="</div></fieldset>"),$("#"+this.htmlObject).html(e),this.cssClass&&$("#"+this.htmlObject).addClass(this.cssClass)},updateInternal:function(){var e="";return $.each(this.components,function(t,n){e+=this.getMarkupFor(n)}.bind(this)),e}}),window.CompositeComponent.mapComponents=function(e,t,n){return t.call(n,e),e.components&&window.CompositeComponent.mapComponentsList(e.components,t,n),e},window.CompositeComponent.mapComponentsList=function(e,t,n){var r=this;return $.each(e,function(e,i){r.mapComponents(i,t,n)}),r},window.PromptLayoutComponent=CompositeComponent.extend({getClassFor:function(e){if(!e.param)return;return"parameter"+(e.cssClass?" "+e.cssClass:"")}}),window.TableBasedPromptLayoutComponent=PromptLayoutComponent.extend({buildComponentCell:function(e){return"<td align='left' style='vertical-align: top;'><div id='"+e.htmlObject+"'></div></td>"},getMarkupFor:function(e){throw"TableBasedPromptLayoutComponent should not be used directly."},updateInternal:function(){var e='<table cellspacing="0" cellpadding="0" class="parameter-container" style="width: 100%;">';return e+='<tr><td><div><table cellspacing="0" cellpadding="0">',e+=this.getMarkupFor(this.components),e+"</table></div></td></tr></table>"}}),window.VerticalTableBasedPromptLayoutComponent=TableBasedPromptLayoutComponent.extend({getMarkupFor:function(e){var t="";return $.each(e,function(e,n){var r=this.getClassFor(n);t+='<tr><td><div id="'+n.htmlObject+'"',r&&(t+=' class="'+r+'"'),t+="></div></td></tr>"}.bind(this)),t}}),window.HorizontalTableBasedPromptLayoutComponent=TableBasedPromptLayoutComponent.extend({getMarkupFor:function(e){var t="<tr>";return $.each(e,function(e,n){var r=this.getClassFor(n);t+='<td align="left" style="vertical-align: top;"><div id="'+n.htmlObject+'"',r&&(t+=' class="'+r+'"'),t+="></div></td>"}.bind(this)),t+"</tr>"}}),window.FlowPromptLayoutComponent=PromptLayoutComponent.extend({update:function(){$("#"+this.htmlObject).addClass("flow"),this.base()}}),window.ScrollingPromptPanelLayoutComponent=PromptLayoutComponent.extend({update:function(){if(this.components){if(this.components.length==0){$("#"+this.htmlObject).empty();return}var e='<div class="prompt-panel">',t='<div class="submit-panel">';$.each(this.components,function(n,r){r.promptType==="submit"?t+=this.getMarkupFor(r):e+=this.getMarkupFor(r)}.bind(this)),e+="</div>"+t+"</div>",$("#"+this.htmlObject).html(e)}}}),window.PanelComponent=CompositeComponent.extend({getClassFor:function(e){return undefined},getMarkupFor:function(e){var t=this.getClassFor(e),n='<div id="'+e.htmlObject+'"';return t&&(n+=' class="'+t+'"'),n+="></div>",n}}),window.ParameterPanelComponent=PanelComponent.extend({getClassFor:function(e){if(e.promptType==="label")return"parameter-label"}}),window.ExternalInputComponent=BaseComponent.extend({clear:function(){this.dijitId&&(this.onChangeHandle&&this.onChangeHandle.remove(),i.byId(this.dijitId).destroyRecursive(),delete this.dijitId)},update:function(){var e=Dashboards.getParameterValue(this.parameter),t=$("#"+this.htmlObject).empty(),n=this.htmlObject+"-textButtonCombo",r='<div id="'+n+'"></div>';t.append(r);var i=new pentaho.common.TextButtonCombo({},n);i.set("textPlaceHolder","file path..."),i.set("value",e);var s=this.param.attributes["button-label"];s!=null&&s!=""&&i.set("buttonLabel",s),i.onClickCallback=o.hitch(this,function(e){try{var t=Dashboards.getComponentByName(this.name),n=function(e){i.set("text",e),Dashboards.processChange(this.name)};t.param.values=[e],t.promptPanel.getExternalValueForParam(t.param,n)}catch(r){typeof console!="undefined"&&console.error&&console.error(r)}}),this.dijitId=n,i.onChangeCallback=o.hitch(this,function(e){Dashboards.processChange(this.name)})},getValue:function(){return i.byId(this.dijitId).get("value")}}),window.DojoDateTextBoxComponent=BaseComponent.extend({clear:function(){this.dijitId&&(this.onChangeHandle&&this.onChangeHandle.remove(),i.byId(this.dijitId).destroyRecursive(),delete this.dijitId)},update:function(){var e=this.transportFormatter.parse(Dashboards.getParameterValue(this.parameter));this.dijitId=this.htmlObject+"_input";var t=$("#"+this.htmlObject).html($("<input/>").attr("id",this.dijitId)),n=new pentaho.common.DateTextBox({name:this.name,constraints:{datePattern:this.param.attributes["data-format"],selector:"date",formatLength:"medium"}},this.dijitId);n.set("value",e,!1),this.onChangeHandle=s(n,"change",function(){Dashboards.processChange(this.name)}.bind(this)),this._doAutoFocus()},getValue:function(){var e=i.byId(this.dijitId).get("value");return this.transportFormatter.format(e)}}),window.StaticAutocompleteBoxComponent=BaseComponent.extend({update:function(){this.labelValueMap===undefined&&(this.labelValueMap={},$.each(this.valuesArray,function(e,t){this.labelValueMap[t.label]=t.value}.bind(this)));var e=$("#"+this.htmlObject);e.empty();var t='<input type="text" id="'+this.htmlObject+'-input"';if(this.parameter){var n;$.each(this.param.values,function(e,t){t.selected&&(n=this.formatter?this.formatter.format(this.transportFormatter.parse(t.label)):t.label)}.bind(this)),n!==undefined&&(t+=' value="'+n+'"')}t+="></input>",e.html(t);var r=$("input",e);r.autocomplete({delay:0,source:function(e,t){var n=e.term.toUpperCase(),r=$.map(this.valuesArray,function(e){if(e.label.toUpperCase().indexOf(n)>=0)return e});t(r)}.bind(this),select:function(e,t){$("#"+this.htmlObject+"-input").val(t.item.value),Dashboards.processChange(this.name)}.bind(this)}),r.keypress(function(e){e.which===13&&Dashboards.processChange(this.name)}.bind(this));var i;r.focus(function(){i=this.getValue()}.bind(this)),r.focusout(function(){if(i!==this.getValue()){try{var e=$("#ui-active-menuitem").text();e&&$("#"+this.htmlObject+"-input").val(e)}catch(t){}Dashboards.processChange(this.name)}}.bind(this)),this._doAutoFocus()},getValue:function(){var e=$("#"+this.htmlObject+"-input").val();return this.param.list?this.labelValueMap[e]||e:this.formatter?this.transportFormatter.format(this.formatter.parse(e)):e}}),window.TextAreaComponent=BaseComponent.extend({update:function(){var e=Dashboards.getParameterValue(this.parameter),t='<textarea id="'+this.htmlObject+'-input">';e!=undefined&&(t+=Dashboards.escapeHtml(e)),t+="</textarea>",$("#"+this.htmlObject).html(t);var n=$("#"+this.htmlObject+"-input");n.change(function(){}.bind(this)),n.keypress(function(e){e.which===13&&Dashboards.processChange(this.name)}.bind(this)),n.focusout(function(){Dashboards.processChange(this.name)}.bind(this)),this._doAutoFocus()},getValue:function(){var e=$("#"+this.htmlObject+"-input").val();return this.formatter?this.transportFormatter.format(this.formatter.parse(e)):e}})}),pen.define("common-ui/util/base64",function(){}),pentaho=typeof pentaho=="undefined"?{}:pentaho,pentaho.common=pentaho.common||{},pentaho.common.prompting=pentaho.common.prompting||{},pen.define("common-ui/prompting/pentaho-prompting",["cdf/cdf-module","common-ui/prompting/pentaho-prompting-bind","common-ui/prompting/pentaho-prompting-components","common-ui/util/base64"],function(){var e=function(){this._assignedGUIDs={},this._gen=function(){return Math.round(Math.random()*1e5)},this.generateGUID=function(){var e=this._gen();while(this._assignedGUIDs[e])e=this._gen();return this._assignedGUIDs[e]=!0,""+e},this.reset=function(){this._assignedGUIDs={}}};$.extend(pentaho.common.prompting,{ParameterDefinition:function(){return{autoSubmit:undefined,autoSubmitUI:undefined,ignoreBiServer5538:undefined,layout:undefined,page:undefined,paginate:undefined,parameterGroups:[],promptNeeded:undefined,totalPages:undefined,errors:{},getParameterGroup:function(e){var t;return $.each(this.parameterGroups,function(n,r){if(r.name===e)return t=r,!1}),t},allowAutoSubmit:function(){return this.autoSubmit!=undefined?this.autoSubmit:this.autoSubmitUI},showParameterUI:function(){var e;return this.mapParameters(function(t){if(t.name=="showParameters")return e=t,!1}),!e||!e.isSelectedValue("false")},getParameter:function(e){var t;return this.mapParameters(function(n){if(n.name===e)return t=n,!1}),t},mapParameters:function(e,t){var n=this,r=!1;return $.each(this.parameterGroups,function(i,s){$.each(this.parameters,function(i,o){if(e.call(t,o,s,n)===!1)return r=!0,!1});if(r)return!1}),!r}}},ParameterGroup:function(){return{name:undefined,label:undefined,parameters:[]}},Parameter:function(){return{name:undefined,type:undefined,list:undefined,mandatory:undefined,multiSelect:undefined,strict:undefined,timezoneHint:undefined,attributes:{},values:[],isSelectedValue:function(e){var t=!1;return $.each(this.values,function(n,r){if(r.selected&&e===r.value)return t=!0,!1}),t},hasSelection:function(){var e=!1;return $.each(this.values,function(t,n){if(n.selected)return e=!0,!1}),e},getSelectedValues:function(){var e=[];return $.each(this.values,function(t,n){n.selected&&e.push(n)}),e},getSelectedValuesValue:function(){var e=[];return $.each(this.values,function(t,n){n.selected&&e.push(n.value)}),e}}},ParameterValue:function(){return{type:undefined,label:undefined,selected:!1,value:undefined}},promptGUIDHelper:new e,removeDashboardComponents:function(e,t){var n=[];window.CompositeComponent.mapComponentsList(e,function(e){var t=Dashboards.removeComponent(e.name);t&&n.push(t)}),$.each(n,function(e,n){t||n.clear(),n.parameter&&($.each(Dashboards.components,function(e,t){$.isArray(t.listeners)&&(t.listeners=$.grep(t.listeners,function(e){return e!==n.parameter}))}),$.each(Dashboards.components,function(e,t){$.isArray(t.parameters)&&(t.parameters=$.each(t.parameters,function(e,t){return t[1]===n.parameter?[t[0],"",""]:t}))}))})},appendInline:function(e,t){e.splice.apply(e,[e.length,0].concat(t))},prepareCDF:function(){if(this.prepared)return;Dashboards.setGlobalContext(!1),Dashboards.escapeParameterValues=!1,this.prepared=!0},parseXML:function(e,t,n){return window.DOMParser?(n=new DOMParser,t=n.parseFromString(e,"text/xml")):(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)),n=t.documentElement,(!n||!n.nodeName||n.nodeName==="parsererror")&&jQuery.error("Invalid XML: "+e),t},ParameterXmlParser:function(){this.parseParameterXml=function(e){var t=$(pentaho.common.prompting.parseXML(e));if(t.find("parsererror").length>0)throw e;var n=new pentaho.common.prompting.ParameterDefinition,r=$(t.find("parameters")[0]);n.promptNeeded="true"==r.attr("is-prompt-needed"),n.ignoreBiServer5538="true"==r.attr("ignore-biserver-5538"),n.paginate="true"==r.attr("paginate"),n.layout=r.attr("layout");var i=function(e,t){var n=parseInt(e);return"NaN"==n?t:n};return n.page=i(r.attr("accepted-page"),0),n.totalPages=i(r.attr("page-count"),0),n.autoSubmit=r.attr("autoSubmit"),n.autoSubmit=="true"?n.autoSubmit=!0:n.autoSubmit=="false"?n.autoSubmit=!1:n.autoSubmit=undefined,n.autoSubmitUI="true"==r.attr("autoSubmitUI"),this.parseParameters(n,r),this.parseErrors(n,t),n},this.parseParameters=function(e,t){t.find("parameter").each(function(t,n){var r=this.parseParameter(n);n=$(n);var i=r.attributes["parameter-group"];if(i==undefined||!$.trim(i).length)i="parameters";var s=e.getParameterGroup(i);s||(s=new pentaho.common.prompting.ParameterGroup,s.name=i,s.label=r.attributes["parameter-group-label"],e.parameterGroups.push(s)),s.parameters.push(r)}.bind(this))},this.parseParameter=function(e){var t=new pentaho.common.prompting.Parameter;return e=$(e),t.name=e.attr("name"),t.mandatory="true"==e.attr("is-mandatory"),t.strict="true"==e.attr("is-strict"),t.list="true"==e.attr("is-list"),t.multiSelect="true"==e.attr("is-multi-select"),t.type=e.attr("type"),t.timezoneHint=e.attr("timezone-hint"),$(e).find("attribute").each(function(e,n){n=$(n),t.attributes[n.attr("name")]=n.attr("value")}),t.values=this.parseParameterValues(e,t),t},this.parseParameterValues=function(e,t){var n=[];return $(e).find("values value").each(function(e,r){var i=new pentaho.common.prompting.ParameterValue;r=$(r),"true"==r.attr("encoded")?i.label=base64Decode(r.attr("label")):i.label=r.attr("label"),"true"==r.attr("null")?i.value="":"true"==r.attr("encoded")?i.value=base64Decode(r.attr("value")):i.value=r.attr("value"),i.type=r.attr("type");if(i.type==undefined||!$.trim(i.type).length)i.type=t.type;i.selected="true"==r.attr("selected"),i.value=this.normalizeParameterValue(t,i.type,i.value),n.push(i)}.bind(this)),n},this.normalizeParameterValue=function(e,t,n){return n},this.parseErrors=function(e,t){var n=function(e,t,n){var r=e.errors[t];r||(r=[]),r.push(n),e.errors[t]=r};t.find("error").each(function(t,r){var i=$(r),s=i.attr("parameter"),o=i.attr("message");n(e,s,o)}.bind(this)),t.find("global-error").each(function(t,r){var i=$(r),s=i.attr("message");n(e,null,s)}.bind(this))}},PromptPanel:function(t,n){if(!t)throw"destinationId is required";this.destinationId=t;if(!n)throw"paramDefn is required";this.paramDefn=n,this.autoSubmit=n.allowAutoSubmit(),this.guid=pentaho.common.prompting.promptGUIDHelper.generateGUID(),this.getString=function(e,t){return t||"!"+e+"!"},this.getAutoSubmitSetting=function(){return this.autoSubmit},this.getParameterName=function(e){return this.guid+e.name},this.getParameterValues=function(){var e={};return this.paramDefn.mapParameters(function(t){var n=Dashboards.getParameterValue(this.getParameterName(t));if(n===""||typeof n=="undefined")return;t.multiSelect&&!$.isArray(n)&&(n=[n]);var r;try{r=dojo.number.parse(n,{locale:SESSION_LOCALE.toLowerCase()})}catch(i){r=n}e[t.name]=isNaN(r)?n:r},this),e},this.createDataTransportFormatter=function(e,t,n,r){},this.createFormatter=function(e,t,n){},this._widgetGUIDHelper=new e,this.generateWidgetGUID=function(){return this.guid+"-"+this._widgetGUIDHelper.generateGUID()},this.initializeParameterValue=function(e,t){var n=t.getSelectedValuesValue();n.length===0?n="":n.length===1&&(n=n[0]),this.setParameterValue(t,n)},this.setParameterValue=function(e,t){Dashboards.setParameter(this.getParameterName(e),t)},this.getParameterValue=function(e){return typeof e!="string"&&(e=this.getParameterName(e)),Dashboards.getParameterValue(e)},this._ready=function(){this.ready(this)},this._submit=function(e){this.submit(this,e)},this._submitStart=function(){this.submitStart(this)},this.ready=function(e){},this.submit=function(e,t){this.forceAutoSubmit=!1},this.submitStart=function(e){},this.parameterChanged=function(e,t,n){this.refreshPrompt()},this.getParameterDefinition=function(e,t){t()},this.refreshPrompt=function(){try{this.getParameterDefinition(this,this.refresh.bind(this))}catch(e){alert("Error in refreshCallback")}},this.refresh=function(e,t){var n=this;if(Dashboards.waitingForInit&&Dashboards.waitingForInit.length){Dashboards.log("Overlapping refresh!","warn"),setTimeout(function(){n.refresh(e,t)},0);return}if(e){this.paramDefn=e;if(this.components){var r=this.paramDefn.showParameterUI();pentaho.common.prompting.removeDashboardComponents(this.components,r);var i;/android|ipad|iphone/i.test(navigator.userAgent)||(i=this._multiListBoxTopValuesByParam={});var s;window.CompositeComponent.mapComponentsList(this.components,function(e){if(!e.components&&e.param&&e.promptType==="prompt"){if(!s){var t=e.placeholder();$(":focus",t).length&&(s=e.param.name)}if(i&&e.type==="SelectMultiComponent"){var n=e.topValue();n!=null&&(i["_"+e.param.name]=n)}}}),this._focusedParam=s}this.init(t)}},this.init=function(e){pentaho.common.prompting.prepareCDF();var t=!0;if(this.paramDefn.showParameterUI()){this._widgetGUIDHelper.reset();var r=[],i=pentaho.common.prompting.builders.WidgetBuilder.build(this,"prompt-panel"),s=this._multiListBoxTopValuesByParam;s&&delete this._multiListBoxTopValuesByParam;var o=this._focusedParam;o&&delete this._focusedParam,window.CompositeComponent.mapComponents(i,function(e){r.push(e),t&&e.promptType=="submit"&&(t=!1);if(!e.components&&e.param&&e.promptType==="prompt"){var n=e.param.name;o&&o===n&&(o=null,e.autoFocus=!0);if(s&&e.type==="SelectMultiComponent"){var i=s["_"+n];i!=null&&(e.autoTopValue=i)}}});if(this.components&&this.components.length>0){var u=pentaho.common.prompting.builders.WidgetBuilder.build({promptPanel:this,components:this.components},"gc");if(!u)throw"Cannot create garbage collector";r=[u].concat(r)}this.components=r,Dashboards.init(r)}else this.paramDefn.mapParameters(function(e){this.initializeParameterValue(n,e)},this),t=!e;t&&this.submit(this,{isInit:!0})},this.hide=function(){$("#"+this.destinationId).css("display","none")},this.createSubmitPanel=function(e){return pentaho.common.prompting.builders.WidgetBuilder.build({promptPanel:this},"submit-panel")},this.getParameterPanelType=function(){return"parameter-panel"},this.createWidgetForParameter=function(e,t){if(t.strict&&t.values.length===0)return;return pentaho.common.prompting.builders.WidgetBuilder.build({promptPanel:this,param:t})},this.shouldBuildSubmitPanel=function(e){return e.length>0},this.buildPanelComponents=function(){var e=[];$.each(this.paramDefn.parameterGroups,function(t,n){var r=[];$.each(n.parameters,function(e,t){this.initializeParameterValue(this.paramDefn,t);if("true"==t.attributes["hidden"])return;var n=this.createWidgetForParameter(this.paramDefn,t);if(!n)return;var i=pentaho.common.prompting.builders.WidgetBuilder.build({promptPanel:this,param:t},"label"),s=this.paramDefn.errors[t.name],o=[];s&&s.length>0&&$.each(s,function(e,n){var r=pentaho.common.prompting.builders.WidgetBuilder.build({promptPanel:this,param:t,errorMessage:n},"error-label");r&&o.push(r)}.bind(this));var u=[i];u=u.concat(o),u.push(n);var a=pentaho.common.prompting.builders.WidgetBuilder.build({promptPanel:this,param:t,components:u},this.getParameterPanelType());o.length>0&&(a.cssClass=(a.cssClass||"")+" error"),r.push(a)}.bind(this));if(r.length>0){var i=pentaho.common.prompting.builders.WidgetBuilder.build({promptPanel:this,paramGroup:n,components:r},"group-panel");e.push(i)}}.bind(this));if(this.shouldBuildSubmitPanel(e)){var t=this.createSubmitPanel(this.paramDefn);t&&e.push(t)}return e}}})}),pen.define("common-ui/util/util",["dijit/registry","dojo/dom"],function(e,t){return{getUrlParameters:function(){var e={},t,n=/\+/g,r=/([^&=]+)=?([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(n," "))},s=window.location.search.substring(1);while(t=r.exec(s)){var o=i(t[1]),u=i(t[2]);e[o]!==undefined&&(u=$.isArray(e[o])?e[o].concat([u]):[e[o],u]),e[o]=u}return e},getLocale:function(){var e=this.getUrlParameters().locale;return e&&e.length>2&&(e=e.substring(0,2)),e},localizeDomCtrl:function(n,r,i){var s=null,o=null,u=null,a=i||"";n.indexOf("_label")==n.length-6?(u=n.substr(0,n.length-6),s="label"):n.indexOf("_title")==n.length-6?(u=n.substr(0,n.length-6),s="title"):n.indexOf("_content")==n.length-8?(u=n.substr(0,n.length-8),s="inner"):n.indexOf("_legend")==n.length-7?(u=n.substr(0,n.length-7),s="legend"):n.indexOf("_header")==n.length-7?(u=n.substr(0,n.length-7),s="header"):n.indexOf("_button")==n.length-7&&(u=n.substr(0,n.length-7),s="inner"),u!=null&&(u=a+u,this[u]?o=this[u]:(o=e.byId(u),o||(o=t.byId(u))));var f=-1;o||(o=t.byId(u+"1"),o&&(f=1));while(o&&s){if(s=="inner")o.domNode&&(o=o.domNode),o.innerHTML=r;else if(s=="legend")if(o.firstElementChild===undefined){var l=o.firstChild;while(l){if(l.nodeType==1){l.innerHTML=r;break}l=l.nextSibling}}else o.firstElementChild.innerHTML=r;else s=="label"&&o.setLabel?o.setLabel(r):s=="title"&&o.setTitle?o.setTitle(r):o.set?o.set(s,r):s=="title"&&o.title&&(o.title=r);f!=-1?(f++,o=dojo.byId(u+f)):o=null}},localizeDom:function(e,t){var n;if(pentaho&&pentaho.common&&pentaho.common.Messages){var r=pentaho.common.Messages.getBundle(e);if(r)for(n in r)r.hasOwnProperty(n)&&this.localizeDomCtrl(n,pentaho.common.Messages.getString(n),t)}else console.log("pentaho.common.Messages not available for localizing the DOM")}}}),pen.define("common-ui/util/timeutil",[],function(){return{offsets:{ACT:570,AET:600,AGT:-180,ART:120,AST:-540,"Africa/Abidjan":0,"Africa/Accra":0,"Africa/Addis_Ababa":180,"Africa/Algiers":60,"Africa/Asmara":180,"Africa/Asmera":180,"Africa/Bamako":0,"Africa/Bangui":60,"Africa/Banjul":0,"Africa/Bissau":0,"Africa/Blantyre":120,"Africa/Brazzaville":60,"Africa/Bujumbura":120,"Africa/Cairo":120,"Africa/Casablanca":0,"Africa/Ceuta":60,"Africa/Conakry":0,"Africa/Dakar":0,"Africa/Dar_es_Salaam":180,"Africa/Djibouti":180,"Africa/Douala":60,"Africa/El_Aaiun":0,"Africa/Freetown":0,"Africa/Gaborone":120,"Africa/Harare":120,"Africa/Johannesburg":120,"Africa/Kampala":180,"Africa/Khartoum":180,"Africa/Kigali":120,"Africa/Kinshasa":60,"Africa/Lagos":60,"Africa/Libreville":60,"Africa/Lome":0,"Africa/Luanda":60,"Africa/Lubumbashi":120,"Africa/Lusaka":120,"Africa/Malabo":60,"Africa/Maputo":120,"Africa/Maseru":120,"Africa/Mbabane":120,"Africa/Mogadishu":180,"Africa/Monrovia":0,"Africa/Nairobi":180,"Africa/Ndjamena":60,"Africa/Niamey":60,"Africa/Nouakchott":0,"Africa/Ouagadougou":0,"Africa/Porto-Novo":60,"Africa/Sao_Tome":0,"Africa/Timbuktu":0,"Africa/Tripoli":120,"Africa/Tunis":60,"Africa/Windhoek":60,"America/Adak":-600,"America/Anchorage":-540,"America/Anguilla":-240,"America/Antigua":-240,"America/Araguaina":-180,"America/Argentina/Buenos_Aires":-180,"America/Argentina/Catamarca":-180,"America/Argentina/ComodRivadavia":-180,"America/Argentina/Cordoba":-180,"America/Argentina/Jujuy":-180,"America/Argentina/La_Rioja":-180,"America/Argentina/Mendoza":-180,"America/Argentina/Rio_Gallegos":-180,"America/Argentina/Salta":-180,"America/Argentina/San_Juan":-180,"America/Argentina/San_Luis":-240,"America/Argentina/Tucuman":-180,"America/Argentina/Ushuaia":-180,"America/Aruba":-240,"America/Asuncion":-240,"America/Atikokan":-300,"America/Atka":-600,"America/Bahia":-180,"America/Barbados":-240,"America/Belem":-180,"America/Belize":-360,"America/Blanc-Sablon":-240,"America/Boa_Vista":-240,"America/Bogota":-300,"America/Boise":-420,"America/Buenos_Aires":-180,"America/Cambridge_Bay":-420,"America/Campo_Grande":-240,"America/Cancun":-360,"America/Caracas":-270,"America/Catamarca":-180,"America/Cayenne":-180,"America/Cayman":-300,"America/Chicago":-360,"America/Chihuahua":-420,"America/Coral_Harbour":-300,"America/Cordoba":-180,"America/Costa_Rica":-360,"America/Cuiaba":-240,"America/Curacao":-240,"America/Danmarkshavn":0,"America/Dawson":-480,"America/Dawson_Creek":-420,"America/Denver":-420,"America/Detroit":-300,"America/Dominica":-240,"America/Edmonton":-420,"America/Eirunepe":-240,"America/El_Salvador":-360,"America/Ensenada":-480,"America/Fort_Wayne":-300,"America/Fortaleza":-180,"America/Glace_Bay":-240,"America/Godthab":-180,"America/Goose_Bay":-240,"America/Grand_Turk":-300,"America/Grenada":-240,"America/Guadeloupe":-240,"America/Guatemala":-360,"America/Guayaquil":-300,"America/Guyana":-240,"America/Halifax":-240,"America/Havana":-300,"America/Hermosillo":-420,"America/Indiana/Indianapolis":-300,"America/Indiana/Knox":-360,"America/Indiana/Marengo":-300,"America/Indiana/Petersburg":-300,"America/Indiana/Tell_City":-360,"America/Indiana/Vevay":-300,"America/Indiana/Vincennes":-300,"America/Indiana/Winamac":-300,"America/Indianapolis":-300,"America/Inuvik":-420,"America/Iqaluit":-300,"America/Jamaica":-300,"America/Jujuy":-180,"America/Juneau":-540,"America/Kentucky/Louisville":-300,"America/Kentucky/Monticello":-300,"America/Knox_IN":-360,"America/La_Paz":-240,"America/Lima":-300,"America/Los_Angeles":-480,"America/Louisville":-300,"America/Maceio":-180,"America/Managua":-360,"America/Manaus":-240,"America/Marigot":-240,"America/Martinique":-240,"America/Matamoros":-360,"America/Mazatlan":-420,"America/Mendoza":-180,"America/Menominee":-360,"America/Merida":-360,"America/Mexico_City":-360,"America/Miquelon":-180,"America/Moncton":-240,"America/Monterrey":-360,"America/Montevideo":-180,"America/Montreal":-300,"America/Montserrat":-240,"America/Nassau":-300,"America/New_York":-300,"America/Nipigon":-300,"America/Nome":-540,"America/Noronha":-120,"America/North_Dakota/Center":-360,"America/North_Dakota/New_Salem":-360,"America/Ojinaga":-420,"America/Panama":-300,"America/Pangnirtung":-300,"America/Paramaribo":-180,"America/Phoenix":-420,"America/Port-au-Prince":-300,"America/Port_of_Spain":-240,"America/Porto_Acre":-240,"America/Porto_Velho":-240,"America/Puerto_Rico":-240,"America/Rainy_River":-360,"America/Rankin_Inlet":-360,"America/Recife":-180,"America/Regina":-360,"America/Resolute":-300,"America/Rio_Branco":-240,"America/Rosario":-180,"America/Santa_Isabel":-480,"America/Santarem":-180,"America/Santiago":-240,"America/Santo_Domingo":-240,"America/Sao_Paulo":-180,"America/Scoresbysund":-60,"America/Shiprock":-420,"America/St_Barthelemy":-240,"America/St_Johns":-210,"America/St_Kitts":-240,"America/St_Lucia":-240,"America/St_Thomas":-240,"America/St_Vincent":-240,"America/Swift_Current":-360,"America/Tegucigalpa":-360,"America/Thule":-240,"America/Thunder_Bay":-300,"America/Tijuana":-480,"America/Toronto":-300,"America/Tortola":-240,"America/Vancouver":-480,"America/Virgin":-240,"America/Whitehorse":-480,"America/Winnipeg":-360,"America/Yakutat":-540,"America/Yellowknife":-420,"Antarctica/Casey":660,"Antarctica/Davis":300,"Antarctica/DumontDUrville":600,"Antarctica/Mawson":300,"Antarctica/McMurdo":720,"Antarctica/Palmer":-240,"Antarctica/Rothera":-180,"Antarctica/South_Pole":720,"Antarctica/Syowa":180,"Antarctica/Vostok":360,"Arctic/Longyearbyen":60,"Asia/Aden":180,"Asia/Almaty":360,"Asia/Amman":120,"Asia/Anadyr":720,"Asia/Aqtau":300,"Asia/Aqtobe":300,"Asia/Ashgabat":300,"Asia/Ashkhabad":300,"Asia/Baghdad":180,"Asia/Bahrain":180,"Asia/Baku":240,"Asia/Bangkok":420,"Asia/Beirut":120,"Asia/Bishkek":360,"Asia/Brunei":480,"Asia/Calcutta":330,"Asia/Choibalsan":480,"Asia/Chongqing":480,"Asia/Chungking":480,"Asia/Colombo":330,"Asia/Dacca":360,"Asia/Damascus":120,"Asia/Dhaka":360,"Asia/Dili":540,"Asia/Dubai":240,"Asia/Dushanbe":300,"Asia/Gaza":120,"Asia/Harbin":480,"Asia/Ho_Chi_Minh":420,"Asia/Hong_Kong":480,"Asia/Hovd":420,"Asia/Irkutsk":480,"Asia/Istanbul":120,"Asia/Jakarta":420,"Asia/Jayapura":540,"Asia/Jerusalem":120,"Asia/Kabul":270,"Asia/Kamchatka":720,"Asia/Karachi":300,"Asia/Kashgar":480,"Asia/Kathmandu":345,"Asia/Katmandu":345,"Asia/Kolkata":330,"Asia/Krasnoyarsk":420,"Asia/Kuala_Lumpur":480,"Asia/Kuching":480,"Asia/Kuwait":180,"Asia/Macao":480,"Asia/Macau":480,"Asia/Magadan":660,"Asia/Makassar":480,"Asia/Manila":480,"Asia/Muscat":240,"Asia/Nicosia":120,"Asia/Novokuznetsk":360,"Asia/Novosibirsk":360,"Asia/Omsk":360,"Asia/Oral":300,"Asia/Phnom_Penh":420,"Asia/Pontianak":420,"Asia/Pyongyang":540,"Asia/Qatar":180,"Asia/Qyzylorda":360,"Asia/Rangoon":390,"Asia/Riyadh":180,"Asia/Riyadh87":187,"Asia/Riyadh88":187,"Asia/Riyadh89":187,"Asia/Saigon":420,"Asia/Sakhalin":600,"Asia/Samarkand":300,"Asia/Seoul":540,"Asia/Shanghai":480,"Asia/Singapore":480,"Asia/Taipei":480,"Asia/Tashkent":300,"Asia/Tbilisi":240,"Asia/Tehran":210,"Asia/Tel_Aviv":120,"Asia/Thimbu":360,"Asia/Thimphu":360,"Asia/Tokyo":540,"Asia/Ujung_Pandang":480,"Asia/Ulaanbaatar":480,"Asia/Ulan_Bator":480,"Asia/Urumqi":480,"Asia/Vientiane":420,"Asia/Vladivostok":600,"Asia/Yakutsk":540,"Asia/Yekaterinburg":300,"Asia/Yerevan":240,"Atlantic/Azores":-60,"Atlantic/Bermuda":-240,"Atlantic/Canary":0,"Atlantic/Cape_Verde":-60,"Atlantic/Faeroe":0,"Atlantic/Faroe":0,"Atlantic/Jan_Mayen":60,"Atlantic/Madeira":0,"Atlantic/Reykjavik":0,"Atlantic/South_Georgia":-120,"Atlantic/St_Helena":0,"Atlantic/Stanley":-240,"Australia/ACT":600,"Australia/Adelaide":570,"Australia/Brisbane":600,"Australia/Broken_Hill":570,"Australia/Canberra":600,"Australia/Currie":600,"Australia/Darwin":570,"Australia/Eucla":525,"Australia/Hobart":600,"Australia/LHI":630,"Australia/Lindeman":600,"Australia/Lord_Howe":630,"Australia/Melbourne":600,"Australia/NSW":600,"Australia/North":570,"Australia/Perth":480,"Australia/Queensland":600,"Australia/South":570,"Australia/Sydney":600,"Australia/Tasmania":600,"Australia/Victoria":600,"Australia/West":480,"Australia/Yancowinna":570,BET:-180,BST:360,"Brazil/Acre":-240,"Brazil/DeNoronha":-120,"Brazil/East":-180,"Brazil/West":-240,CAT:120,CET:60,CNT:-210,CST:-360,CST6CDT:-360,CTT:480,"Canada/Atlantic":-240,"Canada/Central":-360,"Canada/East-Saskatchewan":-360,"Canada/Eastern":-300,"Canada/Mountain":-420,"Canada/Newfoundland":-210,"Canada/Pacific":-480,"Canada/Saskatchewan":-360,"Canada/Yukon":-480,"Chile/Continental":-240,"Chile/EasterIsland":-360,Cuba:-300,EAT:180,ECT:60,EET:120,EST:-300,EST5EDT:-300,Egypt:120,Eire:0,"Etc/GMT":0,"Etc/GMT+0":0,"Etc/GMT+1":-60,"Etc/GMT+10":-600,"Etc/GMT+11":-660,"Etc/GMT+12":-720,"Etc/GMT+2":-120,"Etc/GMT+3":-180,"Etc/GMT+4":-240,"Etc/GMT+5":-300,"Etc/GMT+6":-360,"Etc/GMT+7":-420,"Etc/GMT+8":-480,"Etc/GMT+9":-540,"Etc/GMT-0":0,"Etc/GMT-1":60,"Etc/GMT-10":600,"Etc/GMT-11":660,"Etc/GMT-12":720,"Etc/GMT-13":780,"Etc/GMT-14":840,"Etc/GMT-2":120,"Etc/GMT-3":180,"Etc/GMT-4":240,"Etc/GMT-5":300,"Etc/GMT-6":360,"Etc/GMT-7":420,"Etc/GMT-8":480,"Etc/GMT-9":540,"Etc/GMT0":0,"Etc/Greenwich":0,"Etc/UCT":0,"Etc/UTC":0,"Etc/Universal":0,"Etc/Zulu":0,"Europe/Amsterdam":60,"Europe/Andorra":60,"Europe/Athens":120,"Europe/Belfast":0,"Europe/Belgrade":60,"Europe/Berlin":60,"Europe/Bratislava":60,"Europe/Brussels":60,"Europe/Bucharest":120,"Europe/Budapest":60,"Europe/Chisinau":120,"Europe/Copenhagen":60,"Europe/Dublin":0,"Europe/Gibraltar":60,"Europe/Guernsey":0,"Europe/Helsinki":120,"Europe/Isle_of_Man":0,"Europe/Istanbul":120,"Europe/Jersey":0,"Europe/Kaliningrad":120,"Europe/Kiev":120,"Europe/Lisbon":0,"Europe/Ljubljana":60,"Europe/London":0,"Europe/Luxembourg":60,"Europe/Madrid":60,"Europe/Malta":60,"Europe/Mariehamn":120,"Europe/Minsk":120,"Europe/Monaco":60,"Europe/Moscow":180,"Europe/Nicosia":120,"Europe/Oslo":60,"Europe/Paris":60,"Europe/Podgorica":60,"Europe/Prague":60,"Europe/Riga":120,"Europe/Rome":60,"Europe/Samara":240,"Europe/San_Marino":60,"Europe/Sarajevo":60,"Europe/Simferopol":120,"Europe/Skopje":60,"Europe/Sofia":120,"Europe/Stockholm":60,"Europe/Tallinn":120,"Europe/Tirane":60,"Europe/Tiraspol":120,"Europe/Uzhgorod":120,"Europe/Vaduz":60,"Europe/Vatican":60,"Europe/Vienna":60,"Europe/Vilnius":120,"Europe/Volgograd":180,"Europe/Warsaw":60,"Europe/Zagreb":60,"Europe/Zaporozhye":120,"Europe/Zurich":60,GB:0,"GB-Eire":0,GMT:0,GMT0:0,Greenwich:0,HST:-600,Hongkong:480,IET:-300,IST:330,Iceland:0,"Indian/Antananarivo":180,"Indian/Chagos":360,"Indian/Christmas":420,"Indian/Cocos":390,"Indian/Comoro":180,"Indian/Kerguelen":300,"Indian/Mahe":240,"Indian/Maldives":300,"Indian/Mauritius":240,"Indian/Mayotte":180,"Indian/Reunion":240,Iran:210,Israel:120,JST:540,Jamaica:-300,Japan:540,Kwajalein:720,Libya:120,MET:60,MIT:-660,MST:-420,MST7MDT:-420,"Mexico/BajaNorte":-480,"Mexico/BajaSur":-420,"Mexico/General":-360,"Mideast/Riyadh87":187,"Mideast/Riyadh88":187,"Mideast/Riyadh89":187,NET:240,NST:720,NZ:720,"NZ-CHAT":765,Navajo:-420,PLT:300,PNT:-420,PRC:480,PRT:-240,PST:-480,PST8PDT:-480,"Pacific/Apia":-660,"Pacific/Auckland":720,"Pacific/Chatham":765,"Pacific/Easter":-360,"Pacific/Efate":660,"Pacific/Enderbury":780,"Pacific/Fakaofo":-600,"Pacific/Fiji":720,"Pacific/Funafuti":720,"Pacific/Galapagos":-360,"Pacific/Gambier":-540,"Pacific/Guadalcanal":660,"Pacific/Guam":600,"Pacific/Honolulu":-600,"Pacific/Johnston":-600,"Pacific/Kiritimati":840,"Pacific/Kosrae":660,"Pacific/Kwajalein":720,"Pacific/Majuro":720,"Pacific/Marquesas":-570,"Pacific/Midway":-660,"Pacific/Nauru":720,"Pacific/Niue":-660,"Pacific/Norfolk":690,"Pacific/Noumea":660,"Pacific/Pago_Pago":-660,"Pacific/Palau":540,"Pacific/Pitcairn":-480,"Pacific/Ponape":660,"Pacific/Port_Moresby":600,"Pacific/Rarotonga":-600,"Pacific/Saipan":600,"Pacific/Samoa":-660,"Pacific/Tahiti":-600,"Pacific/Tarawa":720,"Pacific/Tongatapu":780,"Pacific/Truk":600,"Pacific/Wake":720,"Pacific/Wallis":720,"Pacific/Yap":600,Poland:60,Portugal:0,ROK:540,SST:660,Singapore:480,"SystemV/AST4":-240,"SystemV/AST4ADT":-240,"SystemV/CST6":-360,"SystemV/CST6CDT":-360,"SystemV/EST5":-300,"SystemV/EST5EDT":-300,"SystemV/HST10":-600,"SystemV/MST7":-420,"SystemV/MST7MDT":-420,"SystemV/PST8":-480,"SystemV/PST8PDT":-480,"SystemV/YST9":-540,"SystemV/YST9YDT":-540,Turkey:120,UCT:0,"US/Alaska":-540,"US/Aleutian":-600,"US/Arizona":-420,"US/Central":-360,"US/East-Indiana":-300,"US/Eastern":-300,"US/Hawaii":-600,"US/Indiana-Starke":-360,"US/Michigan":-300,"US/Mountain":-420,"US/Pacific":-480,"US/Pacific-New":-480,"US/Samoa":-660,UTC:0,Universal:0,VST:420,"W-SU":180,WET:0,Zulu:0},getOffset:function(e){return this.offsets[e]||0},getOffsetAsString:function(e){return this.formatOffset(this.getOffset(e))},formatOffset:function(e){var t=Math.abs(e/60),n=Math.abs(e%60),r="";return e>=0?r+="+":r+="-",t<10&&(r+="0"),r+=t,n<10&&(r+="0"),r+=n,r}}}),pen.define("common-ui/util/formatting",["common-ui/prompting/pentaho-prompting","common-ui/util/timeutil"],function(e,t){return{createDataTransportFormatter:function(e,t,n){var r=this._formatTypeMap[t.type];if(r=="number")return{format:function(e){return""+e},parse:function(e){return e}};if(r=="date")return this._createDateTransportFormatter(t)},createFormatter:function(e,t,n){if(!jsTextFormatter){console.log("Unable to find formatter module. No text formatting will be possible.");return}var r=n||t.attributes["data-format"];if(!t.list&&r)return jsTextFormatter.createFormatter(t.type,r)},_formatTypeMap:{number:"number","java.lang.Number":"number","java.lang.Byte":"number","java.lang.Short":"number","java.lang.Integer":"number","java.lang.Long":"number","java.lang.Float":"number","java.lang.Double":"number","java.math.BigDecimal":"number","java.math.BigInteger":"number",date:"date","java.util.Date":"date","java.sql.Date":"date","java.sql.Time":"date","java.sql.Timestamp":"date"},_initDateFormatters:function(){this.dateFormatters||(this.dateFormatters={"with-timezone":jsTextFormatter.createFormatter("date","yyyy-MM-dd'T'HH:mm:ss.SSSZ"),"without-timezone":jsTextFormatter.createFormatter("date","yyyy-MM-dd'T'HH:mm:ss.SSS"),utc:jsTextFormatter.createFormatter("date","yyyy-MM-dd'T'HH:mm:ss.SSS'+0000'"),simple:jsTextFormatter.createFormatter("date","yyyy-MM-dd")})},_createDataTransportFormatter:function(e,t){var n=this._formatTypeMap[e.type];if(n=="number")return{format:function(e){return t.format(e)},parse:function(e){return""+t.parse(e)}};if(n=="date"){var r=this._createDateTransportFormatter(e);return{format:function(e){return t.format(r.parse(e))},parse:function(e){return r.format(t.parse(e))}}}},_createDateTransportFormatter:function(e,n){var r=e.attributes.timezone;return this._initDateFormatters(),{format:function(e){if("client"===r)return this.dateFormatters["with-timezone"].format(e);if("server"===r||!r)return this.dateFormatters["without-timezone"].format(e);if("utc"===r)return this.dateFormatters.utc.format(e);var n=t.getOffsetAsString(r);return this.dateFormatters[n]||(this.dateFormatters[n]=jsTextFormatter.createFormatter("date","yyyy-MM-dd'T'HH:mm:ss.SSS'"+n+"'")),this.dateFormatters[n].format(e)}.bind(this),parse:function(e){if("client"===r)try{return this.dateFormatters["with-timezone"].parse(e)}catch(t){}try{return this.parseDateWithoutTimezoneInfo(e)}catch(t){}try{if(e.length==10)return this.dateFormatters.simple.parse(e)}catch(t){}try{return new Date(parseFloat(e))}catch(t){}return""}.bind(this)}},parseDateWithoutTimezoneInfo:function(e){return e.length===28&&(e=e.substring(0,23)),this.dateFormatters["without-timezone"].parse(e)},normalizeParameterValue:function(e,t,n){if(n==null||t==null)return null;var r=t.match("^\\[L([^;]+);$");r!=null&&r.length===2&&(t=r[1]);switch(t){case"java.util.Date":case"java.sql.Date":case"java.sql.Time":case"java.sql.Timestamp":var i=e.attributes.timezone;if(!i||i=="server")return e.timezoneHint==undefined&&n.length==28&&(e.timezoneHint=n.substring(23,28)),n;if(i=="client")return n;if(e.timezoneHint!=undefined&&$.trim(e.timezoneHint).length!=0&&n.match(e.timezoneHint+"$"))return n;return this.convertTimeStampToTimeZone(n,i)}return n},convertTimeStampToTimeZone:function(e,n){this._initDateFormatters();var r=t.getOffset(n),i=this.parseDateWithoutTimezoneInfo(e),s=this.dateFormatters["with-timezone"].parse(e),o=t.formatOffset(r),u=-(new Date(i)).getTimezoneOffset(),a=i.getTime()+r*6e4+(s.getTime()-i.getTime()-u*6e4),f=new Date(a);return this.dateFormatters["without-timezone"].format(f)+o}}}),pen.define("dijit/_Templated",["./_WidgetBase","./_TemplatedMixin","./_WidgetsInTemplateMixin","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/kernel"],function(e,t,n,r,i,s,o){return s.extend(e,{waiRole:"",waiState:""}),i("dijit._Templated",[t,n],{widgetsInTemplate:!1,constructor:function(){o.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin","","2.0")},_processNode:function(e,t){var n=this.inherited(arguments),i=t(e,"waiRole");i&&e.setAttribute("role",i);var s=t(e,"waiState");return s&&r.forEach(s.split(/\s*,\s*/),function(t){if(t.indexOf("-")!=-1){var n=t.split("-");e.setAttribute("aria-"+n[0],n[1])}}),n}})}),pen.define("pentaho/common/Messages",["dojo/_base/declare","dijit/_WidgetBase","dijit/_Templated","dojo/on","dojo/query","dojo/_base/lang","dojo/request","dojo/i18n","dojo/string"],function(e,t,n,r,i,s,o,u,a){var f=e("pentaho.common.Messages",[],{});f.init=function(){f.messageBundle===undefined&&(f.messageBundle={})},pentaho=typeof pentaho=="undefined"?{}:pentaho,pentaho.common=pentaho.common||{},pentaho.common.Messages=pentaho.common.Messages||f,f.addBundle=function(e,t){dojo.requireLocalization(e,t,"ROOT","ROOT"),f.messageBundle[e]=u.getLocalization(e,t)},f.getBundle=function(e){return f.messageBundle[e]},f.entityDecoder=document.createElement("textarea"),f.getString=function(e,t){var n,r,i=e;for(n in f.messageBundle)if(f.messageBundle.hasOwnProperty(n)){r=f.messageBundle[n];if(r.hasOwnProperty(e)){i=r[e];if(undefined!=t){var o={};if(typeof t=="string")o[0]=t;else if(typeof t=="array")for(var u=0;u<t.length;u++)o[""+u]=t[u];else s.isObject(t)&&(o=t);i=s.replace(i,o)}break}}return i};var l=0;return f.setElementText=function(e,t){var n;typeof e=="string"?n=document.getElementById(e):n=e,n&&(n.innerHTML=f.getString(t))},f.addUrlBundle=function(e,t,n){if(!n&&f.messageBundle.hasOwnProperty(e))return;var r=o(t,{handleAs:"json",sync:!0});r.then(function(t){f.messageBundle[e]=t},function(e){typeof console!="undefined"&&console.log("error loading message bundle at:"+t)})},f.init(),f.addUrlBundle("pentaho.common",CONTEXT_PATH+"i18n?plugin=common-ui&name=resources/web/dojo/pentaho/common/nls/messages"),f}),pen.define("reportviewer/reportviewer-prompt",["common-ui/util/util","common-ui/util/formatting","pentaho/common/Messages","dijit/registry"],function(util,ReportFormatUtil,Messages,registry){return function(){return logged({mode:"INITIAL",load:function(){pentaho.common.Messages.addUrlBundle("reportviewer",CONTEXT_PATH+"i18n?plugin=reporting&name=reportviewer/messages/messages")},createPromptPanel:function(){this.fetchParameterDefinition(null,this._createPromptPanelFetchCallback.bind(this),"INITIAL")},_createPromptPanelFetchCallback:function(e){var t=this.panel=new pentaho.common.prompting.PromptPanel("promptPanel",e);t.submit=this.submit.bind(this),t.submitStart=this.submitStart.bind(this),t.ready=this.ready.bind(this),t.getParameterDefinition=function(e,t){this.fetchParameterDefinition(e,t,"USERINPUT")}.bind(this),t.createDataTransportFormatter=ReportFormatUtil.createDataTransportFormatter.bind(ReportFormatUtil),t.createFormatter=ReportFormatUtil.createFormatter.bind(ReportFormatUtil),t.getString=pentaho.common.Messages.getString,this.initPromptPanel(),this._hideLoadingIndicator()},_hideLoadingIndicator:function(){try{window.top.hideLoadingIndicator?window.top.hideLoadingIndicator():window.parent.hideLoadingIndicator&&window.parent.hideLoadingIndicator()}catch(e){}},initPromptPanel:function(){this.panel.init()},showGlassPane:function(){registry.byId("glassPane").show()},hideGlassPane:function(){registry.byId("glassPane").hide()},ready:function(e){this.hideGlassPane()},submit:function(e,t){alert("submit fired for panel: "+e)},submitStart:function(e){alert("submit start fired for panel: "+e)},parameterParser:new pentaho.common.prompting.ParameterXmlParser,parseParameterDefinition:function(e){return this.parameterParser.normalizeParameterValue=ReportFormatUtil.normalizeParameterValue.bind(ReportFormatUtil),e=this.removeControlCharacters(e),this.parameterParser.parseParameterXml(e)},removeControlCharacters:function(inStr){for(var i=0;i<=31;i++){var safe=i;i<10&&(safe="0"+i),eval("inStr = inStr.replace(/&#"+safe+';/g, "")')}return inStr},checkSessionTimeout:function(e,t){return e.status==401||this.isSessionTimeoutResponse(e)?(this.handleSessionTimeout(t),!0):!1},isSessionTimeoutResponse:function(e){return String(e).indexOf("j_spring_security_check")!=-1?!0:!1},handleSessionTimeout:function(e){var t=function(){this.fetchParameterDefinition.apply(this,e)}.bind(this);this.reauthenticate(t)},reauthenticate:function(e){var t=null;try{var n=window.parent.mantle_initialized;t=!0}catch(r){t=!1}if(t&&top.mantle_initialized){var i={loginCallback:e};window.parent.authenticate(i)}else this.showMessageBox(pentaho.common.Messages.getString("SessionExpiredComment"),pentaho.common.Messages.getString("SessionExpired"),pentaho.common.Messages.getString("OK"),undefined,undefined,undefined,!0)},_fetchParamDefId:-1,fetchParameterDefinition:function(e,t,n){var r=this,i=++r._fetchParamDefId;r.showGlassPane(),n||(n="MANUAL");if(r.clicking){var s=n==="USERINPUT";r.ignoreNextClickSubmit=s,e&&(e.forceAutoSubmit=s),delete r.clicking}r.mode=n;var o=util.getUrlParameters();e&&$.extend(o,e.getParameterValues()),o.renderMode=this._getParameterDefinitionRenderMode(e,n),delete o["::session"];var u=arguments,a=logged("fetchParameterDefinition_success",function(s){if(r.checkSessionTimeout(s,u))return;if(i!==r._fetchParamDefId)return;try{var o=r.parseParameterDefinition(s);if(n==="INITIAL"&&o.allowAutoSubmit()){r.fetchParameterDefinition(null,t,"MANUAL");return}var a=e&&e.getAutoSubmitSetting();a!=null&&(o.autoSubmitUI=a),t.call(r,o)}catch(f){r.onFatalError(f)}}),f=function(e){r.checkSessionTimeout(e,u)||r.onFatalError(e)};$.ajax({async:!0,traditional:!0,cache:!1,type:"POST",url:r.getParameterUrl(),data:o,dataType:"text",success:a,error:f})},_getParameterDefinitionRenderMode:function(e,t){switch(t){case"INITIAL":return"PARAMETER";case"USERINPUT":if(!e||!e.getAutoSubmitSetting())return"PARAMETER"}return"XML"},getParameterUrl:function(){return"parameter"},showMessageBox:function(e,t,n,r,i,s,o){var u=registry.byId("messageBox");u.setTitle(t),u.setMessage(e);if(o)u.setButtons([]);else{var a=function(){Dashboards.hideProgressIndicator(),u.hide.call(u)};n||(n=pentaho.common.Messages.getString("OK")),r||(r=a),u.onCancel=a,i?(u.callbacks=[r,s],u.setButtons([n,i])):(u.callbacks=[r],u.setButtons([n]))}Dashboards.showProgressIndicator(),u.show()},onFatalError:function(e){var t=pentaho.common.Messages.getString("ErrorParsingParamXmlMessage");typeof console!="undefined"&&console.log&&console.log(t+": "+e),this.showMessageBox(t,pentaho.common.Messages.getString("FatalErrorTitle"))}})}}),pen.define("dojo/text!pentaho/common/button.html",[],function(){return'<button type="button" data-dojo-attach-point="button" tabindex="0" class="pentaho-button" id="${id}">\n	${label}\n</button>'}),pen.define("pentaho/common/button",["dojo/_base/declare","dijit/_WidgetBase","dijit/_Templated","dojo/_base/lang","dojo/text!pentaho/common/button.html","dojo/on"],function(e,t,n,r,i,s){return e("pentaho.common.button",[t,n],{label:"a button",onClick:function(){this.callback()},callback:null,templateString:i,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments),s(this.button,"click",r.hitch(this,this.onClick))}})}),pen.define("pentaho/common/Dialog",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dojo/on","dojo/dom","dojo/query","dojo/dom-construct","dojo/dom-style","dijit/Dialog","pentaho/common/button","pentaho/common/SmallImageButton","pentaho/common/Messages","dojo/dom-class","dojo/_base/lang","dojo/_base/event","dojo/keys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){return e("pentaho.common.Dialog",[t,n,r],{popup:null,title:"",getLocaleString:pentaho.common.Messages.getString,callbacks:[],shown:!1,buttonsCreated:!1,buttonPanel:null,hasTitleBar:!0,hasBorder:!0,hasCloseIcon:!1,closeIcon:undefined,_onCancelCallback:undefined,setLocalizationLookupFunction:function(e){this.getLocaleString=e,this._localize()},buttonClick:function(e){this.callbacks[e]&&this.callbacks[e]()},buttons:[],_localize:function(){if(this.getLocaleString){for(var e=0;e<this.buttons.length;e++){var t=o("button"+e,this.popup.domNode);this.buttons[e]=this.getLocaleString(this.buttons[e]),t&&(t.innerHTML=this.getLocaleString())}this.hasCloseIcon&&this.closeIcon.domNode.setAttribute("title",this.getLocaleString("CloseIcon_title"))}},templateString:"<div></div>",postMixInProperties:function(){this.inherited(arguments)},_createButtonPanel:function(){this.buttonPanel=u.create("TABLE"),a.set(this.buttonPanel,"width","100%"),u.place(this.buttonPanel,this.popup.domNode),p.add(this.buttonPanel,"button-panel")},_createButtons:function(){this.buttonPanel.rows.length>0&&this.buttonPanel.deleteRow(-1);var e=this.buttonPanel.insertRow(-1),t=e.insertCell(-1);a.set(t,"align","right"),a.set(t,"width","100%");for(var n=0;n<this.buttons.length;n++){t=e.insertCell(-1),a.set(t,"align","right");var r=document.createElement("BUTTON");p.add(r,"pentaho-button"),r.setAttribute("id","button"+n),r.innerHTML=this.buttons[n],t.appendChild(r),r.onclick=d.hitch(this,this.buttonClick,n)}},setButtonEnabled:function(e,t){var n=s.byId("button"+e);typeof n!="undefined"&&n!=null&&(typeof n.set!="undefined"?n.set("disabled",!t):n.disabled=!t)},postCreate:function(){(this.templatePath||this.templateString!="<div></div>")&&this.popup.attr("content",this.domNode),this.inherited(arguments),this.hasTitleBar||p.add(o(".dijitDialogTitleBar",this.popup.domNode)[0],"hidden"),this.hasBorder&&p.add(this.popup.domNode,"pentaho-dialog"),this.hasCloseIcon&&(this.closeIcon=new pentaho.common.SmallImageButton({baseClass:"pentaho-closebutton"}),p.add(this.closeIcon.domNode,"pentahoDialogCloseIcon"),u.place(this.closeIcon.domNode,o(".dijitDialogTitleBar",this.popup.domNode)[0]),this.closeIcon.callback=d.hitch(this,this.onCancel)),p.add(o(".dijitDialogTitleBar",this.popup.domNode)[0],"Caption"),i(this.domNode,"keyPress",d.hitch(this,this.keyUp)),i(this.popup.domNode,"keyPress",d.hitch(this,this.keyUp)),this.onKeyUp=d.hitch(this,this.keyup),i(this.domNode,"keyUp",d.hitch(this,this.keyup)),i(this.popup,"keyUp",d.hitch(this,this.keyup)),i(this.popup.domNode,"keyUp",d.hitch(this,this.keyup)),this.popup.onCancel=d.hitch(this,function(){}),this.popup.onExecute=d.hitch(this,this.okClick),this._localize(),i(this.popup,"Hide",d.hitch(d.hitch(this,"onHide")))},keyup:function(e){v.stop(e),e.keyCode==m.ENTER&&this.execute&&this.execute(),e.keyCode==m.ESCAPE&&this.onCancel&&this.onCancel()},setTitle:function(e){this.title=e,this.popup.set("title",this.title)},show:function(){this.domNode.style.display="",this.popup.set("title",this.title),a.set(this.popup.domNode,"display","none"),this.templateBased?this.shown||(this.width=""+a.get(this.domNode,"width")+"px",a.get(this.domNode,"display")==="block"&&(this.width=a.get(this.domNode,"width")+a.get(this.domNode,"paddingLeft")+a.get(this.domNode,"paddingRight")+a.get(this.domNode,"borderLeftWidth")+a.get(this.domNode,"borderRightWidth")+"px"),a.set(this.popup.domNode,"width",this.width),a.set(o(".dijitDialogPaneContent",this.popup.domNode),"width",this.width),a.set(o(".dijitDialogPaneContent",this.domNode),"width",this.width)):this.shown||(a.set(this.domNode,"width",this.width),a.set(this.popup.domNode,"width",this.width),a.set(o(".dijitDialogPaneContent",this.popup.domNode),"width",this.width),a.set(o(".dijitDialogPaneContent",this.domNode),"width",this.width),a.set(this.domNode,"height",this.height),a.set(this.popup.domNode,"height",this.height),a.set(o(".dijitDialogPaneContent",this.popup.domNode),"height",this.height),a.set(o(".dijitDialogPaneContent",this.domNode),"height",this.height)),this.shown||this._createButtonPanel(),this._createButtons(),this.popup.show(),this.shown=!0},hide:function(){return this.popup.hide()},destroy:function(){this.popup.destroy()},destroyRecursive:function(){this.popup.destroyRecursive(),u.empty(this.domNode)},buildRendering:function(){this.templatePath&&(this.templateString=null),this.inherited(arguments),this.templateString=="<div></div>"&&this.popup.buildRendering()},_attachTemplateNodes:function(e,t){this.inherited(arguments)},_fillContent:function(e){!this.templatePath&&this.templateString=="<div></div>"?(this.templateBased=!1,this.width=""+a.get(e,"width")+"px",this.height=""+a.get(e,"height")+"px",p.contains(e,"hidden")&&p.remove(e,"hidden"),this._attachTemplateNodes(e),this.source=e,this.popup=new f({title:this.title,content:this.source.innerHTML}),p.add(this.popup.domNode,"pentaho-dialog"),p.remove(this.popup.domNode,"hidden"),p.add(o(".dijitDialogTitleBar",this.popup.domNode)[0],"Caption")):(this.templateBased=!0,this.popup=new f),this.inherited(arguments)},registerOnCancelCallback:function(e){this._onCancelCallback=e},onCancel:function(){if(this._onCancelCallback)try{this._onCancelCallback()}catch(e){console.warn("error in onCancelCallback: "+e)}this.hide()},onHide:function(){}})}),pen.define("pentaho/reportviewer/ReportDialog",["dojo/_base/declare","dojo/on","dojo/query","dojo/_base/lang","dijit/_WidgetBase","dijit/_TemplatedMixin","pentaho/common/button","pentaho/common/Dialog","dojo/dom-style","dojo/dom-attr"],function(e,t,n,r,i,s,o,u,a,f){return e("pentaho.reportviewer.ReportDialog",[pentaho.common.Dialog],{hasCloseIcon:!1,width:"800px",height:"600px",buttons:["OK"],templateString:'<div style="padding: 5px 10px 10px 10px;" class="dialog-content"><iframe data-dojo-attach-point="iframe" width="100%" height="100%"></iframe></div>',cleanseSizeAttr:function(e,t){return e===undefined?t:(/.*px$/.exec(e)||(e+="px"),e)},open:function(e,t,n,r){this.setTitle(e),a.set(this.domNode,"width",this.cleanseSizeAttr(n,this.width)),a.set(this.domNode,"height",this.cleanseSizeAttr(r,this.height)),f.set(this.iframe,"src",t),this.show()},postCreate:function(){this.inherited(arguments),this.callbacks=[r.hitch(this,this.onCancel)]}})}),pen.define("reportviewer/reportviewer",["common-ui/util/util","reportviewer/reportviewer-prompt","common-ui/util/timeutil","common-ui/util/formatting","pentaho/common/Messages","dojo/dom","dojo/on","dojo/_base/lang","dijit/registry","dojo/has","dojo/sniff","dojo/dom-class","pentaho/reportviewer/ReportDialog","dojo/dom-style","dojo/query","dojo/dom-geometry","dojo/parser","dojo/window","dojo/_base/window"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){return function(t){if(!t){alert("report prompt is required");return}var n=logged({prompt:t,load:function(){function e(e){e.setAttribute("style","-webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;"),typeof e.onselectstart!="undefined"&&(e.setAttribute("unselectable","on"),e.onselectstart=function(){return!1})}m.parse(),pentaho.common.Messages.addUrlBundle("reportviewer",CONTEXT_PATH+"i18n?plugin=reporting&name=reportviewer/messages/messages"),this.view.localize(),this.createRequiredHooks(),this.view.updatePageBackground(),e(s.byId("reportArea")),e(s.byId("reportPageOutline")),e(s.byId("reportContent")),o(a.byId("toolbar-parameterToggle"),"click",u.hitch(this,function(){this.view.togglePromptPanel()}));var t=this._onReportContentLoaded.bind(this),n=logged("onFrameLoaded",function(){setTimeout(t)});f("ie")?o(s.byId("reportContent"),"readystatechange",function(){this.readyState==="complete"&&n()}):o(s.byId("reportContent"),"load",u.hitch(n));var r=this.prompt.ready.bind(this.prompt),i=this.prompt.showGlassPane.bind(this.prompt),l=this.prompt.hideGlassPane.bind(this.prompt);this.prompt.ready=this.view.promptReady.bind(this.view,r),this.prompt.showGlassPane=this.view.showGlassPane.bind(this.view,i),this.prompt.hideGlassPane=this.view.hideGlassPane.bind(this.view,l),this.prompt.submit=this.submitReport.bind(this),this.prompt.submitStart=this.submitReportStart.bind(this),$("body").addClass(_isTopReportViewer?"topViewer leafViewer":"leafViewer").addClass(inMobile?"mobile":"nonMobile"),logger&&$("body").addClass("debug");var c=this.prompt.initPromptPanel.bind(this.prompt);this.prompt.initPromptPanel=logged("prompt.initPromptPanel",function(){var e=this.prompt.panel,t=e.init;e.init=function(e){this.view.initPrompt(t,this.prompt.panel,e)}.bind(this),c()}.bind(this)),this.prompt.createPromptPanel()},view:logged({localize:function(){$("#toolbar-parameterToggle").attr("title",pentaho.common.Messages.getString("parameterToolbarItem_title")),a.byId("pageControl").registerLocalizationLookup(pentaho.common.Messages.getString)},updatePageBackground:function(){var e;try{e=window.top.mantle_initialized}catch(t){e=!1}var n=top!==self;!inSchedulerDialog&&!inMobile&&(!e||n)&&c.add(document.body,"pentaho-page-background")},_showReportContent:function(e,t){var n=this._hasReportContent();n||(e=!1),this._isReportContentVisible()!==!!e&&(!e&&!t&&n&&(logger&&logger.log("Will clear content iframe.src"),$("#reportContent").attr("src","about:blank"),this._updatedIFrameSrc=!0),$("body")[e?"removeClass":"addClass"]("contentHidden"))},_calcReportContentVisibility:function(e){var t=this._hasReportContent()&&!e.paramDefn.promptNeeded&&!inSchedulerDialog&&(this._isAutoSubmitAllowed(e)||prompt.mode==="MANUAL");return t},_isAutoSubmitAllowed:function(e){if(e.forceAutoSubmit||e.paramDefn.allowAutoSubmit())return!0;var t=document.getElementsByTagName("IFRAME");if(t.length>0){var n=t[0].src;return n!=null&&n.indexOf("dashboard-mode")!==-1}return!1},_hasReportContent:function(){var e=s.byId("reportContent"),t=e.src;return t!==""&&t!=="about:blank"},_isReportContentVisible:function(){return!$("body").hasClass("contentHidden")},initPrompt:function(e,t,n){t.paramDefn.showParameterUI()||this._hideToolbarPromptControls(),this._calcReportContentVisibility(t)||this._showReportContent(!1),this._layoutInited=!1,e.call(t,n),this._initLayout(t)},_hideToolbarPromptControls:function(){inMobile||c.add("toolbar-parameter-separator","hidden");var e="toolbar-parameterToggle",t=s.byId(e);while(t){if(t.getAttribute("widgetid")===e){c.add(t,"hidden");break}t=t.parentNode}},showGlassPane:function(e){$("#glasspane").css("background",n.reportContentUpdating()?"":"transparent"),e()},hideGlassPane:function(e){n.reportContentUpdating()||e(),$("#glasspane").css("background","")},promptReady:function(e,t){e(t);if(inSchedulerDialog){this.showPromptPanel(!0),a.byId("glassPane").hide(),c.add("reportContent","hidden"),c.add(d(".submit-panel")[0],"hidden"),c.add("toolbarlinner2","hidden"),c.remove("promptPanel","pentaho-rounded-panel-bottom-lr"),c.remove("reportControlPanel","pentaho-shadow"),c.remove("reportControlPanel","pentaho-rounded-panel-bottom-lr");if(typeof window.parameterValidityCallback!="undefined"){var n=!t.paramDefn.promptNeeded;window.parameterValidityCallback(n)}}},_initLayout:function(e){if(this._layoutInited)return;var t=!!this._initedOnce;this._initedOnce=!0;var n=e.paramDefn.showParameterUI();this.updatePageControl(e);var r=!e.paramDefn.paginate&&!n;c[r?"add":"remove"]("toppanel","hidden");var i;n?t||(i=!inMobile&&_isTopReportViewer||e.paramDefn.promptNeeded||!e.paramDefn.allowAutoSubmit()):i=!1,i!=null&&this.showPromptPanel(i),this._layoutInited=!0},show:function(){this.resize()},updatePageControl:function(e){var t=a.byId("pageControl");t.registerPageNumberChangeCallback(undefined);if(!e.paramDefn.paginate)e.setParameterValue(e.paramDefn.getParameter("accepted-page"),"-1"),t.setPageCount(1),t.setPageNumber(1);else{var n=e.paramDefn.totalPages,r=e.paramDefn.page;r=Math.max(0,Math.min(r,n-1)),e.setParameterValue(e.paramDefn.getParameter("accepted-page"),""+r),t.setPageCount(n),t.setPageNumber(r+1)}t.registerPageNumberChangeCallback(function(t){this.pageChanged(e,t)}.bind(this))},pageChanged:function(e,t){e.setParameterValue(e.paramDefn.getParameter("accepted-page"),""+(t-1)),e.submit(e,{isPageChange:!0})},togglePromptPanel:function(){this.showPromptPanel(a.byId("toolbar-parameterToggle").checked),this.resize()},showPromptPanel:function(e){a.byId("toolbar-parameterToggle").set("checked",!!e),c[e?"remove":"add"]("reportControlPanel","hidden")},isPageStyled:function(){return $("body").hasClass("styled")},setPageStyled:function(e){e=!!e;if(!this._pageStyledOnce||this.isPageStyled()!==e){this._pageStyledOnce=!0;var t=e?"addClass":"removeClass";$("body")[t]("styled")[e?"removeClass":"addClass"]("nonStyled"),e||($("#reportArea").css({height:""}),$("#reportContent").css({height:"",width:""})),$("#reportPageOutline")[t]("pentaho-rounded-panel2-shadowed pentaho-padding-lg pentaho-background")}},onViewportResize:function(){this.resizeContentArea()},resizeContentArea:function(e){var t=g.getBox(),n=v.getMarginBox("toppanel"),r={h:t.h-n.h-2};logger&&logger.log("viewport=("+t.w+","+t.h+") "+" toppanel=("+n.w+","+n.h+") "),v.setMarginBox("reportArea",r),inMobile&&this._isHtmlReport&&this._resizeMobileHtmlReportHandlesScrolling(r)},_resizeMobileHtmlReportHandlesScrolling:function(e){var t=$("#reportContent"),n=t.contents(),r=n.find('head>meta[name="generator"]').attr("content")||"",i=r.indexOf("Reporting")>=0;if(i){t.attr("scrolling","no");var s=e.h-15,o=n.find("#reportTableDiv");o.length?o.css({height:s,width:window.innerWidth-10+"px",overflow:"auto"}):(n.find("body").css({margin:"2px"}),n.find("body>table").wrap('<div id="reportTableDiv" style="height:'+s+"px; width:"+(window.innerWidth-10)+'px; overflow:auto;"/>'))}},resize:function(){if(!this._hasReportContent())return;var e=this._isReportContentVisible();e&&this._showReportContent(!1,!0),this.isPageStyled()&&this._pollReportContentSize(),this.resizeContentArea(),e&&this._showReportContent(!0)},_pollReportContentSize:function(){var e=10,t=s.byId("reportContent");v.setContentSize(t,{w:e,h:e});var n=document;y.withDoc(t.contentWindow.document,function(){p.set(y.doc.getElementsByTagName("html")[0],{overflow:"hidden"});var r=v.getMarginBox(y.doc.getElementsByTagName("body")[0]);r.w=$("#reportContent").contents().width(),logger&&logger.log("Styled page - polled dimensions = ("+r.w+", "+r.h+")");if(r.w<=e){var i;y.withDoc(n,function(){i=g.getBox()}),r.w=Math.round(2*i.w/3),logger&&logger.log("Width is too small - assuming a default width of "+r.w)}v.setContentSize(t,{w:r.w,h:r.h})})}}),createRequiredHooks:function(e){var t=null;try{var n=window.top.mantle_initialized;t=!0}catch(r){t=!1}t&&(top.mantle_initialized||(top.mantle_openTab=function(e,t,n){window.open(n,"_blank")}),top.mantle_initialized?top.reportViewer_openUrlInDialog=function(e,t,n,r){top.urlCommand(t,e,!0,n,r)}:top.reportViewer_openUrlInDialog=this.openUrlInDialog.bind(this),window.reportViewer_openUrlInDialog=top.reportViewer_openUrlInDialog),window.reportViewer_hide=this.hide.bind(this);var i=this;t&&typeof window.top.addGlassPaneListener!="undefined"&&window.top.addGlassPaneListener({glassPaneHidden:function(){i.view.show()}})},openUrlInDialog:function(e,t,n,r){this.dialog===undefined&&(this.dialog=new pentaho.reportviewer.ReportDialog,this.dialog.setLocalizationLookupFunction(pentaho.common.Messages.getString)),this.dialog.open(e,t,n,r)},hide:function(){$("#toppanel").empty(),this.view.resize()},submitReportStart:function(){this.prompt.clicking=!0},submitReport:function(e,t){var n=t&&t.isInit;if(!n){if(this.prompt.ignoreNextClickSubmit){delete this.prompt.ignoreNextClickSubmit,logger&&logger.log("Ignored submit click");return}this.prompt.mode="MANUAL"}try{if(inSchedulerDialog){this._submitReportEnded(e);return}this.view._initLayout(e);var r=!e.paramDefn.promptNeeded;if(!r){logger&&logger.log("Prompt is needed. Will clear htmlObject.src"),$("#"+this.htmlObject).attr("src","about:blank"),this._submitReportEnded(e);return}this._updateReportContent(e,t)}catch(i){throw this._submitReportEnded(e),i}},_updatedIFrameSrc:!1,_updateReportTimeout:-1,reportContentUpdating:function(){return this._updateReportTimeout>=0},_updateReportContent:function(e,t){var n=this;if(!e.getAutoSubmitSetting()){var r=logged("_updateReportContent_fetchParameterCallback",function(r){delete e.forceAutoSubmit,e.refresh(r,!0),n._updateReportContentCore(e,t)});n.prompt.fetchParameterDefinition(e,r,"MANUAL")}else n._updateReportContentCore(e,t)},_updateReportContentCore:function(e,t){var n=this;n._updateReportTimeout=setTimeout(logged("updateReportTimeout",function(){n._submitReportEnded(e,!0)}),5e3),n.prompt.showGlassPane();var r=n._buildReportContentOptions(e),i=n._buildReportContentUrl(r),s=r["output-target"],o=s.indexOf("html")!=-1,u=o&&r["htmlProportionalWidth"]=="true",a=c.contains("toppanel","hidden"),f=_isTopReportViewer&&!a&&o&&!u&&!inMobile;n.view.isPageStyled()!==f&&(logger&&logger.log("Page style will change to "+(f?"":"non-")+"styled. Will hide report before iframe update."),n.view._showReportContent(!1,!0)),logger&&logger.log("Will set iframe url to "+i.substr(0,50)+"... "),$("#reportContent").attr("src",i),this._updatedIFrameSrc=!0,n._submitLoadCallback=logged("_submitLoadCallback",function(){n._isHtmlReport=n.view._isHtmlReport=o,n._outputFormat=s;var t=n.view._calcReportContentVisibility(e);t&&(n.view.setPageStyled(f&&!this._isParentViewer),n.view.resize()),n.view._showReportContent(t),n._submitReportEnded(e)})},_submitReportEnded:function(e,t){delete this.prompt.clicking,e&&delete e.forceAutoSubmit,delete this.prompt.ignoreNextClickSubmit,this._updateReportTimeout>=0&&(clearTimeout(this._updateReportTimeout),this._updateReportTimeout=-1,t&&this.view._showReportContent(!1,!0),this.prompt.hideGlassPane())},_onReportContentLoaded:function(){var e=this._isParentViewer;this._detectLoadedContent();var t=this.view;if(!this._updatedIFrameSrc)t._hasReportContent()?this._isParentViewer&&!e?(t.setPageStyled(!1),t.resize()):logger&&logger.log("Unrequested IFrame load."):logger&&logger.log("Empty IFrame loaded.");else{this._updatedIFrameSrc=!1;var n=this._submitLoadCallback;n&&t._hasReportContent()?(delete this._submitLoadCallback,n.call(this)):t.resize()}},_detectLoadedContent:function(){var e=!1;try{var t=s.byId("reportContent").contentWindow;t&&(t._isReportViewer?e=!0:$(t.document).find("body area").each(function(){this.href=this.href.replace("http://localhost:8080","")}))}catch(n){logger&&logger.log("ERROR"+String(n))}this._isParentViewer=e,$("body")[e?"addClass":"removeClass"]("parentViewer")[e?"removeClass":"addClass"]("leafViewer")},_buildReportContentOptions:function(t){var n=e.getUrlParameters();return $.extend(n,t.getParameterValues()),n.renderMode="REPORT",n.name===undefined&&(n.name=n.action),delete n["::session"],n},_buildReportContentUrl:function(e){var t=window.location.href;t=t.substring(0,t.lastIndexOf("/"))+"/report?";var n=[],r=function(e,t){t&&n.push(e+"="+encodeURIComponent(t))};return $.each(e,function(e,t){if(t==null)return;var n=encodeURIComponent(e);$.isArray(t)?$.each(t,function(e,t){r(n,t)}):r(n,t)}),t+n.join("&")}});return t.load=n.load.bind(n),n}}),pen.define("reportviewer/reportviewer-logging",[],function(){var e="&nbsp;&nbsp;&nbsp;&nbsp;",t=function(e){return e==null?"":String(e)},n=function(e){return t(e).replace("&","&amp;").replace("<","&lt;")},r=function(e,t,r){if(t.__logwrapper__)return t;var i=function(){r.group(e);var i=r.count(),s,o;try{return s=t.apply(this,arguments)}catch(u){throw o=u,r.raw("$*? "+n(u),null,i),u}finally{!o&&s!==undefined&&r.raw("&rarr; "+n(s),null,i),r.groupEnd(e)}};return i.__logwrapper__=!0,i},i=function(r,i){i||(i={}),r||(r="unnamed");var s=i.parent;if(s)return{id:r,raw:function(e,t,n){s.raw(e,t||r,n)},log:function(e,t,n){s.log(e,t||r,n)},group:function(e,t,n){s.group(e,t||r,n)},groupEnd:function(){s.groupEnd()},count:function(){return s.count()}};var o=!!i.enabled;if(!o)return null;var u=window.open("",i.winname||"report_viewer_log");if(!u)return null;var a=u.document;a.open(),a.write('<h1>LOG</h1><table id="logTable"><tbody /></table>'),a.close();var f=$(a).find("#logTable > tbody"),l=[],c=1,h={},p=["green","blue","red"],d=0,v=function(e){return h[e]||(h[e]=p[d++%p.length])},m=function(e,n,i){n==null&&(n=r);var s=i!=null&&i===c;c++;try{s?$("<span>&nbsp;"+t(e)+"</span>",a).appendTo(f.children().last().children().last()):$('<tr><td style="color:'+v(n)+';">'+n+"</td>"+"<td>"+l.join("")+t(e)+"</td>"+"</tr>",a).appendTo(f)}catch(o){alert("["+n+"] log - "+o)}};return{raw:function(e,t,n){m(e,t,n)},log:function(e,t,r){m("&bull; "+n(e),t,r)},group:function(t,r,i){m("&rsaquo; "+n(t),r,i),l.push(e)},groupEnd:function(){c++,l.pop()},count:function(){return c}}},s=function(e){var t;return e?t=function(t,n){switch(typeof t){case"string":return r(t,n,e);case"function":return r("anonymous",t,e)}for(var i in t){var n=t[i];typeof n=="function"&&(t[i]=r(i,n,e))}return t}:t=function(e,t){return typeof e=="string"?t:e},t.logger=e,t};return{create:function(e,t){var n=i(e,t);return s(n)}}}),pen.define("dojo/text!pentaho/common/MessageBox.html",[],function(){return'<div class="dialog-content pentaho-padding-sm" style="width:100%; overflow: auto">\n	<table width="100%">\n    <tbody>\n      <tr>\n        <td>\n          <div data-dojo-attach-point="typeIcon"></div>\n        </td>\n        <td width="100%" valign="middle">\n          <div data-dojo-attach-point="messagelbl" class="label pentaho-padding-lg"></div>\n        </td>\n      </tr>\n    </tbody>\n	</table>\n</div>'}),pen.define("pentaho/common/MessageBox",["dojo/_base/declare","dijit/_WidgetBase","dijit/_Templated","dojo/on","dojo/query","pentaho/common/button","pentaho/common/Dialog","dojo/dom-class","dojo/text!pentaho/common/MessageBox.html"],function(e,t,n,r,i,s,o,u,a){return e("pentaho.common.MessageBox",[o],{buttons:["btn1","btn2","btn3"],messageType:null,setTitle:function(e){this.set("title",e)},postCreate:function(){this.inherited(arguments),this.setMessageType(this.messageType)},setMessageType:function(e){this.messageType=e,e!=null?e=="ERR"||e=="ERROR"?u.replace(this.typeIcon,"error-large-icon","warning-large-icon info-large-icon"):e=="WARN"||e=="WARNING"?u.replace(this.typeIcon,"warning-large-icon","error-large-icon info-large-icon"):u.replace(this.typeIcon,"info-large-icon","error-large-icon warning-large-icon"):u.remove(this.typeIcon,"error-large-icon info-large-icon warning-large-icon")},setMessage:function(e){this.messagelbl.innerHTML=e},setButtons:function(e){this.buttons=e;for(var t=0;t<3;t++){var n=i("button"+t,this.popup.domNode);n&&(t<this.buttons.length?(n.innerHTML=this.buttons[t],u.remove(n,"hidden")):u.add(n,"hidden"))}},templateString:a})}),pen.define("dojo/text!dijit/templates/Menu.html",[],function(){return'<table class="dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role="menu" tabIndex="${tabIndex}"\n	   cellspacing="0">\n	<tbody class="dijitReset" data-dojo-attach-point="containerNode"></tbody>\n</table>\n'}),pen.define("dijit/_KeyNavMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/keys","dojo/_base/lang","dojo/on","dijit/registry","dijit/_FocusMixin"],function(e,t,n,r,i,s,o,u){return t("dijit._KeyNavMixin",u,{tabIndex:"0",childSelector:null,postCreate:function(){this.inherited(arguments),n.set(this.domNode,"tabIndex",this.tabIndex);if(!this._keyNavCodes){var e=this._keyNavCodes={};e[r.HOME]=i.hitch(this,"focusFirstChild"),e[r.END]=i.hitch(this,"focusLastChild"),e[this.isLeftToRight()?r.LEFT_ARROW:r.RIGHT_ARROW]=i.hitch(this,"_onLeftArrow"),e[this.isLeftToRight()?r.RIGHT_ARROW:r.LEFT_ARROW]=i.hitch(this,"_onRightArrow"),e[r.UP_ARROW]=i.hitch(this,"_onUpArrow"),e[r.DOWN_ARROW]=i.hitch(this,"_onDownArrow")}var t=this,u=typeof this.childSelector=="string"?this.childSelector:i.hitch(this,"childSelector");this.own(s(this.domNode,"keypress",i.hitch(this,"_onContainerKeypress")),s(this.domNode,"keydown",i.hitch(this,"_onContainerKeydown")),s(this.domNode,"focus",i.hitch(this,"_onContainerFocus")),s(this.containerNode,s.selector(u,"focusin"),function(e){t._onChildFocus(o.getEnclosingWidget(this),e)}))},_onLeftArrow:function(){},_onRightArrow:function(){},_onUpArrow:function(){},_onDownArrow:function(){},focus:function(){this.focusFirstChild()},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1)},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1)},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild())},focusLastChild:function(){this.focusChild(this._getLastFocusableChild())},focusChild:function(e,t){if(!e)return;this.focusedChild&&e!==this.focusedChild&&this._onChildBlur(this.focusedChild),e.set("tabIndex",this.tabIndex),e.focus(t?"end":"start")},_onContainerFocus:function(e){if(e.target!==this.domNode||this.focusedChild)return;this.focus()},_onFocus:function(){n.set(this.domNode,"tabIndex","-1"),this.inherited(arguments)},_onBlur:function(e){n.set(this.domNode,"tabIndex",this.tabIndex),this.focusedChild&&(this.focusedChild.set("tabIndex","-1"),this.lastFocusedChild=this.focusedChild,this._set("focusedChild",null)),this.inherited(arguments)},_onChildFocus:function(e){e&&e!=this.focusedChild&&(this.focusedChild&&!this.focusedChild._destroyed&&this.focusedChild.set("tabIndex","-1"),e.set("tabIndex",this.tabIndex),this.lastFocused=e,this._set("focusedChild",e))},_searchString:"",multiCharSearchDuration:1e3,onKeyboardSearch:function(e,t,n,r){e&&this.focusChild(e)},_keyboardSearchCompare:function(e,t){var n=e.domNode,r=e.label||(n.focusNode?n.focusNode.label:"")||n.innerText||n.textContent||"",i=r.replace(/^\s+/,"").substr(0,t.length).toLowerCase();return!t.length||i!=t?0:-1},_onContainerKeydown:function(e){var t=this._keyNavCodes[e.keyCode];t?(t(e,this.focusedChild),e.stopPropagation(),e.preventDefault(),this._searchString=""):e.keyCode==r.SPACE&&this._searchTimer&&!(e.ctrlKey||e.altKey||e.metaKey)&&(e.stopImmediatePropagation(),e.preventDefault(),this._keyboardSearch(e," "))},_onContainerKeypress:function(e){if(e.charCode<r.SPACE||e.ctrlKey||e.altKey||e.metaKey||e.charCode==r.SPACE&&this._searchTimer)return;e.preventDefault(),e.stopPropagation(),this._keyboardSearch(e,String.fromCharCode(e.charCode).toLowerCase())},_keyboardSearch:function(e,t){var n=null,r,s=0,o=i.hitch(this,function(){this._searchTimer&&this._searchTimer.remove(),this._searchString+=t;var e=/^(.)\1*$/.test(this._searchString),i=e?1:this._searchString.length;r=this._searchString.substr(0,i),this._searchTimer=this.defer(function(){this._searchTimer=null,this._searchString=""},this.multiCharSearchDuration);var o=this.focusedChild||null;if(i==1||!o){o=this._getNextFocusableChild(o,1);if(!o)return}var u=o;do{var a=this._keyboardSearchCompare(o,r);!!a&&s++==0&&(n=o);if(a==-1){s=-1;break}o=this._getNextFocusableChild(o,1)}while(o!=u)});o(),this.onKeyboardSearch(n,e,r,s)},_onChildBlur:function(){},_getNextFocusableChild:function(e,t){var n=e;do{if(!e){e=this[t>0?"_getFirst":"_getLast"]();if(!e)break}else e=this._getNext(e,t);if(e!=null&&e!=n&&e.isFocusable())return e}while(e!=n);return null},_getFirst:function(){return null},_getLast:function(){return null},_getNext:function(e,t){if(e){e=e.domNode;while(e){e=e[t<0?"previousSibling":"nextSibling"];if(e&&"getAttribute"in e){var n=o.byNode(e);if(n)return n}}}return null}})}),pen.define("dijit/_KeyNavContainer",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/_base/kernel","dojo/keys","dojo/_base/lang","./registry","./_Container","./_FocusMixin","./_KeyNavMixin"],function(e,t,n,r,i,s,o,u,a,f){return t("dijit._KeyNavContainer",[a,f,u],{connectKeyNavHandlers:function(t,n){var r=this._keyNavCodes={},o=s.hitch(this,"focusPrev"),u=s.hitch(this,"focusNext");e.forEach(t,function(e){r[e]=o}),e.forEach(n,function(e){r[e]=u}),r[i.HOME]=s.hitch(this,"focusFirstChild"),r[i.END]=s.hitch(this,"focusLastChild")},startupKeyNavChildren:function(){r.deprecated("startupKeyNavChildren() call no longer needed","","2.0")},startup:function(){this.inherited(arguments),e.forEach(this.getChildren(),s.hitch(this,"_startupChild"))},addChild:function(e,t){this.inherited(arguments),this._startupChild(e)},_startupChild:function(e){e.set("tabIndex","-1")},_getFirst:function(){var e=this.getChildren();return e.length?e[0]:null},_getLast:function(){var e=this.getChildren();return e.length?e[e.length-1]:null},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1))},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),!0)},childSelector:function(e){var e=o.byNode(e);return e&&e.getParent()==this}})}),pen.define("dijit/_MenuBase",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/lang","dojo/mouse","dojo/on","dojo/window","./a11yclick","./registry","./_Widget","./_CssStateMixin","./_KeyNavContainer","./_TemplatedMixin"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){return t("dijit._MenuBase",[c,d,p,h],{selected:null,_setSelectedAttr:function(e){this.selected!=e&&(this.selected&&(this.selected._setSelected(!1),this._onChildDeselect(this.selected)),e&&e._setSelected(!0),this._set("selected",e))},activated:!1,_setActivatedAttr:function(e){i.toggle(this.domNode,"dijitMenuActive",e),i.toggle(this.domNode,"dijitMenuPassive",!e),this._set("activated",e)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,childSelector:function(e){var t=l.byNode(e);return e.parentNode==this.containerNode&&t&&t.focus},postCreate:function(){var e=this,t=typeof this.childSelector=="string"?this.childSelector:s.hitch(this,"childSelector");this.own(u(this.containerNode,u.selector(t,o.enter),function(){e.onItemHover(l.byNode(this))}),u(this.containerNode,u.selector(t,o.leave),function(){e.onItemUnhover(l.byNode(this))}),u(this.containerNode,u.selector(t,f),function(t){e.onItemClick(l.byNode(this),t),t.stopPropagation(),t.preventDefault()})),this.inherited(arguments)},onKeyboardSearch:function(e,t,n,r){this.inherited(arguments),!!e&&(r==-1||!!e.popup&&r==1)&&this.onItemClick(e,t)},_keyboardSearchCompare:function(e,t){return e.shortcutKey?t==e.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(e){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,e);else{var t=this._getTopMenu();t&&t._isMenuBar&&t.focusNext()}},_onPopupHover:function(){this.set("selected",this.currentPopupItem),this._stopPendingCloseTimer()},onItemHover:function(e){this.activated?(this.set("selected",e),e.popup&&!e.disabled&&!this.hover_timer&&(this.hover_timer=this.defer(function(){this._openItemPopup(e)},this.popupDelay))):this.passivePopupDelay<Infinity&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(e,{type:"click"})},this.passivePopupDelay)),this._hoveredChild=e,e._set("hovering",!0)},_onChildDeselect:function(e){this._stopPopupTimer(),this.currentPopupItem==e&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this._pendingClose_timer=null,this.currentPopupItem=null,e._closePopup()},this.popupDelay))},onItemUnhover:function(e){this._hoveredChild==e&&(this._hoveredChild=null),this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null),e._set("hovering",!1)},_stopPopupTimer:function(){this.hover_timer&&(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var e=this;e.parentMenu;e=e.parentMenu);return e},onItemClick:function(e,t){this.passive_hover_timer&&this.passive_hover_timer.remove(),this.focusChild(e);if(e.disabled)return!1;if(e.popup){this.set("selected",e),this.set("activated",!0);var n=/^key/.test(t._origType||t.type)||t.clientX==0&&t.clientY==0;this._openItemPopup(e,n)}else this.onExecute(),e._onClick?e._onClick(t):e.onClick(t)},_openItemPopup:function(e,t){if(e==this.currentPopupItem)return;this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup()),this._stopPopupTimer();var n=e.popup;n.parentMenu=this,this.own(this._mouseoverHandle=u.once(n.domNode,"mouseover",s.hitch(this,"_onPopupHover")));var r=this;e._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){t&&r.focusChild(e),r._cleanUp()},onExecute:s.hitch(this,"_cleanUp",!0),onClose:function(){r._mouseoverHandle&&(r._mouseoverHandle.remove(),delete r._mouseoverHandle)}},t),this.currentPopupItem=e},onOpen:function(){this.isShowingNow=!0,this.set("activated",!0)},onClose:function(){this.set("activated",!1),this.set("selected",null),this.isShowingNow=!1,this.parentMenu=null},_closeChild:function(){this._stopPopupTimer(),this.currentPopupItem&&(this.focused&&(r.set(this.selected.focusNode,"tabIndex",this.tabIndex),this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),this.currentPopupItem=null)},_onItemFocus:function(e){this._hoveredChild&&this._hoveredChild!=e&&this.onItemUnhover(this._hoveredChild),this.set("selected",e)},_onBlur:function(){this._cleanUp(!0),this.inherited(arguments)},_cleanUp:function(e){this._closeChild(),typeof this.isShowingNow=="undefined"&&this.set("activated",!1),e&&this.set("selected",null)}})}),pen.define("dijit/DropDownMenu",["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html","./_OnDijitClickMixin","./_MenuBase"],function(e,t,n,r,i){return e("dijit.DropDownMenu",[i,r],{templateString:n,baseClass:"dijitMenu",_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(e){this._moveToPopup(e),e.stopPropagation(),e.preventDefault()},_onLeftArrow:function(e){this.parentMenu?this.parentMenu._isMenuBar?this.parentMenu.focusPrev():this.onCancel(!1):(e.stopPropagation(),e.preventDefault())}})}),pen.define("dijit/Menu",["require","dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-geometry","dojo/dom-style","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","dojo/_base/window","dojo/window","./popup","./DropDownMenu","dojo/ready"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){return l("dijit-legacy-requires")&&v(0,function(){var t=["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"];e(t)}),n("dijit.Menu",d,{constructor:function(){this._bindings=[]},targetNodeIds:[],selector:"",contextMenuForWindow:!1,leftClickToOpen:!1,refocus:!0,postCreate:function(){this.contextMenuForWindow?this.bindDomNode(this.ownerDocumentBody):t.forEach(this.targetNodeIds,this.bindDomNode,this),this.inherited(arguments)},_iframeContentWindow:function(e){return h.get(this._iframeContentDocument(e))||this._iframeContentDocument(e).__parent__||e.name&&document.frames[e.name]||null},_iframeContentDocument:function(e){return e.contentDocument||e.contentWindow&&e.contentWindow.document||e.name&&document.frames[e.name]&&document.frames[e.name].document||null},bindDomNode:function(e){e=r.byId(e,this.ownerDocument);var t;if(e.tagName.toLowerCase()=="iframe"){var n=e,s=this._iframeContentWindow(n);t=c.body(s.document)}else t=e==c.body(this.ownerDocument)?this.ownerDocument.documentElement:e;var o={node:e,iframe:n};i.set(e,"_dijitMenu"+this.id,this._bindings.push(o));var l=a.hitch(this,function(e){var t=this.selector,r=t?function(e){return f.selector(t,e)}:function(e){return e},i=this;return[f(e,r(this.leftClickToOpen?"click":"contextmenu"),function(e){e.stopPropagation(),e.preventDefault(),i._scheduleOpen(this,n,{x:e.pageX,y:e.pageY})}),f(e,r("keydown"),function(e){e.shiftKey&&e.keyCode==u.F10&&(e.stopPropagation(),e.preventDefault(),i._scheduleOpen(this,n))})]});o.connects=t?l(t):[],n&&(o.onloadHandler=a.hitch(this,function(){var e=this._iframeContentWindow(n),t=c.body(e.document);o.connects=l(t)}),n.addEventListener?n.addEventListener("load",o.onloadHandler,!1):n.attachEvent("onload",o.onloadHandler))},unBindDomNode:function(e){var t;try{t=r.byId(e,this.ownerDocument)}catch(n){return}var s="_dijitMenu"+this.id;if(t&&i.has(t,s)){var o=i.get(t,s)-1,u=this._bindings[o],a;while(a=u.connects.pop())a.remove();var f=u.iframe;f&&(f.removeEventListener?f.removeEventListener("load",u.onloadHandler,!1):f.detachEvent("onload",u.onloadHandler)),i.remove(t,s),delete this._bindings[o]}},_scheduleOpen:function(e,t,n){this._openTimer||(this._openTimer=this.defer(function(){delete this._openTimer,this._openMyself({target:e,iframe:t,coords:n})},1))},_openMyself:function(e){function E(){g.refocus&&w&&w.focus(),p.close(g)}var t=e.target,n=e.iframe,i=e.coords,u=!i;this.currentTarget=t;if(i){if(n){var a=s.position(n,!0),f=this._iframeContentWindow(n),c=s.docScroll(f.document),h=o.getComputedStyle(n),d=o.toPixelValue,v=(l("ie")&&l("quirks")?0:d(n,h.paddingLeft))+(l("ie")&&l("quirks")?d(n,h.borderLeftWidth):0),m=(l("ie")&&l("quirks")?0:d(n,h.paddingTop))+(l("ie")&&l("quirks")?d(n,h.borderTopWidth):0);i.x+=a.x+v-c.x,i.y+=a.y+m-c.y}}else i=s.position(t,!0),i.x+=10,i.y+=10;var g=this,y=this._focusManager.get("prevNode"),b=this._focusManager.get("curNode"),w=!b||r.isDescendant(b,this.domNode)?y:b;p.open({popup:this,x:i.x,y:i.y,onExecute:E,onCancel:E,orient:this.isLeftToRight()?"L":"R"}),this.focus(),u||this.defer(function(){this._cleanUp(!0)}),this._onBlur=function(){this.inherited("_onBlur",arguments),p.close(this)}},destroy:function(){t.forEach(this._bindings,function(e){e&&this.unBindDomNode(e.node)},this),this.inherited(arguments)}})}),pen.define("dojo/text!pentaho/common/Menu.html",[],function(){return'<table class="pentaho-menu-outer" role="menu" tabIndex="${tabIndex}" dojoAttachEvent="onkeypress:_onContainerKeypress" cellspacing="0">\n	<tbody class="dijitReset" data-dojo-attach-point="containerNode"></tbody>\n</table>\n'}),pen.define("pentaho/common/Menu",["dojo/_base/declare","dijit/_WidgetBase","dijit/_Templated","dojo/on","dojo/query","dijit/Menu","dojo/text!pentaho/common/Menu.html"],function(e,t,n,r,i,s,o){return e("pentaho.common.Menu",[s],{baseClass:"pentaho-menu",templateString:o})}),pen.define("dijit/_Contained",["dojo/_base/declare","./registry"],function(e,t){return e("dijit._Contained",null,{_getSibling:function(e){var n=this.domNode;do n=n[e+"Sibling"];while(n&&n.nodeType!=1);return n&&t.byNode(n)},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},getIndexInParent:function(){var e=this.getParent();return!e||!e.getIndexOfChild?-1:e.getIndexOfChild(this)}})}),pen.define("dojo/text!dijit/templates/MenuItem.html",[],function(){return'<tr class="dijitReset dijitMenuItem pentaho-menuitem" data-dojo-attach-point="focusNode" role="menuitem" tabIndex="-1">\n	<td class="dijitReset dijitMenuItemIconCell" role="presentation">\n		<span role="presentation" class="dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point="iconNode"></span>\n	</td>\n	<td class="dijitReset dijitMenuItemLabel" colspan="2" data-dojo-attach-point="containerNode,textDirNode"></td>\n	<td class="dijitReset dijitMenuItemAccelKey" style="display: none" data-dojo-attach-point="accelKeyNode"></td>\n	<td class="dijitReset dijitMenuArrowCell" role="presentation">\n		<span data-dojo-attach-point="arrowWrapper" style="visibility: hidden">\n			<span class="dijitInline dijitIcon dijitMenuExpand"></span>\n			<span class="dijitMenuExpandA11y">+</span>\n		</span>\n	</td>\n</tr>\n'}),pen.define("dijit/MenuItem",["dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/kernel","dojo/sniff","dojo/_base/lang","./_Widget","./_TemplatedMixin","./_Contained","./_CssStateMixin","dojo/text!./templates/MenuItem.html"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=e("dijit.MenuItem"+(s("dojo-bidi")?"_NoBidi":""),[u,a,f,l],{templateString:c,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(e){this._set("label",e);var t="",n,r=e.search(/{\S}/);if(r>=0){t=e.charAt(r+1);var i=e.substr(0,r),s=e.substr(r+3);n=i+t+s,e=i+'<span class="dijitMenuItemShortcutKey">'+t+"</span>"+s}else n=e;this.domNode.setAttribute("aria-label",n+" "+this.accelKey),this.containerNode.innerHTML=e,this._set("shortcutKey",t)},iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:!1,_fillContent:function(e){e&&!("label"in this.params)&&this._set("label",e.innerHTML)},buildRendering:function(){this.inherited(arguments);var e=this.id+"_text";n.set(this.containerNode,"id",e),this.accelKeyNode&&n.set(this.accelKeyNode,"id",this.id+"_accel"),t.setSelectable(this.domNode,!1)},onClick:function(){},focus:function(){try{s("ie")==8&&this.containerNode.focus(),this.focusNode.focus()}catch(e){}},_onFocus:function(){this.getParent()._onItemFocus(this),this.inherited(arguments)},_setSelected:function(e){r.toggle(this.domNode,"dijitMenuItemSelected",e)},setLabel:function(e){i.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0"),this.set("label",e)},setDisabled:function(e){i.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0"),this.set("disabled",e)},_setDisabledAttr:function(e){this.focusNode.setAttribute("aria-disabled",e?"true":"false"),this._set("disabled",e)},_setAccelKeyAttr:function(e){this.accelKeyNode&&(this.accelKeyNode.style.display=e?"":"none",this.accelKeyNode.innerHTML=e,n.set(this.containerNode,"colSpan",e?"1":"2")),this._set("accelKey",e)}});return s("dojo-bidi")&&(h=e("dijit.MenuItem",h,{_setLabelAttr:function(e){this.inherited(arguments),this.textDir==="auto"&&this.applyTextDir(this.textDirNode)}})),h}),pen.define("dojo/text!pentaho/common/MenuItem.html",[],function(){return'<tr class="dijitReset pentaho-menuitem" data-dojo-attach-point="focusNode" role="menuitem" tabIndex="-1"\n		>\n	<td class="dijitReset dijitMenuItemIconCell" role="presentation">\n		<img src="${_blankGif}" alt="" class="pentaho-checkmenuitem" data-dojo-attach-point="iconNode"/>\n	</td>\n	<td class="dijitReset pentaho-menuitem-label" colspan="2" data-dojo-attach-point="containerNode"></td>\n	<td class="dijitReset dijitMenuArrowCell" role="presentation">\n		<div data-dojo-attach-point="arrowWrapper" style="visibility: hidden">\n			<img src="${_blankGif}" alt="" class="dijitMenuExpand"/>\n			<span class="dijitMenuExpandA11y">+</span>\n		</div>\n	</td>\n</tr>\n'}),pen.define("pentaho/common/MenuItem",["dojo/_base/declare","dijit/_WidgetBase","dijit/_Templated","dojo/on","dojo/query","dijit/MenuItem","dojo/text!pentaho/common/MenuItem.html","dojo/dom-class"],function(e,t,n,r,i,s,o,u){return e("pentaho.common.MenuItem",[s],{baseClass:"pentaho-menuitem",templateString:o,_setSelected:function(e){this.disabled||u.toggle(this.domNode,"pentaho-menuitem-hover",e)},setDisabled:function(e){this.set("disabled",e),u.toggle(this.domNode,"pentaho-menuitem-disabled",e)},_setDisabledAttr:function(e){this.focusNode.setAttribute("aria-disabled",e?"true":"false"),this._set("disabled",e),u.toggle(this.domNode,"pentaho-menuitem-disabled",e)},_onHover:function(){this.getParent().onItemHover(this),this.disabled||u.add(this.domNode,"pentaho-menuitem-hover")},_onUnhover:function(){this.getParent().onItemUnhover(this),this._set("hovering",!1),this.disabled||u.remove(this.domNode,"pentaho-menuitem-hover")}})}),pen.define("dijit/form/NumberTextBox",["dojo/_base/declare","dojo/_base/lang","dojo/number","./RangeBoundTextBox"],function(e,t,n,r){var i=e("dijit.form.NumberTextBoxMixin",null,{pattern:function(e){return"("+(this.focused&&this.editOptions?this._regExpGenerator(t.delegate(e,this.editOptions))+"|":"")+this._regExpGenerator(e)+")"},value:NaN,editOptions:{pattern:"#.######"},_formatter:n.format,_regExpGenerator:n.regexp,postMixInProperties:function(){this.inherited(arguments),this._set("type","text")},_setConstraintsAttr:function(e){var t=typeof e.places=="number"?e.places:0;t&&t++,typeof e.max!="number"&&(e.max=9*Math.pow(10,15-t)),typeof e.min!="number"&&(e.min=-9*Math.pow(10,15-t)),this.inherited(arguments,[e]),this.focusNode&&this.focusNode.value&&!isNaN(this.value)&&this.set("value",this.value)},_onFocus:function(){if(this.disabled||this.readOnly)return;var e=this.get("value");if(typeof e=="number"&&!isNaN(e)){var t=this.format(e,this.constraints);t!==undefined&&(this.textbox.value=t)}this.inherited(arguments)},format:function(e,n){var r=String(e);return typeof e!="number"?r:isNaN(e)?"":!("rangeCheck"in this&&this.rangeCheck(e,n))&&n.exponent!==!1&&/\de[-+]?\d/i.test(r)?r:(this.editOptions&&this.focused&&(n=t.mixin({},n,this.editOptions)),this._formatter(e,n))},_parser:n.parse,parse:function(e,n){var r=this._parser(e,t.mixin({},n,this.editOptions&&this.focused?this.editOptions:{}));return this.editOptions&&this.focused&&isNaN(r)&&(r=this._parser(e,n)),r},_getDisplayedValueAttr:function(){var e=this.inherited(arguments);return isNaN(e)?this.textbox.value:e},filter:function(e){return e==null||e===""?NaN:this.inherited(arguments)},serialize:function(e,t){return typeof e!="number"||isNaN(e)?"":this.inherited(arguments)},_setBlurValue:function(){var e=t.hitch(t.delegate(this,{focused:!0}),"get")("value");this._setValueAttr(e,!0)},_setValueAttr:function(e,t,n){if(e!==undefined&&n===undefined){n=String(e);if(typeof e=="number"){if(isNaN(e))n="";else if("rangeCheck"in this&&this.rangeCheck(e,this.constraints)||this.constraints.exponent===!1||!/\de[-+]?\d/i.test(n))n=undefined}else e?e=undefined:(n="",e=NaN)}this.inherited(arguments,[e,t,n])},_getValueAttr:function(){var e=this.inherited(arguments);if(isNaN(e)&&this.textbox.value!==""){if(this.constraints.exponent!==!1&&/\de[-+]?\d/i.test(this.textbox.value)&&(new RegExp("^"+n._realNumberRegexp(t.delegate(this.constraints))+"$")).test(this.textbox.value)){var r=Number(this.textbox.value);return isNaN(r)?undefined:r}return undefined}return e},isValid:function(e){if(!this.focused||this._isEmpty(this.textbox.value))return this.inherited(arguments);var t=this.get("value");return!isNaN(t)&&this.rangeCheck(t,this.constraints)?this.constraints.exponent!==!1&&/\de[-+]?\d/i.test(this.textbox.value)?!0:this.inherited(arguments):!1}}),s=e("dijit.form.NumberTextBox",[r,i],{baseClass:"dijitTextBox dijitNumberTextBox"});return s.Mixin=i,s}),pen.define("pentaho/common/PageControl",["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/form/NumberTextBox","dojo/dom-class","dojo/keys"],function(e,t,n,r,i,s,o){return e("pentaho.common.PageControl",[t,n,r],{templateString:"<div class='pc_pageControlContainer' data-dojo-attach-point='containerNode'><div class='pc_pagePrev' data-dojo-attach-point='prevPageControl'></div><div class='pc_pageNext' data-dojo-attach-point='nextPageControl'></div><div data-dojo-attach-point='pageNumberInput' data-dojo-type='dijit.form.NumberTextBox' class='pc_pageNumberInput' constraints='{min:1}'></div><div class='pc_pageTotal contrast-color' data-dojo-attach-point='pageTotalSpan'>/ ##</div></div>",getLocaleString:null,changePageNumberCallback:null,pageNumber:1,pageTotal:1,postCreate:function(){this.inherited(arguments),this._resetPageNumber(),this.setPageCount(this.pageTotal),this.connect(this.pageNumberInput,"onChange",this._changePageNumber),this.connect(this.pageNumberInput,"onKeyUp",this._pageNumberKeyUp),this.connect(this.prevPageControl,"onclick",this._prevPage),this.connect(this.nextPageControl,"onclick",this._nextPage)},registerLocalizationLookup:function(e){this.getLocaleString=e,this._localize()},registerPageNumberChangeCallback:function(e){this.changePageNumberCallback=e},setPageNumber:function(e){if(e<1||e>this.pageTotal){this._resetPageNumber();return}if(this.pageNumber===e)return;try{this._updateInternalPageNumber(e)}catch(t){console.error("Unable to update page number: "+t),this._resetPageNumber()}},getPageNumber:function(){return this.pageNumberInput.get("value")},getPageTotal:function(){return this.pageTotal},setPageCount:function(e){typeof e=="number"?this.pageTotal=e:this.pageTotal=1,this.pageTotalSpan.innerHTML="/ "+e,this._updatePageButtonState()},reset:function(){this._updateInternalPageNumber(1)},_localize:function(){this.prevPageControl.setAttribute("title",this.getLocaleString("PageControlPreviousPage_title")),this.nextPageControl.setAttribute("title",this.getLocaleString("PageControlNextPage_title"))},_updatePageButtonState:function(){this.pagePrevDisabled=this.pageNumber==1,this.pageNextDisabled=this.pageTotal==this.pageNumber,this.pagePrevDisabled?s.add(this.prevPageControl,"pc_pagePrevDisabled"):s.remove(this.prevPageControl,"pc_pagePrevDisabled"),this.pageNextDisabled?s.add(this.nextPageControl,"pc_pageNextDisabled"):s.remove(this.nextPageControl,"pc_pageNextDisabled")},_changePageNumber:function(){if(!this.pageNumberInput.isValid()){this._resetPageNumber();return}this.setPageNumber(this.pageNumberInput.get("value"))},_updateInternalPageNumber:function(e){this.changePageNumberCallback&&this.changePageNumberCallback(e),this.pageNumber=e,this.pageNumberInput.set("value",this.pageNumber,!1),this._updatePageButtonState()},_pageNumberKeyUp:function(e){switch(e.keyCode){case o.ENTER:this._changePageNumber();break;case o.ESCAPE:this._resetPageNumber();break;default:}},_resetPageNumber:function(){this.pageNumberInput.set("value",this.pageNumber),this._updatePageButtonState()},_prevPage:function(){if(this.pagePrevDisabled)return;this.setPageNumber(this.pageNumber-1)},_nextPage:function(){if(this.pageNextDisabled)return;this.setPageNumber(this.pageNumber+1)}})}),pen.define("dijit/Toolbar",["require","dojo/_base/declare","dojo/has","dojo/keys","dojo/ready","./_Widget","./_KeyNavContainer","./_TemplatedMixin"],function(e,t,n,r,i,s,o,u){return n("dijit-legacy-requires")&&i(0,function(){var t=["dijit/ToolbarSeparator"];e(t)}),t("dijit.Toolbar",[s,u,o],{templateString:'<div class="dijit" role="toolbar" tabIndex="${tabIndex}" data-dojo-attach-point="containerNode"></div>',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})}),pen.define("dijit/ToolbarSeparator",["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],function(e,t,n,r){return e("dijit.ToolbarSeparator",[n,r],{templateString:'<div class="dijitToolbarSeparator dijitInline" role="presentation"></div>',buildRendering:function(){this.inherited(arguments),t.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})}),pen.define("dijit/form/_ToggleButtonMixin",["dojo/_base/declare","dojo/dom-attr"],function(e,t){return e("dijit.form._ToggleButtonMixin",null,{checked:!1,_aria_attr:"aria-pressed",_onClick:function(e){var t=this.checked;this._set("checked",!t);var n=this.inherited(arguments);return this.set("checked",n?this.checked:t),n},_setCheckedAttr:function(e,n){this._set("checked",e);var r=this.focusNode||this.domNode;this._created&&t.get(r,"checked")!=!!e&&t.set(r,"checked",!!e),r.setAttribute(this._aria_attr,String(e)),this._handleOnChange(e,n)},postCreate:function(){this.inherited(arguments);var e=this.focusNode||this.domNode;this.checked&&e.setAttribute("checked","checked")},reset:function(){this._hasBeenBlurred=!1,this.set("checked",this.params.checked||!1)}})}),pen.define("dijit/form/ToggleButton",["dojo/_base/declare","dojo/_base/kernel","./Button","./_ToggleButtonMixin"],function(e,t,n,r){return e("dijit.form.ToggleButton",[n,r],{baseClass:"dijitToggleButton",setChecked:function(e){t.deprecated("setChecked("+e+") is deprecated. Use set('checked',"+e+") instead.","","2.0"),this.set("checked",e)}})}),pen.define("pentaho/common/GlassPane",["dojo/_base/declare","dijit/_WidgetBase","dijit/_Templated","dojo/on","dojo/query","dojo/dom-construct","dojo/dom-style"],function(e,t,n,r,i,s,o){return e("pentaho.common.GlassPane",[t],{_glassPaneDiv:null,create:function(e,t){this.inherited(arguments),this._glassPaneDiv=s.create("div",{id:"glasspane",className:"glasspane"}),document.body.appendChild(this._glassPaneDiv)},show:function(){o.set(this._glassPaneDiv,"display","block")},hide:function(){o.set(this._glassPaneDiv,"display","none")}})}),pen.define("reportviewer/reportviewer-main-module",["cdf/jquery","cdf/jquery-impromptu.3.1","cdf/jquery.ui","cdf/jquery.bgiframe","cdf/jquery.jdMenu","cdf/jquery.positionBy","cdf/jquery.tooltip","cdf/jquery.blockUI","cdf/jquery.eventstack","cdf/Base","cdf/Dashboards","cdf/CoreComponents","cdf/simile/ajax/simile-ajax-api","cdf/simile/ajax/scripts/json","common-repo/pentaho-ajax","common-ui/prompting/pentaho-prompting","common-ui/prompting/pentaho-prompting-builders","common-ui/prompting/pentaho-prompting-components","common-ui/prompting/pentaho-prompting-bind","reportviewer/reportviewer","reportviewer/reportviewer-prompt","reportviewer/reportviewer-logging","reportviewer/formatter","reportviewer/reportviewer","dojo/parser","pentaho/common/Messages","pentaho/common/MessageBox","pentaho/common/Menu","pentaho/common/MenuItem","pentaho/common/PageControl","dijit/Toolbar","dijit/ToolbarSeparator","dijit/form/ToggleButton","pentaho/common/GlassPane"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A){}),pen.define("reportviewer/reportviewer-app",["reportviewer/reportviewer-main-module","dojo/parser","reportviewer/reportviewer-prompt","reportviewer/reportviewer","reportviewer/reportviewer-logging"],function(e,t,n,r,i){t.parse(),window._isReportViewer=!0,window._isTopReportViewer=!0;try{_window.isTopReportViewer=window.parent===window||!window.parent._isReportViewer}catch(s){}var o=!1;try{o=!!window.top.PentahoMobile}catch(s){}Dashboards.blockUIwithDrag=function(){};var u;if(_isTopReportViewer){var a;try{a=window.top.location.search}catch(s){a=window.location.search}u={enabled:!!a&&("&"+a.substr(1)).indexOf("&debug=true")>=0}}else u={parent:window.parent.logger};window.logged=i.create(window.name,u),window.logger=window.logged.logger,window.prompt=new n,window.viewer=new r(prompt),window.prompt.load(),$(window).resize(logged("window.resize",function(){viewer.view.onViewportResize()}))}),pen.define("reportviewer/reportviewer-app",function(){});